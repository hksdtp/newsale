(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function n(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(c){if(c.ep)return;c.ep=!0;const u=n(c);fetch(c.href,u)}})();function Hg(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function nv(l){if(Object.prototype.hasOwnProperty.call(l,"__esModule"))return l;var a=l.default;if(typeof a=="function"){var n=function i(){var c=!1;try{c=this instanceof i}catch{}return c?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};n.prototype=a.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(l).forEach(function(i){var c=Object.getOwnPropertyDescriptor(l,i);Object.defineProperty(n,i,c.get?c:{enumerable:!0,get:function(){return l[i]}})}),n}var Du={exports:{}},ll={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S0;function lv(){if(S0)return ll;S0=1;var l=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function n(i,c,u){var h=null;if(u!==void 0&&(h=""+u),c.key!==void 0&&(h=""+c.key),"key"in c){u={};for(var g in c)g!=="key"&&(u[g]=c[g])}else u=c;return c=u.ref,{$$typeof:l,type:i,key:h,ref:c!==void 0?c:null,props:u}}return ll.Fragment=a,ll.jsx=n,ll.jsxs=n,ll}var _0;function iv(){return _0||(_0=1,Du.exports=lv()),Du.exports}var s=iv(),Au={exports:{}},_e={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k0;function ov(){if(k0)return _e;k0=1;var l=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function j(k){return k===null||typeof k!="object"?null:(k=v&&k[v]||k["@@iterator"],typeof k=="function"?k:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,_={};function D(k,V,C){this.props=k,this.context=V,this.refs=_,this.updater=C||N}D.prototype.isReactComponent={},D.prototype.setState=function(k,V){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,V,"setState")},D.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function M(){}M.prototype=D.prototype;function E(k,V,C){this.props=k,this.context=V,this.refs=_,this.updater=C||N}var A=E.prototype=new M;A.constructor=E,S(A,D.prototype),A.isPureReactComponent=!0;var G=Array.isArray,q={H:null,A:null,T:null,S:null,V:null},H=Object.prototype.hasOwnProperty;function R(k,V,C,I,oe,he){return C=he.ref,{$$typeof:l,type:k,key:V,ref:C!==void 0?C:null,props:he}}function Z(k,V){return R(k.type,V,void 0,void 0,void 0,k.props)}function ue(k){return typeof k=="object"&&k!==null&&k.$$typeof===l}function re(k){var V={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(C){return V[C]})}var ee=/\/+/g;function le(k,V){return typeof k=="object"&&k!==null&&k.key!=null?re(""+k.key):V.toString(36)}function ne(){}function Y(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(ne,ne):(k.status="pending",k.then(function(V){k.status==="pending"&&(k.status="fulfilled",k.value=V)},function(V){k.status==="pending"&&(k.status="rejected",k.reason=V)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function ie(k,V,C,I,oe){var he=typeof k;(he==="undefined"||he==="boolean")&&(k=null);var xe=!1;if(k===null)xe=!0;else switch(he){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(k.$$typeof){case l:case a:xe=!0;break;case p:return xe=k._init,ie(xe(k._payload),V,C,I,oe)}}if(xe)return oe=oe(k),xe=I===""?"."+le(k,0):I,G(oe)?(C="",xe!=null&&(C=xe.replace(ee,"$&/")+"/"),ie(oe,V,C,"",function(zt){return zt})):oe!=null&&(ue(oe)&&(oe=Z(oe,C+(oe.key==null||k&&k.key===oe.key?"":(""+oe.key).replace(ee,"$&/")+"/")+xe)),V.push(oe)),1;xe=0;var mt=I===""?".":I+":";if(G(k))for(var Be=0;Be<k.length;Be++)I=k[Be],he=mt+le(I,Be),xe+=ie(I,V,C,he,oe);else if(Be=j(k),typeof Be=="function")for(k=Be.call(k),Be=0;!(I=k.next()).done;)I=I.value,he=mt+le(I,Be++),xe+=ie(I,V,C,he,oe);else if(he==="object"){if(typeof k.then=="function")return ie(Y(k),V,C,I,oe);throw V=String(k),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return xe}function L(k,V,C){if(k==null)return k;var I=[],oe=0;return ie(k,I,"","",function(he){return V.call(C,he,oe++)}),I}function Q(k){if(k._status===-1){var V=k._result;V=V(),V.then(function(C){(k._status===0||k._status===-1)&&(k._status=1,k._result=C)},function(C){(k._status===0||k._status===-1)&&(k._status=2,k._result=C)}),k._status===-1&&(k._status=0,k._result=V)}if(k._status===1)return k._result.default;throw k._result}var ae=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)};function ye(){}return _e.Children={map:L,forEach:function(k,V,C){L(k,function(){V.apply(this,arguments)},C)},count:function(k){var V=0;return L(k,function(){V++}),V},toArray:function(k){return L(k,function(V){return V})||[]},only:function(k){if(!ue(k))throw Error("React.Children.only expected to receive a single React element child.");return k}},_e.Component=D,_e.Fragment=n,_e.Profiler=c,_e.PureComponent=E,_e.StrictMode=i,_e.Suspense=m,_e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=q,_e.__COMPILER_RUNTIME={__proto__:null,c:function(k){return q.H.useMemoCache(k)}},_e.cache=function(k){return function(){return k.apply(null,arguments)}},_e.cloneElement=function(k,V,C){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var I=S({},k.props),oe=k.key,he=void 0;if(V!=null)for(xe in V.ref!==void 0&&(he=void 0),V.key!==void 0&&(oe=""+V.key),V)!H.call(V,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&V.ref===void 0||(I[xe]=V[xe]);var xe=arguments.length-2;if(xe===1)I.children=C;else if(1<xe){for(var mt=Array(xe),Be=0;Be<xe;Be++)mt[Be]=arguments[Be+2];I.children=mt}return R(k.type,oe,void 0,void 0,he,I)},_e.createContext=function(k){return k={$$typeof:h,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:u,_context:k},k},_e.createElement=function(k,V,C){var I,oe={},he=null;if(V!=null)for(I in V.key!==void 0&&(he=""+V.key),V)H.call(V,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(oe[I]=V[I]);var xe=arguments.length-2;if(xe===1)oe.children=C;else if(1<xe){for(var mt=Array(xe),Be=0;Be<xe;Be++)mt[Be]=arguments[Be+2];oe.children=mt}if(k&&k.defaultProps)for(I in xe=k.defaultProps,xe)oe[I]===void 0&&(oe[I]=xe[I]);return R(k,he,void 0,void 0,null,oe)},_e.createRef=function(){return{current:null}},_e.forwardRef=function(k){return{$$typeof:g,render:k}},_e.isValidElement=ue,_e.lazy=function(k){return{$$typeof:p,_payload:{_status:-1,_result:k},_init:Q}},_e.memo=function(k,V){return{$$typeof:x,type:k,compare:V===void 0?null:V}},_e.startTransition=function(k){var V=q.T,C={};q.T=C;try{var I=k(),oe=q.S;oe!==null&&oe(C,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(ye,ae)}catch(he){ae(he)}finally{q.T=V}},_e.unstable_useCacheRefresh=function(){return q.H.useCacheRefresh()},_e.use=function(k){return q.H.use(k)},_e.useActionState=function(k,V,C){return q.H.useActionState(k,V,C)},_e.useCallback=function(k,V){return q.H.useCallback(k,V)},_e.useContext=function(k){return q.H.useContext(k)},_e.useDebugValue=function(){},_e.useDeferredValue=function(k,V){return q.H.useDeferredValue(k,V)},_e.useEffect=function(k,V,C){var I=q.H;if(typeof C=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return I.useEffect(k,V)},_e.useId=function(){return q.H.useId()},_e.useImperativeHandle=function(k,V,C){return q.H.useImperativeHandle(k,V,C)},_e.useInsertionEffect=function(k,V){return q.H.useInsertionEffect(k,V)},_e.useLayoutEffect=function(k,V){return q.H.useLayoutEffect(k,V)},_e.useMemo=function(k,V){return q.H.useMemo(k,V)},_e.useOptimistic=function(k,V){return q.H.useOptimistic(k,V)},_e.useReducer=function(k,V,C){return q.H.useReducer(k,V,C)},_e.useRef=function(k){return q.H.useRef(k)},_e.useState=function(k){return q.H.useState(k)},_e.useSyncExternalStore=function(k,V,C){return q.H.useSyncExternalStore(k,V,C)},_e.useTransition=function(){return q.H.useTransition()},_e.version="19.1.0",_e}var T0;function fd(){return T0||(T0=1,Au.exports=ov()),Au.exports}var b=fd();const Wr=Hg(b);var Mu={exports:{}},il={},Ou={exports:{}},Ru={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E0;function cv(){return E0||(E0=1,function(l){function a(L,Q){var ae=L.length;L.push(Q);e:for(;0<ae;){var ye=ae-1>>>1,k=L[ye];if(0<c(k,Q))L[ye]=Q,L[ae]=k,ae=ye;else break e}}function n(L){return L.length===0?null:L[0]}function i(L){if(L.length===0)return null;var Q=L[0],ae=L.pop();if(ae!==Q){L[0]=ae;e:for(var ye=0,k=L.length,V=k>>>1;ye<V;){var C=2*(ye+1)-1,I=L[C],oe=C+1,he=L[oe];if(0>c(I,ae))oe<k&&0>c(he,I)?(L[ye]=he,L[oe]=ae,ye=oe):(L[ye]=I,L[C]=ae,ye=C);else if(oe<k&&0>c(he,ae))L[ye]=he,L[oe]=ae,ye=oe;else break e}}return Q}function c(L,Q){var ae=L.sortIndex-Q.sortIndex;return ae!==0?ae:L.id-Q.id}if(l.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;l.unstable_now=function(){return u.now()}}else{var h=Date,g=h.now();l.unstable_now=function(){return h.now()-g}}var m=[],x=[],p=1,v=null,j=3,N=!1,S=!1,_=!1,D=!1,M=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function G(L){for(var Q=n(x);Q!==null;){if(Q.callback===null)i(x);else if(Q.startTime<=L)i(x),Q.sortIndex=Q.expirationTime,a(m,Q);else break;Q=n(x)}}function q(L){if(_=!1,G(L),!S)if(n(m)!==null)S=!0,H||(H=!0,le());else{var Q=n(x);Q!==null&&ie(q,Q.startTime-L)}}var H=!1,R=-1,Z=5,ue=-1;function re(){return D?!0:!(l.unstable_now()-ue<Z)}function ee(){if(D=!1,H){var L=l.unstable_now();ue=L;var Q=!0;try{e:{S=!1,_&&(_=!1,E(R),R=-1),N=!0;var ae=j;try{t:{for(G(L),v=n(m);v!==null&&!(v.expirationTime>L&&re());){var ye=v.callback;if(typeof ye=="function"){v.callback=null,j=v.priorityLevel;var k=ye(v.expirationTime<=L);if(L=l.unstable_now(),typeof k=="function"){v.callback=k,G(L),Q=!0;break t}v===n(m)&&i(m),G(L)}else i(m);v=n(m)}if(v!==null)Q=!0;else{var V=n(x);V!==null&&ie(q,V.startTime-L),Q=!1}}break e}finally{v=null,j=ae,N=!1}Q=void 0}}finally{Q?le():H=!1}}}var le;if(typeof A=="function")le=function(){A(ee)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,Y=ne.port2;ne.port1.onmessage=ee,le=function(){Y.postMessage(null)}}else le=function(){M(ee,0)};function ie(L,Q){R=M(function(){L(l.unstable_now())},Q)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(L){L.callback=null},l.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<L?Math.floor(1e3/L):5},l.unstable_getCurrentPriorityLevel=function(){return j},l.unstable_next=function(L){switch(j){case 1:case 2:case 3:var Q=3;break;default:Q=j}var ae=j;j=Q;try{return L()}finally{j=ae}},l.unstable_requestPaint=function(){D=!0},l.unstable_runWithPriority=function(L,Q){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var ae=j;j=L;try{return Q()}finally{j=ae}},l.unstable_scheduleCallback=function(L,Q,ae){var ye=l.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?ye+ae:ye):ae=ye,L){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=ae+k,L={id:p++,callback:Q,priorityLevel:L,startTime:ae,expirationTime:k,sortIndex:-1},ae>ye?(L.sortIndex=ae,a(x,L),n(m)===null&&L===n(x)&&(_?(E(R),R=-1):_=!0,ie(q,ae-ye))):(L.sortIndex=k,a(m,L),S||N||(S=!0,H||(H=!0,le()))),L},l.unstable_shouldYield=re,l.unstable_wrapCallback=function(L){var Q=j;return function(){var ae=j;j=Q;try{return L.apply(this,arguments)}finally{j=ae}}}}(Ru)),Ru}var C0;function uv(){return C0||(C0=1,Ou.exports=cv()),Ou.exports}var Uu={exports:{}},bt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D0;function dv(){if(D0)return bt;D0=1;var l=fd();function a(m){var x="https://react.dev/errors/"+m;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)x+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+m+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(a(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},c=Symbol.for("react.portal");function u(m,x,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:v==null?null:""+v,children:m,containerInfo:x,implementation:p}}var h=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(m,x){if(m==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return bt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,bt.createPortal=function(m,x){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(a(299));return u(m,x,null,p)},bt.flushSync=function(m){var x=h.T,p=i.p;try{if(h.T=null,i.p=2,m)return m()}finally{h.T=x,i.p=p,i.d.f()}},bt.preconnect=function(m,x){typeof m=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,i.d.C(m,x))},bt.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},bt.preinit=function(m,x){if(typeof m=="string"&&x&&typeof x.as=="string"){var p=x.as,v=g(p,x.crossOrigin),j=typeof x.integrity=="string"?x.integrity:void 0,N=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;p==="style"?i.d.S(m,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:v,integrity:j,fetchPriority:N}):p==="script"&&i.d.X(m,{crossOrigin:v,integrity:j,fetchPriority:N,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},bt.preinitModule=function(m,x){if(typeof m=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var p=g(x.as,x.crossOrigin);i.d.M(m,{crossOrigin:p,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&i.d.M(m)},bt.preload=function(m,x){if(typeof m=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var p=x.as,v=g(p,x.crossOrigin);i.d.L(m,p,{crossOrigin:v,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},bt.preloadModule=function(m,x){if(typeof m=="string")if(x){var p=g(x.as,x.crossOrigin);i.d.m(m,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:p,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else i.d.m(m)},bt.requestFormReset=function(m){i.d.r(m)},bt.unstable_batchedUpdates=function(m,x){return m(x)},bt.useFormState=function(m,x,p){return h.H.useFormState(m,x,p)},bt.useFormStatus=function(){return h.H.useHostTransitionStatus()},bt.version="19.1.0",bt}var A0;function Bg(){if(A0)return Uu.exports;A0=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(a){console.error(a)}}return l(),Uu.exports=dv(),Uu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M0;function hv(){if(M0)return il;M0=1;var l=uv(),a=fd(),n=Bg();function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(u(e)!==e)throw Error(i(188))}function m(e){var t=e.alternate;if(!t){if(t=u(e),t===null)throw Error(i(188));return t!==e?null:e}for(var r=e,o=t;;){var d=r.return;if(d===null)break;var f=d.alternate;if(f===null){if(o=d.return,o!==null){r=o;continue}break}if(d.child===f.child){for(f=d.child;f;){if(f===r)return g(d),e;if(f===o)return g(d),t;f=f.sibling}throw Error(i(188))}if(r.return!==o.return)r=d,o=f;else{for(var y=!1,w=d.child;w;){if(w===r){y=!0,r=d,o=f;break}if(w===o){y=!0,o=d,r=f;break}w=w.sibling}if(!y){for(w=f.child;w;){if(w===r){y=!0,r=f,o=d;break}if(w===o){y=!0,o=f,r=d;break}w=w.sibling}if(!y)throw Error(i(189))}}if(r.alternate!==o)throw Error(i(190))}if(r.tag!==3)throw Error(i(188));return r.stateNode.current===r?e:t}function x(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=x(e),t!==null)return t;e=e.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),A=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),ue=Symbol.for("react.activity"),re=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function le(e){return e===null||typeof e!="object"?null:(e=ee&&e[ee]||e["@@iterator"],typeof e=="function"?e:null)}var ne=Symbol.for("react.client.reference");function Y(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ne?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case D:return"Profiler";case _:return"StrictMode";case q:return"Suspense";case H:return"SuspenseList";case ue:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case N:return"Portal";case A:return(e.displayName||"Context")+".Provider";case E:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case R:return t=e.displayName||null,t!==null?t:Y(e.type)||"Memo";case Z:t=e._payload,e=e._init;try{return Y(e(t))}catch{}}return null}var ie=Array.isArray,L=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},ye=[],k=-1;function V(e){return{current:e}}function C(e){0>k||(e.current=ye[k],ye[k]=null,k--)}function I(e,t){k++,ye[k]=e.current,e.current=t}var oe=V(null),he=V(null),xe=V(null),mt=V(null);function Be(e,t){switch(I(xe,t),I(he,e),I(oe,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Jm(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Jm(t),e=Wm(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}C(oe),I(oe,e)}function zt(){C(oe),C(he),C(xe)}function Wa(e){e.memoizedState!==null&&I(mt,e);var t=oe.current,r=Wm(t,e.type);t!==r&&(I(he,e),I(oe,r))}function us(e){he.current===e&&(C(oe),C(he)),mt.current===e&&(C(mt),tl._currentValue=ae)}var J=Object.prototype.hasOwnProperty,fe=l.unstable_scheduleCallback,Ee=l.unstable_cancelCallback,Ce=l.unstable_shouldYield,Re=l.unstable_requestPaint,tt=l.unstable_now,er=l.unstable_getCurrentPriorityLevel,wa=l.unstable_ImmediatePriority,tr=l.unstable_UserBlockingPriority,ja=l.unstable_NormalPriority,yo=l.unstable_LowPriority,K=l.unstable_IdlePriority,ce=l.log,te=l.unstable_setDisableYieldValue,we=null,de=null;function He(e){if(typeof ce=="function"&&te(e),de&&typeof de.setStrictMode=="function")try{de.setStrictMode(we,e)}catch{}}var Ne=Math.clz32?Math.clz32:Gs,$t=Math.log,es=Math.LN2;function Gs(e){return e>>>=0,e===0?32:31-($t(e)/es|0)|0}var Na=256,Sa=4194304;function _a(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Al(e,t,r){var o=e.pendingLanes;if(o===0)return 0;var d=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var w=o&134217727;return w!==0?(o=w&~f,o!==0?d=_a(o):(y&=w,y!==0?d=_a(y):r||(r=w&~e,r!==0&&(d=_a(r))))):(w=o&~f,w!==0?d=_a(w):y!==0?d=_a(y):r||(r=o&~e,r!==0&&(d=_a(r)))),d===0?0:t!==0&&t!==d&&(t&f)===0&&(f=d&-d,r=t&-t,f>=r||f===32&&(r&4194048)!==0)?t:d}function un(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Vx(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rd(){var e=Na;return Na<<=1,(Na&4194048)===0&&(Na=256),e}function Ud(){var e=Sa;return Sa<<=1,(Sa&62914560)===0&&(Sa=4194304),e}function vo(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function dn(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Qx(e,t,r,o,d,f){var y=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var w=e.entanglements,T=e.expirationTimes,z=e.hiddenUpdates;for(r=y&~r;0<r;){var F=31-Ne(r),W=1<<F;w[F]=0,T[F]=-1;var $=z[F];if($!==null)for(z[F]=null,F=0;F<$.length;F++){var P=$[F];P!==null&&(P.lane&=-536870913)}r&=~W}o!==0&&Ld(e,o,0),f!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~t))}function Ld(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var o=31-Ne(t);e.entangledLanes|=t,e.entanglements[o]=e.entanglements[o]|1073741824|r&4194090}function Hd(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var o=31-Ne(r),d=1<<o;d&t|e[o]&t&&(e[o]|=t),r&=~d}}function bo(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function wo(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Bd(){var e=Q.p;return e!==0?e:(e=window.event,e===void 0?32:y0(e.type))}function Yx(e,t){var r=Q.p;try{return Q.p=e,t()}finally{Q.p=r}}var Is=Math.random().toString(36).slice(2),yt="__reactFiber$"+Is,_t="__reactProps$"+Is,sr="__reactContainer$"+Is,jo="__reactEvents$"+Is,Fx="__reactListeners$"+Is,Xx="__reactHandles$"+Is,qd="__reactResources$"+Is,hn="__reactMarker$"+Is;function No(e){delete e[yt],delete e[_t],delete e[jo],delete e[Fx],delete e[Xx]}function ar(e){var t=e[yt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[sr]||r[yt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=a0(e);e!==null;){if(r=e[yt])return r;e=a0(e)}return t}e=r,r=e.parentNode}return null}function rr(e){if(e=e[yt]||e[sr]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function fn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function nr(e){var t=e[qd];return t||(t=e[qd]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function ot(e){e[hn]=!0}var zd=new Set,$d={};function ka(e,t){lr(e,t),lr(e+"Capture",t)}function lr(e,t){for($d[e]=t,e=0;e<t.length;e++)zd.add(t[e])}var Zx=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pd={},Kd={};function Jx(e){return J.call(Kd,e)?!0:J.call(Pd,e)?!1:Zx.test(e)?Kd[e]=!0:(Pd[e]=!0,!1)}function Ml(e,t,r){if(Jx(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var o=t.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function Ol(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function js(e,t,r,o){if(o===null)e.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+o)}}var So,Gd;function ir(e){if(So===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);So=t&&t[1]||"",Gd=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+So+e+Gd}var _o=!1;function ko(e,t){if(!e||_o)return"";_o=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(t){var W=function(){throw Error()};if(Object.defineProperty(W.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(W,[])}catch(P){var $=P}Reflect.construct(e,[],W)}else{try{W.call()}catch(P){$=P}e.call(W.prototype)}}else{try{throw Error()}catch(P){$=P}(W=e())&&typeof W.catch=="function"&&W.catch(function(){})}}catch(P){if(P&&$&&typeof P.stack=="string")return[P.stack,$.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=o.DetermineComponentFrameRoot(),y=f[0],w=f[1];if(y&&w){var T=y.split(`
`),z=w.split(`
`);for(d=o=0;o<T.length&&!T[o].includes("DetermineComponentFrameRoot");)o++;for(;d<z.length&&!z[d].includes("DetermineComponentFrameRoot");)d++;if(o===T.length||d===z.length)for(o=T.length-1,d=z.length-1;1<=o&&0<=d&&T[o]!==z[d];)d--;for(;1<=o&&0<=d;o--,d--)if(T[o]!==z[d]){if(o!==1||d!==1)do if(o--,d--,0>d||T[o]!==z[d]){var F=`
`+T[o].replace(" at new "," at ");return e.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",e.displayName)),F}while(1<=o&&0<=d);break}}}finally{_o=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?ir(r):""}function Wx(e){switch(e.tag){case 26:case 27:case 5:return ir(e.type);case 16:return ir("Lazy");case 13:return ir("Suspense");case 19:return ir("SuspenseList");case 0:case 15:return ko(e.type,!1);case 11:return ko(e.type.render,!1);case 1:return ko(e.type,!0);case 31:return ir("Activity");default:return""}}function Id(e){try{var t="";do t+=Wx(e),e=e.return;while(e);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}function Pt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Vd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ep(e){var t=Vd(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var d=r.get,f=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return d.call(this)},set:function(y){o=""+y,f.call(this,y)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return o},setValue:function(y){o=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Rl(e){e._valueTracker||(e._valueTracker=ep(e))}function Qd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),o="";return e&&(o=Vd(e)?e.checked?"true":"false":e.value),e=o,e!==r?(t.setValue(e),!0):!1}function Ul(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var tp=/[\n"\\]/g;function Kt(e){return e.replace(tp,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function To(e,t,r,o,d,f,y,w){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Pt(t)):e.value!==""+Pt(t)&&(e.value=""+Pt(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?Eo(e,y,Pt(t)):r!=null?Eo(e,y,Pt(r)):o!=null&&e.removeAttribute("value"),d==null&&f!=null&&(e.defaultChecked=!!f),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?e.name=""+Pt(w):e.removeAttribute("name")}function Yd(e,t,r,o,d,f,y,w){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||r!=null){if(!(f!=="submit"&&f!=="reset"||t!=null))return;r=r!=null?""+Pt(r):"",t=t!=null?""+Pt(t):r,w||t===e.value||(e.value=t),e.defaultValue=t}o=o??d,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=w?e.checked:!!o,e.defaultChecked=!!o,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y)}function Eo(e,t,r){t==="number"&&Ul(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function or(e,t,r,o){if(e=e.options,t){t={};for(var d=0;d<r.length;d++)t["$"+r[d]]=!0;for(r=0;r<e.length;r++)d=t.hasOwnProperty("$"+e[r].value),e[r].selected!==d&&(e[r].selected=d),d&&o&&(e[r].defaultSelected=!0)}else{for(r=""+Pt(r),t=null,d=0;d<e.length;d++){if(e[d].value===r){e[d].selected=!0,o&&(e[d].defaultSelected=!0);return}t!==null||e[d].disabled||(t=e[d])}t!==null&&(t.selected=!0)}}function Fd(e,t,r){if(t!=null&&(t=""+Pt(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+Pt(r):""}function Xd(e,t,r,o){if(t==null){if(o!=null){if(r!=null)throw Error(i(92));if(ie(o)){if(1<o.length)throw Error(i(93));o=o[0]}r=o}r==null&&(r=""),t=r}r=Pt(t),e.defaultValue=r,o=e.textContent,o===r&&o!==""&&o!==null&&(e.value=o)}function cr(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var sp=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zd(e,t,r){var o=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?o?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":o?e.setProperty(t,r):typeof r!="number"||r===0||sp.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Jd(e,t,r){if(t!=null&&typeof t!="object")throw Error(i(62));if(e=e.style,r!=null){for(var o in r)!r.hasOwnProperty(o)||t!=null&&t.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var d in t)o=t[d],t.hasOwnProperty(d)&&r[d]!==o&&Zd(e,d,o)}else for(var f in t)t.hasOwnProperty(f)&&Zd(e,f,t[f])}function Co(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ap=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),rp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ll(e){return rp.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Do=null;function Ao(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ur=null,dr=null;function Wd(e){var t=rr(e);if(t&&(e=t.stateNode)){var r=e[_t]||null;e:switch(e=t.stateNode,t.type){case"input":if(To(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Kt(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var o=r[t];if(o!==e&&o.form===e.form){var d=o[_t]||null;if(!d)throw Error(i(90));To(o,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(t=0;t<r.length;t++)o=r[t],o.form===e.form&&Qd(o)}break e;case"textarea":Fd(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&or(e,!!r.multiple,t,!1)}}}var Mo=!1;function eh(e,t,r){if(Mo)return e(t,r);Mo=!0;try{var o=e(t);return o}finally{if(Mo=!1,(ur!==null||dr!==null)&&(wi(),ur&&(t=ur,e=dr,dr=ur=null,Wd(t),e)))for(t=0;t<e.length;t++)Wd(e[t])}}function mn(e,t){var r=e.stateNode;if(r===null)return null;var o=r[_t]||null;if(o===null)return null;r=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(i(231,t,typeof r));return r}var Ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Oo=!1;if(Ns)try{var gn={};Object.defineProperty(gn,"passive",{get:function(){Oo=!0}}),window.addEventListener("test",gn,gn),window.removeEventListener("test",gn,gn)}catch{Oo=!1}var Vs=null,Ro=null,Hl=null;function th(){if(Hl)return Hl;var e,t=Ro,r=t.length,o,d="value"in Vs?Vs.value:Vs.textContent,f=d.length;for(e=0;e<r&&t[e]===d[e];e++);var y=r-e;for(o=1;o<=y&&t[r-o]===d[f-o];o++);return Hl=d.slice(e,1<o?1-o:void 0)}function Bl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ql(){return!0}function sh(){return!1}function kt(e){function t(r,o,d,f,y){this._reactName=r,this._targetInst=d,this.type=o,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var w in e)e.hasOwnProperty(w)&&(r=e[w],this[w]=r?r(f):f[w]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?ql:sh,this.isPropagationStopped=sh,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),t}var Ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zl=kt(Ta),xn=p({},Ta,{view:0,detail:0}),np=kt(xn),Uo,Lo,pn,$l=p({},xn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pn&&(pn&&e.type==="mousemove"?(Uo=e.screenX-pn.screenX,Lo=e.screenY-pn.screenY):Lo=Uo=0,pn=e),Uo)},movementY:function(e){return"movementY"in e?e.movementY:Lo}}),ah=kt($l),lp=p({},$l,{dataTransfer:0}),ip=kt(lp),op=p({},xn,{relatedTarget:0}),Ho=kt(op),cp=p({},Ta,{animationName:0,elapsedTime:0,pseudoElement:0}),up=kt(cp),dp=p({},Ta,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),hp=kt(dp),fp=p({},Ta,{data:0}),rh=kt(fp),mp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=xp[e])?!!t[e]:!1}function Bo(){return pp}var yp=p({},xn,{key:function(e){if(e.key){var t=mp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Bl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bo,charCode:function(e){return e.type==="keypress"?Bl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Bl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),vp=kt(yp),bp=p({},$l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nh=kt(bp),wp=p({},xn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bo}),jp=kt(wp),Np=p({},Ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sp=kt(Np),_p=p({},$l,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),kp=kt(_p),Tp=p({},Ta,{newState:0,oldState:0}),Ep=kt(Tp),Cp=[9,13,27,32],qo=Ns&&"CompositionEvent"in window,yn=null;Ns&&"documentMode"in document&&(yn=document.documentMode);var Dp=Ns&&"TextEvent"in window&&!yn,lh=Ns&&(!qo||yn&&8<yn&&11>=yn),ih=" ",oh=!1;function ch(e,t){switch(e){case"keyup":return Cp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hr=!1;function Ap(e,t){switch(e){case"compositionend":return uh(t);case"keypress":return t.which!==32?null:(oh=!0,ih);case"textInput":return e=t.data,e===ih&&oh?null:e;default:return null}}function Mp(e,t){if(hr)return e==="compositionend"||!qo&&ch(e,t)?(e=th(),Hl=Ro=Vs=null,hr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return lh&&t.locale!=="ko"?null:t.data;default:return null}}var Op={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Op[e.type]:t==="textarea"}function hh(e,t,r,o){ur?dr?dr.push(o):dr=[o]:ur=o,t=Ti(t,"onChange"),0<t.length&&(r=new zl("onChange","change",null,r,o),e.push({event:r,listeners:t}))}var vn=null,bn=null;function Rp(e){Qm(e,0)}function Pl(e){var t=fn(e);if(Qd(t))return e}function fh(e,t){if(e==="change")return t}var mh=!1;if(Ns){var zo;if(Ns){var $o="oninput"in document;if(!$o){var gh=document.createElement("div");gh.setAttribute("oninput","return;"),$o=typeof gh.oninput=="function"}zo=$o}else zo=!1;mh=zo&&(!document.documentMode||9<document.documentMode)}function xh(){vn&&(vn.detachEvent("onpropertychange",ph),bn=vn=null)}function ph(e){if(e.propertyName==="value"&&Pl(bn)){var t=[];hh(t,bn,e,Ao(e)),eh(Rp,t)}}function Up(e,t,r){e==="focusin"?(xh(),vn=t,bn=r,vn.attachEvent("onpropertychange",ph)):e==="focusout"&&xh()}function Lp(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Pl(bn)}function Hp(e,t){if(e==="click")return Pl(t)}function Bp(e,t){if(e==="input"||e==="change")return Pl(t)}function qp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Mt=typeof Object.is=="function"?Object.is:qp;function wn(e,t){if(Mt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++){var d=r[o];if(!J.call(t,d)||!Mt(e[d],t[d]))return!1}return!0}function yh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function vh(e,t){var r=yh(e);e=0;for(var o;r;){if(r.nodeType===3){if(o=e+r.textContent.length,e<=t&&o>=t)return{node:r,offset:t-e};e=o}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=yh(r)}}function bh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?bh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function wh(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Ul(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ul(e.document)}return t}function Po(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var zp=Ns&&"documentMode"in document&&11>=document.documentMode,fr=null,Ko=null,jn=null,Go=!1;function jh(e,t,r){var o=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Go||fr==null||fr!==Ul(o)||(o=fr,"selectionStart"in o&&Po(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),jn&&wn(jn,o)||(jn=o,o=Ti(Ko,"onSelect"),0<o.length&&(t=new zl("onSelect","select",null,t,r),e.push({event:t,listeners:o}),t.target=fr)))}function Ea(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var mr={animationend:Ea("Animation","AnimationEnd"),animationiteration:Ea("Animation","AnimationIteration"),animationstart:Ea("Animation","AnimationStart"),transitionrun:Ea("Transition","TransitionRun"),transitionstart:Ea("Transition","TransitionStart"),transitioncancel:Ea("Transition","TransitionCancel"),transitionend:Ea("Transition","TransitionEnd")},Io={},Nh={};Ns&&(Nh=document.createElement("div").style,"AnimationEvent"in window||(delete mr.animationend.animation,delete mr.animationiteration.animation,delete mr.animationstart.animation),"TransitionEvent"in window||delete mr.transitionend.transition);function Ca(e){if(Io[e])return Io[e];if(!mr[e])return e;var t=mr[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Nh)return Io[e]=t[r];return e}var Sh=Ca("animationend"),_h=Ca("animationiteration"),kh=Ca("animationstart"),$p=Ca("transitionrun"),Pp=Ca("transitionstart"),Kp=Ca("transitioncancel"),Th=Ca("transitionend"),Eh=new Map,Vo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vo.push("scrollEnd");function ts(e,t){Eh.set(e,t),ka(t,[e])}var Ch=new WeakMap;function Gt(e,t){if(typeof e=="object"&&e!==null){var r=Ch.get(e);return r!==void 0?r:(t={value:e,source:t,stack:Id(t)},Ch.set(e,t),t)}return{value:e,source:t,stack:Id(t)}}var It=[],gr=0,Qo=0;function Kl(){for(var e=gr,t=Qo=gr=0;t<e;){var r=It[t];It[t++]=null;var o=It[t];It[t++]=null;var d=It[t];It[t++]=null;var f=It[t];if(It[t++]=null,o!==null&&d!==null){var y=o.pending;y===null?d.next=d:(d.next=y.next,y.next=d),o.pending=d}f!==0&&Dh(r,d,f)}}function Gl(e,t,r,o){It[gr++]=e,It[gr++]=t,It[gr++]=r,It[gr++]=o,Qo|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function Yo(e,t,r,o){return Gl(e,t,r,o),Il(e)}function xr(e,t){return Gl(e,null,null,t),Il(e)}function Dh(e,t,r){e.lanes|=r;var o=e.alternate;o!==null&&(o.lanes|=r);for(var d=!1,f=e.return;f!==null;)f.childLanes|=r,o=f.alternate,o!==null&&(o.childLanes|=r),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(d=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,d&&t!==null&&(d=31-Ne(r),e=f.hiddenUpdates,o=e[d],o===null?e[d]=[t]:o.push(t),t.lane=r|536870912),f):null}function Il(e){if(50<Qn)throw Qn=0,eu=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var pr={};function Gp(e,t,r,o){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ot(e,t,r,o){return new Gp(e,t,r,o)}function Fo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ss(e,t){var r=e.alternate;return r===null?(r=Ot(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Ah(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Vl(e,t,r,o,d,f){var y=0;if(o=e,typeof e=="function")Fo(e)&&(y=1);else if(typeof e=="string")y=Vy(e,r,oe.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ue:return e=Ot(31,r,t,d),e.elementType=ue,e.lanes=f,e;case S:return Da(r.children,d,f,t);case _:y=8,d|=24;break;case D:return e=Ot(12,r,t,d|2),e.elementType=D,e.lanes=f,e;case q:return e=Ot(13,r,t,d),e.elementType=q,e.lanes=f,e;case H:return e=Ot(19,r,t,d),e.elementType=H,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:case A:y=10;break e;case E:y=9;break e;case G:y=11;break e;case R:y=14;break e;case Z:y=16,o=null;break e}y=29,r=Error(i(130,e===null?"null":typeof e,"")),o=null}return t=Ot(y,r,t,d),t.elementType=e,t.type=o,t.lanes=f,t}function Da(e,t,r,o){return e=Ot(7,e,o,t),e.lanes=r,e}function Xo(e,t,r){return e=Ot(6,e,null,t),e.lanes=r,e}function Zo(e,t,r){return t=Ot(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var yr=[],vr=0,Ql=null,Yl=0,Vt=[],Qt=0,Aa=null,_s=1,ks="";function Ma(e,t){yr[vr++]=Yl,yr[vr++]=Ql,Ql=e,Yl=t}function Mh(e,t,r){Vt[Qt++]=_s,Vt[Qt++]=ks,Vt[Qt++]=Aa,Aa=e;var o=_s;e=ks;var d=32-Ne(o)-1;o&=~(1<<d),r+=1;var f=32-Ne(t)+d;if(30<f){var y=d-d%5;f=(o&(1<<y)-1).toString(32),o>>=y,d-=y,_s=1<<32-Ne(t)+d|r<<d|o,ks=f+e}else _s=1<<f|r<<d|o,ks=e}function Jo(e){e.return!==null&&(Ma(e,1),Mh(e,1,0))}function Wo(e){for(;e===Ql;)Ql=yr[--vr],yr[vr]=null,Yl=yr[--vr],yr[vr]=null;for(;e===Aa;)Aa=Vt[--Qt],Vt[Qt]=null,ks=Vt[--Qt],Vt[Qt]=null,_s=Vt[--Qt],Vt[Qt]=null}var jt=null,We=null,Le=!1,Oa=null,ds=!1,ec=Error(i(519));function Ra(e){var t=Error(i(418,""));throw _n(Gt(t,e)),ec}function Oh(e){var t=e.stateNode,r=e.type,o=e.memoizedProps;switch(t[yt]=e,t[_t]=o,r){case"dialog":Ae("cancel",t),Ae("close",t);break;case"iframe":case"object":case"embed":Ae("load",t);break;case"video":case"audio":for(r=0;r<Fn.length;r++)Ae(Fn[r],t);break;case"source":Ae("error",t);break;case"img":case"image":case"link":Ae("error",t),Ae("load",t);break;case"details":Ae("toggle",t);break;case"input":Ae("invalid",t),Yd(t,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0),Rl(t);break;case"select":Ae("invalid",t);break;case"textarea":Ae("invalid",t),Xd(t,o.value,o.defaultValue,o.children),Rl(t)}r=o.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||o.suppressHydrationWarning===!0||Zm(t.textContent,r)?(o.popover!=null&&(Ae("beforetoggle",t),Ae("toggle",t)),o.onScroll!=null&&Ae("scroll",t),o.onScrollEnd!=null&&Ae("scrollend",t),o.onClick!=null&&(t.onclick=Ei),t=!0):t=!1,t||Ra(e)}function Rh(e){for(jt=e.return;jt;)switch(jt.tag){case 5:case 13:ds=!1;return;case 27:case 3:ds=!0;return;default:jt=jt.return}}function Nn(e){if(e!==jt)return!1;if(!Le)return Rh(e),Le=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||xu(e.type,e.memoizedProps)),r=!r),r&&We&&Ra(e),Rh(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(r=e.data,r==="/$"){if(t===0){We=as(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++;e=e.nextSibling}We=null}}else t===27?(t=We,oa(e.type)?(e=bu,bu=null,We=e):We=t):We=jt?as(e.stateNode.nextSibling):null;return!0}function Sn(){We=jt=null,Le=!1}function Uh(){var e=Oa;return e!==null&&(Ct===null?Ct=e:Ct.push.apply(Ct,e),Oa=null),e}function _n(e){Oa===null?Oa=[e]:Oa.push(e)}var tc=V(null),Ua=null,Ts=null;function Qs(e,t,r){I(tc,t._currentValue),t._currentValue=r}function Es(e){e._currentValue=tc.current,C(tc)}function sc(e,t,r){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===r)break;e=e.return}}function ac(e,t,r,o){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var f=d.dependencies;if(f!==null){var y=d.child;f=f.firstContext;e:for(;f!==null;){var w=f;f=d;for(var T=0;T<t.length;T++)if(w.context===t[T]){f.lanes|=r,w=f.alternate,w!==null&&(w.lanes|=r),sc(f.return,r,e),o||(y=null);break e}f=w.next}}else if(d.tag===18){if(y=d.return,y===null)throw Error(i(341));y.lanes|=r,f=y.alternate,f!==null&&(f.lanes|=r),sc(y,r,e),y=null}else y=d.child;if(y!==null)y.return=d;else for(y=d;y!==null;){if(y===e){y=null;break}if(d=y.sibling,d!==null){d.return=y.return,y=d;break}y=y.return}d=y}}function kn(e,t,r,o){e=null;for(var d=t,f=!1;d!==null;){if(!f){if((d.flags&524288)!==0)f=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var y=d.alternate;if(y===null)throw Error(i(387));if(y=y.memoizedProps,y!==null){var w=d.type;Mt(d.pendingProps.value,y.value)||(e!==null?e.push(w):e=[w])}}else if(d===mt.current){if(y=d.alternate,y===null)throw Error(i(387));y.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(tl):e=[tl])}d=d.return}e!==null&&ac(t,e,r,o),t.flags|=262144}function Fl(e){for(e=e.firstContext;e!==null;){if(!Mt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function La(e){Ua=e,Ts=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function vt(e){return Lh(Ua,e)}function Xl(e,t){return Ua===null&&La(e),Lh(e,t)}function Lh(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},Ts===null){if(e===null)throw Error(i(308));Ts=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ts=Ts.next=t;return r}var Ip=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,o){e.push(o)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},Vp=l.unstable_scheduleCallback,Qp=l.unstable_NormalPriority,lt={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function rc(){return{controller:new Ip,data:new Map,refCount:0}}function Tn(e){e.refCount--,e.refCount===0&&Vp(Qp,function(){e.controller.abort()})}var En=null,nc=0,br=0,wr=null;function Yp(e,t){if(En===null){var r=En=[];nc=0,br=iu(),wr={status:"pending",value:void 0,then:function(o){r.push(o)}}}return nc++,t.then(Hh,Hh),t}function Hh(){if(--nc===0&&En!==null){wr!==null&&(wr.status="fulfilled");var e=En;En=null,br=0,wr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Fp(e,t){var r=[],o={status:"pending",value:null,reason:null,then:function(d){r.push(d)}};return e.then(function(){o.status="fulfilled",o.value=t;for(var d=0;d<r.length;d++)(0,r[d])(t)},function(d){for(o.status="rejected",o.reason=d,d=0;d<r.length;d++)(0,r[d])(void 0)}),o}var Bh=L.S;L.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Yp(e,t),Bh!==null&&Bh(e,t)};var Ha=V(null);function lc(){var e=Ha.current;return e!==null?e:Ve.pooledCache}function Zl(e,t){t===null?I(Ha,Ha.current):I(Ha,t.pool)}function qh(){var e=lc();return e===null?null:{parent:lt._currentValue,pool:e}}var Cn=Error(i(460)),zh=Error(i(474)),Jl=Error(i(542)),ic={then:function(){}};function $h(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Wl(){}function Ph(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(Wl,Wl),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Gh(e),e;default:if(typeof t.status=="string")t.then(Wl,Wl);else{if(e=Ve,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status="pending",e.then(function(o){if(t.status==="pending"){var d=t;d.status="fulfilled",d.value=o}},function(o){if(t.status==="pending"){var d=t;d.status="rejected",d.reason=o}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Gh(e),e}throw Dn=t,Cn}}var Dn=null;function Kh(){if(Dn===null)throw Error(i(459));var e=Dn;return Dn=null,e}function Gh(e){if(e===Cn||e===Jl)throw Error(i(483))}var Ys=!1;function oc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Fs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Xs(e,t,r){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(qe&2)!==0){var d=o.pending;return d===null?t.next=t:(t.next=d.next,d.next=t),o.pending=t,t=Il(e),Dh(e,null,r),t}return Gl(e,o,t,r),Il(e)}function An(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,Hd(e,r)}}function uc(e,t){var r=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,r===o)){var d=null,f=null;if(r=r.firstBaseUpdate,r!==null){do{var y={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};f===null?d=f=y:f=f.next=y,r=r.next}while(r!==null);f===null?d=f=t:f=f.next=t}else d=f=t;r={baseState:o.baseState,firstBaseUpdate:d,lastBaseUpdate:f,shared:o.shared,callbacks:o.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var dc=!1;function Mn(){if(dc){var e=wr;if(e!==null)throw e}}function On(e,t,r,o){dc=!1;var d=e.updateQueue;Ys=!1;var f=d.firstBaseUpdate,y=d.lastBaseUpdate,w=d.shared.pending;if(w!==null){d.shared.pending=null;var T=w,z=T.next;T.next=null,y===null?f=z:y.next=z,y=T;var F=e.alternate;F!==null&&(F=F.updateQueue,w=F.lastBaseUpdate,w!==y&&(w===null?F.firstBaseUpdate=z:w.next=z,F.lastBaseUpdate=T))}if(f!==null){var W=d.baseState;y=0,F=z=T=null,w=f;do{var $=w.lane&-536870913,P=$!==w.lane;if(P?(Oe&$)===$:(o&$)===$){$!==0&&$===br&&(dc=!0),F!==null&&(F=F.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var be=e,pe=w;$=t;var Ge=r;switch(pe.tag){case 1:if(be=pe.payload,typeof be=="function"){W=be.call(Ge,W,$);break e}W=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=pe.payload,$=typeof be=="function"?be.call(Ge,W,$):be,$==null)break e;W=p({},W,$);break e;case 2:Ys=!0}}$=w.callback,$!==null&&(e.flags|=64,P&&(e.flags|=8192),P=d.callbacks,P===null?d.callbacks=[$]:P.push($))}else P={lane:$,tag:w.tag,payload:w.payload,callback:w.callback,next:null},F===null?(z=F=P,T=W):F=F.next=P,y|=$;if(w=w.next,w===null){if(w=d.shared.pending,w===null)break;P=w,w=P.next,P.next=null,d.lastBaseUpdate=P,d.shared.pending=null}}while(!0);F===null&&(T=W),d.baseState=T,d.firstBaseUpdate=z,d.lastBaseUpdate=F,f===null&&(d.shared.lanes=0),ra|=y,e.lanes=y,e.memoizedState=W}}function Ih(e,t){if(typeof e!="function")throw Error(i(191,e));e.call(t)}function Vh(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)Ih(r[e],t)}var jr=V(null),ei=V(0);function Qh(e,t){e=Us,I(ei,e),I(jr,t),Us=e|t.baseLanes}function hc(){I(ei,Us),I(jr,jr.current)}function fc(){Us=ei.current,C(jr),C(ei)}var Zs=0,ke=null,Pe=null,rt=null,ti=!1,Nr=!1,Ba=!1,si=0,Rn=0,Sr=null,Xp=0;function st(){throw Error(i(321))}function mc(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Mt(e[r],t[r]))return!1;return!0}function gc(e,t,r,o,d,f){return Zs=f,ke=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,L.H=e===null||e.memoizedState===null?Af:Mf,Ba=!1,f=r(o,d),Ba=!1,Nr&&(f=Fh(t,r,o,d)),Yh(e),f}function Yh(e){L.H=oi;var t=Pe!==null&&Pe.next!==null;if(Zs=0,rt=Pe=ke=null,ti=!1,Rn=0,Sr=null,t)throw Error(i(300));e===null||ct||(e=e.dependencies,e!==null&&Fl(e)&&(ct=!0))}function Fh(e,t,r,o){ke=e;var d=0;do{if(Nr&&(Sr=null),Rn=0,Nr=!1,25<=d)throw Error(i(301));if(d+=1,rt=Pe=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}L.H=ay,f=t(r,o)}while(Nr);return f}function Zp(){var e=L.H,t=e.useState()[0];return t=typeof t.then=="function"?Un(t):t,e=e.useState()[0],(Pe!==null?Pe.memoizedState:null)!==e&&(ke.flags|=1024),t}function xc(){var e=si!==0;return si=0,e}function pc(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function yc(e){if(ti){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}ti=!1}Zs=0,rt=Pe=ke=null,Nr=!1,Rn=si=0,Sr=null}function Tt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?ke.memoizedState=rt=e:rt=rt.next=e,rt}function nt(){if(Pe===null){var e=ke.alternate;e=e!==null?e.memoizedState:null}else e=Pe.next;var t=rt===null?ke.memoizedState:rt.next;if(t!==null)rt=t,Pe=e;else{if(e===null)throw ke.alternate===null?Error(i(467)):Error(i(310));Pe=e,e={memoizedState:Pe.memoizedState,baseState:Pe.baseState,baseQueue:Pe.baseQueue,queue:Pe.queue,next:null},rt===null?ke.memoizedState=rt=e:rt=rt.next=e}return rt}function vc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Un(e){var t=Rn;return Rn+=1,Sr===null&&(Sr=[]),e=Ph(Sr,e,t),t=ke,(rt===null?t.memoizedState:rt.next)===null&&(t=t.alternate,L.H=t===null||t.memoizedState===null?Af:Mf),e}function ai(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Un(e);if(e.$$typeof===A)return vt(e)}throw Error(i(438,String(e)))}function bc(e){var t=null,r=ke.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var o=ke.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(t={data:o.data.map(function(d){return d.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=vc(),ke.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),o=0;o<e;o++)r[o]=re;return t.index++,r}function Cs(e,t){return typeof t=="function"?t(e):t}function ri(e){var t=nt();return wc(t,Pe,e)}function wc(e,t,r){var o=e.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var d=e.baseQueue,f=o.pending;if(f!==null){if(d!==null){var y=d.next;d.next=f.next,f.next=y}t.baseQueue=d=f,o.pending=null}if(f=e.baseState,d===null)e.memoizedState=f;else{t=d.next;var w=y=null,T=null,z=t,F=!1;do{var W=z.lane&-536870913;if(W!==z.lane?(Oe&W)===W:(Zs&W)===W){var $=z.revertLane;if($===0)T!==null&&(T=T.next={lane:0,revertLane:0,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),W===br&&(F=!0);else if((Zs&$)===$){z=z.next,$===br&&(F=!0);continue}else W={lane:0,revertLane:z.revertLane,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},T===null?(w=T=W,y=f):T=T.next=W,ke.lanes|=$,ra|=$;W=z.action,Ba&&r(f,W),f=z.hasEagerState?z.eagerState:r(f,W)}else $={lane:W,revertLane:z.revertLane,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null},T===null?(w=T=$,y=f):T=T.next=$,ke.lanes|=W,ra|=W;z=z.next}while(z!==null&&z!==t);if(T===null?y=f:T.next=w,!Mt(f,e.memoizedState)&&(ct=!0,F&&(r=wr,r!==null)))throw r;e.memoizedState=f,e.baseState=y,e.baseQueue=T,o.lastRenderedState=f}return d===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function jc(e){var t=nt(),r=t.queue;if(r===null)throw Error(i(311));r.lastRenderedReducer=e;var o=r.dispatch,d=r.pending,f=t.memoizedState;if(d!==null){r.pending=null;var y=d=d.next;do f=e(f,y.action),y=y.next;while(y!==d);Mt(f,t.memoizedState)||(ct=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),r.lastRenderedState=f}return[f,o]}function Xh(e,t,r){var o=ke,d=nt(),f=Le;if(f){if(r===void 0)throw Error(i(407));r=r()}else r=t();var y=!Mt((Pe||d).memoizedState,r);y&&(d.memoizedState=r,ct=!0),d=d.queue;var w=Wh.bind(null,o,d,e);if(Ln(2048,8,w,[e]),d.getSnapshot!==t||y||rt!==null&&rt.memoizedState.tag&1){if(o.flags|=2048,_r(9,ni(),Jh.bind(null,o,d,r,t),null),Ve===null)throw Error(i(349));f||(Zs&124)!==0||Zh(o,t,r)}return r}function Zh(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ke.updateQueue,t===null?(t=vc(),ke.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Jh(e,t,r,o){t.value=r,t.getSnapshot=o,ef(t)&&tf(e)}function Wh(e,t,r){return r(function(){ef(t)&&tf(e)})}function ef(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Mt(e,r)}catch{return!0}}function tf(e){var t=xr(e,2);t!==null&&Bt(t,e,2)}function Nc(e){var t=Tt();if(typeof e=="function"){var r=e;if(e=r(),Ba){He(!0);try{r()}finally{He(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:e},t}function sf(e,t,r,o){return e.baseState=r,wc(e,Pe,typeof o=="function"?o:Cs)}function Jp(e,t,r,o,d){if(ii(e))throw Error(i(485));if(e=t.action,e!==null){var f={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};L.T!==null?r(!0):f.isTransition=!1,o(f),r=t.pending,r===null?(f.next=t.pending=f,af(t,f)):(f.next=r.next,t.pending=r.next=f)}}function af(e,t){var r=t.action,o=t.payload,d=e.state;if(t.isTransition){var f=L.T,y={};L.T=y;try{var w=r(d,o),T=L.S;T!==null&&T(y,w),rf(e,t,w)}catch(z){Sc(e,t,z)}finally{L.T=f}}else try{f=r(d,o),rf(e,t,f)}catch(z){Sc(e,t,z)}}function rf(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(o){nf(e,t,o)},function(o){return Sc(e,t,o)}):nf(e,t,r)}function nf(e,t,r){t.status="fulfilled",t.value=r,lf(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,af(e,r)))}function Sc(e,t,r){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do t.status="rejected",t.reason=r,lf(t),t=t.next;while(t!==o)}e.action=null}function lf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function of(e,t){return t}function cf(e,t){if(Le){var r=Ve.formState;if(r!==null){e:{var o=ke;if(Le){if(We){t:{for(var d=We,f=ds;d.nodeType!==8;){if(!f){d=null;break t}if(d=as(d.nextSibling),d===null){d=null;break t}}f=d.data,d=f==="F!"||f==="F"?d:null}if(d){We=as(d.nextSibling),o=d.data==="F!";break e}}Ra(o)}o=!1}o&&(t=r[0])}}return r=Tt(),r.memoizedState=r.baseState=t,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:of,lastRenderedState:t},r.queue=o,r=Ef.bind(null,ke,o),o.dispatch=r,o=Nc(!1),f=Cc.bind(null,ke,!1,o.queue),o=Tt(),d={state:t,dispatch:null,action:e,pending:null},o.queue=d,r=Jp.bind(null,ke,d,f,r),d.dispatch=r,o.memoizedState=e,[t,r,!1]}function uf(e){var t=nt();return df(t,Pe,e)}function df(e,t,r){if(t=wc(e,t,of)[0],e=ri(Cs)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var o=Un(t)}catch(y){throw y===Cn?Jl:y}else o=t;t=nt();var d=t.queue,f=d.dispatch;return r!==t.memoizedState&&(ke.flags|=2048,_r(9,ni(),Wp.bind(null,d,r),null)),[o,f,e]}function Wp(e,t){e.action=t}function hf(e){var t=nt(),r=Pe;if(r!==null)return df(t,r,e);nt(),t=t.memoizedState,r=nt();var o=r.queue.dispatch;return r.memoizedState=e,[t,o,!1]}function _r(e,t,r,o){return e={tag:e,create:r,deps:o,inst:t,next:null},t=ke.updateQueue,t===null&&(t=vc(),ke.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(o=r.next,r.next=e,e.next=o,t.lastEffect=e),e}function ni(){return{destroy:void 0,resource:void 0}}function ff(){return nt().memoizedState}function li(e,t,r,o){var d=Tt();o=o===void 0?null:o,ke.flags|=e,d.memoizedState=_r(1|t,ni(),r,o)}function Ln(e,t,r,o){var d=nt();o=o===void 0?null:o;var f=d.memoizedState.inst;Pe!==null&&o!==null&&mc(o,Pe.memoizedState.deps)?d.memoizedState=_r(t,f,r,o):(ke.flags|=e,d.memoizedState=_r(1|t,f,r,o))}function mf(e,t){li(8390656,8,e,t)}function gf(e,t){Ln(2048,8,e,t)}function xf(e,t){return Ln(4,2,e,t)}function pf(e,t){return Ln(4,4,e,t)}function yf(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function vf(e,t,r){r=r!=null?r.concat([e]):null,Ln(4,4,yf.bind(null,t,e),r)}function _c(){}function bf(e,t){var r=nt();t=t===void 0?null:t;var o=r.memoizedState;return t!==null&&mc(t,o[1])?o[0]:(r.memoizedState=[e,t],e)}function wf(e,t){var r=nt();t=t===void 0?null:t;var o=r.memoizedState;if(t!==null&&mc(t,o[1]))return o[0];if(o=e(),Ba){He(!0);try{e()}finally{He(!1)}}return r.memoizedState=[o,t],o}function kc(e,t,r){return r===void 0||(Zs&1073741824)!==0?e.memoizedState=t:(e.memoizedState=r,e=Sm(),ke.lanes|=e,ra|=e,r)}function jf(e,t,r,o){return Mt(r,t)?r:jr.current!==null?(e=kc(e,r,o),Mt(e,t)||(ct=!0),e):(Zs&42)===0?(ct=!0,e.memoizedState=r):(e=Sm(),ke.lanes|=e,ra|=e,t)}function Nf(e,t,r,o,d){var f=Q.p;Q.p=f!==0&&8>f?f:8;var y=L.T,w={};L.T=w,Cc(e,!1,t,r);try{var T=d(),z=L.S;if(z!==null&&z(w,T),T!==null&&typeof T=="object"&&typeof T.then=="function"){var F=Fp(T,o);Hn(e,t,F,Ht(e))}else Hn(e,t,o,Ht(e))}catch(W){Hn(e,t,{then:function(){},status:"rejected",reason:W},Ht())}finally{Q.p=f,L.T=y}}function ey(){}function Tc(e,t,r,o){if(e.tag!==5)throw Error(i(476));var d=Sf(e).queue;Nf(e,d,t,ae,r===null?ey:function(){return _f(e),r(o)})}function Sf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:ae},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cs,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function _f(e){var t=Sf(e).next.queue;Hn(e,t,{},Ht())}function Ec(){return vt(tl)}function kf(){return nt().memoizedState}function Tf(){return nt().memoizedState}function ty(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=Ht();e=Fs(r);var o=Xs(t,e,r);o!==null&&(Bt(o,t,r),An(o,t,r)),t={cache:rc()},e.payload=t;return}t=t.return}}function sy(e,t,r){var o=Ht();r={lane:o,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},ii(e)?Cf(t,r):(r=Yo(e,t,r,o),r!==null&&(Bt(r,e,o),Df(r,t,o)))}function Ef(e,t,r){var o=Ht();Hn(e,t,r,o)}function Hn(e,t,r,o){var d={lane:o,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(ii(e))Cf(t,d);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var y=t.lastRenderedState,w=f(y,r);if(d.hasEagerState=!0,d.eagerState=w,Mt(w,y))return Gl(e,t,d,0),Ve===null&&Kl(),!1}catch{}finally{}if(r=Yo(e,t,d,o),r!==null)return Bt(r,e,o),Df(r,t,o),!0}return!1}function Cc(e,t,r,o){if(o={lane:2,revertLane:iu(),action:o,hasEagerState:!1,eagerState:null,next:null},ii(e)){if(t)throw Error(i(479))}else t=Yo(e,r,o,2),t!==null&&Bt(t,e,2)}function ii(e){var t=e.alternate;return e===ke||t!==null&&t===ke}function Cf(e,t){Nr=ti=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Df(e,t,r){if((r&4194048)!==0){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,Hd(e,r)}}var oi={readContext:vt,use:ai,useCallback:st,useContext:st,useEffect:st,useImperativeHandle:st,useLayoutEffect:st,useInsertionEffect:st,useMemo:st,useReducer:st,useRef:st,useState:st,useDebugValue:st,useDeferredValue:st,useTransition:st,useSyncExternalStore:st,useId:st,useHostTransitionStatus:st,useFormState:st,useActionState:st,useOptimistic:st,useMemoCache:st,useCacheRefresh:st},Af={readContext:vt,use:ai,useCallback:function(e,t){return Tt().memoizedState=[e,t===void 0?null:t],e},useContext:vt,useEffect:mf,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,li(4194308,4,yf.bind(null,t,e),r)},useLayoutEffect:function(e,t){return li(4194308,4,e,t)},useInsertionEffect:function(e,t){li(4,2,e,t)},useMemo:function(e,t){var r=Tt();t=t===void 0?null:t;var o=e();if(Ba){He(!0);try{e()}finally{He(!1)}}return r.memoizedState=[o,t],o},useReducer:function(e,t,r){var o=Tt();if(r!==void 0){var d=r(t);if(Ba){He(!0);try{r(t)}finally{He(!1)}}}else d=t;return o.memoizedState=o.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},o.queue=e,e=e.dispatch=sy.bind(null,ke,e),[o.memoizedState,e]},useRef:function(e){var t=Tt();return e={current:e},t.memoizedState=e},useState:function(e){e=Nc(e);var t=e.queue,r=Ef.bind(null,ke,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:_c,useDeferredValue:function(e,t){var r=Tt();return kc(r,e,t)},useTransition:function(){var e=Nc(!1);return e=Nf.bind(null,ke,e.queue,!0,!1),Tt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var o=ke,d=Tt();if(Le){if(r===void 0)throw Error(i(407));r=r()}else{if(r=t(),Ve===null)throw Error(i(349));(Oe&124)!==0||Zh(o,t,r)}d.memoizedState=r;var f={value:r,getSnapshot:t};return d.queue=f,mf(Wh.bind(null,o,f,e),[e]),o.flags|=2048,_r(9,ni(),Jh.bind(null,o,f,r,t),null),r},useId:function(){var e=Tt(),t=Ve.identifierPrefix;if(Le){var r=ks,o=_s;r=(o&~(1<<32-Ne(o)-1)).toString(32)+r,t="«"+t+"R"+r,r=si++,0<r&&(t+="H"+r.toString(32)),t+="»"}else r=Xp++,t="«"+t+"r"+r.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Ec,useFormState:cf,useActionState:cf,useOptimistic:function(e){var t=Tt();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=Cc.bind(null,ke,!0,r),r.dispatch=t,[e,t]},useMemoCache:bc,useCacheRefresh:function(){return Tt().memoizedState=ty.bind(null,ke)}},Mf={readContext:vt,use:ai,useCallback:bf,useContext:vt,useEffect:gf,useImperativeHandle:vf,useInsertionEffect:xf,useLayoutEffect:pf,useMemo:wf,useReducer:ri,useRef:ff,useState:function(){return ri(Cs)},useDebugValue:_c,useDeferredValue:function(e,t){var r=nt();return jf(r,Pe.memoizedState,e,t)},useTransition:function(){var e=ri(Cs)[0],t=nt().memoizedState;return[typeof e=="boolean"?e:Un(e),t]},useSyncExternalStore:Xh,useId:kf,useHostTransitionStatus:Ec,useFormState:uf,useActionState:uf,useOptimistic:function(e,t){var r=nt();return sf(r,Pe,e,t)},useMemoCache:bc,useCacheRefresh:Tf},ay={readContext:vt,use:ai,useCallback:bf,useContext:vt,useEffect:gf,useImperativeHandle:vf,useInsertionEffect:xf,useLayoutEffect:pf,useMemo:wf,useReducer:jc,useRef:ff,useState:function(){return jc(Cs)},useDebugValue:_c,useDeferredValue:function(e,t){var r=nt();return Pe===null?kc(r,e,t):jf(r,Pe.memoizedState,e,t)},useTransition:function(){var e=jc(Cs)[0],t=nt().memoizedState;return[typeof e=="boolean"?e:Un(e),t]},useSyncExternalStore:Xh,useId:kf,useHostTransitionStatus:Ec,useFormState:hf,useActionState:hf,useOptimistic:function(e,t){var r=nt();return Pe!==null?sf(r,Pe,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:bc,useCacheRefresh:Tf},kr=null,Bn=0;function ci(e){var t=Bn;return Bn+=1,kr===null&&(kr=[]),Ph(kr,e,t)}function qn(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function ui(e,t){throw t.$$typeof===v?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Of(e){var t=e._init;return t(e._payload)}function Rf(e){function t(U,O){if(e){var B=U.deletions;B===null?(U.deletions=[O],U.flags|=16):B.push(O)}}function r(U,O){if(!e)return null;for(;O!==null;)t(U,O),O=O.sibling;return null}function o(U){for(var O=new Map;U!==null;)U.key!==null?O.set(U.key,U):O.set(U.index,U),U=U.sibling;return O}function d(U,O){return U=Ss(U,O),U.index=0,U.sibling=null,U}function f(U,O,B){return U.index=B,e?(B=U.alternate,B!==null?(B=B.index,B<O?(U.flags|=67108866,O):B):(U.flags|=67108866,O)):(U.flags|=1048576,O)}function y(U){return e&&U.alternate===null&&(U.flags|=67108866),U}function w(U,O,B,X){return O===null||O.tag!==6?(O=Xo(B,U.mode,X),O.return=U,O):(O=d(O,B),O.return=U,O)}function T(U,O,B,X){var me=B.type;return me===S?F(U,O,B.props.children,X,B.key):O!==null&&(O.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Z&&Of(me)===O.type)?(O=d(O,B.props),qn(O,B),O.return=U,O):(O=Vl(B.type,B.key,B.props,null,U.mode,X),qn(O,B),O.return=U,O)}function z(U,O,B,X){return O===null||O.tag!==4||O.stateNode.containerInfo!==B.containerInfo||O.stateNode.implementation!==B.implementation?(O=Zo(B,U.mode,X),O.return=U,O):(O=d(O,B.children||[]),O.return=U,O)}function F(U,O,B,X,me){return O===null||O.tag!==7?(O=Da(B,U.mode,X,me),O.return=U,O):(O=d(O,B),O.return=U,O)}function W(U,O,B){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=Xo(""+O,U.mode,B),O.return=U,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case j:return B=Vl(O.type,O.key,O.props,null,U.mode,B),qn(B,O),B.return=U,B;case N:return O=Zo(O,U.mode,B),O.return=U,O;case Z:var X=O._init;return O=X(O._payload),W(U,O,B)}if(ie(O)||le(O))return O=Da(O,U.mode,B,null),O.return=U,O;if(typeof O.then=="function")return W(U,ci(O),B);if(O.$$typeof===A)return W(U,Xl(U,O),B);ui(U,O)}return null}function $(U,O,B,X){var me=O!==null?O.key:null;if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return me!==null?null:w(U,O,""+B,X);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case j:return B.key===me?T(U,O,B,X):null;case N:return B.key===me?z(U,O,B,X):null;case Z:return me=B._init,B=me(B._payload),$(U,O,B,X)}if(ie(B)||le(B))return me!==null?null:F(U,O,B,X,null);if(typeof B.then=="function")return $(U,O,ci(B),X);if(B.$$typeof===A)return $(U,O,Xl(U,B),X);ui(U,B)}return null}function P(U,O,B,X,me){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return U=U.get(B)||null,w(O,U,""+X,me);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case j:return U=U.get(X.key===null?B:X.key)||null,T(O,U,X,me);case N:return U=U.get(X.key===null?B:X.key)||null,z(O,U,X,me);case Z:var Te=X._init;return X=Te(X._payload),P(U,O,B,X,me)}if(ie(X)||le(X))return U=U.get(B)||null,F(O,U,X,me,null);if(typeof X.then=="function")return P(U,O,B,ci(X),me);if(X.$$typeof===A)return P(U,O,B,Xl(O,X),me);ui(O,X)}return null}function be(U,O,B,X){for(var me=null,Te=null,ge=O,ve=O=0,dt=null;ge!==null&&ve<B.length;ve++){ge.index>ve?(dt=ge,ge=null):dt=ge.sibling;var Ue=$(U,ge,B[ve],X);if(Ue===null){ge===null&&(ge=dt);break}e&&ge&&Ue.alternate===null&&t(U,ge),O=f(Ue,O,ve),Te===null?me=Ue:Te.sibling=Ue,Te=Ue,ge=dt}if(ve===B.length)return r(U,ge),Le&&Ma(U,ve),me;if(ge===null){for(;ve<B.length;ve++)ge=W(U,B[ve],X),ge!==null&&(O=f(ge,O,ve),Te===null?me=ge:Te.sibling=ge,Te=ge);return Le&&Ma(U,ve),me}for(ge=o(ge);ve<B.length;ve++)dt=P(ge,U,ve,B[ve],X),dt!==null&&(e&&dt.alternate!==null&&ge.delete(dt.key===null?ve:dt.key),O=f(dt,O,ve),Te===null?me=dt:Te.sibling=dt,Te=dt);return e&&ge.forEach(function(fa){return t(U,fa)}),Le&&Ma(U,ve),me}function pe(U,O,B,X){if(B==null)throw Error(i(151));for(var me=null,Te=null,ge=O,ve=O=0,dt=null,Ue=B.next();ge!==null&&!Ue.done;ve++,Ue=B.next()){ge.index>ve?(dt=ge,ge=null):dt=ge.sibling;var fa=$(U,ge,Ue.value,X);if(fa===null){ge===null&&(ge=dt);break}e&&ge&&fa.alternate===null&&t(U,ge),O=f(fa,O,ve),Te===null?me=fa:Te.sibling=fa,Te=fa,ge=dt}if(Ue.done)return r(U,ge),Le&&Ma(U,ve),me;if(ge===null){for(;!Ue.done;ve++,Ue=B.next())Ue=W(U,Ue.value,X),Ue!==null&&(O=f(Ue,O,ve),Te===null?me=Ue:Te.sibling=Ue,Te=Ue);return Le&&Ma(U,ve),me}for(ge=o(ge);!Ue.done;ve++,Ue=B.next())Ue=P(ge,U,ve,Ue.value,X),Ue!==null&&(e&&Ue.alternate!==null&&ge.delete(Ue.key===null?ve:Ue.key),O=f(Ue,O,ve),Te===null?me=Ue:Te.sibling=Ue,Te=Ue);return e&&ge.forEach(function(rv){return t(U,rv)}),Le&&Ma(U,ve),me}function Ge(U,O,B,X){if(typeof B=="object"&&B!==null&&B.type===S&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case j:e:{for(var me=B.key;O!==null;){if(O.key===me){if(me=B.type,me===S){if(O.tag===7){r(U,O.sibling),X=d(O,B.props.children),X.return=U,U=X;break e}}else if(O.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Z&&Of(me)===O.type){r(U,O.sibling),X=d(O,B.props),qn(X,B),X.return=U,U=X;break e}r(U,O);break}else t(U,O);O=O.sibling}B.type===S?(X=Da(B.props.children,U.mode,X,B.key),X.return=U,U=X):(X=Vl(B.type,B.key,B.props,null,U.mode,X),qn(X,B),X.return=U,U=X)}return y(U);case N:e:{for(me=B.key;O!==null;){if(O.key===me)if(O.tag===4&&O.stateNode.containerInfo===B.containerInfo&&O.stateNode.implementation===B.implementation){r(U,O.sibling),X=d(O,B.children||[]),X.return=U,U=X;break e}else{r(U,O);break}else t(U,O);O=O.sibling}X=Zo(B,U.mode,X),X.return=U,U=X}return y(U);case Z:return me=B._init,B=me(B._payload),Ge(U,O,B,X)}if(ie(B))return be(U,O,B,X);if(le(B)){if(me=le(B),typeof me!="function")throw Error(i(150));return B=me.call(B),pe(U,O,B,X)}if(typeof B.then=="function")return Ge(U,O,ci(B),X);if(B.$$typeof===A)return Ge(U,O,Xl(U,B),X);ui(U,B)}return typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint"?(B=""+B,O!==null&&O.tag===6?(r(U,O.sibling),X=d(O,B),X.return=U,U=X):(r(U,O),X=Xo(B,U.mode,X),X.return=U,U=X),y(U)):r(U,O)}return function(U,O,B,X){try{Bn=0;var me=Ge(U,O,B,X);return kr=null,me}catch(ge){if(ge===Cn||ge===Jl)throw ge;var Te=Ot(29,ge,null,U.mode);return Te.lanes=X,Te.return=U,Te}finally{}}}var Tr=Rf(!0),Uf=Rf(!1),Yt=V(null),hs=null;function Js(e){var t=e.alternate;I(it,it.current&1),I(Yt,e),hs===null&&(t===null||jr.current!==null||t.memoizedState!==null)&&(hs=e)}function Lf(e){if(e.tag===22){if(I(it,it.current),I(Yt,e),hs===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(hs=e)}}else Ws()}function Ws(){I(it,it.current),I(Yt,Yt.current)}function Ds(e){C(Yt),hs===e&&(hs=null),C(it)}var it=V(0);function di(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||vu(r)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Dc(e,t,r,o){t=e.memoizedState,r=r(o,t),r=r==null?t:p({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Ac={enqueueSetState:function(e,t,r){e=e._reactInternals;var o=Ht(),d=Fs(o);d.payload=t,r!=null&&(d.callback=r),t=Xs(e,d,o),t!==null&&(Bt(t,e,o),An(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var o=Ht(),d=Fs(o);d.tag=1,d.payload=t,r!=null&&(d.callback=r),t=Xs(e,d,o),t!==null&&(Bt(t,e,o),An(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ht(),o=Fs(r);o.tag=2,t!=null&&(o.callback=t),t=Xs(e,o,r),t!==null&&(Bt(t,e,r),An(t,e,r))}};function Hf(e,t,r,o,d,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,f,y):t.prototype&&t.prototype.isPureReactComponent?!wn(r,o)||!wn(d,f):!0}function Bf(e,t,r,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,o),t.state!==e&&Ac.enqueueReplaceState(t,t.state,null)}function qa(e,t){var r=t;if("ref"in t){r={};for(var o in t)o!=="ref"&&(r[o]=t[o])}if(e=e.defaultProps){r===t&&(r=p({},r));for(var d in e)r[d]===void 0&&(r[d]=e[d])}return r}var hi=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function qf(e){hi(e)}function zf(e){console.error(e)}function $f(e){hi(e)}function fi(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(o){setTimeout(function(){throw o})}}function Pf(e,t,r){try{var o=e.onCaughtError;o(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Mc(e,t,r){return r=Fs(r),r.tag=3,r.payload={element:null},r.callback=function(){fi(e,t)},r}function Kf(e){return e=Fs(e),e.tag=3,e}function Gf(e,t,r,o){var d=r.type.getDerivedStateFromError;if(typeof d=="function"){var f=o.value;e.payload=function(){return d(f)},e.callback=function(){Pf(t,r,o)}}var y=r.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){Pf(t,r,o),typeof d!="function"&&(na===null?na=new Set([this]):na.add(this));var w=o.stack;this.componentDidCatch(o.value,{componentStack:w!==null?w:""})})}function ry(e,t,r,o,d){if(r.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(t=r.alternate,t!==null&&kn(t,r,d,!0),r=Yt.current,r!==null){switch(r.tag){case 13:return hs===null?su():r.alternate===null&&et===0&&(et=3),r.flags&=-257,r.flags|=65536,r.lanes=d,o===ic?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([o]):t.add(o),ru(e,o,d)),!1;case 22:return r.flags|=65536,o===ic?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([o])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([o]):r.add(o)),ru(e,o,d)),!1}throw Error(i(435,r.tag))}return ru(e,o,d),su(),!1}if(Le)return t=Yt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=d,o!==ec&&(e=Error(i(422),{cause:o}),_n(Gt(e,r)))):(o!==ec&&(t=Error(i(423),{cause:o}),_n(Gt(t,r))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,o=Gt(o,r),d=Mc(e.stateNode,o,d),uc(e,d),et!==4&&(et=2)),!1;var f=Error(i(520),{cause:o});if(f=Gt(f,r),Vn===null?Vn=[f]:Vn.push(f),et!==4&&(et=2),t===null)return!0;o=Gt(o,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=d&-d,r.lanes|=e,e=Mc(r.stateNode,o,e),uc(r,e),!1;case 1:if(t=r.type,f=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(na===null||!na.has(f))))return r.flags|=65536,d&=-d,r.lanes|=d,d=Kf(d),Gf(d,e,r,o),uc(r,d),!1}r=r.return}while(r!==null);return!1}var If=Error(i(461)),ct=!1;function gt(e,t,r,o){t.child=e===null?Uf(t,null,r,o):Tr(t,e.child,r,o)}function Vf(e,t,r,o,d){r=r.render;var f=t.ref;if("ref"in o){var y={};for(var w in o)w!=="ref"&&(y[w]=o[w])}else y=o;return La(t),o=gc(e,t,r,y,f,d),w=xc(),e!==null&&!ct?(pc(e,t,d),As(e,t,d)):(Le&&w&&Jo(t),t.flags|=1,gt(e,t,o,d),t.child)}function Qf(e,t,r,o,d){if(e===null){var f=r.type;return typeof f=="function"&&!Fo(f)&&f.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=f,Yf(e,t,f,o,d)):(e=Vl(r.type,null,o,t,t.mode,d),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!zc(e,d)){var y=f.memoizedProps;if(r=r.compare,r=r!==null?r:wn,r(y,o)&&e.ref===t.ref)return As(e,t,d)}return t.flags|=1,e=Ss(f,o),e.ref=t.ref,e.return=t,t.child=e}function Yf(e,t,r,o,d){if(e!==null){var f=e.memoizedProps;if(wn(f,o)&&e.ref===t.ref)if(ct=!1,t.pendingProps=o=f,zc(e,d))(e.flags&131072)!==0&&(ct=!0);else return t.lanes=e.lanes,As(e,t,d)}return Oc(e,t,r,o,d)}function Ff(e,t,r){var o=t.pendingProps,d=o.children,f=e!==null?e.memoizedState:null;if(o.mode==="hidden"){if((t.flags&128)!==0){if(o=f!==null?f.baseLanes|r:r,e!==null){for(d=t.child=e.child,f=0;d!==null;)f=f|d.lanes|d.childLanes,d=d.sibling;t.childLanes=f&~o}else t.childLanes=0,t.child=null;return Xf(e,t,o,r)}if((r&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Zl(t,f!==null?f.cachePool:null),f!==null?Qh(t,f):hc(),Lf(t);else return t.lanes=t.childLanes=536870912,Xf(e,t,f!==null?f.baseLanes|r:r,r)}else f!==null?(Zl(t,f.cachePool),Qh(t,f),Ws(),t.memoizedState=null):(e!==null&&Zl(t,null),hc(),Ws());return gt(e,t,d,r),t.child}function Xf(e,t,r,o){var d=lc();return d=d===null?null:{parent:lt._currentValue,pool:d},t.memoizedState={baseLanes:r,cachePool:d},e!==null&&Zl(t,null),hc(),Lf(t),e!==null&&kn(e,t,o,!0),null}function mi(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(i(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function Oc(e,t,r,o,d){return La(t),r=gc(e,t,r,o,void 0,d),o=xc(),e!==null&&!ct?(pc(e,t,d),As(e,t,d)):(Le&&o&&Jo(t),t.flags|=1,gt(e,t,r,d),t.child)}function Zf(e,t,r,o,d,f){return La(t),t.updateQueue=null,r=Fh(t,o,r,d),Yh(e),o=xc(),e!==null&&!ct?(pc(e,t,f),As(e,t,f)):(Le&&o&&Jo(t),t.flags|=1,gt(e,t,r,f),t.child)}function Jf(e,t,r,o,d){if(La(t),t.stateNode===null){var f=pr,y=r.contextType;typeof y=="object"&&y!==null&&(f=vt(y)),f=new r(o,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=Ac,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=o,f.state=t.memoizedState,f.refs={},oc(t),y=r.contextType,f.context=typeof y=="object"&&y!==null?vt(y):pr,f.state=t.memoizedState,y=r.getDerivedStateFromProps,typeof y=="function"&&(Dc(t,r,y,o),f.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&Ac.enqueueReplaceState(f,f.state,null),On(t,o,f,d),Mn(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),o=!0}else if(e===null){f=t.stateNode;var w=t.memoizedProps,T=qa(r,w);f.props=T;var z=f.context,F=r.contextType;y=pr,typeof F=="object"&&F!==null&&(y=vt(F));var W=r.getDerivedStateFromProps;F=typeof W=="function"||typeof f.getSnapshotBeforeUpdate=="function",w=t.pendingProps!==w,F||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w||z!==y)&&Bf(t,f,o,y),Ys=!1;var $=t.memoizedState;f.state=$,On(t,o,f,d),Mn(),z=t.memoizedState,w||$!==z||Ys?(typeof W=="function"&&(Dc(t,r,W,o),z=t.memoizedState),(T=Ys||Hf(t,r,T,o,$,z,y))?(F||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=z),f.props=o,f.state=z,f.context=y,o=T):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{f=t.stateNode,cc(e,t),y=t.memoizedProps,F=qa(r,y),f.props=F,W=t.pendingProps,$=f.context,z=r.contextType,T=pr,typeof z=="object"&&z!==null&&(T=vt(z)),w=r.getDerivedStateFromProps,(z=typeof w=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==W||$!==T)&&Bf(t,f,o,T),Ys=!1,$=t.memoizedState,f.state=$,On(t,o,f,d),Mn();var P=t.memoizedState;y!==W||$!==P||Ys||e!==null&&e.dependencies!==null&&Fl(e.dependencies)?(typeof w=="function"&&(Dc(t,r,w,o),P=t.memoizedState),(F=Ys||Hf(t,r,F,o,$,P,T)||e!==null&&e.dependencies!==null&&Fl(e.dependencies))?(z||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(o,P,T),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(o,P,T)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&$===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&$===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=P),f.props=o,f.state=P,f.context=T,o=F):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&$===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&$===e.memoizedState||(t.flags|=1024),o=!1)}return f=o,mi(e,t),o=(t.flags&128)!==0,f||o?(f=t.stateNode,r=o&&typeof r.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&o?(t.child=Tr(t,e.child,null,d),t.child=Tr(t,null,r,d)):gt(e,t,r,d),t.memoizedState=f.state,e=t.child):e=As(e,t,d),e}function Wf(e,t,r,o){return Sn(),t.flags|=256,gt(e,t,r,o),t.child}var Rc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Uc(e){return{baseLanes:e,cachePool:qh()}}function Lc(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=Ft),e}function em(e,t,r){var o=t.pendingProps,d=!1,f=(t.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(it.current&2)!==0),y&&(d=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Le){if(d?Js(t):Ws(),Le){var w=We,T;if(T=w){e:{for(T=w,w=ds;T.nodeType!==8;){if(!w){w=null;break e}if(T=as(T.nextSibling),T===null){w=null;break e}}w=T}w!==null?(t.memoizedState={dehydrated:w,treeContext:Aa!==null?{id:_s,overflow:ks}:null,retryLane:536870912,hydrationErrors:null},T=Ot(18,null,null,0),T.stateNode=w,T.return=t,t.child=T,jt=t,We=null,T=!0):T=!1}T||Ra(t)}if(w=t.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return vu(w)?t.lanes=32:t.lanes=536870912,null;Ds(t)}return w=o.children,o=o.fallback,d?(Ws(),d=t.mode,w=gi({mode:"hidden",children:w},d),o=Da(o,d,r,null),w.return=t,o.return=t,w.sibling=o,t.child=w,d=t.child,d.memoizedState=Uc(r),d.childLanes=Lc(e,y,r),t.memoizedState=Rc,o):(Js(t),Hc(t,w))}if(T=e.memoizedState,T!==null&&(w=T.dehydrated,w!==null)){if(f)t.flags&256?(Js(t),t.flags&=-257,t=Bc(e,t,r)):t.memoizedState!==null?(Ws(),t.child=e.child,t.flags|=128,t=null):(Ws(),d=o.fallback,w=t.mode,o=gi({mode:"visible",children:o.children},w),d=Da(d,w,r,null),d.flags|=2,o.return=t,d.return=t,o.sibling=d,t.child=o,Tr(t,e.child,null,r),o=t.child,o.memoizedState=Uc(r),o.childLanes=Lc(e,y,r),t.memoizedState=Rc,t=d);else if(Js(t),vu(w)){if(y=w.nextSibling&&w.nextSibling.dataset,y)var z=y.dgst;y=z,o=Error(i(419)),o.stack="",o.digest=y,_n({value:o,source:null,stack:null}),t=Bc(e,t,r)}else if(ct||kn(e,t,r,!1),y=(r&e.childLanes)!==0,ct||y){if(y=Ve,y!==null&&(o=r&-r,o=(o&42)!==0?1:bo(o),o=(o&(y.suspendedLanes|r))!==0?0:o,o!==0&&o!==T.retryLane))throw T.retryLane=o,xr(e,o),Bt(y,e,o),If;w.data==="$?"||su(),t=Bc(e,t,r)}else w.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=T.treeContext,We=as(w.nextSibling),jt=t,Le=!0,Oa=null,ds=!1,e!==null&&(Vt[Qt++]=_s,Vt[Qt++]=ks,Vt[Qt++]=Aa,_s=e.id,ks=e.overflow,Aa=t),t=Hc(t,o.children),t.flags|=4096);return t}return d?(Ws(),d=o.fallback,w=t.mode,T=e.child,z=T.sibling,o=Ss(T,{mode:"hidden",children:o.children}),o.subtreeFlags=T.subtreeFlags&65011712,z!==null?d=Ss(z,d):(d=Da(d,w,r,null),d.flags|=2),d.return=t,o.return=t,o.sibling=d,t.child=o,o=d,d=t.child,w=e.child.memoizedState,w===null?w=Uc(r):(T=w.cachePool,T!==null?(z=lt._currentValue,T=T.parent!==z?{parent:z,pool:z}:T):T=qh(),w={baseLanes:w.baseLanes|r,cachePool:T}),d.memoizedState=w,d.childLanes=Lc(e,y,r),t.memoizedState=Rc,o):(Js(t),r=e.child,e=r.sibling,r=Ss(r,{mode:"visible",children:o.children}),r.return=t,r.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=r,t.memoizedState=null,r)}function Hc(e,t){return t=gi({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function gi(e,t){return e=Ot(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Bc(e,t,r){return Tr(t,e.child,null,r),e=Hc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function tm(e,t,r){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),sc(e.return,t,r)}function qc(e,t,r,o,d){var f=e.memoizedState;f===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:d}:(f.isBackwards=t,f.rendering=null,f.renderingStartTime=0,f.last=o,f.tail=r,f.tailMode=d)}function sm(e,t,r){var o=t.pendingProps,d=o.revealOrder,f=o.tail;if(gt(e,t,o.children,r),o=it.current,(o&2)!==0)o=o&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&tm(e,r,t);else if(e.tag===19)tm(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}switch(I(it,o),d){case"forwards":for(r=t.child,d=null;r!==null;)e=r.alternate,e!==null&&di(e)===null&&(d=r),r=r.sibling;r=d,r===null?(d=t.child,t.child=null):(d=r.sibling,r.sibling=null),qc(t,!1,d,r,f);break;case"backwards":for(r=null,d=t.child,t.child=null;d!==null;){if(e=d.alternate,e!==null&&di(e)===null){t.child=d;break}e=d.sibling,d.sibling=r,r=d,d=e}qc(t,!0,r,null,f);break;case"together":qc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function As(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ra|=t.lanes,(r&t.childLanes)===0)if(e!==null){if(kn(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,r=Ss(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ss(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function zc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Fl(e)))}function ny(e,t,r){switch(t.tag){case 3:Be(t,t.stateNode.containerInfo),Qs(t,lt,e.memoizedState.cache),Sn();break;case 27:case 5:Wa(t);break;case 4:Be(t,t.stateNode.containerInfo);break;case 10:Qs(t,t.type,t.memoizedProps.value);break;case 13:var o=t.memoizedState;if(o!==null)return o.dehydrated!==null?(Js(t),t.flags|=128,null):(r&t.child.childLanes)!==0?em(e,t,r):(Js(t),e=As(e,t,r),e!==null?e.sibling:null);Js(t);break;case 19:var d=(e.flags&128)!==0;if(o=(r&t.childLanes)!==0,o||(kn(e,t,r,!1),o=(r&t.childLanes)!==0),d){if(o)return sm(e,t,r);t.flags|=128}if(d=t.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),I(it,it.current),o)break;return null;case 22:case 23:return t.lanes=0,Ff(e,t,r);case 24:Qs(t,lt,e.memoizedState.cache)}return As(e,t,r)}function am(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)ct=!0;else{if(!zc(e,r)&&(t.flags&128)===0)return ct=!1,ny(e,t,r);ct=(e.flags&131072)!==0}else ct=!1,Le&&(t.flags&1048576)!==0&&Mh(t,Yl,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var o=t.elementType,d=o._init;if(o=d(o._payload),t.type=o,typeof o=="function")Fo(o)?(e=qa(o,e),t.tag=1,t=Jf(null,t,o,e,r)):(t.tag=0,t=Oc(null,t,o,e,r));else{if(o!=null){if(d=o.$$typeof,d===G){t.tag=11,t=Vf(null,t,o,e,r);break e}else if(d===R){t.tag=14,t=Qf(null,t,o,e,r);break e}}throw t=Y(o)||o,Error(i(306,t,""))}}return t;case 0:return Oc(e,t,t.type,t.pendingProps,r);case 1:return o=t.type,d=qa(o,t.pendingProps),Jf(e,t,o,d,r);case 3:e:{if(Be(t,t.stateNode.containerInfo),e===null)throw Error(i(387));o=t.pendingProps;var f=t.memoizedState;d=f.element,cc(e,t),On(t,o,null,r);var y=t.memoizedState;if(o=y.cache,Qs(t,lt,o),o!==f.cache&&ac(t,[lt],r,!0),Mn(),o=y.element,f.isDehydrated)if(f={element:o,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=Wf(e,t,o,r);break e}else if(o!==d){d=Gt(Error(i(424)),t),_n(d),t=Wf(e,t,o,r);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(We=as(e.firstChild),jt=t,Le=!0,Oa=null,ds=!0,r=Uf(t,null,o,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(Sn(),o===d){t=As(e,t,r);break e}gt(e,t,o,r)}t=t.child}return t;case 26:return mi(e,t),e===null?(r=i0(t.type,null,t.pendingProps,null))?t.memoizedState=r:Le||(r=t.type,e=t.pendingProps,o=Ci(xe.current).createElement(r),o[yt]=t,o[_t]=e,pt(o,r,e),ot(o),t.stateNode=o):t.memoizedState=i0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Wa(t),e===null&&Le&&(o=t.stateNode=r0(t.type,t.pendingProps,xe.current),jt=t,ds=!0,d=We,oa(t.type)?(bu=d,We=as(o.firstChild)):We=d),gt(e,t,t.pendingProps.children,r),mi(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Le&&((d=o=We)&&(o=Oy(o,t.type,t.pendingProps,ds),o!==null?(t.stateNode=o,jt=t,We=as(o.firstChild),ds=!1,d=!0):d=!1),d||Ra(t)),Wa(t),d=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,o=f.children,xu(d,f)?o=null:y!==null&&xu(d,y)&&(t.flags|=32),t.memoizedState!==null&&(d=gc(e,t,Zp,null,null,r),tl._currentValue=d),mi(e,t),gt(e,t,o,r),t.child;case 6:return e===null&&Le&&((e=r=We)&&(r=Ry(r,t.pendingProps,ds),r!==null?(t.stateNode=r,jt=t,We=null,e=!0):e=!1),e||Ra(t)),null;case 13:return em(e,t,r);case 4:return Be(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=Tr(t,null,o,r):gt(e,t,o,r),t.child;case 11:return Vf(e,t,t.type,t.pendingProps,r);case 7:return gt(e,t,t.pendingProps,r),t.child;case 8:return gt(e,t,t.pendingProps.children,r),t.child;case 12:return gt(e,t,t.pendingProps.children,r),t.child;case 10:return o=t.pendingProps,Qs(t,t.type,o.value),gt(e,t,o.children,r),t.child;case 9:return d=t.type._context,o=t.pendingProps.children,La(t),d=vt(d),o=o(d),t.flags|=1,gt(e,t,o,r),t.child;case 14:return Qf(e,t,t.type,t.pendingProps,r);case 15:return Yf(e,t,t.type,t.pendingProps,r);case 19:return sm(e,t,r);case 31:return o=t.pendingProps,r=t.mode,o={mode:o.mode,children:o.children},e===null?(r=gi(o,r),r.ref=t.ref,t.child=r,r.return=t,t=r):(r=Ss(e.child,o),r.ref=t.ref,t.child=r,r.return=t,t=r),t;case 22:return Ff(e,t,r);case 24:return La(t),o=vt(lt),e===null?(d=lc(),d===null&&(d=Ve,f=rc(),d.pooledCache=f,f.refCount++,f!==null&&(d.pooledCacheLanes|=r),d=f),t.memoizedState={parent:o,cache:d},oc(t),Qs(t,lt,d)):((e.lanes&r)!==0&&(cc(e,t),On(t,null,null,r),Mn()),d=e.memoizedState,f=t.memoizedState,d.parent!==o?(d={parent:o,cache:o},t.memoizedState=d,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=d),Qs(t,lt,o)):(o=f.cache,Qs(t,lt,o),o!==d.cache&&ac(t,[lt],r,!0))),gt(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Ms(e){e.flags|=4}function rm(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!h0(t)){if(t=Yt.current,t!==null&&((Oe&4194048)===Oe?hs!==null:(Oe&62914560)!==Oe&&(Oe&536870912)===0||t!==hs))throw Dn=ic,zh;e.flags|=8192}}function xi(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Ud():536870912,e.lanes|=t,Ar|=t)}function zn(e,t){if(!Le)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Je(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,o=0;if(t)for(var d=e.child;d!==null;)r|=d.lanes|d.childLanes,o|=d.subtreeFlags&65011712,o|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)r|=d.lanes|d.childLanes,o|=d.subtreeFlags,o|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=o,e.childLanes=r,t}function ly(e,t,r){var o=t.pendingProps;switch(Wo(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Je(t),null;case 1:return Je(t),null;case 3:return r=t.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),t.memoizedState.cache!==o&&(t.flags|=2048),Es(lt),zt(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Nn(t)?Ms(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Uh())),Je(t),null;case 26:return r=t.memoizedState,e===null?(Ms(t),r!==null?(Je(t),rm(t,r)):(Je(t),t.flags&=-16777217)):r?r!==e.memoizedState?(Ms(t),Je(t),rm(t,r)):(Je(t),t.flags&=-16777217):(e.memoizedProps!==o&&Ms(t),Je(t),t.flags&=-16777217),null;case 27:us(t),r=xe.current;var d=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==o&&Ms(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return Je(t),null}e=oe.current,Nn(t)?Oh(t):(e=r0(d,o,r),t.stateNode=e,Ms(t))}return Je(t),null;case 5:if(us(t),r=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==o&&Ms(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return Je(t),null}if(e=oe.current,Nn(t))Oh(t);else{switch(d=Ci(xe.current),e){case 1:e=d.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:e=d.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":e=d.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":e=d.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof o.is=="string"?d.createElement("select",{is:o.is}):d.createElement("select"),o.multiple?e.multiple=!0:o.size&&(e.size=o.size);break;default:e=typeof o.is=="string"?d.createElement(r,{is:o.is}):d.createElement(r)}}e[yt]=t,e[_t]=o;e:for(d=t.child;d!==null;){if(d.tag===5||d.tag===6)e.appendChild(d.stateNode);else if(d.tag!==4&&d.tag!==27&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}t.stateNode=e;e:switch(pt(e,r,o),r){case"button":case"input":case"select":case"textarea":e=!!o.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Ms(t)}}return Je(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==o&&Ms(t);else{if(typeof o!="string"&&t.stateNode===null)throw Error(i(166));if(e=xe.current,Nn(t)){if(e=t.stateNode,r=t.memoizedProps,o=null,d=jt,d!==null)switch(d.tag){case 27:case 5:o=d.memoizedProps}e[yt]=t,e=!!(e.nodeValue===r||o!==null&&o.suppressHydrationWarning===!0||Zm(e.nodeValue,r)),e||Ra(t)}else e=Ci(e).createTextNode(o),e[yt]=t,t.stateNode=e}return Je(t),null;case 13:if(o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=Nn(t),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(i(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(i(317));d[yt]=t}else Sn(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Je(t),d=!1}else d=Uh(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return t.flags&256?(Ds(t),t):(Ds(t),null)}if(Ds(t),(t.flags&128)!==0)return t.lanes=r,t;if(r=o!==null,e=e!==null&&e.memoizedState!==null,r){o=t.child,d=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(d=o.alternate.memoizedState.cachePool.pool);var f=null;o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==d&&(o.flags|=2048)}return r!==e&&r&&(t.child.flags|=8192),xi(t,t.updateQueue),Je(t),null;case 4:return zt(),e===null&&du(t.stateNode.containerInfo),Je(t),null;case 10:return Es(t.type),Je(t),null;case 19:if(C(it),d=t.memoizedState,d===null)return Je(t),null;if(o=(t.flags&128)!==0,f=d.rendering,f===null)if(o)zn(d,!1);else{if(et!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=di(e),f!==null){for(t.flags|=128,zn(d,!1),e=f.updateQueue,t.updateQueue=e,xi(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)Ah(r,e),r=r.sibling;return I(it,it.current&1|2),t.child}e=e.sibling}d.tail!==null&&tt()>vi&&(t.flags|=128,o=!0,zn(d,!1),t.lanes=4194304)}else{if(!o)if(e=di(f),e!==null){if(t.flags|=128,o=!0,e=e.updateQueue,t.updateQueue=e,xi(t,e),zn(d,!0),d.tail===null&&d.tailMode==="hidden"&&!f.alternate&&!Le)return Je(t),null}else 2*tt()-d.renderingStartTime>vi&&r!==536870912&&(t.flags|=128,o=!0,zn(d,!1),t.lanes=4194304);d.isBackwards?(f.sibling=t.child,t.child=f):(e=d.last,e!==null?e.sibling=f:t.child=f,d.last=f)}return d.tail!==null?(t=d.tail,d.rendering=t,d.tail=t.sibling,d.renderingStartTime=tt(),t.sibling=null,e=it.current,I(it,o?e&1|2:e&1),t):(Je(t),null);case 22:case 23:return Ds(t),fc(),o=t.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(t.flags|=8192):o&&(t.flags|=8192),o?(r&536870912)!==0&&(t.flags&128)===0&&(Je(t),t.subtreeFlags&6&&(t.flags|=8192)):Je(t),r=t.updateQueue,r!==null&&xi(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),o=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),o!==r&&(t.flags|=2048),e!==null&&C(Ha),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Es(lt),Je(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function iy(e,t){switch(Wo(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Es(lt),zt(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return us(t),null;case 13:if(Ds(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));Sn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return C(it),null;case 4:return zt(),null;case 10:return Es(t.type),null;case 22:case 23:return Ds(t),fc(),e!==null&&C(Ha),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Es(lt),null;case 25:return null;default:return null}}function nm(e,t){switch(Wo(t),t.tag){case 3:Es(lt),zt();break;case 26:case 27:case 5:us(t);break;case 4:zt();break;case 13:Ds(t);break;case 19:C(it);break;case 10:Es(t.type);break;case 22:case 23:Ds(t),fc(),e!==null&&C(Ha);break;case 24:Es(lt)}}function $n(e,t){try{var r=t.updateQueue,o=r!==null?r.lastEffect:null;if(o!==null){var d=o.next;r=d;do{if((r.tag&e)===e){o=void 0;var f=r.create,y=r.inst;o=f(),y.destroy=o}r=r.next}while(r!==d)}}catch(w){Ie(t,t.return,w)}}function ea(e,t,r){try{var o=t.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var f=d.next;o=f;do{if((o.tag&e)===e){var y=o.inst,w=y.destroy;if(w!==void 0){y.destroy=void 0,d=t;var T=r,z=w;try{z()}catch(F){Ie(d,T,F)}}}o=o.next}while(o!==f)}}catch(F){Ie(t,t.return,F)}}function lm(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{Vh(t,r)}catch(o){Ie(e,e.return,o)}}}function im(e,t,r){r.props=qa(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(o){Ie(e,t,o)}}function Pn(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof r=="function"?e.refCleanup=r(o):r.current=o}}catch(d){Ie(e,t,d)}}function fs(e,t){var r=e.ref,o=e.refCleanup;if(r!==null)if(typeof o=="function")try{o()}catch(d){Ie(e,t,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(d){Ie(e,t,d)}else r.current=null}function om(e){var t=e.type,r=e.memoizedProps,o=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&o.focus();break e;case"img":r.src?o.src=r.src:r.srcSet&&(o.srcset=r.srcSet)}}catch(d){Ie(e,e.return,d)}}function $c(e,t,r){try{var o=e.stateNode;Ey(o,e.type,r,t),o[_t]=t}catch(d){Ie(e,e.return,d)}}function cm(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&oa(e.type)||e.tag===4}function Pc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||cm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&oa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Kc(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ei));else if(o!==4&&(o===27&&oa(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(Kc(e,t,r),e=e.sibling;e!==null;)Kc(e,t,r),e=e.sibling}function pi(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(o!==4&&(o===27&&oa(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(pi(e,t,r),e=e.sibling;e!==null;)pi(e,t,r),e=e.sibling}function um(e){var t=e.stateNode,r=e.memoizedProps;try{for(var o=e.type,d=t.attributes;d.length;)t.removeAttributeNode(d[0]);pt(t,o,r),t[yt]=e,t[_t]=r}catch(f){Ie(e,e.return,f)}}var Os=!1,at=!1,Gc=!1,dm=typeof WeakSet=="function"?WeakSet:Set,ut=null;function oy(e,t){if(e=e.containerInfo,mu=Ui,e=wh(e),Po(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var o=r.getSelection&&r.getSelection();if(o&&o.rangeCount!==0){r=o.anchorNode;var d=o.anchorOffset,f=o.focusNode;o=o.focusOffset;try{r.nodeType,f.nodeType}catch{r=null;break e}var y=0,w=-1,T=-1,z=0,F=0,W=e,$=null;t:for(;;){for(var P;W!==r||d!==0&&W.nodeType!==3||(w=y+d),W!==f||o!==0&&W.nodeType!==3||(T=y+o),W.nodeType===3&&(y+=W.nodeValue.length),(P=W.firstChild)!==null;)$=W,W=P;for(;;){if(W===e)break t;if($===r&&++z===d&&(w=y),$===f&&++F===o&&(T=y),(P=W.nextSibling)!==null)break;W=$,$=W.parentNode}W=P}r=w===-1||T===-1?null:{start:w,end:T}}else r=null}r=r||{start:0,end:0}}else r=null;for(gu={focusedElem:e,selectionRange:r},Ui=!1,ut=t;ut!==null;)if(t=ut,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,ut=e;else for(;ut!==null;){switch(t=ut,f=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,r=t,d=f.memoizedProps,f=f.memoizedState,o=r.stateNode;try{var be=qa(r.type,d,r.elementType===r.type);e=o.getSnapshotBeforeUpdate(be,f),o.__reactInternalSnapshotBeforeUpdate=e}catch(pe){Ie(r,r.return,pe)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)yu(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":yu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,ut=e;break}ut=t.return}}function hm(e,t,r){var o=r.flags;switch(r.tag){case 0:case 11:case 15:ta(e,r),o&4&&$n(5,r);break;case 1:if(ta(e,r),o&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(y){Ie(r,r.return,y)}else{var d=qa(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(d,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){Ie(r,r.return,y)}}o&64&&lm(r),o&512&&Pn(r,r.return);break;case 3:if(ta(e,r),o&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{Vh(e,t)}catch(y){Ie(r,r.return,y)}}break;case 27:t===null&&o&4&&um(r);case 26:case 5:ta(e,r),t===null&&o&4&&om(r),o&512&&Pn(r,r.return);break;case 12:ta(e,r);break;case 13:ta(e,r),o&4&&gm(e,r),o&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=py.bind(null,r),Uy(e,r))));break;case 22:if(o=r.memoizedState!==null||Os,!o){t=t!==null&&t.memoizedState!==null||at,d=Os;var f=at;Os=o,(at=t)&&!f?sa(e,r,(r.subtreeFlags&8772)!==0):ta(e,r),Os=d,at=f}break;case 30:break;default:ta(e,r)}}function fm(e){var t=e.alternate;t!==null&&(e.alternate=null,fm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&No(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Xe=null,Et=!1;function Rs(e,t,r){for(r=r.child;r!==null;)mm(e,t,r),r=r.sibling}function mm(e,t,r){if(de&&typeof de.onCommitFiberUnmount=="function")try{de.onCommitFiberUnmount(we,r)}catch{}switch(r.tag){case 26:at||fs(r,t),Rs(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:at||fs(r,t);var o=Xe,d=Et;oa(r.type)&&(Xe=r.stateNode,Et=!1),Rs(e,t,r),Zn(r.stateNode),Xe=o,Et=d;break;case 5:at||fs(r,t);case 6:if(o=Xe,d=Et,Xe=null,Rs(e,t,r),Xe=o,Et=d,Xe!==null)if(Et)try{(Xe.nodeType===9?Xe.body:Xe.nodeName==="HTML"?Xe.ownerDocument.body:Xe).removeChild(r.stateNode)}catch(f){Ie(r,t,f)}else try{Xe.removeChild(r.stateNode)}catch(f){Ie(r,t,f)}break;case 18:Xe!==null&&(Et?(e=Xe,s0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),nl(e)):s0(Xe,r.stateNode));break;case 4:o=Xe,d=Et,Xe=r.stateNode.containerInfo,Et=!0,Rs(e,t,r),Xe=o,Et=d;break;case 0:case 11:case 14:case 15:at||ea(2,r,t),at||ea(4,r,t),Rs(e,t,r);break;case 1:at||(fs(r,t),o=r.stateNode,typeof o.componentWillUnmount=="function"&&im(r,t,o)),Rs(e,t,r);break;case 21:Rs(e,t,r);break;case 22:at=(o=at)||r.memoizedState!==null,Rs(e,t,r),at=o;break;default:Rs(e,t,r)}}function gm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{nl(e)}catch(r){Ie(t,t.return,r)}}function cy(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new dm),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new dm),t;default:throw Error(i(435,e.tag))}}function Ic(e,t){var r=cy(e);t.forEach(function(o){var d=yy.bind(null,e,o);r.has(o)||(r.add(o),o.then(d,d))})}function Rt(e,t){var r=t.deletions;if(r!==null)for(var o=0;o<r.length;o++){var d=r[o],f=e,y=t,w=y;e:for(;w!==null;){switch(w.tag){case 27:if(oa(w.type)){Xe=w.stateNode,Et=!1;break e}break;case 5:Xe=w.stateNode,Et=!1;break e;case 3:case 4:Xe=w.stateNode.containerInfo,Et=!0;break e}w=w.return}if(Xe===null)throw Error(i(160));mm(f,y,d),Xe=null,Et=!1,f=d.alternate,f!==null&&(f.return=null),d.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)xm(t,e),t=t.sibling}var ss=null;function xm(e,t){var r=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Rt(t,e),Ut(e),o&4&&(ea(3,e,e.return),$n(3,e),ea(5,e,e.return));break;case 1:Rt(t,e),Ut(e),o&512&&(at||r===null||fs(r,r.return)),o&64&&Os&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?o:r.concat(o))));break;case 26:var d=ss;if(Rt(t,e),Ut(e),o&512&&(at||r===null||fs(r,r.return)),o&4){var f=r!==null?r.memoizedState:null;if(o=e.memoizedState,r===null)if(o===null)if(e.stateNode===null){e:{o=e.type,r=e.memoizedProps,d=d.ownerDocument||d;t:switch(o){case"title":f=d.getElementsByTagName("title")[0],(!f||f[hn]||f[yt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=d.createElement(o),d.head.insertBefore(f,d.querySelector("head > title"))),pt(f,o,r),f[yt]=e,ot(f),o=f;break e;case"link":var y=u0("link","href",d).get(o+(r.href||""));if(y){for(var w=0;w<y.length;w++)if(f=y[w],f.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&f.getAttribute("rel")===(r.rel==null?null:r.rel)&&f.getAttribute("title")===(r.title==null?null:r.title)&&f.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){y.splice(w,1);break t}}f=d.createElement(o),pt(f,o,r),d.head.appendChild(f);break;case"meta":if(y=u0("meta","content",d).get(o+(r.content||""))){for(w=0;w<y.length;w++)if(f=y[w],f.getAttribute("content")===(r.content==null?null:""+r.content)&&f.getAttribute("name")===(r.name==null?null:r.name)&&f.getAttribute("property")===(r.property==null?null:r.property)&&f.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&f.getAttribute("charset")===(r.charSet==null?null:r.charSet)){y.splice(w,1);break t}}f=d.createElement(o),pt(f,o,r),d.head.appendChild(f);break;default:throw Error(i(468,o))}f[yt]=e,ot(f),o=f}e.stateNode=o}else d0(d,e.type,e.stateNode);else e.stateNode=c0(d,o,e.memoizedProps);else f!==o?(f===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):f.count--,o===null?d0(d,e.type,e.stateNode):c0(d,o,e.memoizedProps)):o===null&&e.stateNode!==null&&$c(e,e.memoizedProps,r.memoizedProps)}break;case 27:Rt(t,e),Ut(e),o&512&&(at||r===null||fs(r,r.return)),r!==null&&o&4&&$c(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Rt(t,e),Ut(e),o&512&&(at||r===null||fs(r,r.return)),e.flags&32){d=e.stateNode;try{cr(d,"")}catch(P){Ie(e,e.return,P)}}o&4&&e.stateNode!=null&&(d=e.memoizedProps,$c(e,d,r!==null?r.memoizedProps:d)),o&1024&&(Gc=!0);break;case 6:if(Rt(t,e),Ut(e),o&4){if(e.stateNode===null)throw Error(i(162));o=e.memoizedProps,r=e.stateNode;try{r.nodeValue=o}catch(P){Ie(e,e.return,P)}}break;case 3:if(Mi=null,d=ss,ss=Di(t.containerInfo),Rt(t,e),ss=d,Ut(e),o&4&&r!==null&&r.memoizedState.isDehydrated)try{nl(t.containerInfo)}catch(P){Ie(e,e.return,P)}Gc&&(Gc=!1,pm(e));break;case 4:o=ss,ss=Di(e.stateNode.containerInfo),Rt(t,e),Ut(e),ss=o;break;case 12:Rt(t,e),Ut(e);break;case 13:Rt(t,e),Ut(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Zc=tt()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,Ic(e,o)));break;case 22:d=e.memoizedState!==null;var T=r!==null&&r.memoizedState!==null,z=Os,F=at;if(Os=z||d,at=F||T,Rt(t,e),at=F,Os=z,Ut(e),o&8192)e:for(t=e.stateNode,t._visibility=d?t._visibility&-2:t._visibility|1,d&&(r===null||T||Os||at||za(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){T=r=t;try{if(f=T.stateNode,d)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{w=T.stateNode;var W=T.memoizedProps.style,$=W!=null&&W.hasOwnProperty("display")?W.display:null;w.style.display=$==null||typeof $=="boolean"?"":(""+$).trim()}}catch(P){Ie(T,T.return,P)}}}else if(t.tag===6){if(r===null){T=t;try{T.stateNode.nodeValue=d?"":T.memoizedProps}catch(P){Ie(T,T.return,P)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}o&4&&(o=e.updateQueue,o!==null&&(r=o.retryQueue,r!==null&&(o.retryQueue=null,Ic(e,r))));break;case 19:Rt(t,e),Ut(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,Ic(e,o)));break;case 30:break;case 21:break;default:Rt(t,e),Ut(e)}}function Ut(e){var t=e.flags;if(t&2){try{for(var r,o=e.return;o!==null;){if(cm(o)){r=o;break}o=o.return}if(r==null)throw Error(i(160));switch(r.tag){case 27:var d=r.stateNode,f=Pc(e);pi(e,f,d);break;case 5:var y=r.stateNode;r.flags&32&&(cr(y,""),r.flags&=-33);var w=Pc(e);pi(e,w,y);break;case 3:case 4:var T=r.stateNode.containerInfo,z=Pc(e);Kc(e,z,T);break;default:throw Error(i(161))}}catch(F){Ie(e,e.return,F)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pm(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;pm(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ta(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)hm(e,t.alternate,t),t=t.sibling}function za(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ea(4,t,t.return),za(t);break;case 1:fs(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&im(t,t.return,r),za(t);break;case 27:Zn(t.stateNode);case 26:case 5:fs(t,t.return),za(t);break;case 22:t.memoizedState===null&&za(t);break;case 30:za(t);break;default:za(t)}e=e.sibling}}function sa(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var o=t.alternate,d=e,f=t,y=f.flags;switch(f.tag){case 0:case 11:case 15:sa(d,f,r),$n(4,f);break;case 1:if(sa(d,f,r),o=f,d=o.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(z){Ie(o,o.return,z)}if(o=f,d=o.updateQueue,d!==null){var w=o.stateNode;try{var T=d.shared.hiddenCallbacks;if(T!==null)for(d.shared.hiddenCallbacks=null,d=0;d<T.length;d++)Ih(T[d],w)}catch(z){Ie(o,o.return,z)}}r&&y&64&&lm(f),Pn(f,f.return);break;case 27:um(f);case 26:case 5:sa(d,f,r),r&&o===null&&y&4&&om(f),Pn(f,f.return);break;case 12:sa(d,f,r);break;case 13:sa(d,f,r),r&&y&4&&gm(d,f);break;case 22:f.memoizedState===null&&sa(d,f,r),Pn(f,f.return);break;case 30:break;default:sa(d,f,r)}t=t.sibling}}function Vc(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&Tn(r))}function Qc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Tn(e))}function ms(e,t,r,o){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ym(e,t,r,o),t=t.sibling}function ym(e,t,r,o){var d=t.flags;switch(t.tag){case 0:case 11:case 15:ms(e,t,r,o),d&2048&&$n(9,t);break;case 1:ms(e,t,r,o);break;case 3:ms(e,t,r,o),d&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Tn(e)));break;case 12:if(d&2048){ms(e,t,r,o),e=t.stateNode;try{var f=t.memoizedProps,y=f.id,w=f.onPostCommit;typeof w=="function"&&w(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(T){Ie(t,t.return,T)}}else ms(e,t,r,o);break;case 13:ms(e,t,r,o);break;case 23:break;case 22:f=t.stateNode,y=t.alternate,t.memoizedState!==null?f._visibility&2?ms(e,t,r,o):Kn(e,t):f._visibility&2?ms(e,t,r,o):(f._visibility|=2,Er(e,t,r,o,(t.subtreeFlags&10256)!==0)),d&2048&&Vc(y,t);break;case 24:ms(e,t,r,o),d&2048&&Qc(t.alternate,t);break;default:ms(e,t,r,o)}}function Er(e,t,r,o,d){for(d=d&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var f=e,y=t,w=r,T=o,z=y.flags;switch(y.tag){case 0:case 11:case 15:Er(f,y,w,T,d),$n(8,y);break;case 23:break;case 22:var F=y.stateNode;y.memoizedState!==null?F._visibility&2?Er(f,y,w,T,d):Kn(f,y):(F._visibility|=2,Er(f,y,w,T,d)),d&&z&2048&&Vc(y.alternate,y);break;case 24:Er(f,y,w,T,d),d&&z&2048&&Qc(y.alternate,y);break;default:Er(f,y,w,T,d)}t=t.sibling}}function Kn(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,o=t,d=o.flags;switch(o.tag){case 22:Kn(r,o),d&2048&&Vc(o.alternate,o);break;case 24:Kn(r,o),d&2048&&Qc(o.alternate,o);break;default:Kn(r,o)}t=t.sibling}}var Gn=8192;function Cr(e){if(e.subtreeFlags&Gn)for(e=e.child;e!==null;)vm(e),e=e.sibling}function vm(e){switch(e.tag){case 26:Cr(e),e.flags&Gn&&e.memoizedState!==null&&Yy(ss,e.memoizedState,e.memoizedProps);break;case 5:Cr(e);break;case 3:case 4:var t=ss;ss=Di(e.stateNode.containerInfo),Cr(e),ss=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=Gn,Gn=16777216,Cr(e),Gn=t):Cr(e));break;default:Cr(e)}}function bm(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function In(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];ut=o,jm(o,e)}bm(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)wm(e),e=e.sibling}function wm(e){switch(e.tag){case 0:case 11:case 15:In(e),e.flags&2048&&ea(9,e,e.return);break;case 3:In(e);break;case 12:In(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,yi(e)):In(e);break;default:In(e)}}function yi(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];ut=o,jm(o,e)}bm(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ea(8,t,t.return),yi(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,yi(t));break;default:yi(t)}e=e.sibling}}function jm(e,t){for(;ut!==null;){var r=ut;switch(r.tag){case 0:case 11:case 15:ea(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var o=r.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Tn(r.memoizedState.cache)}if(o=r.child,o!==null)o.return=r,ut=o;else e:for(r=e;ut!==null;){o=ut;var d=o.sibling,f=o.return;if(fm(o),o===r){ut=null;break e}if(d!==null){d.return=f,ut=d;break e}ut=f}}}var uy={getCacheForType:function(e){var t=vt(lt),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r}},dy=typeof WeakMap=="function"?WeakMap:Map,qe=0,Ve=null,De=null,Oe=0,ze=0,Lt=null,aa=!1,Dr=!1,Yc=!1,Us=0,et=0,ra=0,$a=0,Fc=0,Ft=0,Ar=0,Vn=null,Ct=null,Xc=!1,Zc=0,vi=1/0,bi=null,na=null,xt=0,la=null,Mr=null,Or=0,Jc=0,Wc=null,Nm=null,Qn=0,eu=null;function Ht(){if((qe&2)!==0&&Oe!==0)return Oe&-Oe;if(L.T!==null){var e=br;return e!==0?e:iu()}return Bd()}function Sm(){Ft===0&&(Ft=(Oe&536870912)===0||Le?Rd():536870912);var e=Yt.current;return e!==null&&(e.flags|=32),Ft}function Bt(e,t,r){(e===Ve&&(ze===2||ze===9)||e.cancelPendingCommit!==null)&&(Rr(e,0),ia(e,Oe,Ft,!1)),dn(e,r),((qe&2)===0||e!==Ve)&&(e===Ve&&((qe&2)===0&&($a|=r),et===4&&ia(e,Oe,Ft,!1)),gs(e))}function _m(e,t,r){if((qe&6)!==0)throw Error(i(327));var o=!r&&(t&124)===0&&(t&e.expiredLanes)===0||un(e,t),d=o?my(e,t):au(e,t,!0),f=o;do{if(d===0){Dr&&!o&&ia(e,t,0,!1);break}else{if(r=e.current.alternate,f&&!hy(r)){d=au(e,t,!1),f=!1;continue}if(d===2){if(f=t,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var w=e;d=Vn;var T=w.current.memoizedState.isDehydrated;if(T&&(Rr(w,y).flags|=256),y=au(w,y,!1),y!==2){if(Yc&&!T){w.errorRecoveryDisabledLanes|=f,$a|=f,d=4;break e}f=Ct,Ct=d,f!==null&&(Ct===null?Ct=f:Ct.push.apply(Ct,f))}d=y}if(f=!1,d!==2)continue}}if(d===1){Rr(e,0),ia(e,t,0,!0);break}e:{switch(o=e,f=d,f){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:ia(o,t,Ft,!aa);break e;case 2:Ct=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(d=Zc+300-tt(),10<d)){if(ia(o,t,Ft,!aa),Al(o,0,!0)!==0)break e;o.timeoutHandle=e0(km.bind(null,o,r,Ct,bi,Xc,t,Ft,$a,Ar,aa,f,2,-0,0),d);break e}km(o,r,Ct,bi,Xc,t,Ft,$a,Ar,aa,f,0,-0,0)}}break}while(!0);gs(e)}function km(e,t,r,o,d,f,y,w,T,z,F,W,$,P){if(e.timeoutHandle=-1,W=t.subtreeFlags,(W&8192||(W&16785408)===16785408)&&(el={stylesheets:null,count:0,unsuspend:Qy},vm(t),W=Fy(),W!==null)){e.cancelPendingCommit=W(Om.bind(null,e,t,f,r,o,d,y,w,T,F,1,$,P)),ia(e,f,y,!z);return}Om(e,t,f,r,o,d,y,w,T)}function hy(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var o=0;o<r.length;o++){var d=r[o],f=d.getSnapshot;d=d.value;try{if(!Mt(f(),d))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ia(e,t,r,o){t&=~Fc,t&=~$a,e.suspendedLanes|=t,e.pingedLanes&=~t,o&&(e.warmLanes|=t),o=e.expirationTimes;for(var d=t;0<d;){var f=31-Ne(d),y=1<<f;o[f]=-1,d&=~y}r!==0&&Ld(e,r,t)}function wi(){return(qe&6)===0?(Yn(0),!1):!0}function tu(){if(De!==null){if(ze===0)var e=De.return;else e=De,Ts=Ua=null,yc(e),kr=null,Bn=0,e=De;for(;e!==null;)nm(e.alternate,e),e=e.return;De=null}}function Rr(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,Dy(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),tu(),Ve=e,De=r=Ss(e.current,null),Oe=t,ze=0,Lt=null,aa=!1,Dr=un(e,t),Yc=!1,Ar=Ft=Fc=$a=ra=et=0,Ct=Vn=null,Xc=!1,(t&8)!==0&&(t|=t&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=t;0<o;){var d=31-Ne(o),f=1<<d;t|=e[d],o&=~f}return Us=t,Kl(),r}function Tm(e,t){ke=null,L.H=oi,t===Cn||t===Jl?(t=Kh(),ze=3):t===zh?(t=Kh(),ze=4):ze=t===If?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Lt=t,De===null&&(et=1,fi(e,Gt(t,e.current)))}function Em(){var e=L.H;return L.H=oi,e===null?oi:e}function Cm(){var e=L.A;return L.A=uy,e}function su(){et=4,aa||(Oe&4194048)!==Oe&&Yt.current!==null||(Dr=!0),(ra&134217727)===0&&($a&134217727)===0||Ve===null||ia(Ve,Oe,Ft,!1)}function au(e,t,r){var o=qe;qe|=2;var d=Em(),f=Cm();(Ve!==e||Oe!==t)&&(bi=null,Rr(e,t)),t=!1;var y=et;e:do try{if(ze!==0&&De!==null){var w=De,T=Lt;switch(ze){case 8:tu(),y=6;break e;case 3:case 2:case 9:case 6:Yt.current===null&&(t=!0);var z=ze;if(ze=0,Lt=null,Ur(e,w,T,z),r&&Dr){y=0;break e}break;default:z=ze,ze=0,Lt=null,Ur(e,w,T,z)}}fy(),y=et;break}catch(F){Tm(e,F)}while(!0);return t&&e.shellSuspendCounter++,Ts=Ua=null,qe=o,L.H=d,L.A=f,De===null&&(Ve=null,Oe=0,Kl()),y}function fy(){for(;De!==null;)Dm(De)}function my(e,t){var r=qe;qe|=2;var o=Em(),d=Cm();Ve!==e||Oe!==t?(bi=null,vi=tt()+500,Rr(e,t)):Dr=un(e,t);e:do try{if(ze!==0&&De!==null){t=De;var f=Lt;t:switch(ze){case 1:ze=0,Lt=null,Ur(e,t,f,1);break;case 2:case 9:if($h(f)){ze=0,Lt=null,Am(t);break}t=function(){ze!==2&&ze!==9||Ve!==e||(ze=7),gs(e)},f.then(t,t);break e;case 3:ze=7;break e;case 4:ze=5;break e;case 7:$h(f)?(ze=0,Lt=null,Am(t)):(ze=0,Lt=null,Ur(e,t,f,7));break;case 5:var y=null;switch(De.tag){case 26:y=De.memoizedState;case 5:case 27:var w=De;if(!y||h0(y)){ze=0,Lt=null;var T=w.sibling;if(T!==null)De=T;else{var z=w.return;z!==null?(De=z,ji(z)):De=null}break t}}ze=0,Lt=null,Ur(e,t,f,5);break;case 6:ze=0,Lt=null,Ur(e,t,f,6);break;case 8:tu(),et=6;break e;default:throw Error(i(462))}}gy();break}catch(F){Tm(e,F)}while(!0);return Ts=Ua=null,L.H=o,L.A=d,qe=r,De!==null?0:(Ve=null,Oe=0,Kl(),et)}function gy(){for(;De!==null&&!Ce();)Dm(De)}function Dm(e){var t=am(e.alternate,e,Us);e.memoizedProps=e.pendingProps,t===null?ji(e):De=t}function Am(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Zf(r,t,t.pendingProps,t.type,void 0,Oe);break;case 11:t=Zf(r,t,t.pendingProps,t.type.render,t.ref,Oe);break;case 5:yc(t);default:nm(r,t),t=De=Ah(t,Us),t=am(r,t,Us)}e.memoizedProps=e.pendingProps,t===null?ji(e):De=t}function Ur(e,t,r,o){Ts=Ua=null,yc(t),kr=null,Bn=0;var d=t.return;try{if(ry(e,d,t,r,Oe)){et=1,fi(e,Gt(r,e.current)),De=null;return}}catch(f){if(d!==null)throw De=d,f;et=1,fi(e,Gt(r,e.current)),De=null;return}t.flags&32768?(Le||o===1?e=!0:Dr||(Oe&536870912)!==0?e=!1:(aa=e=!0,(o===2||o===9||o===3||o===6)&&(o=Yt.current,o!==null&&o.tag===13&&(o.flags|=16384))),Mm(t,e)):ji(t)}function ji(e){var t=e;do{if((t.flags&32768)!==0){Mm(t,aa);return}e=t.return;var r=ly(t.alternate,t,Us);if(r!==null){De=r;return}if(t=t.sibling,t!==null){De=t;return}De=t=e}while(t!==null);et===0&&(et=5)}function Mm(e,t){do{var r=iy(e.alternate,e);if(r!==null){r.flags&=32767,De=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){De=e;return}De=e=r}while(e!==null);et=6,De=null}function Om(e,t,r,o,d,f,y,w,T){e.cancelPendingCommit=null;do Ni();while(xt!==0);if((qe&6)!==0)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(f=t.lanes|t.childLanes,f|=Qo,Qx(e,r,f,y,w,T),e===Ve&&(De=Ve=null,Oe=0),Mr=t,la=e,Or=r,Jc=f,Wc=d,Nm=o,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,vy(ja,function(){return Bm(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||o){o=L.T,L.T=null,d=Q.p,Q.p=2,y=qe,qe|=4;try{oy(e,t,r)}finally{qe=y,Q.p=d,L.T=o}}xt=1,Rm(),Um(),Lm()}}function Rm(){if(xt===1){xt=0;var e=la,t=Mr,r=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||r){r=L.T,L.T=null;var o=Q.p;Q.p=2;var d=qe;qe|=4;try{xm(t,e);var f=gu,y=wh(e.containerInfo),w=f.focusedElem,T=f.selectionRange;if(y!==w&&w&&w.ownerDocument&&bh(w.ownerDocument.documentElement,w)){if(T!==null&&Po(w)){var z=T.start,F=T.end;if(F===void 0&&(F=z),"selectionStart"in w)w.selectionStart=z,w.selectionEnd=Math.min(F,w.value.length);else{var W=w.ownerDocument||document,$=W&&W.defaultView||window;if($.getSelection){var P=$.getSelection(),be=w.textContent.length,pe=Math.min(T.start,be),Ge=T.end===void 0?pe:Math.min(T.end,be);!P.extend&&pe>Ge&&(y=Ge,Ge=pe,pe=y);var U=vh(w,pe),O=vh(w,Ge);if(U&&O&&(P.rangeCount!==1||P.anchorNode!==U.node||P.anchorOffset!==U.offset||P.focusNode!==O.node||P.focusOffset!==O.offset)){var B=W.createRange();B.setStart(U.node,U.offset),P.removeAllRanges(),pe>Ge?(P.addRange(B),P.extend(O.node,O.offset)):(B.setEnd(O.node,O.offset),P.addRange(B))}}}}for(W=[],P=w;P=P.parentNode;)P.nodeType===1&&W.push({element:P,left:P.scrollLeft,top:P.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<W.length;w++){var X=W[w];X.element.scrollLeft=X.left,X.element.scrollTop=X.top}}Ui=!!mu,gu=mu=null}finally{qe=d,Q.p=o,L.T=r}}e.current=t,xt=2}}function Um(){if(xt===2){xt=0;var e=la,t=Mr,r=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||r){r=L.T,L.T=null;var o=Q.p;Q.p=2;var d=qe;qe|=4;try{hm(e,t.alternate,t)}finally{qe=d,Q.p=o,L.T=r}}xt=3}}function Lm(){if(xt===4||xt===3){xt=0,Re();var e=la,t=Mr,r=Or,o=Nm;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?xt=5:(xt=0,Mr=la=null,Hm(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(na=null),wo(r),t=t.stateNode,de&&typeof de.onCommitFiberRoot=="function")try{de.onCommitFiberRoot(we,t,void 0,(t.current.flags&128)===128)}catch{}if(o!==null){t=L.T,d=Q.p,Q.p=2,L.T=null;try{for(var f=e.onRecoverableError,y=0;y<o.length;y++){var w=o[y];f(w.value,{componentStack:w.stack})}}finally{L.T=t,Q.p=d}}(Or&3)!==0&&Ni(),gs(e),d=e.pendingLanes,(r&4194090)!==0&&(d&42)!==0?e===eu?Qn++:(Qn=0,eu=e):Qn=0,Yn(0)}}function Hm(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Tn(t)))}function Ni(e){return Rm(),Um(),Lm(),Bm()}function Bm(){if(xt!==5)return!1;var e=la,t=Jc;Jc=0;var r=wo(Or),o=L.T,d=Q.p;try{Q.p=32>r?32:r,L.T=null,r=Wc,Wc=null;var f=la,y=Or;if(xt=0,Mr=la=null,Or=0,(qe&6)!==0)throw Error(i(331));var w=qe;if(qe|=4,wm(f.current),ym(f,f.current,y,r),qe=w,Yn(0,!1),de&&typeof de.onPostCommitFiberRoot=="function")try{de.onPostCommitFiberRoot(we,f)}catch{}return!0}finally{Q.p=d,L.T=o,Hm(e,t)}}function qm(e,t,r){t=Gt(r,t),t=Mc(e.stateNode,t,2),e=Xs(e,t,2),e!==null&&(dn(e,2),gs(e))}function Ie(e,t,r){if(e.tag===3)qm(e,e,r);else for(;t!==null;){if(t.tag===3){qm(t,e,r);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(na===null||!na.has(o))){e=Gt(r,e),r=Kf(2),o=Xs(t,r,2),o!==null&&(Gf(r,o,t,e),dn(o,2),gs(o));break}}t=t.return}}function ru(e,t,r){var o=e.pingCache;if(o===null){o=e.pingCache=new dy;var d=new Set;o.set(t,d)}else d=o.get(t),d===void 0&&(d=new Set,o.set(t,d));d.has(r)||(Yc=!0,d.add(r),e=xy.bind(null,e,t,r),t.then(e,e))}function xy(e,t,r){var o=e.pingCache;o!==null&&o.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,Ve===e&&(Oe&r)===r&&(et===4||et===3&&(Oe&62914560)===Oe&&300>tt()-Zc?(qe&2)===0&&Rr(e,0):Fc|=r,Ar===Oe&&(Ar=0)),gs(e)}function zm(e,t){t===0&&(t=Ud()),e=xr(e,t),e!==null&&(dn(e,t),gs(e))}function py(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),zm(e,r)}function yy(e,t){var r=0;switch(e.tag){case 13:var o=e.stateNode,d=e.memoizedState;d!==null&&(r=d.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(i(314))}o!==null&&o.delete(t),zm(e,r)}function vy(e,t){return fe(e,t)}var Si=null,Lr=null,nu=!1,_i=!1,lu=!1,Pa=0;function gs(e){e!==Lr&&e.next===null&&(Lr===null?Si=Lr=e:Lr=Lr.next=e),_i=!0,nu||(nu=!0,wy())}function Yn(e,t){if(!lu&&_i){lu=!0;do for(var r=!1,o=Si;o!==null;){if(e!==0){var d=o.pendingLanes;if(d===0)var f=0;else{var y=o.suspendedLanes,w=o.pingedLanes;f=(1<<31-Ne(42|e)+1)-1,f&=d&~(y&~w),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(r=!0,Gm(o,f))}else f=Oe,f=Al(o,o===Ve?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(f&3)===0||un(o,f)||(r=!0,Gm(o,f));o=o.next}while(r);lu=!1}}function by(){$m()}function $m(){_i=nu=!1;var e=0;Pa!==0&&(Cy()&&(e=Pa),Pa=0);for(var t=tt(),r=null,o=Si;o!==null;){var d=o.next,f=Pm(o,t);f===0?(o.next=null,r===null?Si=d:r.next=d,d===null&&(Lr=r)):(r=o,(e!==0||(f&3)!==0)&&(_i=!0)),o=d}Yn(e)}function Pm(e,t){for(var r=e.suspendedLanes,o=e.pingedLanes,d=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-Ne(f),w=1<<y,T=d[y];T===-1?((w&r)===0||(w&o)!==0)&&(d[y]=Vx(w,t)):T<=t&&(e.expiredLanes|=w),f&=~w}if(t=Ve,r=Oe,r=Al(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,r===0||e===t&&(ze===2||ze===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&Ee(o),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||un(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(o!==null&&Ee(o),wo(r)){case 2:case 8:r=tr;break;case 32:r=ja;break;case 268435456:r=K;break;default:r=ja}return o=Km.bind(null,e),r=fe(r,o),e.callbackPriority=t,e.callbackNode=r,t}return o!==null&&o!==null&&Ee(o),e.callbackPriority=2,e.callbackNode=null,2}function Km(e,t){if(xt!==0&&xt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Ni()&&e.callbackNode!==r)return null;var o=Oe;return o=Al(e,e===Ve?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(_m(e,o,t),Pm(e,tt()),e.callbackNode!=null&&e.callbackNode===r?Km.bind(null,e):null)}function Gm(e,t){if(Ni())return null;_m(e,t,!0)}function wy(){Ay(function(){(qe&6)!==0?fe(wa,by):$m()})}function iu(){return Pa===0&&(Pa=Rd()),Pa}function Im(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ll(""+e)}function Vm(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function jy(e,t,r,o,d){if(t==="submit"&&r&&r.stateNode===d){var f=Im((d[_t]||null).action),y=o.submitter;y&&(t=(t=y[_t]||null)?Im(t.formAction):y.getAttribute("formAction"),t!==null&&(f=t,y=null));var w=new zl("action","action",null,o,d);e.push({event:w,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(Pa!==0){var T=y?Vm(d,y):new FormData(d);Tc(r,{pending:!0,data:T,method:d.method,action:f},null,T)}}else typeof f=="function"&&(w.preventDefault(),T=y?Vm(d,y):new FormData(d),Tc(r,{pending:!0,data:T,method:d.method,action:f},f,T))},currentTarget:d}]})}}for(var ou=0;ou<Vo.length;ou++){var cu=Vo[ou],Ny=cu.toLowerCase(),Sy=cu[0].toUpperCase()+cu.slice(1);ts(Ny,"on"+Sy)}ts(Sh,"onAnimationEnd"),ts(_h,"onAnimationIteration"),ts(kh,"onAnimationStart"),ts("dblclick","onDoubleClick"),ts("focusin","onFocus"),ts("focusout","onBlur"),ts($p,"onTransitionRun"),ts(Pp,"onTransitionStart"),ts(Kp,"onTransitionCancel"),ts(Th,"onTransitionEnd"),lr("onMouseEnter",["mouseout","mouseover"]),lr("onMouseLeave",["mouseout","mouseover"]),lr("onPointerEnter",["pointerout","pointerover"]),lr("onPointerLeave",["pointerout","pointerover"]),ka("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ka("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ka("onBeforeInput",["compositionend","keypress","textInput","paste"]),ka("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ka("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ka("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_y=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fn));function Qm(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var o=e[r],d=o.event;o=o.listeners;e:{var f=void 0;if(t)for(var y=o.length-1;0<=y;y--){var w=o[y],T=w.instance,z=w.currentTarget;if(w=w.listener,T!==f&&d.isPropagationStopped())break e;f=w,d.currentTarget=z;try{f(d)}catch(F){hi(F)}d.currentTarget=null,f=T}else for(y=0;y<o.length;y++){if(w=o[y],T=w.instance,z=w.currentTarget,w=w.listener,T!==f&&d.isPropagationStopped())break e;f=w,d.currentTarget=z;try{f(d)}catch(F){hi(F)}d.currentTarget=null,f=T}}}}function Ae(e,t){var r=t[jo];r===void 0&&(r=t[jo]=new Set);var o=e+"__bubble";r.has(o)||(Ym(t,e,2,!1),r.add(o))}function uu(e,t,r){var o=0;t&&(o|=4),Ym(r,e,o,t)}var ki="_reactListening"+Math.random().toString(36).slice(2);function du(e){if(!e[ki]){e[ki]=!0,zd.forEach(function(r){r!=="selectionchange"&&(_y.has(r)||uu(r,!1,e),uu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ki]||(t[ki]=!0,uu("selectionchange",!1,t))}}function Ym(e,t,r,o){switch(y0(t)){case 2:var d=Jy;break;case 8:d=Wy;break;default:d=_u}r=d.bind(null,t,r,e),d=void 0,!Oo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(d=!0),o?d!==void 0?e.addEventListener(t,r,{capture:!0,passive:d}):e.addEventListener(t,r,!0):d!==void 0?e.addEventListener(t,r,{passive:d}):e.addEventListener(t,r,!1)}function hu(e,t,r,o,d){var f=o;if((t&1)===0&&(t&2)===0&&o!==null)e:for(;;){if(o===null)return;var y=o.tag;if(y===3||y===4){var w=o.stateNode.containerInfo;if(w===d)break;if(y===4)for(y=o.return;y!==null;){var T=y.tag;if((T===3||T===4)&&y.stateNode.containerInfo===d)return;y=y.return}for(;w!==null;){if(y=ar(w),y===null)return;if(T=y.tag,T===5||T===6||T===26||T===27){o=f=y;continue e}w=w.parentNode}}o=o.return}eh(function(){var z=f,F=Ao(r),W=[];e:{var $=Eh.get(e);if($!==void 0){var P=zl,be=e;switch(e){case"keypress":if(Bl(r)===0)break e;case"keydown":case"keyup":P=vp;break;case"focusin":be="focus",P=Ho;break;case"focusout":be="blur",P=Ho;break;case"beforeblur":case"afterblur":P=Ho;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":P=ah;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":P=ip;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":P=jp;break;case Sh:case _h:case kh:P=up;break;case Th:P=Sp;break;case"scroll":case"scrollend":P=np;break;case"wheel":P=kp;break;case"copy":case"cut":case"paste":P=hp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":P=nh;break;case"toggle":case"beforetoggle":P=Ep}var pe=(t&4)!==0,Ge=!pe&&(e==="scroll"||e==="scrollend"),U=pe?$!==null?$+"Capture":null:$;pe=[];for(var O=z,B;O!==null;){var X=O;if(B=X.stateNode,X=X.tag,X!==5&&X!==26&&X!==27||B===null||U===null||(X=mn(O,U),X!=null&&pe.push(Xn(O,X,B))),Ge)break;O=O.return}0<pe.length&&($=new P($,be,null,r,F),W.push({event:$,listeners:pe}))}}if((t&7)===0){e:{if($=e==="mouseover"||e==="pointerover",P=e==="mouseout"||e==="pointerout",$&&r!==Do&&(be=r.relatedTarget||r.fromElement)&&(ar(be)||be[sr]))break e;if((P||$)&&($=F.window===F?F:($=F.ownerDocument)?$.defaultView||$.parentWindow:window,P?(be=r.relatedTarget||r.toElement,P=z,be=be?ar(be):null,be!==null&&(Ge=u(be),pe=be.tag,be!==Ge||pe!==5&&pe!==27&&pe!==6)&&(be=null)):(P=null,be=z),P!==be)){if(pe=ah,X="onMouseLeave",U="onMouseEnter",O="mouse",(e==="pointerout"||e==="pointerover")&&(pe=nh,X="onPointerLeave",U="onPointerEnter",O="pointer"),Ge=P==null?$:fn(P),B=be==null?$:fn(be),$=new pe(X,O+"leave",P,r,F),$.target=Ge,$.relatedTarget=B,X=null,ar(F)===z&&(pe=new pe(U,O+"enter",be,r,F),pe.target=B,pe.relatedTarget=Ge,X=pe),Ge=X,P&&be)t:{for(pe=P,U=be,O=0,B=pe;B;B=Hr(B))O++;for(B=0,X=U;X;X=Hr(X))B++;for(;0<O-B;)pe=Hr(pe),O--;for(;0<B-O;)U=Hr(U),B--;for(;O--;){if(pe===U||U!==null&&pe===U.alternate)break t;pe=Hr(pe),U=Hr(U)}pe=null}else pe=null;P!==null&&Fm(W,$,P,pe,!1),be!==null&&Ge!==null&&Fm(W,Ge,be,pe,!0)}}e:{if($=z?fn(z):window,P=$.nodeName&&$.nodeName.toLowerCase(),P==="select"||P==="input"&&$.type==="file")var me=fh;else if(dh($))if(mh)me=Bp;else{me=Lp;var Te=Up}else P=$.nodeName,!P||P.toLowerCase()!=="input"||$.type!=="checkbox"&&$.type!=="radio"?z&&Co(z.elementType)&&(me=fh):me=Hp;if(me&&(me=me(e,z))){hh(W,me,r,F);break e}Te&&Te(e,$,z),e==="focusout"&&z&&$.type==="number"&&z.memoizedProps.value!=null&&Eo($,"number",$.value)}switch(Te=z?fn(z):window,e){case"focusin":(dh(Te)||Te.contentEditable==="true")&&(fr=Te,Ko=z,jn=null);break;case"focusout":jn=Ko=fr=null;break;case"mousedown":Go=!0;break;case"contextmenu":case"mouseup":case"dragend":Go=!1,jh(W,r,F);break;case"selectionchange":if(zp)break;case"keydown":case"keyup":jh(W,r,F)}var ge;if(qo)e:{switch(e){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else hr?ch(e,r)&&(ve="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(ve="onCompositionStart");ve&&(lh&&r.locale!=="ko"&&(hr||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&hr&&(ge=th()):(Vs=F,Ro="value"in Vs?Vs.value:Vs.textContent,hr=!0)),Te=Ti(z,ve),0<Te.length&&(ve=new rh(ve,e,null,r,F),W.push({event:ve,listeners:Te}),ge?ve.data=ge:(ge=uh(r),ge!==null&&(ve.data=ge)))),(ge=Dp?Ap(e,r):Mp(e,r))&&(ve=Ti(z,"onBeforeInput"),0<ve.length&&(Te=new rh("onBeforeInput","beforeinput",null,r,F),W.push({event:Te,listeners:ve}),Te.data=ge)),jy(W,e,z,r,F)}Qm(W,t)})}function Xn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ti(e,t){for(var r=t+"Capture",o=[];e!==null;){var d=e,f=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||f===null||(d=mn(e,r),d!=null&&o.unshift(Xn(e,d,f)),d=mn(e,t),d!=null&&o.push(Xn(e,d,f))),e.tag===3)return o;e=e.return}return[]}function Hr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Fm(e,t,r,o,d){for(var f=t._reactName,y=[];r!==null&&r!==o;){var w=r,T=w.alternate,z=w.stateNode;if(w=w.tag,T!==null&&T===o)break;w!==5&&w!==26&&w!==27||z===null||(T=z,d?(z=mn(r,f),z!=null&&y.unshift(Xn(r,z,T))):d||(z=mn(r,f),z!=null&&y.push(Xn(r,z,T)))),r=r.return}y.length!==0&&e.push({event:t,listeners:y})}var ky=/\r\n?/g,Ty=/\u0000|\uFFFD/g;function Xm(e){return(typeof e=="string"?e:""+e).replace(ky,`
`).replace(Ty,"")}function Zm(e,t){return t=Xm(t),Xm(e)===t}function Ei(){}function Ke(e,t,r,o,d,f){switch(r){case"children":typeof o=="string"?t==="body"||t==="textarea"&&o===""||cr(e,o):(typeof o=="number"||typeof o=="bigint")&&t!=="body"&&cr(e,""+o);break;case"className":Ol(e,"class",o);break;case"tabIndex":Ol(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":Ol(e,r,o);break;case"style":Jd(e,o,f);break;case"data":if(t!=="object"){Ol(e,"data",o);break}case"src":case"href":if(o===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(r);break}o=Ll(""+o),e.setAttribute(r,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(r==="formAction"?(t!=="input"&&Ke(e,t,"name",d.name,d,null),Ke(e,t,"formEncType",d.formEncType,d,null),Ke(e,t,"formMethod",d.formMethod,d,null),Ke(e,t,"formTarget",d.formTarget,d,null)):(Ke(e,t,"encType",d.encType,d,null),Ke(e,t,"method",d.method,d,null),Ke(e,t,"target",d.target,d,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(r);break}o=Ll(""+o),e.setAttribute(r,o);break;case"onClick":o!=null&&(e.onclick=Ei);break;case"onScroll":o!=null&&Ae("scroll",e);break;case"onScrollEnd":o!=null&&Ae("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(r=o.__html,r!=null){if(d.children!=null)throw Error(i(60));e.innerHTML=r}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}r=Ll(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,""+o):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":o===!0?e.setAttribute(r,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(r,o):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(r,o):e.removeAttribute(r);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(r):e.setAttribute(r,o);break;case"popover":Ae("beforetoggle",e),Ae("toggle",e),Ml(e,"popover",o);break;case"xlinkActuate":js(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":js(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":js(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":js(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":js(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":js(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":js(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":js(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":js(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":Ml(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=ap.get(r)||r,Ml(e,r,o))}}function fu(e,t,r,o,d,f){switch(r){case"style":Jd(e,o,f);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(r=o.__html,r!=null){if(d.children!=null)throw Error(i(60));e.innerHTML=r}}break;case"children":typeof o=="string"?cr(e,o):(typeof o=="number"||typeof o=="bigint")&&cr(e,""+o);break;case"onScroll":o!=null&&Ae("scroll",e);break;case"onScrollEnd":o!=null&&Ae("scrollend",e);break;case"onClick":o!=null&&(e.onclick=Ei);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$d.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(d=r.endsWith("Capture"),t=r.slice(2,d?r.length-7:void 0),f=e[_t]||null,f=f!=null?f[r]:null,typeof f=="function"&&e.removeEventListener(t,f,d),typeof o=="function")){typeof f!="function"&&f!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,o,d);break e}r in e?e[r]=o:o===!0?e.setAttribute(r,""):Ml(e,r,o)}}}function pt(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ae("error",e),Ae("load",e);var o=!1,d=!1,f;for(f in r)if(r.hasOwnProperty(f)){var y=r[f];if(y!=null)switch(f){case"src":o=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Ke(e,t,f,y,r,null)}}d&&Ke(e,t,"srcSet",r.srcSet,r,null),o&&Ke(e,t,"src",r.src,r,null);return;case"input":Ae("invalid",e);var w=f=y=d=null,T=null,z=null;for(o in r)if(r.hasOwnProperty(o)){var F=r[o];if(F!=null)switch(o){case"name":d=F;break;case"type":y=F;break;case"checked":T=F;break;case"defaultChecked":z=F;break;case"value":f=F;break;case"defaultValue":w=F;break;case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(i(137,t));break;default:Ke(e,t,o,F,r,null)}}Yd(e,f,w,T,z,y,d,!1),Rl(e);return;case"select":Ae("invalid",e),o=y=f=null;for(d in r)if(r.hasOwnProperty(d)&&(w=r[d],w!=null))switch(d){case"value":f=w;break;case"defaultValue":y=w;break;case"multiple":o=w;default:Ke(e,t,d,w,r,null)}t=f,r=y,e.multiple=!!o,t!=null?or(e,!!o,t,!1):r!=null&&or(e,!!o,r,!0);return;case"textarea":Ae("invalid",e),f=d=o=null;for(y in r)if(r.hasOwnProperty(y)&&(w=r[y],w!=null))switch(y){case"value":o=w;break;case"defaultValue":d=w;break;case"children":f=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:Ke(e,t,y,w,r,null)}Xd(e,o,d,f),Rl(e);return;case"option":for(T in r)if(r.hasOwnProperty(T)&&(o=r[T],o!=null))switch(T){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:Ke(e,t,T,o,r,null)}return;case"dialog":Ae("beforetoggle",e),Ae("toggle",e),Ae("cancel",e),Ae("close",e);break;case"iframe":case"object":Ae("load",e);break;case"video":case"audio":for(o=0;o<Fn.length;o++)Ae(Fn[o],e);break;case"image":Ae("error",e),Ae("load",e);break;case"details":Ae("toggle",e);break;case"embed":case"source":case"link":Ae("error",e),Ae("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(z in r)if(r.hasOwnProperty(z)&&(o=r[z],o!=null))switch(z){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Ke(e,t,z,o,r,null)}return;default:if(Co(t)){for(F in r)r.hasOwnProperty(F)&&(o=r[F],o!==void 0&&fu(e,t,F,o,r,void 0));return}}for(w in r)r.hasOwnProperty(w)&&(o=r[w],o!=null&&Ke(e,t,w,o,r,null))}function Ey(e,t,r,o){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,f=null,y=null,w=null,T=null,z=null,F=null;for(P in r){var W=r[P];if(r.hasOwnProperty(P)&&W!=null)switch(P){case"checked":break;case"value":break;case"defaultValue":T=W;default:o.hasOwnProperty(P)||Ke(e,t,P,null,o,W)}}for(var $ in o){var P=o[$];if(W=r[$],o.hasOwnProperty($)&&(P!=null||W!=null))switch($){case"type":f=P;break;case"name":d=P;break;case"checked":z=P;break;case"defaultChecked":F=P;break;case"value":y=P;break;case"defaultValue":w=P;break;case"children":case"dangerouslySetInnerHTML":if(P!=null)throw Error(i(137,t));break;default:P!==W&&Ke(e,t,$,P,o,W)}}To(e,y,w,T,z,F,f,d);return;case"select":P=y=w=$=null;for(f in r)if(T=r[f],r.hasOwnProperty(f)&&T!=null)switch(f){case"value":break;case"multiple":P=T;default:o.hasOwnProperty(f)||Ke(e,t,f,null,o,T)}for(d in o)if(f=o[d],T=r[d],o.hasOwnProperty(d)&&(f!=null||T!=null))switch(d){case"value":$=f;break;case"defaultValue":w=f;break;case"multiple":y=f;default:f!==T&&Ke(e,t,d,f,o,T)}t=w,r=y,o=P,$!=null?or(e,!!r,$,!1):!!o!=!!r&&(t!=null?or(e,!!r,t,!0):or(e,!!r,r?[]:"",!1));return;case"textarea":P=$=null;for(w in r)if(d=r[w],r.hasOwnProperty(w)&&d!=null&&!o.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:Ke(e,t,w,null,o,d)}for(y in o)if(d=o[y],f=r[y],o.hasOwnProperty(y)&&(d!=null||f!=null))switch(y){case"value":$=d;break;case"defaultValue":P=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(i(91));break;default:d!==f&&Ke(e,t,y,d,o,f)}Fd(e,$,P);return;case"option":for(var be in r)if($=r[be],r.hasOwnProperty(be)&&$!=null&&!o.hasOwnProperty(be))switch(be){case"selected":e.selected=!1;break;default:Ke(e,t,be,null,o,$)}for(T in o)if($=o[T],P=r[T],o.hasOwnProperty(T)&&$!==P&&($!=null||P!=null))switch(T){case"selected":e.selected=$&&typeof $!="function"&&typeof $!="symbol";break;default:Ke(e,t,T,$,o,P)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pe in r)$=r[pe],r.hasOwnProperty(pe)&&$!=null&&!o.hasOwnProperty(pe)&&Ke(e,t,pe,null,o,$);for(z in o)if($=o[z],P=r[z],o.hasOwnProperty(z)&&$!==P&&($!=null||P!=null))switch(z){case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(i(137,t));break;default:Ke(e,t,z,$,o,P)}return;default:if(Co(t)){for(var Ge in r)$=r[Ge],r.hasOwnProperty(Ge)&&$!==void 0&&!o.hasOwnProperty(Ge)&&fu(e,t,Ge,void 0,o,$);for(F in o)$=o[F],P=r[F],!o.hasOwnProperty(F)||$===P||$===void 0&&P===void 0||fu(e,t,F,$,o,P);return}}for(var U in r)$=r[U],r.hasOwnProperty(U)&&$!=null&&!o.hasOwnProperty(U)&&Ke(e,t,U,null,o,$);for(W in o)$=o[W],P=r[W],!o.hasOwnProperty(W)||$===P||$==null&&P==null||Ke(e,t,W,$,o,P)}var mu=null,gu=null;function Ci(e){return e.nodeType===9?e:e.ownerDocument}function Jm(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Wm(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function xu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var pu=null;function Cy(){var e=window.event;return e&&e.type==="popstate"?e===pu?!1:(pu=e,!0):(pu=null,!1)}var e0=typeof setTimeout=="function"?setTimeout:void 0,Dy=typeof clearTimeout=="function"?clearTimeout:void 0,t0=typeof Promise=="function"?Promise:void 0,Ay=typeof queueMicrotask=="function"?queueMicrotask:typeof t0<"u"?function(e){return t0.resolve(null).then(e).catch(My)}:e0;function My(e){setTimeout(function(){throw e})}function oa(e){return e==="head"}function s0(e,t){var r=t,o=0,d=0;do{var f=r.nextSibling;if(e.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"){if(0<o&&8>o){r=o;var y=e.ownerDocument;if(r&1&&Zn(y.documentElement),r&2&&Zn(y.body),r&4)for(r=y.head,Zn(r),y=r.firstChild;y;){var w=y.nextSibling,T=y.nodeName;y[hn]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&y.rel.toLowerCase()==="stylesheet"||r.removeChild(y),y=w}}if(d===0){e.removeChild(f),nl(t);return}d--}else r==="$"||r==="$?"||r==="$!"?d++:o=r.charCodeAt(0)-48;else o=0;r=f}while(r);nl(t)}function yu(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":yu(r),No(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function Oy(e,t,r,o){for(;e.nodeType===1;){var d=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[hn])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=as(e.nextSibling),e===null)break}return null}function Ry(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=as(e.nextSibling),e===null))return null;return e}function vu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Uy(e,t){var r=e.ownerDocument;if(e.data!=="$?"||r.readyState==="complete")t();else{var o=function(){t(),r.removeEventListener("DOMContentLoaded",o)};r.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function as(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var bu=null;function a0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}function r0(e,t,r){switch(t=Ci(r),e){case"html":if(e=t.documentElement,!e)throw Error(i(452));return e;case"head":if(e=t.head,!e)throw Error(i(453));return e;case"body":if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Zn(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);No(e)}var Xt=new Map,n0=new Set;function Di(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Ls=Q.d;Q.d={f:Ly,r:Hy,D:By,C:qy,L:zy,m:$y,X:Ky,S:Py,M:Gy};function Ly(){var e=Ls.f(),t=wi();return e||t}function Hy(e){var t=rr(e);t!==null&&t.tag===5&&t.type==="form"?_f(t):Ls.r(e)}var Br=typeof document>"u"?null:document;function l0(e,t,r){var o=Br;if(o&&typeof t=="string"&&t){var d=Kt(t);d='link[rel="'+e+'"][href="'+d+'"]',typeof r=="string"&&(d+='[crossorigin="'+r+'"]'),n0.has(d)||(n0.add(d),e={rel:e,crossOrigin:r,href:t},o.querySelector(d)===null&&(t=o.createElement("link"),pt(t,"link",e),ot(t),o.head.appendChild(t)))}}function By(e){Ls.D(e),l0("dns-prefetch",e,null)}function qy(e,t){Ls.C(e,t),l0("preconnect",e,t)}function zy(e,t,r){Ls.L(e,t,r);var o=Br;if(o&&e&&t){var d='link[rel="preload"][as="'+Kt(t)+'"]';t==="image"&&r&&r.imageSrcSet?(d+='[imagesrcset="'+Kt(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(d+='[imagesizes="'+Kt(r.imageSizes)+'"]')):d+='[href="'+Kt(e)+'"]';var f=d;switch(t){case"style":f=qr(e);break;case"script":f=zr(e)}Xt.has(f)||(e=p({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),Xt.set(f,e),o.querySelector(d)!==null||t==="style"&&o.querySelector(Jn(f))||t==="script"&&o.querySelector(Wn(f))||(t=o.createElement("link"),pt(t,"link",e),ot(t),o.head.appendChild(t)))}}function $y(e,t){Ls.m(e,t);var r=Br;if(r&&e){var o=t&&typeof t.as=="string"?t.as:"script",d='link[rel="modulepreload"][as="'+Kt(o)+'"][href="'+Kt(e)+'"]',f=d;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=zr(e)}if(!Xt.has(f)&&(e=p({rel:"modulepreload",href:e},t),Xt.set(f,e),r.querySelector(d)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Wn(f)))return}o=r.createElement("link"),pt(o,"link",e),ot(o),r.head.appendChild(o)}}}function Py(e,t,r){Ls.S(e,t,r);var o=Br;if(o&&e){var d=nr(o).hoistableStyles,f=qr(e);t=t||"default";var y=d.get(f);if(!y){var w={loading:0,preload:null};if(y=o.querySelector(Jn(f)))w.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Xt.get(f))&&wu(e,r);var T=y=o.createElement("link");ot(T),pt(T,"link",e),T._p=new Promise(function(z,F){T.onload=z,T.onerror=F}),T.addEventListener("load",function(){w.loading|=1}),T.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Ai(y,t,o)}y={type:"stylesheet",instance:y,count:1,state:w},d.set(f,y)}}}function Ky(e,t){Ls.X(e,t);var r=Br;if(r&&e){var o=nr(r).hoistableScripts,d=zr(e),f=o.get(d);f||(f=r.querySelector(Wn(d)),f||(e=p({src:e,async:!0},t),(t=Xt.get(d))&&ju(e,t),f=r.createElement("script"),ot(f),pt(f,"link",e),r.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},o.set(d,f))}}function Gy(e,t){Ls.M(e,t);var r=Br;if(r&&e){var o=nr(r).hoistableScripts,d=zr(e),f=o.get(d);f||(f=r.querySelector(Wn(d)),f||(e=p({src:e,async:!0,type:"module"},t),(t=Xt.get(d))&&ju(e,t),f=r.createElement("script"),ot(f),pt(f,"link",e),r.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},o.set(d,f))}}function i0(e,t,r,o){var d=(d=xe.current)?Di(d):null;if(!d)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=qr(r.href),r=nr(d).hoistableStyles,o=r.get(t),o||(o={type:"style",instance:null,count:0,state:null},r.set(t,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=qr(r.href);var f=nr(d).hoistableStyles,y=f.get(e);if(y||(d=d.ownerDocument||d,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=d.querySelector(Jn(e)))&&!f._p&&(y.instance=f,y.state.loading=5),Xt.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Xt.set(e,r),f||Iy(d,e,r,y.state))),t&&o===null)throw Error(i(528,""));return y}if(t&&o!==null)throw Error(i(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=zr(r),r=nr(d).hoistableScripts,o=r.get(t),o||(o={type:"script",instance:null,count:0,state:null},r.set(t,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function qr(e){return'href="'+Kt(e)+'"'}function Jn(e){return'link[rel="stylesheet"]['+e+"]"}function o0(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Iy(e,t,r,o){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?o.loading=1:(t=e.createElement("link"),o.preload=t,t.addEventListener("load",function(){return o.loading|=1}),t.addEventListener("error",function(){return o.loading|=2}),pt(t,"link",r),ot(t),e.head.appendChild(t))}function zr(e){return'[src="'+Kt(e)+'"]'}function Wn(e){return"script[async]"+e}function c0(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var o=e.querySelector('style[data-href~="'+Kt(r.href)+'"]');if(o)return t.instance=o,ot(o),o;var d=p({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),ot(o),pt(o,"style",d),Ai(o,r.precedence,e),t.instance=o;case"stylesheet":d=qr(r.href);var f=e.querySelector(Jn(d));if(f)return t.state.loading|=4,t.instance=f,ot(f),f;o=o0(r),(d=Xt.get(d))&&wu(o,d),f=(e.ownerDocument||e).createElement("link"),ot(f);var y=f;return y._p=new Promise(function(w,T){y.onload=w,y.onerror=T}),pt(f,"link",o),t.state.loading|=4,Ai(f,r.precedence,e),t.instance=f;case"script":return f=zr(r.src),(d=e.querySelector(Wn(f)))?(t.instance=d,ot(d),d):(o=r,(d=Xt.get(f))&&(o=p({},r),ju(o,d)),e=e.ownerDocument||e,d=e.createElement("script"),ot(d),pt(d,"link",o),e.head.appendChild(d),t.instance=d);case"void":return null;default:throw Error(i(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(o=t.instance,t.state.loading|=4,Ai(o,r.precedence,e));return t.instance}function Ai(e,t,r){for(var o=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=o.length?o[o.length-1]:null,f=d,y=0;y<o.length;y++){var w=o[y];if(w.dataset.precedence===t)f=w;else if(f!==d)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function wu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function ju(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Mi=null;function u0(e,t,r){if(Mi===null){var o=new Map,d=Mi=new Map;d.set(r,o)}else d=Mi,o=d.get(r),o||(o=new Map,d.set(r,o));if(o.has(e))return o;for(o.set(e,null),r=r.getElementsByTagName(e),d=0;d<r.length;d++){var f=r[d];if(!(f[hn]||f[yt]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(t)||"";y=e+y;var w=o.get(y);w?w.push(f):o.set(y,[f])}}return o}function d0(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function Vy(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function h0(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var el=null;function Qy(){}function Yy(e,t,r){if(el===null)throw Error(i(475));var o=el;if(t.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var d=qr(r.href),f=e.querySelector(Jn(d));if(f){e=f._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(o.count++,o=Oi.bind(o),e.then(o,o)),t.state.loading|=4,t.instance=f,ot(f);return}f=e.ownerDocument||e,r=o0(r),(d=Xt.get(d))&&wu(r,d),f=f.createElement("link"),ot(f);var y=f;y._p=new Promise(function(w,T){y.onload=w,y.onerror=T}),pt(f,"link",r),t.instance=f}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(o.count++,t=Oi.bind(o),e.addEventListener("load",t),e.addEventListener("error",t))}}function Fy(){if(el===null)throw Error(i(475));var e=el;return e.stylesheets&&e.count===0&&Nu(e,e.stylesheets),0<e.count?function(t){var r=setTimeout(function(){if(e.stylesheets&&Nu(e,e.stylesheets),e.unsuspend){var o=e.unsuspend;e.unsuspend=null,o()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(r)}}:null}function Oi(){if(this.count--,this.count===0){if(this.stylesheets)Nu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Ri=null;function Nu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Ri=new Map,t.forEach(Xy,e),Ri=null,Oi.call(e))}function Xy(e,t){if(!(t.state.loading&4)){var r=Ri.get(e);if(r)var o=r.get(null);else{r=new Map,Ri.set(e,r);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<d.length;f++){var y=d[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(r.set(y.dataset.precedence,y),o=y)}o&&r.set(null,o)}d=t.instance,y=d.getAttribute("data-precedence"),f=r.get(y)||o,f===o&&r.set(null,d),r.set(y,d),this.count++,o=Oi.bind(this),d.addEventListener("load",o),d.addEventListener("error",o),f?f.parentNode.insertBefore(d,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),t.state.loading|=4}}var tl={$$typeof:A,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function Zy(e,t,r,o,d,f,y,w){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=vo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vo(0),this.hiddenUpdates=vo(null),this.identifierPrefix=o,this.onUncaughtError=d,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function f0(e,t,r,o,d,f,y,w,T,z,F,W){return e=new Zy(e,t,r,y,w,T,z,W),t=1,f===!0&&(t|=24),f=Ot(3,null,null,t),e.current=f,f.stateNode=e,t=rc(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:o,isDehydrated:r,cache:t},oc(f),e}function m0(e){return e?(e=pr,e):pr}function g0(e,t,r,o,d,f){d=m0(d),o.context===null?o.context=d:o.pendingContext=d,o=Fs(t),o.payload={element:r},f=f===void 0?null:f,f!==null&&(o.callback=f),r=Xs(e,o,t),r!==null&&(Bt(r,e,t),An(r,e,t))}function x0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Su(e,t){x0(e,t),(e=e.alternate)&&x0(e,t)}function p0(e){if(e.tag===13){var t=xr(e,67108864);t!==null&&Bt(t,e,67108864),Su(e,67108864)}}var Ui=!0;function Jy(e,t,r,o){var d=L.T;L.T=null;var f=Q.p;try{Q.p=2,_u(e,t,r,o)}finally{Q.p=f,L.T=d}}function Wy(e,t,r,o){var d=L.T;L.T=null;var f=Q.p;try{Q.p=8,_u(e,t,r,o)}finally{Q.p=f,L.T=d}}function _u(e,t,r,o){if(Ui){var d=ku(o);if(d===null)hu(e,t,o,Li,r),v0(e,o);else if(tv(d,e,t,r,o))o.stopPropagation();else if(v0(e,o),t&4&&-1<ev.indexOf(e)){for(;d!==null;){var f=rr(d);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=_a(f.pendingLanes);if(y!==0){var w=f;for(w.pendingLanes|=2,w.entangledLanes|=2;y;){var T=1<<31-Ne(y);w.entanglements[1]|=T,y&=~T}gs(f),(qe&6)===0&&(vi=tt()+500,Yn(0))}}break;case 13:w=xr(f,2),w!==null&&Bt(w,f,2),wi(),Su(f,2)}if(f=ku(o),f===null&&hu(e,t,o,Li,r),f===d)break;d=f}d!==null&&o.stopPropagation()}else hu(e,t,o,null,r)}}function ku(e){return e=Ao(e),Tu(e)}var Li=null;function Tu(e){if(Li=null,e=ar(e),e!==null){var t=u(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=h(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Li=e,null}function y0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(er()){case wa:return 2;case tr:return 8;case ja:case yo:return 32;case K:return 268435456;default:return 32}default:return 32}}var Eu=!1,ca=null,ua=null,da=null,sl=new Map,al=new Map,ha=[],ev="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function v0(e,t){switch(e){case"focusin":case"focusout":ca=null;break;case"dragenter":case"dragleave":ua=null;break;case"mouseover":case"mouseout":da=null;break;case"pointerover":case"pointerout":sl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":al.delete(t.pointerId)}}function rl(e,t,r,o,d,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:r,eventSystemFlags:o,nativeEvent:f,targetContainers:[d]},t!==null&&(t=rr(t),t!==null&&p0(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,d!==null&&t.indexOf(d)===-1&&t.push(d),e)}function tv(e,t,r,o,d){switch(t){case"focusin":return ca=rl(ca,e,t,r,o,d),!0;case"dragenter":return ua=rl(ua,e,t,r,o,d),!0;case"mouseover":return da=rl(da,e,t,r,o,d),!0;case"pointerover":var f=d.pointerId;return sl.set(f,rl(sl.get(f)||null,e,t,r,o,d)),!0;case"gotpointercapture":return f=d.pointerId,al.set(f,rl(al.get(f)||null,e,t,r,o,d)),!0}return!1}function b0(e){var t=ar(e.target);if(t!==null){var r=u(t);if(r!==null){if(t=r.tag,t===13){if(t=h(r),t!==null){e.blockedOn=t,Yx(e.priority,function(){if(r.tag===13){var o=Ht();o=bo(o);var d=xr(r,o);d!==null&&Bt(d,r,o),Su(r,o)}});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Hi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ku(e.nativeEvent);if(r===null){r=e.nativeEvent;var o=new r.constructor(r.type,r);Do=o,r.target.dispatchEvent(o),Do=null}else return t=rr(r),t!==null&&p0(t),e.blockedOn=r,!1;t.shift()}return!0}function w0(e,t,r){Hi(e)&&r.delete(t)}function sv(){Eu=!1,ca!==null&&Hi(ca)&&(ca=null),ua!==null&&Hi(ua)&&(ua=null),da!==null&&Hi(da)&&(da=null),sl.forEach(w0),al.forEach(w0)}function Bi(e,t){e.blockedOn===t&&(e.blockedOn=null,Eu||(Eu=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,sv)))}var qi=null;function j0(e){qi!==e&&(qi=e,l.unstable_scheduleCallback(l.unstable_NormalPriority,function(){qi===e&&(qi=null);for(var t=0;t<e.length;t+=3){var r=e[t],o=e[t+1],d=e[t+2];if(typeof o!="function"){if(Tu(o||r)===null)continue;break}var f=rr(r);f!==null&&(e.splice(t,3),t-=3,Tc(f,{pending:!0,data:d,method:r.method,action:o},o,d))}}))}function nl(e){function t(T){return Bi(T,e)}ca!==null&&Bi(ca,e),ua!==null&&Bi(ua,e),da!==null&&Bi(da,e),sl.forEach(t),al.forEach(t);for(var r=0;r<ha.length;r++){var o=ha[r];o.blockedOn===e&&(o.blockedOn=null)}for(;0<ha.length&&(r=ha[0],r.blockedOn===null);)b0(r),r.blockedOn===null&&ha.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(o=0;o<r.length;o+=3){var d=r[o],f=r[o+1],y=d[_t]||null;if(typeof f=="function")y||j0(r);else if(y){var w=null;if(f&&f.hasAttribute("formAction")){if(d=f,y=f[_t]||null)w=y.formAction;else if(Tu(d)!==null)continue}else w=y.action;typeof w=="function"?r[o+1]=w:(r.splice(o,3),o-=3),j0(r)}}}function Cu(e){this._internalRoot=e}zi.prototype.render=Cu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var r=t.current,o=Ht();g0(r,o,e,t,null,null)},zi.prototype.unmount=Cu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;g0(e.current,2,null,e,null,null),wi(),t[sr]=null}};function zi(e){this._internalRoot=e}zi.prototype.unstable_scheduleHydration=function(e){if(e){var t=Bd();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ha.length&&t!==0&&t<ha[r].priority;r++);ha.splice(r,0,e),r===0&&b0(e)}};var N0=a.version;if(N0!=="19.1.0")throw Error(i(527,N0,"19.1.0"));Q.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(t),e=e!==null?x(e):null,e=e===null?null:e.stateNode,e};var av={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $i=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$i.isDisabled&&$i.supportsFiber)try{we=$i.inject(av),de=$i}catch{}}return il.createRoot=function(e,t){if(!c(e))throw Error(i(299));var r=!1,o="",d=qf,f=zf,y=$f,w=null;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onUncaughtError!==void 0&&(d=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(w=t.unstable_transitionCallbacks)),t=f0(e,1,!1,null,null,r,o,d,f,y,w,null),e[sr]=t.current,du(e),new Cu(t)},il.hydrateRoot=function(e,t,r){if(!c(e))throw Error(i(299));var o=!1,d="",f=qf,y=zf,w=$f,T=null,z=null;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(T=r.unstable_transitionCallbacks),r.formState!==void 0&&(z=r.formState)),t=f0(e,1,!0,t,r??null,o,d,f,y,w,T,z),t.context=m0(null),r=t.current,o=Ht(),o=bo(o),d=Fs(o),d.callback=null,Xs(r,d,o),r=o,t.current.lanes=r,dn(t,r),gs(t),e[sr]=t.current,du(e),new zi(t)},il.version="19.1.0",il}var O0;function fv(){if(O0)return Mu.exports;O0=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(a){console.error(a)}}return l(),Mu.exports=hv(),Mu.exports}var mv=fv();/**
 * react-router v7.7.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var R0="popstate";function gv(l={}){function a(i,c){let{pathname:u,search:h,hash:g}=i.location;return Zu("",{pathname:u,search:h,hash:g},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function n(i,c){return typeof c=="string"?c:yl(c)}return pv(a,n,null,l)}function Ze(l,a){if(l===!1||l===null||typeof l>"u")throw new Error(a)}function Wt(l,a){if(!l){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function xv(){return Math.random().toString(36).substring(2,10)}function U0(l,a){return{usr:l.state,key:l.key,idx:a}}function Zu(l,a,n=null,i){return{pathname:typeof l=="string"?l:l.pathname,search:"",hash:"",...typeof a=="string"?sn(a):a,state:n,key:a&&a.key||i||xv()}}function yl({pathname:l="/",search:a="",hash:n=""}){return a&&a!=="?"&&(l+=a.charAt(0)==="?"?a:"?"+a),n&&n!=="#"&&(l+=n.charAt(0)==="#"?n:"#"+n),l}function sn(l){let a={};if(l){let n=l.indexOf("#");n>=0&&(a.hash=l.substring(n),l=l.substring(0,n));let i=l.indexOf("?");i>=0&&(a.search=l.substring(i),l=l.substring(0,i)),l&&(a.pathname=l)}return a}function pv(l,a,n,i={}){let{window:c=document.defaultView,v5Compat:u=!1}=i,h=c.history,g="POP",m=null,x=p();x==null&&(x=0,h.replaceState({...h.state,idx:x},""));function p(){return(h.state||{idx:null}).idx}function v(){g="POP";let D=p(),M=D==null?null:D-x;x=D,m&&m({action:g,location:_.location,delta:M})}function j(D,M){g="PUSH";let E=Zu(_.location,D,M);x=p()+1;let A=U0(E,x),G=_.createHref(E);try{h.pushState(A,"",G)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;c.location.assign(G)}u&&m&&m({action:g,location:_.location,delta:1})}function N(D,M){g="REPLACE";let E=Zu(_.location,D,M);x=p();let A=U0(E,x),G=_.createHref(E);h.replaceState(A,"",G),u&&m&&m({action:g,location:_.location,delta:0})}function S(D){return yv(D)}let _={get action(){return g},get location(){return l(c,h)},listen(D){if(m)throw new Error("A history only accepts one active listener");return c.addEventListener(R0,v),m=D,()=>{c.removeEventListener(R0,v),m=null}},createHref(D){return a(c,D)},createURL:S,encodeLocation(D){let M=S(D);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:j,replace:N,go(D){return h.go(D)}};return _}function yv(l,a=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ze(n,"No window.location.(origin|href) available to create URL");let i=typeof l=="string"?l:yl(l);return i=i.replace(/ $/,"%20"),!a&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function qg(l,a,n="/"){return vv(l,a,n,!1)}function vv(l,a,n,i){let c=typeof a=="string"?sn(a):a,u=Ps(c.pathname||"/",n);if(u==null)return null;let h=zg(l);bv(h);let g=null;for(let m=0;g==null&&m<h.length;++m){let x=Av(u);g=Cv(h[m],x,i)}return g}function zg(l,a=[],n=[],i=""){let c=(u,h,g)=>{let m={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};m.relativePath.startsWith("/")&&(Ze(m.relativePath.startsWith(i),`Absolute route path "${m.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(i.length));let x=zs([i,m.relativePath]),p=n.concat(m);u.children&&u.children.length>0&&(Ze(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),zg(u.children,a,p,x)),!(u.path==null&&!u.index)&&a.push({path:x,score:Tv(x,u.index),routesMeta:p})};return l.forEach((u,h)=>{if(u.path===""||!u.path?.includes("?"))c(u,h);else for(let g of $g(u.path))c(u,h,g)}),a}function $g(l){let a=l.split("/");if(a.length===0)return[];let[n,...i]=a,c=n.endsWith("?"),u=n.replace(/\?$/,"");if(i.length===0)return c?[u,""]:[u];let h=$g(i.join("/")),g=[];return g.push(...h.map(m=>m===""?u:[u,m].join("/"))),c&&g.push(...h),g.map(m=>l.startsWith("/")&&m===""?"/":m)}function bv(l){l.sort((a,n)=>a.score!==n.score?n.score-a.score:Ev(a.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var wv=/^:[\w-]+$/,jv=3,Nv=2,Sv=1,_v=10,kv=-2,L0=l=>l==="*";function Tv(l,a){let n=l.split("/"),i=n.length;return n.some(L0)&&(i+=kv),a&&(i+=Nv),n.filter(c=>!L0(c)).reduce((c,u)=>c+(wv.test(u)?jv:u===""?Sv:_v),i)}function Ev(l,a){return l.length===a.length&&l.slice(0,-1).every((i,c)=>i===a[c])?l[l.length-1]-a[a.length-1]:0}function Cv(l,a,n=!1){let{routesMeta:i}=l,c={},u="/",h=[];for(let g=0;g<i.length;++g){let m=i[g],x=g===i.length-1,p=u==="/"?a:a.slice(u.length)||"/",v=so({path:m.relativePath,caseSensitive:m.caseSensitive,end:x},p),j=m.route;if(!v&&x&&n&&!i[i.length-1].route.index&&(v=so({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},p)),!v)return null;Object.assign(c,v.params),h.push({params:c,pathname:zs([u,v.pathname]),pathnameBase:Uv(zs([u,v.pathnameBase])),route:j}),v.pathnameBase!=="/"&&(u=zs([u,v.pathnameBase]))}return h}function so(l,a){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[n,i]=Dv(l.path,l.caseSensitive,l.end),c=a.match(n);if(!c)return null;let u=c[0],h=u.replace(/(.)\/+$/,"$1"),g=c.slice(1);return{params:i.reduce((x,{paramName:p,isOptional:v},j)=>{if(p==="*"){let S=g[j]||"";h=u.slice(0,u.length-S.length).replace(/(.)\/+$/,"$1")}const N=g[j];return v&&!N?x[p]=void 0:x[p]=(N||"").replace(/%2F/g,"/"),x},{}),pathname:u,pathnameBase:h,pattern:l}}function Dv(l,a=!1,n=!0){Wt(l==="*"||!l.endsWith("*")||l.endsWith("/*"),`Route path "${l}" will be treated as if it were "${l.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${l.replace(/\*$/,"/*")}".`);let i=[],c="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,g,m)=>(i.push({paramName:g,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return l.endsWith("*")?(i.push({paramName:"*"}),c+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?c+="\\/*$":l!==""&&l!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,a?void 0:"i"),i]}function Av(l){try{return l.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return Wt(!1,`The URL path "${l}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${a}).`),l}}function Ps(l,a){if(a==="/")return l;if(!l.toLowerCase().startsWith(a.toLowerCase()))return null;let n=a.endsWith("/")?a.length-1:a.length,i=l.charAt(n);return i&&i!=="/"?null:l.slice(n)||"/"}function Mv(l,a="/"){let{pathname:n,search:i="",hash:c=""}=typeof l=="string"?sn(l):l;return{pathname:n?n.startsWith("/")?n:Ov(n,a):a,search:Lv(i),hash:Hv(c)}}function Ov(l,a){let n=a.replace(/\/+$/,"").split("/");return l.split("/").forEach(c=>{c===".."?n.length>1&&n.pop():c!=="."&&n.push(c)}),n.length>1?n.join("/"):"/"}function Lu(l,a,n,i){return`Cannot include a '${l}' character in a manually specified \`to.${a}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Rv(l){return l.filter((a,n)=>n===0||a.route.path&&a.route.path.length>0)}function md(l){let a=Rv(l);return a.map((n,i)=>i===a.length-1?n.pathname:n.pathnameBase)}function gd(l,a,n,i=!1){let c;typeof l=="string"?c=sn(l):(c={...l},Ze(!c.pathname||!c.pathname.includes("?"),Lu("?","pathname","search",c)),Ze(!c.pathname||!c.pathname.includes("#"),Lu("#","pathname","hash",c)),Ze(!c.search||!c.search.includes("#"),Lu("#","search","hash",c)));let u=l===""||c.pathname==="",h=u?"/":c.pathname,g;if(h==null)g=n;else{let v=a.length-1;if(!i&&h.startsWith("..")){let j=h.split("/");for(;j[0]==="..";)j.shift(),v-=1;c.pathname=j.join("/")}g=v>=0?a[v]:"/"}let m=Mv(c,g),x=h&&h!=="/"&&h.endsWith("/"),p=(u||h===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(x||p)&&(m.pathname+="/"),m}var zs=l=>l.join("/").replace(/\/\/+/g,"/"),Uv=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),Lv=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,Hv=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l;function Bv(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}var Pg=["POST","PUT","PATCH","DELETE"];new Set(Pg);var qv=["GET",...Pg];new Set(qv);var an=b.createContext(null);an.displayName="DataRouter";var uo=b.createContext(null);uo.displayName="DataRouterState";b.createContext(!1);var Kg=b.createContext({isTransitioning:!1});Kg.displayName="ViewTransition";var zv=b.createContext(new Map);zv.displayName="Fetchers";var $v=b.createContext(null);$v.displayName="Await";var os=b.createContext(null);os.displayName="Navigation";var Sl=b.createContext(null);Sl.displayName="Location";var cs=b.createContext({outlet:null,matches:[],isDataRoute:!1});cs.displayName="Route";var xd=b.createContext(null);xd.displayName="RouteError";function Pv(l,{relative:a}={}){Ze(rn(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=b.useContext(os),{hash:c,pathname:u,search:h}=_l(l,{relative:a}),g=u;return n!=="/"&&(g=u==="/"?n:zs([n,u])),i.createHref({pathname:g,search:h,hash:c})}function rn(){return b.useContext(Sl)!=null}function bs(){return Ze(rn(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(Sl).location}var Gg="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ig(l){b.useContext(os).static||b.useLayoutEffect(l)}function ws(){let{isDataRoute:l}=b.useContext(cs);return l?sb():Kv()}function Kv(){Ze(rn(),"useNavigate() may be used only in the context of a <Router> component.");let l=b.useContext(an),{basename:a,navigator:n}=b.useContext(os),{matches:i}=b.useContext(cs),{pathname:c}=bs(),u=JSON.stringify(md(i)),h=b.useRef(!1);return Ig(()=>{h.current=!0}),b.useCallback((m,x={})=>{if(Wt(h.current,Gg),!h.current)return;if(typeof m=="number"){n.go(m);return}let p=gd(m,JSON.parse(u),c,x.relative==="path");l==null&&a!=="/"&&(p.pathname=p.pathname==="/"?a:zs([a,p.pathname])),(x.replace?n.replace:n.push)(p,x.state,x)},[a,n,u,c,l])}b.createContext(null);function Gv(){let{matches:l}=b.useContext(cs),a=l[l.length-1];return a?a.params:{}}function _l(l,{relative:a}={}){let{matches:n}=b.useContext(cs),{pathname:i}=bs(),c=JSON.stringify(md(n));return b.useMemo(()=>gd(l,JSON.parse(c),i,a==="path"),[l,c,i,a])}function Iv(l,a){return Vg(l,a)}function Vg(l,a,n,i){Ze(rn(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=b.useContext(os),{matches:u}=b.useContext(cs),h=u[u.length-1],g=h?h.params:{},m=h?h.pathname:"/",x=h?h.pathnameBase:"/",p=h&&h.route;{let M=p&&p.path||"";Qg(m,!p||M.endsWith("*")||M.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${M}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${M}"> to <Route path="${M==="/"?"*":`${M}/*`}">.`)}let v=bs(),j;if(a){let M=typeof a=="string"?sn(a):a;Ze(x==="/"||M.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${M.pathname}" was given in the \`location\` prop.`),j=M}else j=v;let N=j.pathname||"/",S=N;if(x!=="/"){let M=x.replace(/^\//,"").split("/");S="/"+N.replace(/^\//,"").split("/").slice(M.length).join("/")}let _=qg(l,{pathname:S});Wt(p||_!=null,`No routes matched location "${j.pathname}${j.search}${j.hash}" `),Wt(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${j.pathname}${j.search}${j.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let D=Xv(_&&_.map(M=>Object.assign({},M,{params:Object.assign({},g,M.params),pathname:zs([x,c.encodeLocation?c.encodeLocation(M.pathname).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?x:zs([x,c.encodeLocation?c.encodeLocation(M.pathnameBase).pathname:M.pathnameBase])})),u,n,i);return a&&D?b.createElement(Sl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...j},navigationType:"POP"}},D):D}function Vv(){let l=tb(),a=Bv(l)?`${l.status} ${l.statusText}`:l instanceof Error?l.message:JSON.stringify(l),n=l instanceof Error?l.stack:null,i="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},h=null;return console.error("Error handled by React Router default ErrorBoundary:",l),h=b.createElement(b.Fragment,null,b.createElement("p",null,"💿 Hey developer 👋"),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:u},"ErrorBoundary")," or"," ",b.createElement("code",{style:u},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},a),n?b.createElement("pre",{style:c},n):null,h)}var Qv=b.createElement(Vv,null),Yv=class extends b.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,a){return a.location!==l.location||a.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:a.error,location:a.location,revalidation:l.revalidation||a.revalidation}}componentDidCatch(l,a){console.error("React Router caught the following error during render",l,a)}render(){return this.state.error!==void 0?b.createElement(cs.Provider,{value:this.props.routeContext},b.createElement(xd.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Fv({routeContext:l,match:a,children:n}){let i=b.useContext(an);return i&&i.static&&i.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=a.route.id),b.createElement(cs.Provider,{value:l},n)}function Xv(l,a=[],n=null,i=null){if(l==null){if(!n)return null;if(n.errors)l=n.matches;else if(a.length===0&&!n.initialized&&n.matches.length>0)l=n.matches;else return null}let c=l,u=n?.errors;if(u!=null){let m=c.findIndex(x=>x.route.id&&u?.[x.route.id]!==void 0);Ze(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),c=c.slice(0,Math.min(c.length,m+1))}let h=!1,g=-1;if(n)for(let m=0;m<c.length;m++){let x=c[m];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(g=m),x.route.id){let{loaderData:p,errors:v}=n,j=x.route.loader&&!p.hasOwnProperty(x.route.id)&&(!v||v[x.route.id]===void 0);if(x.route.lazy||j){h=!0,g>=0?c=c.slice(0,g+1):c=[c[0]];break}}}return c.reduceRight((m,x,p)=>{let v,j=!1,N=null,S=null;n&&(v=u&&x.route.id?u[x.route.id]:void 0,N=x.route.errorElement||Qv,h&&(g<0&&p===0?(Qg("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),j=!0,S=null):g===p&&(j=!0,S=x.route.hydrateFallbackElement||null)));let _=a.concat(c.slice(0,p+1)),D=()=>{let M;return v?M=N:j?M=S:x.route.Component?M=b.createElement(x.route.Component,null):x.route.element?M=x.route.element:M=m,b.createElement(Fv,{match:x,routeContext:{outlet:m,matches:_,isDataRoute:n!=null},children:M})};return n&&(x.route.ErrorBoundary||x.route.errorElement||p===0)?b.createElement(Yv,{location:n.location,revalidation:n.revalidation,component:N,error:v,children:D(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):D()},null)}function pd(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Zv(l){let a=b.useContext(an);return Ze(a,pd(l)),a}function Jv(l){let a=b.useContext(uo);return Ze(a,pd(l)),a}function Wv(l){let a=b.useContext(cs);return Ze(a,pd(l)),a}function yd(l){let a=Wv(l),n=a.matches[a.matches.length-1];return Ze(n.route.id,`${l} can only be used on routes that contain a unique "id"`),n.route.id}function eb(){return yd("useRouteId")}function tb(){let l=b.useContext(xd),a=Jv("useRouteError"),n=yd("useRouteError");return l!==void 0?l:a.errors?.[n]}function sb(){let{router:l}=Zv("useNavigate"),a=yd("useNavigate"),n=b.useRef(!1);return Ig(()=>{n.current=!0}),b.useCallback(async(c,u={})=>{Wt(n.current,Gg),n.current&&(typeof c=="number"?l.navigate(c):await l.navigate(c,{fromRouteId:a,...u}))},[l,a])}var H0={};function Qg(l,a,n){!a&&!H0[l]&&(H0[l]=!0,Wt(!1,n))}b.memo(ab);function ab({routes:l,future:a,state:n}){return Vg(l,void 0,n,a)}function fl({to:l,replace:a,state:n,relative:i}){Ze(rn(),"<Navigate> may be used only in the context of a <Router> component.");let{static:c}=b.useContext(os);Wt(!c,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=b.useContext(cs),{pathname:h}=bs(),g=ws(),m=gd(l,md(u),h,i==="path"),x=JSON.stringify(m);return b.useEffect(()=>{g(JSON.parse(x),{replace:a,state:n,relative:i})},[g,x,i,a,n]),null}function Nt(l){Ze(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function rb({basename:l="/",children:a=null,location:n,navigationType:i="POP",navigator:c,static:u=!1}){Ze(!rn(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=l.replace(/^\/*/,"/"),g=b.useMemo(()=>({basename:h,navigator:c,static:u,future:{}}),[h,c,u]);typeof n=="string"&&(n=sn(n));let{pathname:m="/",search:x="",hash:p="",state:v=null,key:j="default"}=n,N=b.useMemo(()=>{let S=Ps(m,h);return S==null?null:{location:{pathname:S,search:x,hash:p,state:v,key:j},navigationType:i}},[h,m,x,p,v,j,i]);return Wt(N!=null,`<Router basename="${h}"> is not able to match the URL "${m}${x}${p}" because it does not start with the basename, so the <Router> won't render anything.`),N==null?null:b.createElement(os.Provider,{value:g},b.createElement(Sl.Provider,{children:a,value:N}))}function nb({children:l,location:a}){return Iv(Ju(l),a)}function Ju(l,a=[]){let n=[];return b.Children.forEach(l,(i,c)=>{if(!b.isValidElement(i))return;let u=[...a,c];if(i.type===b.Fragment){n.push.apply(n,Ju(i.props.children,u));return}Ze(i.type===Nt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ze(!i.props.index||!i.props.children,"An index route cannot have child routes.");let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=Ju(i.props.children,u)),n.push(h)}),n}var eo="get",to="application/x-www-form-urlencoded";function ho(l){return l!=null&&typeof l.tagName=="string"}function lb(l){return ho(l)&&l.tagName.toLowerCase()==="button"}function ib(l){return ho(l)&&l.tagName.toLowerCase()==="form"}function ob(l){return ho(l)&&l.tagName.toLowerCase()==="input"}function cb(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}function ub(l,a){return l.button===0&&(!a||a==="_self")&&!cb(l)}function Wu(l=""){return new URLSearchParams(typeof l=="string"||Array.isArray(l)||l instanceof URLSearchParams?l:Object.keys(l).reduce((a,n)=>{let i=l[n];return a.concat(Array.isArray(i)?i.map(c=>[n,c]):[[n,i]])},[]))}function db(l,a){let n=Wu(l);return a&&a.forEach((i,c)=>{n.has(c)||a.getAll(c).forEach(u=>{n.append(c,u)})}),n}var Pi=null;function hb(){if(Pi===null)try{new FormData(document.createElement("form"),0),Pi=!1}catch{Pi=!0}return Pi}var fb=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Hu(l){return l!=null&&!fb.has(l)?(Wt(!1,`"${l}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${to}"`),null):l}function mb(l,a){let n,i,c,u,h;if(ib(l)){let g=l.getAttribute("action");i=g?Ps(g,a):null,n=l.getAttribute("method")||eo,c=Hu(l.getAttribute("enctype"))||to,u=new FormData(l)}else if(lb(l)||ob(l)&&(l.type==="submit"||l.type==="image")){let g=l.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=l.getAttribute("formaction")||g.getAttribute("action");if(i=m?Ps(m,a):null,n=l.getAttribute("formmethod")||g.getAttribute("method")||eo,c=Hu(l.getAttribute("formenctype"))||Hu(g.getAttribute("enctype"))||to,u=new FormData(g,l),!hb()){let{name:x,type:p,value:v}=l;if(p==="image"){let j=x?`${x}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else x&&u.append(x,v)}}else{if(ho(l))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=eo,i=null,c=to,h=l}return u&&c==="text/plain"&&(h=u,u=void 0),{action:i,method:n.toLowerCase(),encType:c,formData:u,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function vd(l,a){if(l===!1||l===null||typeof l>"u")throw new Error(a)}function gb(l,a,n){let i=typeof l=="string"?new URL(l,typeof window>"u"?"server://singlefetch/":window.location.origin):l;return i.pathname==="/"?i.pathname=`_root.${n}`:a&&Ps(i.pathname,a)==="/"?i.pathname=`${a.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function xb(l,a){if(l.id in a)return a[l.id];try{let n=await import(l.module);return a[l.id]=n,n}catch(n){return console.error(`Error loading route module \`${l.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function pb(l){return l==null?!1:l.href==null?l.rel==="preload"&&typeof l.imageSrcSet=="string"&&typeof l.imageSizes=="string":typeof l.rel=="string"&&typeof l.href=="string"}async function yb(l,a,n){let i=await Promise.all(l.map(async c=>{let u=a.routes[c.route.id];if(u){let h=await xb(u,n);return h.links?h.links():[]}return[]}));return jb(i.flat(1).filter(pb).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function B0(l,a,n,i,c,u){let h=(m,x)=>n[x]?m.route.id!==n[x].route.id:!0,g=(m,x)=>n[x].pathname!==m.pathname||n[x].route.path?.endsWith("*")&&n[x].params["*"]!==m.params["*"];return u==="assets"?a.filter((m,x)=>h(m,x)||g(m,x)):u==="data"?a.filter((m,x)=>{let p=i.routes[m.route.id];if(!p||!p.hasLoader)return!1;if(h(m,x)||g(m,x))return!0;if(m.route.shouldRevalidate){let v=m.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(l,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function vb(l,a,{includeHydrateFallback:n}={}){return bb(l.map(i=>{let c=a.routes[i.route.id];if(!c)return[];let u=[c.module];return c.clientActionModule&&(u=u.concat(c.clientActionModule)),c.clientLoaderModule&&(u=u.concat(c.clientLoaderModule)),n&&c.hydrateFallbackModule&&(u=u.concat(c.hydrateFallbackModule)),c.imports&&(u=u.concat(c.imports)),u}).flat(1))}function bb(l){return[...new Set(l)]}function wb(l){let a={},n=Object.keys(l).sort();for(let i of n)a[i]=l[i];return a}function jb(l,a){let n=new Set;return new Set(a),l.reduce((i,c)=>{let u=JSON.stringify(wb(c));return n.has(u)||(n.add(u),i.push({key:u,link:c})),i},[])}function Yg(){let l=b.useContext(an);return vd(l,"You must render this element inside a <DataRouterContext.Provider> element"),l}function Nb(){let l=b.useContext(uo);return vd(l,"You must render this element inside a <DataRouterStateContext.Provider> element"),l}var bd=b.createContext(void 0);bd.displayName="FrameworkContext";function Fg(){let l=b.useContext(bd);return vd(l,"You must render this element inside a <HydratedRouter> element"),l}function Sb(l,a){let n=b.useContext(bd),[i,c]=b.useState(!1),[u,h]=b.useState(!1),{onFocus:g,onBlur:m,onMouseEnter:x,onMouseLeave:p,onTouchStart:v}=a,j=b.useRef(null);b.useEffect(()=>{if(l==="render"&&h(!0),l==="viewport"){let _=M=>{M.forEach(E=>{h(E.isIntersecting)})},D=new IntersectionObserver(_,{threshold:.5});return j.current&&D.observe(j.current),()=>{D.disconnect()}}},[l]),b.useEffect(()=>{if(i){let _=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(_)}}},[i]);let N=()=>{c(!0)},S=()=>{c(!1),h(!1)};return n?l!=="intent"?[u,j,{}]:[u,j,{onFocus:ol(g,N),onBlur:ol(m,S),onMouseEnter:ol(x,N),onMouseLeave:ol(p,S),onTouchStart:ol(v,N)}]:[!1,j,{}]}function ol(l,a){return n=>{l&&l(n),n.defaultPrevented||a(n)}}function _b({page:l,...a}){let{router:n}=Yg(),i=b.useMemo(()=>qg(n.routes,l,n.basename),[n.routes,l,n.basename]);return i?b.createElement(Tb,{page:l,matches:i,...a}):null}function kb(l){let{manifest:a,routeModules:n}=Fg(),[i,c]=b.useState([]);return b.useEffect(()=>{let u=!1;return yb(l,a,n).then(h=>{u||c(h)}),()=>{u=!0}},[l,a,n]),i}function Tb({page:l,matches:a,...n}){let i=bs(),{manifest:c,routeModules:u}=Fg(),{basename:h}=Yg(),{loaderData:g,matches:m}=Nb(),x=b.useMemo(()=>B0(l,a,m,c,i,"data"),[l,a,m,c,i]),p=b.useMemo(()=>B0(l,a,m,c,i,"assets"),[l,a,m,c,i]),v=b.useMemo(()=>{if(l===i.pathname+i.search+i.hash)return[];let S=new Set,_=!1;if(a.forEach(M=>{let E=c.routes[M.route.id];!E||!E.hasLoader||(!x.some(A=>A.route.id===M.route.id)&&M.route.id in g&&u[M.route.id]?.shouldRevalidate||E.hasClientLoader?_=!0:S.add(M.route.id))}),S.size===0)return[];let D=gb(l,h,"data");return _&&S.size>0&&D.searchParams.set("_routes",a.filter(M=>S.has(M.route.id)).map(M=>M.route.id).join(",")),[D.pathname+D.search]},[h,g,i,c,x,a,l,u]),j=b.useMemo(()=>vb(p,c),[p,c]),N=kb(p);return b.createElement(b.Fragment,null,v.map(S=>b.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...n})),j.map(S=>b.createElement("link",{key:S,rel:"modulepreload",href:S,...n})),N.map(({key:S,link:_})=>b.createElement("link",{key:S,..._})))}function Eb(...l){return a=>{l.forEach(n=>{typeof n=="function"?n(a):n!=null&&(n.current=a)})}}var Xg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Xg&&(window.__reactRouterVersion="7.7.0")}catch{}function Cb({basename:l,children:a,window:n}){let i=b.useRef();i.current==null&&(i.current=gv({window:n,v5Compat:!0}));let c=i.current,[u,h]=b.useState({action:c.action,location:c.location}),g=b.useCallback(m=>{b.startTransition(()=>h(m))},[h]);return b.useLayoutEffect(()=>c.listen(g),[c,g]),b.createElement(rb,{basename:l,children:a,location:u.location,navigationType:u.action,navigator:c})}var Zg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jg=b.forwardRef(function({onClick:a,discover:n="render",prefetch:i="none",relative:c,reloadDocument:u,replace:h,state:g,target:m,to:x,preventScrollReset:p,viewTransition:v,...j},N){let{basename:S}=b.useContext(os),_=typeof x=="string"&&Zg.test(x),D,M=!1;if(typeof x=="string"&&_&&(D=x,Xg))try{let ue=new URL(window.location.href),re=x.startsWith("//")?new URL(ue.protocol+x):new URL(x),ee=Ps(re.pathname,S);re.origin===ue.origin&&ee!=null?x=ee+re.search+re.hash:M=!0}catch{Wt(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=Pv(x,{relative:c}),[A,G,q]=Sb(i,j),H=Ob(x,{replace:h,state:g,target:m,preventScrollReset:p,relative:c,viewTransition:v});function R(ue){a&&a(ue),ue.defaultPrevented||H(ue)}let Z=b.createElement("a",{...j,...q,href:D||E,onClick:M||u?a:R,ref:Eb(N,G),target:m,"data-discover":!_&&n==="render"?"true":void 0});return A&&!_?b.createElement(b.Fragment,null,Z,b.createElement(_b,{page:E})):Z});Jg.displayName="Link";var Db=b.forwardRef(function({"aria-current":a="page",caseSensitive:n=!1,className:i="",end:c=!1,style:u,to:h,viewTransition:g,children:m,...x},p){let v=_l(h,{relative:x.relative}),j=bs(),N=b.useContext(uo),{navigator:S,basename:_}=b.useContext(os),D=N!=null&&Bb(v)&&g===!0,M=S.encodeLocation?S.encodeLocation(v).pathname:v.pathname,E=j.pathname,A=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;n||(E=E.toLowerCase(),A=A?A.toLowerCase():null,M=M.toLowerCase()),A&&_&&(A=Ps(A,_)||A);const G=M!=="/"&&M.endsWith("/")?M.length-1:M.length;let q=E===M||!c&&E.startsWith(M)&&E.charAt(G)==="/",H=A!=null&&(A===M||!c&&A.startsWith(M)&&A.charAt(M.length)==="/"),R={isActive:q,isPending:H,isTransitioning:D},Z=q?a:void 0,ue;typeof i=="function"?ue=i(R):ue=[i,q?"active":null,H?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let re=typeof u=="function"?u(R):u;return b.createElement(Jg,{...x,"aria-current":Z,className:ue,ref:p,style:re,to:h,viewTransition:g},typeof m=="function"?m(R):m)});Db.displayName="NavLink";var Ab=b.forwardRef(({discover:l="render",fetcherKey:a,navigate:n,reloadDocument:i,replace:c,state:u,method:h=eo,action:g,onSubmit:m,relative:x,preventScrollReset:p,viewTransition:v,...j},N)=>{let S=Lb(),_=Hb(g,{relative:x}),D=h.toLowerCase()==="get"?"get":"post",M=typeof g=="string"&&Zg.test(g),E=A=>{if(m&&m(A),A.defaultPrevented)return;A.preventDefault();let G=A.nativeEvent.submitter,q=G?.getAttribute("formmethod")||h;S(G||A.currentTarget,{fetcherKey:a,method:q,navigate:n,replace:c,state:u,relative:x,preventScrollReset:p,viewTransition:v})};return b.createElement("form",{ref:N,method:D,action:_,onSubmit:i?m:E,...j,"data-discover":!M&&l==="render"?"true":void 0})});Ab.displayName="Form";function Mb(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Wg(l){let a=b.useContext(an);return Ze(a,Mb(l)),a}function Ob(l,{target:a,replace:n,state:i,preventScrollReset:c,relative:u,viewTransition:h}={}){let g=ws(),m=bs(),x=_l(l,{relative:u});return b.useCallback(p=>{if(ub(p,a)){p.preventDefault();let v=n!==void 0?n:yl(m)===yl(x);g(l,{replace:v,state:i,preventScrollReset:c,relative:u,viewTransition:h})}},[m,g,x,n,i,a,l,c,u,h])}function fo(l){Wt(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let a=b.useRef(Wu(l)),n=b.useRef(!1),i=bs(),c=b.useMemo(()=>db(i.search,n.current?null:a.current),[i.search]),u=ws(),h=b.useCallback((g,m)=>{const x=Wu(typeof g=="function"?g(new URLSearchParams(c)):g);n.current=!0,u("?"+x,m)},[u,c]);return[c,h]}var Rb=0,Ub=()=>`__${String(++Rb)}__`;function Lb(){let{router:l}=Wg("useSubmit"),{basename:a}=b.useContext(os),n=eb();return b.useCallback(async(i,c={})=>{let{action:u,method:h,encType:g,formData:m,body:x}=mb(i,a);if(c.navigate===!1){let p=c.fetcherKey||Ub();await l.fetch(p,n,c.action||u,{preventScrollReset:c.preventScrollReset,formData:m,body:x,formMethod:c.method||h,formEncType:c.encType||g,flushSync:c.flushSync})}else await l.navigate(c.action||u,{preventScrollReset:c.preventScrollReset,formData:m,body:x,formMethod:c.method||h,formEncType:c.encType||g,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[l,a,n])}function Hb(l,{relative:a}={}){let{basename:n}=b.useContext(os),i=b.useContext(cs);Ze(i,"useFormAction must be used inside a RouteContext");let[c]=i.matches.slice(-1),u={..._l(l||".",{relative:a})},h=bs();if(l==null){u.search=h.search;let g=new URLSearchParams(u.search),m=g.getAll("index");if(m.some(p=>p==="")){g.delete("index"),m.filter(v=>v).forEach(v=>g.append("index",v));let p=g.toString();u.search=p?`?${p}`:""}}return(!l||l===".")&&c.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(u.pathname=u.pathname==="/"?n:zs([n,u.pathname])),yl(u)}function Bb(l,a={}){let n=b.useContext(Kg);Ze(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Wg("useViewTransitionState"),c=_l(l,{relative:a.relative});if(!n.isTransitioning)return!1;let u=Ps(n.currentLocation.pathname,i)||n.currentLocation.pathname,h=Ps(n.nextLocation.pathname,i)||n.nextLocation.pathname;return so(c.pathname,h)!=null||so(c.pathname,u)!=null}var kl=Bg(),mo=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(l){return this.listeners.add(l),this.onSubscribe(),()=>{this.listeners.delete(l),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},go=typeof window>"u"||"Deno"in globalThis;function ns(){}function qb(l,a){return typeof l=="function"?l(a):l}function zb(l){return typeof l=="number"&&l>=0&&l!==1/0}function $b(l,a){return Math.max(l+(a||0)-Date.now(),0)}function ed(l,a){return typeof l=="function"?l(a):l}function Pb(l,a){return typeof l=="function"?l(a):l}function q0(l,a){const{type:n="all",exact:i,fetchStatus:c,predicate:u,queryKey:h,stale:g}=l;if(h){if(i){if(a.queryHash!==wd(h,a.options))return!1}else if(!bl(a.queryKey,h))return!1}if(n!=="all"){const m=a.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof g=="boolean"&&a.isStale()!==g||c&&c!==a.state.fetchStatus||u&&!u(a))}function z0(l,a){const{exact:n,status:i,predicate:c,mutationKey:u}=l;if(u){if(!a.options.mutationKey)return!1;if(n){if(vl(a.options.mutationKey)!==vl(u))return!1}else if(!bl(a.options.mutationKey,u))return!1}return!(i&&a.state.status!==i||c&&!c(a))}function wd(l,a){return(a?.queryKeyHashFn||vl)(l)}function vl(l){return JSON.stringify(l,(a,n)=>td(n)?Object.keys(n).sort().reduce((i,c)=>(i[c]=n[c],i),{}):n)}function bl(l,a){return l===a?!0:typeof l!=typeof a?!1:l&&a&&typeof l=="object"&&typeof a=="object"?Object.keys(a).every(n=>bl(l[n],a[n])):!1}function ex(l,a){if(l===a)return l;const n=$0(l)&&$0(a);if(n||td(l)&&td(a)){const i=n?l:Object.keys(l),c=i.length,u=n?a:Object.keys(a),h=u.length,g=n?[]:{},m=new Set(i);let x=0;for(let p=0;p<h;p++){const v=n?p:u[p];(!n&&m.has(v)||n)&&l[v]===void 0&&a[v]===void 0?(g[v]=void 0,x++):(g[v]=ex(l[v],a[v]),g[v]===l[v]&&l[v]!==void 0&&x++)}return c===h&&x===c?l:g}return a}function $0(l){return Array.isArray(l)&&l.length===Object.keys(l).length}function td(l){if(!P0(l))return!1;const a=l.constructor;if(a===void 0)return!0;const n=a.prototype;return!(!P0(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(l)!==Object.prototype)}function P0(l){return Object.prototype.toString.call(l)==="[object Object]"}function Kb(l){return new Promise(a=>{setTimeout(a,l)})}function Gb(l,a,n){return typeof n.structuralSharing=="function"?n.structuralSharing(l,a):n.structuralSharing!==!1?ex(l,a):a}function Ib(l,a,n=0){const i=[...l,a];return n&&i.length>n?i.slice(1):i}function Vb(l,a,n=0){const i=[a,...l];return n&&i.length>n?i.slice(0,-1):i}var jd=Symbol();function tx(l,a){return!l.queryFn&&a?.initialPromise?()=>a.initialPromise:!l.queryFn||l.queryFn===jd?()=>Promise.reject(new Error(`Missing queryFn: '${l.queryHash}'`)):l.queryFn}var Qb=class extends mo{#e;#t;#s;constructor(){super(),this.#s=l=>{if(!go&&window.addEventListener){const a=()=>l();return window.addEventListener("visibilitychange",a,!1),()=>{window.removeEventListener("visibilitychange",a)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(l){this.#s=l,this.#t?.(),this.#t=l(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()})}setFocused(l){this.#e!==l&&(this.#e=l,this.onFocus())}onFocus(){const l=this.isFocused();this.listeners.forEach(a=>{a(l)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},sx=new Qb,Yb=class extends mo{#e=!0;#t;#s;constructor(){super(),this.#s=l=>{if(!go&&window.addEventListener){const a=()=>l(!0),n=()=>l(!1);return window.addEventListener("online",a,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(l){this.#s=l,this.#t?.(),this.#t=l(this.setOnline.bind(this))}setOnline(l){this.#e!==l&&(this.#e=l,this.listeners.forEach(n=>{n(l)}))}isOnline(){return this.#e}},ao=new Yb;function Fb(){let l,a;const n=new Promise((c,u)=>{l=c,a=u});n.status="pending",n.catch(()=>{});function i(c){Object.assign(n,c),delete n.resolve,delete n.reject}return n.resolve=c=>{i({status:"fulfilled",value:c}),l(c)},n.reject=c=>{i({status:"rejected",reason:c}),a(c)},n}function Xb(l){return Math.min(1e3*2**l,3e4)}function ax(l){return(l??"online")==="online"?ao.isOnline():!0}var rx=class extends Error{constructor(l){super("CancelledError"),this.revert=l?.revert,this.silent=l?.silent}};function Bu(l){return l instanceof rx}function nx(l){let a=!1,n=0,i=!1,c;const u=Fb(),h=_=>{i||(j(new rx(_)),l.abort?.())},g=()=>{a=!0},m=()=>{a=!1},x=()=>sx.isFocused()&&(l.networkMode==="always"||ao.isOnline())&&l.canRun(),p=()=>ax(l.networkMode)&&l.canRun(),v=_=>{i||(i=!0,l.onSuccess?.(_),c?.(),u.resolve(_))},j=_=>{i||(i=!0,l.onError?.(_),c?.(),u.reject(_))},N=()=>new Promise(_=>{c=D=>{(i||x())&&_(D)},l.onPause?.()}).then(()=>{c=void 0,i||l.onContinue?.()}),S=()=>{if(i)return;let _;const D=n===0?l.initialPromise:void 0;try{_=D??l.fn()}catch(M){_=Promise.reject(M)}Promise.resolve(_).then(v).catch(M=>{if(i)return;const E=l.retry??(go?0:3),A=l.retryDelay??Xb,G=typeof A=="function"?A(n,M):A,q=E===!0||typeof E=="number"&&n<E||typeof E=="function"&&E(n,M);if(a||!q){j(M);return}n++,l.onFail?.(n,M),Kb(G).then(()=>x()?void 0:N()).then(()=>{a?j(M):S()})})};return{promise:u,cancel:h,continue:()=>(c?.(),u),cancelRetry:g,continueRetry:m,canStart:p,start:()=>(p()?S():N().then(S),u)}}var Zb=l=>setTimeout(l,0);function Jb(){let l=[],a=0,n=g=>{g()},i=g=>{g()},c=Zb;const u=g=>{a?l.push(g):c(()=>{n(g)})},h=()=>{const g=l;l=[],g.length&&c(()=>{i(()=>{g.forEach(m=>{n(m)})})})};return{batch:g=>{let m;a++;try{m=g()}finally{a--,a||h()}return m},batchCalls:g=>(...m)=>{u(()=>{g(...m)})},schedule:u,setNotifyFunction:g=>{n=g},setBatchNotifyFunction:g=>{i=g},setScheduler:g=>{c=g}}}var St=Jb(),lx=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),zb(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(l){this.gcTime=Math.max(this.gcTime||0,l??(go?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},Wb=class extends lx{#e;#t;#s;#r;#a;#l;#i;constructor(l){super(),this.#i=!1,this.#l=l.defaultOptions,this.setOptions(l.options),this.observers=[],this.#r=l.client,this.#s=this.#r.getQueryCache(),this.queryKey=l.queryKey,this.queryHash=l.queryHash,this.#e=tw(this.options),this.state=l.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#a?.promise}setOptions(l){this.options={...this.#l,...l},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#s.remove(this)}setData(l,a){const n=Gb(this.state.data,l,this.options);return this.#n({data:n,type:"success",dataUpdatedAt:a?.updatedAt,manual:a?.manual}),n}setState(l,a){this.#n({type:"setState",state:l,setStateOptions:a})}cancel(l){const a=this.#a?.promise;return this.#a?.cancel(l),a?a.then(ns).catch(ns):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(l=>Pb(l.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===jd||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(l=>ed(l.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(l=>l.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(l=0){return this.state.data===void 0?!0:l==="static"?!1:this.state.isInvalidated?!0:!$b(this.state.dataUpdatedAt,l)}onFocus(){this.observers.find(a=>a.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#a?.continue()}onOnline(){this.observers.find(a=>a.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#a?.continue()}addObserver(l){this.observers.includes(l)||(this.observers.push(l),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",query:this,observer:l}))}removeObserver(l){this.observers.includes(l)&&(this.observers=this.observers.filter(a=>a!==l),this.observers.length||(this.#a&&(this.#i?this.#a.cancel({revert:!0}):this.#a.cancelRetry()),this.scheduleGc()),this.#s.notify({type:"observerRemoved",query:this,observer:l}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#n({type:"invalidate"})}fetch(l,a){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&a?.cancelRefetch)this.cancel({silent:!0});else if(this.#a)return this.#a.continueRetry(),this.#a.promise}if(l&&this.setOptions(l),!this.options.queryFn){const m=this.observers.find(x=>x.options.queryFn);m&&this.setOptions(m.options)}const n=new AbortController,i=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(this.#i=!0,n.signal)})},c=()=>{const m=tx(this.options,a),p=(()=>{const v={client:this.#r,queryKey:this.queryKey,meta:this.meta};return i(v),v})();return this.#i=!1,this.options.persister?this.options.persister(m,p,this):m(p)},h=(()=>{const m={fetchOptions:a,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:c};return i(m),m})();this.options.behavior?.onFetch(h,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==h.fetchOptions?.meta)&&this.#n({type:"fetch",meta:h.fetchOptions?.meta});const g=m=>{Bu(m)&&m.silent||this.#n({type:"error",error:m}),Bu(m)||(this.#s.config.onError?.(m,this),this.#s.config.onSettled?.(this.state.data,m,this)),this.scheduleGc()};return this.#a=nx({initialPromise:a?.initialPromise,fn:h.fetchFn,abort:n.abort.bind(n),onSuccess:m=>{if(m===void 0){g(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(m)}catch(x){g(x);return}this.#s.config.onSuccess?.(m,this),this.#s.config.onSettled?.(m,this.state.error,this),this.scheduleGc()},onError:g,onFail:(m,x)=>{this.#n({type:"failed",failureCount:m,error:x})},onPause:()=>{this.#n({type:"pause"})},onContinue:()=>{this.#n({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0}),this.#a.start()}#n(l){const a=n=>{switch(l.type){case"failed":return{...n,fetchFailureCount:l.failureCount,fetchFailureReason:l.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...ew(n.data,this.options),fetchMeta:l.meta??null};case"success":return this.#t=void 0,{...n,data:l.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:l.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!l.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=l.error;return Bu(i)&&i.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...l.state}}};this.state=a(this.state),St.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#s.notify({query:this,type:"updated",action:l})})}};function ew(l,a){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ax(a.networkMode)?"fetching":"paused",...l===void 0&&{error:null,status:"pending"}}}function tw(l){const a=typeof l.initialData=="function"?l.initialData():l.initialData,n=a!==void 0,i=n?typeof l.initialDataUpdatedAt=="function"?l.initialDataUpdatedAt():l.initialDataUpdatedAt:0;return{data:a,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var sw=class extends mo{constructor(l={}){super(),this.config=l,this.#e=new Map}#e;build(l,a,n){const i=a.queryKey,c=a.queryHash??wd(i,a);let u=this.get(c);return u||(u=new Wb({client:l,queryKey:i,queryHash:c,options:l.defaultQueryOptions(a),state:n,defaultOptions:l.getQueryDefaults(i)}),this.add(u)),u}add(l){this.#e.has(l.queryHash)||(this.#e.set(l.queryHash,l),this.notify({type:"added",query:l}))}remove(l){const a=this.#e.get(l.queryHash);a&&(l.destroy(),a===l&&this.#e.delete(l.queryHash),this.notify({type:"removed",query:l}))}clear(){St.batch(()=>{this.getAll().forEach(l=>{this.remove(l)})})}get(l){return this.#e.get(l)}getAll(){return[...this.#e.values()]}find(l){const a={exact:!0,...l};return this.getAll().find(n=>q0(a,n))}findAll(l={}){const a=this.getAll();return Object.keys(l).length>0?a.filter(n=>q0(l,n)):a}notify(l){St.batch(()=>{this.listeners.forEach(a=>{a(l)})})}onFocus(){St.batch(()=>{this.getAll().forEach(l=>{l.onFocus()})})}onOnline(){St.batch(()=>{this.getAll().forEach(l=>{l.onOnline()})})}},aw=class extends lx{#e;#t;#s;constructor(l){super(),this.mutationId=l.mutationId,this.#t=l.mutationCache,this.#e=[],this.state=l.state||rw(),this.setOptions(l.options),this.scheduleGc()}setOptions(l){this.options=l,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(l){this.#e.includes(l)||(this.#e.push(l),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:l}))}removeObserver(l){this.#e=this.#e.filter(a=>a!==l),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:l})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(l){const a=()=>{this.#r({type:"continue"})};this.#s=nx({fn:()=>this.options.mutationFn?this.options.mutationFn(l):Promise.reject(new Error("No mutationFn found")),onFail:(c,u)=>{this.#r({type:"failed",failureCount:c,error:u})},onPause:()=>{this.#r({type:"pause"})},onContinue:a,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const n=this.state.status==="pending",i=!this.#s.canStart();try{if(n)a();else{this.#r({type:"pending",variables:l,isPaused:i}),await this.#t.config.onMutate?.(l,this);const u=await this.options.onMutate?.(l);u!==this.state.context&&this.#r({type:"pending",context:u,variables:l,isPaused:i})}const c=await this.#s.start();return await this.#t.config.onSuccess?.(c,l,this.state.context,this),await this.options.onSuccess?.(c,l,this.state.context),await this.#t.config.onSettled?.(c,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(c,null,l,this.state.context),this.#r({type:"success",data:c}),c}catch(c){try{throw await this.#t.config.onError?.(c,l,this.state.context,this),await this.options.onError?.(c,l,this.state.context),await this.#t.config.onSettled?.(void 0,c,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,c,l,this.state.context),c}finally{this.#r({type:"error",error:c})}}finally{this.#t.runNext(this)}}#r(l){const a=n=>{switch(l.type){case"failed":return{...n,failureCount:l.failureCount,failureReason:l.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:l.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:l.isPaused,status:"pending",variables:l.variables,submittedAt:Date.now()};case"success":return{...n,data:l.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:l.error,failureCount:n.failureCount+1,failureReason:l.error,isPaused:!1,status:"error"}}};this.state=a(this.state),St.batch(()=>{this.#e.forEach(n=>{n.onMutationUpdate(l)}),this.#t.notify({mutation:this,type:"updated",action:l})})}};function rw(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var nw=class extends mo{constructor(l={}){super(),this.config=l,this.#e=new Set,this.#t=new Map,this.#s=0}#e;#t;#s;build(l,a,n){const i=new aw({mutationCache:this,mutationId:++this.#s,options:l.defaultMutationOptions(a),state:n});return this.add(i),i}add(l){this.#e.add(l);const a=Ki(l);if(typeof a=="string"){const n=this.#t.get(a);n?n.push(l):this.#t.set(a,[l])}this.notify({type:"added",mutation:l})}remove(l){if(this.#e.delete(l)){const a=Ki(l);if(typeof a=="string"){const n=this.#t.get(a);if(n)if(n.length>1){const i=n.indexOf(l);i!==-1&&n.splice(i,1)}else n[0]===l&&this.#t.delete(a)}}this.notify({type:"removed",mutation:l})}canRun(l){const a=Ki(l);if(typeof a=="string"){const i=this.#t.get(a)?.find(c=>c.state.status==="pending");return!i||i===l}else return!0}runNext(l){const a=Ki(l);return typeof a=="string"?this.#t.get(a)?.find(i=>i!==l&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){St.batch(()=>{this.#e.forEach(l=>{this.notify({type:"removed",mutation:l})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(l){const a={exact:!0,...l};return this.getAll().find(n=>z0(a,n))}findAll(l={}){return this.getAll().filter(a=>z0(l,a))}notify(l){St.batch(()=>{this.listeners.forEach(a=>{a(l)})})}resumePausedMutations(){const l=this.getAll().filter(a=>a.state.isPaused);return St.batch(()=>Promise.all(l.map(a=>a.continue().catch(ns))))}};function Ki(l){return l.options.scope?.id}function K0(l){return{onFetch:(a,n)=>{const i=a.options,c=a.fetchOptions?.meta?.fetchMore?.direction,u=a.state.data?.pages||[],h=a.state.data?.pageParams||[];let g={pages:[],pageParams:[]},m=0;const x=async()=>{let p=!1;const v=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(a.signal.aborted?p=!0:a.signal.addEventListener("abort",()=>{p=!0}),a.signal)})},j=tx(a.options,a.fetchOptions),N=async(S,_,D)=>{if(p)return Promise.reject();if(_==null&&S.pages.length)return Promise.resolve(S);const E=(()=>{const H={client:a.client,queryKey:a.queryKey,pageParam:_,direction:D?"backward":"forward",meta:a.options.meta};return v(H),H})(),A=await j(E),{maxPages:G}=a.options,q=D?Vb:Ib;return{pages:q(S.pages,A,G),pageParams:q(S.pageParams,_,G)}};if(c&&u.length){const S=c==="backward",_=S?lw:G0,D={pages:u,pageParams:h},M=_(i,D);g=await N(D,M,S)}else{const S=l??u.length;do{const _=m===0?h[0]??i.initialPageParam:G0(i,g);if(m>0&&_==null)break;g=await N(g,_),m++}while(m<S)}return g};a.options.persister?a.fetchFn=()=>a.options.persister?.(x,{client:a.client,queryKey:a.queryKey,meta:a.options.meta,signal:a.signal},n):a.fetchFn=x}}}function G0(l,{pages:a,pageParams:n}){const i=a.length-1;return a.length>0?l.getNextPageParam(a[i],a,n[i],n):void 0}function lw(l,{pages:a,pageParams:n}){return a.length>0?l.getPreviousPageParam?.(a[0],a,n[0],n):void 0}var iw=class{#e;#t;#s;#r;#a;#l;#i;#n;constructor(l={}){this.#e=l.queryCache||new sw,this.#t=l.mutationCache||new nw,this.#s=l.defaultOptions||{},this.#r=new Map,this.#a=new Map,this.#l=0}mount(){this.#l++,this.#l===1&&(this.#i=sx.subscribe(async l=>{l&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#n=ao.subscribe(async l=>{l&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#l--,this.#l===0&&(this.#i?.(),this.#i=void 0,this.#n?.(),this.#n=void 0)}isFetching(l){return this.#e.findAll({...l,fetchStatus:"fetching"}).length}isMutating(l){return this.#t.findAll({...l,status:"pending"}).length}getQueryData(l){const a=this.defaultQueryOptions({queryKey:l});return this.#e.get(a.queryHash)?.state.data}ensureQueryData(l){const a=this.defaultQueryOptions(l),n=this.#e.build(this,a),i=n.state.data;return i===void 0?this.fetchQuery(l):(l.revalidateIfStale&&n.isStaleByTime(ed(a.staleTime,n))&&this.prefetchQuery(a),Promise.resolve(i))}getQueriesData(l){return this.#e.findAll(l).map(({queryKey:a,state:n})=>{const i=n.data;return[a,i]})}setQueryData(l,a,n){const i=this.defaultQueryOptions({queryKey:l}),u=this.#e.get(i.queryHash)?.state.data,h=qb(a,u);if(h!==void 0)return this.#e.build(this,i).setData(h,{...n,manual:!0})}setQueriesData(l,a,n){return St.batch(()=>this.#e.findAll(l).map(({queryKey:i})=>[i,this.setQueryData(i,a,n)]))}getQueryState(l){const a=this.defaultQueryOptions({queryKey:l});return this.#e.get(a.queryHash)?.state}removeQueries(l){const a=this.#e;St.batch(()=>{a.findAll(l).forEach(n=>{a.remove(n)})})}resetQueries(l,a){const n=this.#e;return St.batch(()=>(n.findAll(l).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...l},a)))}cancelQueries(l,a={}){const n={revert:!0,...a},i=St.batch(()=>this.#e.findAll(l).map(c=>c.cancel(n)));return Promise.all(i).then(ns).catch(ns)}invalidateQueries(l,a={}){return St.batch(()=>(this.#e.findAll(l).forEach(n=>{n.invalidate()}),l?.refetchType==="none"?Promise.resolve():this.refetchQueries({...l,type:l?.refetchType??l?.type??"active"},a)))}refetchQueries(l,a={}){const n={...a,cancelRefetch:a.cancelRefetch??!0},i=St.batch(()=>this.#e.findAll(l).filter(c=>!c.isDisabled()&&!c.isStatic()).map(c=>{let u=c.fetch(void 0,n);return n.throwOnError||(u=u.catch(ns)),c.state.fetchStatus==="paused"?Promise.resolve():u}));return Promise.all(i).then(ns)}fetchQuery(l){const a=this.defaultQueryOptions(l);a.retry===void 0&&(a.retry=!1);const n=this.#e.build(this,a);return n.isStaleByTime(ed(a.staleTime,n))?n.fetch(a):Promise.resolve(n.state.data)}prefetchQuery(l){return this.fetchQuery(l).then(ns).catch(ns)}fetchInfiniteQuery(l){return l.behavior=K0(l.pages),this.fetchQuery(l)}prefetchInfiniteQuery(l){return this.fetchInfiniteQuery(l).then(ns).catch(ns)}ensureInfiniteQueryData(l){return l.behavior=K0(l.pages),this.ensureQueryData(l)}resumePausedMutations(){return ao.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#s}setDefaultOptions(l){this.#s=l}setQueryDefaults(l,a){this.#r.set(vl(l),{queryKey:l,defaultOptions:a})}getQueryDefaults(l){const a=[...this.#r.values()],n={};return a.forEach(i=>{bl(l,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(l,a){this.#a.set(vl(l),{mutationKey:l,defaultOptions:a})}getMutationDefaults(l){const a=[...this.#a.values()],n={};return a.forEach(i=>{bl(l,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(l){if(l._defaulted)return l;const a={...this.#s.queries,...this.getQueryDefaults(l.queryKey),...l,_defaulted:!0};return a.queryHash||(a.queryHash=wd(a.queryKey,a)),a.refetchOnReconnect===void 0&&(a.refetchOnReconnect=a.networkMode!=="always"),a.throwOnError===void 0&&(a.throwOnError=!!a.suspense),!a.networkMode&&a.persister&&(a.networkMode="offlineFirst"),a.queryFn===jd&&(a.enabled=!1),a}defaultMutationOptions(l){return l?._defaulted?l:{...this.#s.mutations,...l?.mutationKey&&this.getMutationDefaults(l.mutationKey),...l,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},ow=b.createContext(void 0),cw=({client:l,children:a})=>(b.useEffect(()=>(l.mount(),()=>{l.unmount()}),[l]),s.jsx(ow.Provider,{value:l,children:a}));const uw="modulepreload",dw=function(l){return"/"+l},I0={},Tl=function(a,n,i){let c=Promise.resolve();if(n&&n.length>0){let x=function(p){return Promise.all(p.map(v=>Promise.resolve(v).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};var h=x;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),m=g?.nonce||g?.getAttribute("nonce");c=x(n.map(p=>{if(p=dw(p),p in I0)return;I0[p]=!0;const v=p.endsWith(".css"),j=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${j}`))return;const N=document.createElement("link");if(N.rel=v?"stylesheet":uw,v||(N.as="script"),N.crossOrigin="",N.href=p,m&&N.setAttribute("nonce",m),document.head.appendChild(N),v)return new Promise((S,_)=>{N.addEventListener("load",S),N.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(g){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=g,window.dispatchEvent(m),!m.defaultPrevented)throw g}return c.then(g=>{for(const m of g||[])m.status==="rejected"&&u(m.reason);return a().catch(u)})},hw=l=>{let a;return l?a=l:typeof fetch>"u"?a=(...n)=>Tl(async()=>{const{default:i}=await Promise.resolve().then(()=>nn);return{default:i}},[]).then(({default:i})=>i(...n)):a=fetch,(...n)=>a(...n)};class Nd extends Error{constructor(a,n="FunctionsError",i){super(a),this.name=n,this.context=i}}class fw extends Nd{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class V0 extends Nd{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class Q0 extends Nd{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var sd;(function(l){l.Any="any",l.ApNortheast1="ap-northeast-1",l.ApNortheast2="ap-northeast-2",l.ApSouth1="ap-south-1",l.ApSoutheast1="ap-southeast-1",l.ApSoutheast2="ap-southeast-2",l.CaCentral1="ca-central-1",l.EuCentral1="eu-central-1",l.EuWest1="eu-west-1",l.EuWest2="eu-west-2",l.EuWest3="eu-west-3",l.SaEast1="sa-east-1",l.UsEast1="us-east-1",l.UsWest1="us-west-1",l.UsWest2="us-west-2"})(sd||(sd={}));var mw=function(l,a,n,i){function c(u){return u instanceof n?u:new n(function(h){h(u)})}return new(n||(n=Promise))(function(u,h){function g(p){try{x(i.next(p))}catch(v){h(v)}}function m(p){try{x(i.throw(p))}catch(v){h(v)}}function x(p){p.done?u(p.value):c(p.value).then(g,m)}x((i=i.apply(l,a||[])).next())})};class gw{constructor(a,{headers:n={},customFetch:i,region:c=sd.Any}={}){this.url=a,this.headers=n,this.region=c,this.fetch=hw(i)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a,n={}){var i;return mw(this,void 0,void 0,function*(){try{const{headers:c,method:u,body:h}=n;let g={},{region:m}=n;m||(m=this.region);const x=new URL(`${this.url}/${a}`);m&&m!=="any"&&(g["x-region"]=m,x.searchParams.set("forceFunctionRegion",m));let p;h&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)&&(typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(g["Content-Type"]="application/octet-stream",p=h):typeof h=="string"?(g["Content-Type"]="text/plain",p=h):typeof FormData<"u"&&h instanceof FormData?p=h:(g["Content-Type"]="application/json",p=JSON.stringify(h)));const v=yield this.fetch(x.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},g),this.headers),c),body:p}).catch(_=>{throw new fw(_)}),j=v.headers.get("x-relay-error");if(j&&j==="true")throw new V0(v);if(!v.ok)throw new Q0(v);let N=((i=v.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),S;return N==="application/json"?S=yield v.json():N==="application/octet-stream"?S=yield v.blob():N==="text/event-stream"?S=v:N==="multipart/form-data"?S=yield v.formData():S=yield v.text(),{data:S,error:null,response:v}}catch(c){return{data:null,error:c,response:c instanceof Q0||c instanceof V0?c.context:void 0}}})}}var ht={},$r={},Pr={},Kr={},Gr={},Ir={},xw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},tn=xw();const pw=tn.fetch,ix=tn.fetch.bind(tn),ox=tn.Headers,yw=tn.Request,vw=tn.Response,nn=Object.freeze(Object.defineProperty({__proto__:null,Headers:ox,Request:yw,Response:vw,default:ix,fetch:pw},Symbol.toStringTag,{value:"Module"})),bw=nv(nn);var Gi={},Y0;function cx(){if(Y0)return Gi;Y0=1,Object.defineProperty(Gi,"__esModule",{value:!0});class l extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return Gi.default=l,Gi}var F0;function ux(){if(F0)return Ir;F0=1;var l=Ir&&Ir.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Ir,"__esModule",{value:!0});const a=l(bw),n=l(cx());class i{constructor(u){this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=u.headers,this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=u.shouldThrowOnError,this.signal=u.signal,this.isMaybeSingle=u.isMaybeSingle,u.fetch?this.fetch=u.fetch:typeof fetch>"u"?this.fetch=a.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,h){return this.headers=Object.assign({},this.headers),this.headers[u]=h,this}then(u,h){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const g=this.fetch;let m=g(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async x=>{var p,v,j;let N=null,S=null,_=null,D=x.status,M=x.statusText;if(x.ok){if(this.method!=="HEAD"){const q=await x.text();q===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?S=q:S=JSON.parse(q))}const A=(p=this.headers.Prefer)===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),G=(v=x.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");A&&G&&G.length>1&&(_=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(S)&&(S.length>1?(N={code:"PGRST116",details:`Results contain ${S.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},S=null,_=null,D=406,M="Not Acceptable"):S.length===1?S=S[0]:S=null)}else{const A=await x.text();try{N=JSON.parse(A),Array.isArray(N)&&x.status===404&&(S=[],N=null,D=200,M="OK")}catch{x.status===404&&A===""?(D=204,M="No Content"):N={message:A}}if(N&&this.isMaybeSingle&&(!((j=N?.details)===null||j===void 0)&&j.includes("0 rows"))&&(N=null,D=200,M="OK"),N&&this.shouldThrowOnError)throw new n.default(N)}return{error:N,data:S,count:_,status:D,statusText:M}});return this.shouldThrowOnError||(m=m.catch(x=>{var p,v,j;return{error:{message:`${(p=x?.name)!==null&&p!==void 0?p:"FetchError"}: ${x?.message}`,details:`${(v=x?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(j=x?.code)!==null&&j!==void 0?j:""}`},data:null,count:null,status:0,statusText:""}})),m.then(u,h)}returns(){return this}overrideTypes(){return this}}return Ir.default=i,Ir}var X0;function dx(){if(X0)return Gr;X0=1;var l=Gr&&Gr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Gr,"__esModule",{value:!0});const a=l(ux());class n extends a.default{select(c){let u=!1;const h=(c??"*").split("").map(g=>/\s/.test(g)&&!u?"":(g==='"'&&(u=!u),g)).join("");return this.url.searchParams.set("select",h),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(c,{ascending:u=!0,nullsFirst:h,foreignTable:g,referencedTable:m=g}={}){const x=m?`${m}.order`:"order",p=this.url.searchParams.get(x);return this.url.searchParams.set(x,`${p?`${p},`:""}${c}.${u?"asc":"desc"}${h===void 0?"":h?".nullsfirst":".nullslast"}`),this}limit(c,{foreignTable:u,referencedTable:h=u}={}){const g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(g,`${c}`),this}range(c,u,{foreignTable:h,referencedTable:g=h}={}){const m=typeof g>"u"?"offset":`${g}.offset`,x=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(m,`${c}`),this.url.searchParams.set(x,`${u-c+1}`),this}abortSignal(c){return this.signal=c,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:c=!1,verbose:u=!1,settings:h=!1,buffers:g=!1,wal:m=!1,format:x="text"}={}){var p;const v=[c?"analyze":null,u?"verbose":null,h?"settings":null,g?"buffers":null,m?"wal":null].filter(Boolean).join("|"),j=(p=this.headers.Accept)!==null&&p!==void 0?p:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${x}; for="${j}"; options=${v};`,x==="json"?this:this}rollback(){var c;return((c=this.headers.Prefer)!==null&&c!==void 0?c:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Gr.default=n,Gr}var Z0;function Sd(){if(Z0)return Kr;Z0=1;var l=Kr&&Kr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Kr,"__esModule",{value:!0});const a=l(dx());class n extends a.default{eq(c,u){return this.url.searchParams.append(c,`eq.${u}`),this}neq(c,u){return this.url.searchParams.append(c,`neq.${u}`),this}gt(c,u){return this.url.searchParams.append(c,`gt.${u}`),this}gte(c,u){return this.url.searchParams.append(c,`gte.${u}`),this}lt(c,u){return this.url.searchParams.append(c,`lt.${u}`),this}lte(c,u){return this.url.searchParams.append(c,`lte.${u}`),this}like(c,u){return this.url.searchParams.append(c,`like.${u}`),this}likeAllOf(c,u){return this.url.searchParams.append(c,`like(all).{${u.join(",")}}`),this}likeAnyOf(c,u){return this.url.searchParams.append(c,`like(any).{${u.join(",")}}`),this}ilike(c,u){return this.url.searchParams.append(c,`ilike.${u}`),this}ilikeAllOf(c,u){return this.url.searchParams.append(c,`ilike(all).{${u.join(",")}}`),this}ilikeAnyOf(c,u){return this.url.searchParams.append(c,`ilike(any).{${u.join(",")}}`),this}is(c,u){return this.url.searchParams.append(c,`is.${u}`),this}in(c,u){const h=Array.from(new Set(u)).map(g=>typeof g=="string"&&new RegExp("[,()]").test(g)?`"${g}"`:`${g}`).join(",");return this.url.searchParams.append(c,`in.(${h})`),this}contains(c,u){return typeof u=="string"?this.url.searchParams.append(c,`cs.${u}`):Array.isArray(u)?this.url.searchParams.append(c,`cs.{${u.join(",")}}`):this.url.searchParams.append(c,`cs.${JSON.stringify(u)}`),this}containedBy(c,u){return typeof u=="string"?this.url.searchParams.append(c,`cd.${u}`):Array.isArray(u)?this.url.searchParams.append(c,`cd.{${u.join(",")}}`):this.url.searchParams.append(c,`cd.${JSON.stringify(u)}`),this}rangeGt(c,u){return this.url.searchParams.append(c,`sr.${u}`),this}rangeGte(c,u){return this.url.searchParams.append(c,`nxl.${u}`),this}rangeLt(c,u){return this.url.searchParams.append(c,`sl.${u}`),this}rangeLte(c,u){return this.url.searchParams.append(c,`nxr.${u}`),this}rangeAdjacent(c,u){return this.url.searchParams.append(c,`adj.${u}`),this}overlaps(c,u){return typeof u=="string"?this.url.searchParams.append(c,`ov.${u}`):this.url.searchParams.append(c,`ov.{${u.join(",")}}`),this}textSearch(c,u,{config:h,type:g}={}){let m="";g==="plain"?m="pl":g==="phrase"?m="ph":g==="websearch"&&(m="w");const x=h===void 0?"":`(${h})`;return this.url.searchParams.append(c,`${m}fts${x}.${u}`),this}match(c){return Object.entries(c).forEach(([u,h])=>{this.url.searchParams.append(u,`eq.${h}`)}),this}not(c,u,h){return this.url.searchParams.append(c,`not.${u}.${h}`),this}or(c,{foreignTable:u,referencedTable:h=u}={}){const g=h?`${h}.or`:"or";return this.url.searchParams.append(g,`(${c})`),this}filter(c,u,h){return this.url.searchParams.append(c,`${u}.${h}`),this}}return Kr.default=n,Kr}var J0;function hx(){if(J0)return Pr;J0=1;var l=Pr&&Pr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Pr,"__esModule",{value:!0});const a=l(Sd());class n{constructor(c,{headers:u={},schema:h,fetch:g}){this.url=c,this.headers=u,this.schema=h,this.fetch=g}select(c,{head:u=!1,count:h}={}){const g=u?"HEAD":"GET";let m=!1;const x=(c??"*").split("").map(p=>/\s/.test(p)&&!m?"":(p==='"'&&(m=!m),p)).join("");return this.url.searchParams.set("select",x),h&&(this.headers.Prefer=`count=${h}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(c,{count:u,defaultToNull:h=!0}={}){const g="POST",m=[];if(this.headers.Prefer&&m.push(this.headers.Prefer),u&&m.push(`count=${u}`),h||m.push("missing=default"),this.headers.Prefer=m.join(","),Array.isArray(c)){const x=c.reduce((p,v)=>p.concat(Object.keys(v)),[]);if(x.length>0){const p=[...new Set(x)].map(v=>`"${v}"`);this.url.searchParams.set("columns",p.join(","))}}return new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:c,fetch:this.fetch,allowEmpty:!1})}upsert(c,{onConflict:u,ignoreDuplicates:h=!1,count:g,defaultToNull:m=!0}={}){const x="POST",p=[`resolution=${h?"ignore":"merge"}-duplicates`];if(u!==void 0&&this.url.searchParams.set("on_conflict",u),this.headers.Prefer&&p.push(this.headers.Prefer),g&&p.push(`count=${g}`),m||p.push("missing=default"),this.headers.Prefer=p.join(","),Array.isArray(c)){const v=c.reduce((j,N)=>j.concat(Object.keys(N)),[]);if(v.length>0){const j=[...new Set(v)].map(N=>`"${N}"`);this.url.searchParams.set("columns",j.join(","))}}return new a.default({method:x,url:this.url,headers:this.headers,schema:this.schema,body:c,fetch:this.fetch,allowEmpty:!1})}update(c,{count:u}={}){const h="PATCH",g=[];return this.headers.Prefer&&g.push(this.headers.Prefer),u&&g.push(`count=${u}`),this.headers.Prefer=g.join(","),new a.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:c,fetch:this.fetch,allowEmpty:!1})}delete({count:c}={}){const u="DELETE",h=[];return c&&h.push(`count=${c}`),this.headers.Prefer&&h.unshift(this.headers.Prefer),this.headers.Prefer=h.join(","),new a.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Pr.default=n,Pr}var cl={},ul={},W0;function ww(){return W0||(W0=1,Object.defineProperty(ul,"__esModule",{value:!0}),ul.version=void 0,ul.version="0.0.0-automated"),ul}var eg;function jw(){if(eg)return cl;eg=1,Object.defineProperty(cl,"__esModule",{value:!0}),cl.DEFAULT_HEADERS=void 0;const l=ww();return cl.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${l.version}`},cl}var tg;function Nw(){if(tg)return $r;tg=1;var l=$r&&$r.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty($r,"__esModule",{value:!0});const a=l(hx()),n=l(Sd()),i=jw();class c{constructor(h,{headers:g={},schema:m,fetch:x}={}){this.url=h,this.headers=Object.assign(Object.assign({},i.DEFAULT_HEADERS),g),this.schemaName=m,this.fetch=x}from(h){const g=new URL(`${this.url}/${h}`);return new a.default(g,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(h){return new c(this.url,{headers:this.headers,schema:h,fetch:this.fetch})}rpc(h,g={},{head:m=!1,get:x=!1,count:p}={}){let v;const j=new URL(`${this.url}/rpc/${h}`);let N;m||x?(v=m?"HEAD":"GET",Object.entries(g).filter(([_,D])=>D!==void 0).map(([_,D])=>[_,Array.isArray(D)?`{${D.join(",")}}`:`${D}`]).forEach(([_,D])=>{j.searchParams.append(_,D)})):(v="POST",N=g);const S=Object.assign({},this.headers);return p&&(S.Prefer=`count=${p}`),new n.default({method:v,url:j,headers:S,schema:this.schemaName,body:N,fetch:this.fetch,allowEmpty:!1})}}return $r.default=c,$r}var sg;function Sw(){if(sg)return ht;sg=1;var l=ht&&ht.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(ht,"__esModule",{value:!0}),ht.PostgrestError=ht.PostgrestBuilder=ht.PostgrestTransformBuilder=ht.PostgrestFilterBuilder=ht.PostgrestQueryBuilder=ht.PostgrestClient=void 0;const a=l(Nw());ht.PostgrestClient=a.default;const n=l(hx());ht.PostgrestQueryBuilder=n.default;const i=l(Sd());ht.PostgrestFilterBuilder=i.default;const c=l(dx());ht.PostgrestTransformBuilder=c.default;const u=l(ux());ht.PostgrestBuilder=u.default;const h=l(cx());return ht.PostgrestError=h.default,ht.default={PostgrestClient:a.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:c.default,PostgrestBuilder:u.default,PostgrestError:h.default},ht}var _w=Sw();const kw=Hg(_w),{PostgrestClient:Tw,PostgrestQueryBuilder:rS,PostgrestFilterBuilder:nS,PostgrestTransformBuilder:lS,PostgrestBuilder:iS,PostgrestError:oS}=kw;function Ew(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const Cw=Ew(),Dw="2.11.15",Aw=`realtime-js/${Dw}`,Mw="1.0.0",fx=1e4,Ow=1e3;var ml;(function(l){l[l.connecting=0]="connecting",l[l.open=1]="open",l[l.closing=2]="closing",l[l.closed=3]="closed"})(ml||(ml={}));var wt;(function(l){l.closed="closed",l.errored="errored",l.joined="joined",l.joining="joining",l.leaving="leaving"})(wt||(wt={}));var ls;(function(l){l.close="phx_close",l.error="phx_error",l.join="phx_join",l.reply="phx_reply",l.leave="phx_leave",l.access_token="access_token"})(ls||(ls={}));var ad;(function(l){l.websocket="websocket"})(ad||(ad={}));var Qa;(function(l){l.Connecting="connecting",l.Open="open",l.Closing="closing",l.Closed="closed"})(Qa||(Qa={}));class Rw{constructor(){this.HEADER_LENGTH=1}decode(a,n){return a.constructor===ArrayBuffer?n(this._binaryDecode(a)):n(typeof a=="string"?JSON.parse(a):{})}_binaryDecode(a){const n=new DataView(a),i=new TextDecoder;return this._decodeBroadcast(a,n,i)}_decodeBroadcast(a,n,i){const c=n.getUint8(1),u=n.getUint8(2);let h=this.HEADER_LENGTH+2;const g=i.decode(a.slice(h,h+c));h=h+c;const m=i.decode(a.slice(h,h+u));h=h+u;const x=JSON.parse(i.decode(a.slice(h,a.byteLength)));return{ref:null,topic:g,event:m,payload:x}}}class mx{constructor(a,n){this.callback=a,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Qe;(function(l){l.abstime="abstime",l.bool="bool",l.date="date",l.daterange="daterange",l.float4="float4",l.float8="float8",l.int2="int2",l.int4="int4",l.int4range="int4range",l.int8="int8",l.int8range="int8range",l.json="json",l.jsonb="jsonb",l.money="money",l.numeric="numeric",l.oid="oid",l.reltime="reltime",l.text="text",l.time="time",l.timestamp="timestamp",l.timestamptz="timestamptz",l.timetz="timetz",l.tsrange="tsrange",l.tstzrange="tstzrange"})(Qe||(Qe={}));const ag=(l,a,n={})=>{var i;const c=(i=n.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(a).reduce((u,h)=>(u[h]=Uw(h,l,a,c),u),{})},Uw=(l,a,n,i)=>{const c=a.find(g=>g.name===l),u=c?.type,h=n[l];return u&&!i.includes(u)?gx(u,h):rd(h)},gx=(l,a)=>{if(l.charAt(0)==="_"){const n=l.slice(1,l.length);return qw(a,n)}switch(l){case Qe.bool:return Lw(a);case Qe.float4:case Qe.float8:case Qe.int2:case Qe.int4:case Qe.int8:case Qe.numeric:case Qe.oid:return Hw(a);case Qe.json:case Qe.jsonb:return Bw(a);case Qe.timestamp:return zw(a);case Qe.abstime:case Qe.date:case Qe.daterange:case Qe.int4range:case Qe.int8range:case Qe.money:case Qe.reltime:case Qe.text:case Qe.time:case Qe.timestamptz:case Qe.timetz:case Qe.tsrange:case Qe.tstzrange:return rd(a);default:return rd(a)}},rd=l=>l,Lw=l=>{switch(l){case"t":return!0;case"f":return!1;default:return l}},Hw=l=>{if(typeof l=="string"){const a=parseFloat(l);if(!Number.isNaN(a))return a}return l},Bw=l=>{if(typeof l=="string")try{return JSON.parse(l)}catch(a){return console.log(`JSON parse error: ${a}`),l}return l},qw=(l,a)=>{if(typeof l!="string")return l;const n=l.length-1,i=l[n];if(l[0]==="{"&&i==="}"){let u;const h=l.slice(1,n);try{u=JSON.parse("["+h+"]")}catch{u=h?h.split(","):[]}return u.map(g=>gx(a,g))}return l},zw=l=>typeof l=="string"?l.replace(" ","T"):l,xx=l=>{let a=l;return a=a.replace(/^ws/i,"http"),a=a.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),a.replace(/\/+$/,"")};class qu{constructor(a,n,i={},c=fx){this.channel=a,this.event=n,this.payload=i,this.timeout=c,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,n){var i;return this._hasReceived(a)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:a,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:n}){this.recHooks.filter(i=>i.status===a).forEach(i=>i.callback(n))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var rg;(function(l){l.SYNC="sync",l.JOIN="join",l.LEAVE="leave"})(rg||(rg={}));class gl{constructor(a,n){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},c=>{const{onJoin:u,onLeave:h,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=gl.syncState(this.state,c,u,h),this.pendingDiffs.forEach(m=>{this.state=gl.syncDiff(this.state,m,u,h)}),this.pendingDiffs=[],g()}),this.channel._on(i.diff,{},c=>{const{onJoin:u,onLeave:h,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(c):(this.state=gl.syncDiff(this.state,c,u,h),g())}),this.onJoin((c,u,h)=>{this.channel._trigger("presence",{event:"join",key:c,currentPresences:u,newPresences:h})}),this.onLeave((c,u,h)=>{this.channel._trigger("presence",{event:"leave",key:c,currentPresences:u,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,n,i,c){const u=this.cloneDeep(a),h=this.transformState(n),g={},m={};return this.map(u,(x,p)=>{h[x]||(m[x]=p)}),this.map(h,(x,p)=>{const v=u[x];if(v){const j=p.map(D=>D.presence_ref),N=v.map(D=>D.presence_ref),S=p.filter(D=>N.indexOf(D.presence_ref)<0),_=v.filter(D=>j.indexOf(D.presence_ref)<0);S.length>0&&(g[x]=S),_.length>0&&(m[x]=_)}else g[x]=p}),this.syncDiff(u,{joins:g,leaves:m},i,c)}static syncDiff(a,n,i,c){const{joins:u,leaves:h}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),c||(c=()=>{}),this.map(u,(g,m)=>{var x;const p=(x=a[g])!==null&&x!==void 0?x:[];if(a[g]=this.cloneDeep(m),p.length>0){const v=a[g].map(N=>N.presence_ref),j=p.filter(N=>v.indexOf(N.presence_ref)<0);a[g].unshift(...j)}i(g,p,m)}),this.map(h,(g,m)=>{let x=a[g];if(!x)return;const p=m.map(v=>v.presence_ref);x=x.filter(v=>p.indexOf(v.presence_ref)<0),a[g]=x,c(g,x,m),x.length===0&&delete a[g]}),a}static map(a,n){return Object.getOwnPropertyNames(a).map(i=>n(i,a[i]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((n,i)=>{const c=a[i];return"metas"in c?n[i]=c.metas.map(u=>(u.presence_ref=u.phx_ref,delete u.phx_ref,delete u.phx_ref_prev,u)):n[i]=c,n},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ng;(function(l){l.ALL="*",l.INSERT="INSERT",l.UPDATE="UPDATE",l.DELETE="DELETE"})(ng||(ng={}));var lg;(function(l){l.BROADCAST="broadcast",l.PRESENCE="presence",l.POSTGRES_CHANGES="postgres_changes",l.SYSTEM="system"})(lg||(lg={}));var Bs;(function(l){l.SUBSCRIBED="SUBSCRIBED",l.TIMED_OUT="TIMED_OUT",l.CLOSED="CLOSED",l.CHANNEL_ERROR="CHANNEL_ERROR"})(Bs||(Bs={}));class _d{constructor(a,n={config:{}},i){this.topic=a,this.params=n,this.socket=i,this.bindings={},this.state=wt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new qu(this,ls.join,this.params,this.timeout),this.rejoinTimer=new mx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wt.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ls.reply,{},(c,u)=>{this._trigger(this._replyEventName(u),c)}),this.presence=new gl(this),this.broadcastEndpointURL=xx(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(a,n=this.timeout){var i,c;if(this.socket.isConnected()||this.socket.connect(),this.state==wt.closed){const{config:{broadcast:u,presence:h,private:g}}=this.params;this._onError(p=>a?.(Bs.CHANNEL_ERROR,p)),this._onClose(()=>a?.(Bs.CLOSED));const m={},x={broadcast:u,presence:h,postgres_changes:(c=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(p=>p.filter))!==null&&c!==void 0?c:[],private:g};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:x},m)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:p})=>{var v;if(this.socket.setAuth(),p===void 0){a?.(Bs.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,N=(v=j?.length)!==null&&v!==void 0?v:0,S=[];for(let _=0;_<N;_++){const D=j[_],{filter:{event:M,schema:E,table:A,filter:G}}=D,q=p&&p[_];if(q&&q.event===M&&q.schema===E&&q.table===A&&q.filter===G)S.push(Object.assign(Object.assign({},D),{id:q.id}));else{this.unsubscribe(),this.state=wt.errored,a?.(Bs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,a&&a(Bs.SUBSCRIBED);return}}).receive("error",p=>{this.state=wt.errored,a?.(Bs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{a?.(Bs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,n={}){return await this.send({type:"presence",event:"track",payload:a},n.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,n,i){return this._on(a,n,i)}async send(a,n={}){var i,c;if(!this._canPush()&&a.type==="broadcast"){const{event:u,payload:h}=a,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:u,payload:h,private:this.private}]})};try{const x=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);return await((c=x.body)===null||c===void 0?void 0:c.cancel()),x.ok?"ok":"error"}catch(x){return x.name==="AbortError"?"timed out":"error"}}else return new Promise(u=>{var h,g,m;const x=this._push(a.type,a,n.timeout||this.timeout);a.type==="broadcast"&&!(!((m=(g=(h=this.params)===null||h===void 0?void 0:h.config)===null||g===void 0?void 0:g.broadcast)===null||m===void 0)&&m.ack)&&u("ok"),x.receive("ok",()=>u("ok")),x.receive("error",()=>u("error")),x.receive("timeout",()=>u("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=wt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ls.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(c=>{i=new qu(this,ls.leave,{},a),i.receive("ok",()=>{n(),c("ok")}).receive("timeout",()=>{n(),c("timed out")}).receive("error",()=>{c("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(a,n,i){const c=new AbortController,u=setTimeout(()=>c.abort(),i),h=await this.socket.fetch(a,Object.assign(Object.assign({},n),{signal:c.signal}));return clearTimeout(u),h}_push(a,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let c=new qu(this,a,n,i);return this._canPush()?c.send():(c.startTimeout(),this.pushBuffer.push(c)),c}_onMessage(a,n,i){return n}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,n,i){var c,u;const h=a.toLocaleLowerCase(),{close:g,error:m,leave:x,join:p}=ls;if(i&&[g,m,x,p].indexOf(h)>=0&&i!==this._joinRef())return;let j=this._onMessage(h,n,i);if(n&&!j)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(c=this.bindings.postgres_changes)===null||c===void 0||c.filter(N=>{var S,_,D;return((S=N.filter)===null||S===void 0?void 0:S.event)==="*"||((D=(_=N.filter)===null||_===void 0?void 0:_.event)===null||D===void 0?void 0:D.toLocaleLowerCase())===h}).map(N=>N.callback(j,i)):(u=this.bindings[h])===null||u===void 0||u.filter(N=>{var S,_,D,M,E,A;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in N){const G=N.id,q=(S=N.filter)===null||S===void 0?void 0:S.event;return G&&((_=n.ids)===null||_===void 0?void 0:_.includes(G))&&(q==="*"||q?.toLocaleLowerCase()===((D=n.data)===null||D===void 0?void 0:D.type.toLocaleLowerCase()))}else{const G=(E=(M=N?.filter)===null||M===void 0?void 0:M.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return G==="*"||G===((A=n?.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return N.type.toLocaleLowerCase()===h}).map(N=>{if(typeof j=="object"&&"ids"in j){const S=j.data,{schema:_,table:D,commit_timestamp:M,type:E,errors:A}=S;j=Object.assign(Object.assign({},{schema:_,table:D,commit_timestamp:M,eventType:E,new:{},old:{},errors:A}),this._getPayloadRecords(S))}N.callback(j,i)})}_isClosed(){return this.state===wt.closed}_isJoined(){return this.state===wt.joined}_isJoining(){return this.state===wt.joining}_isLeaving(){return this.state===wt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,n,i){const c=a.toLocaleLowerCase(),u={type:c,filter:n,callback:i};return this.bindings[c]?this.bindings[c].push(u):this.bindings[c]=[u],this}_off(a,n){const i=a.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(c=>{var u;return!(((u=c.type)===null||u===void 0?void 0:u.toLocaleLowerCase())===i&&_d.isEqual(c.filter,n))}),this}static isEqual(a,n){if(Object.keys(a).length!==Object.keys(n).length)return!1;for(const i in a)if(a[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(ls.close,{},a)}_onError(a){this._on(ls.error,{},n=>a(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const n={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(n.new=ag(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(n.old=ag(a.columns,a.old_record)),n}}const ig=()=>{},$w=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Pw{constructor(a,n){var i;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=fx,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ig,this.ref=0,this.logger=ig,this.conn=null,this.sendBuffer=[],this.serializer=new Rw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=u=>{let h;return u?h=u:typeof fetch>"u"?h=(...g)=>Tl(async()=>{const{default:m}=await Promise.resolve().then(()=>nn);return{default:m}},void 0).then(({default:m})=>m(...g)):h=fetch,(...g)=>h(...g)},this.endPoint=`${a}/${ad.websocket}`,this.httpEndpoint=xx(a),n?.transport?this.transport=n.transport:this.transport=null,n?.params&&(this.params=n.params),n?.timeout&&(this.timeout=n.timeout),n?.logger&&(this.logger=n.logger),(n?.logLevel||n?.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const c=(i=n?.params)===null||i===void 0?void 0:i.apikey;if(c&&(this.accessTokenValue=c,this.apiKey=c),this.reconnectAfterMs=n?.reconnectAfterMs?n.reconnectAfterMs:u=>[1e3,2e3,5e3,1e4][u-1]||1e4,this.encode=n?.encode?n.encode:(u,h)=>h(JSON.stringify(u)),this.decode=n?.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new mx(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n?.fetch),n?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=n?.worker||!1,this.workerUrl=n?.workerUrl}this.accessToken=n?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=Cw),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Mw}))}disconnect(a,n){this.conn&&(this.conn.onclose=function(){},a?this.conn.close(a,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(i=>i.teardown()))}getChannels(){return this.channels}async removeChannel(a){const n=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const a=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,n,i){this.logger(a,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case ml.connecting:return Qa.Connecting;case ml.open:return Qa.Open;case ml.closing:return Qa.Closing;default:return Qa.Closed}}isConnected(){return this.connectionState()===Qa.Open}channel(a,n={config:{}}){const i=`realtime:${a}`,c=this.getChannels().find(u=>u.topic===i);if(c)return c;{const u=new _d(`realtime:${a}`,n,this);return this.channels.push(u),u}}push(a){const{topic:n,event:i,payload:c,ref:u}=a,h=()=>{this.encode(a,g=>{var m;(m=this.conn)===null||m===void 0||m.send(g)})};this.log("push",`${n} ${i} (${u})`,c),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(a=null){let n=a||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(i=>{const c={access_token:n,version:Aw};n&&i.updateJoinPayload(c),i.joinedOnce&&i._isJoined()&&i._push(ls.access_token,{access_token:n})}))}async sendHeartbeat(){var a;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(a=this.conn)===null||a===void 0||a.close(Ow,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let n=this.channels.find(i=>i.topic===a&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${a}"`),n.unsubscribe())}_remove(a){this.channels=this.channels.filter(n=>n.topic!==a.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_onConnMessage(a){this.decode(a.data,n=>{let{topic:i,event:c,payload:u,ref:h}=n;i==="phoenix"&&c==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),h&&h===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${u.status||""} ${i} ${c} ${h&&"("+h+")"||""}`,u),Array.from(this.channels).filter(g=>g._isMember(i)).forEach(g=>g._trigger(c,u,h)),this.stateChangeCallbacks.message.forEach(g=>g(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(a=>a())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){this.log("transport","close",a),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(a))}_onConnError(a){this.log("transport",`${a}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(a))}_triggerChanError(){this.channels.forEach(a=>a._trigger(ls.error))}_appendParams(a,n){if(Object.keys(n).length===0)return a;const i=a.match(/\?/)?"&":"?",c=new URLSearchParams(n);return`${a}${i}${c}`}_workerObjectUrl(a){let n;if(a)n=a;else{const i=new Blob([$w],{type:"application/javascript"});n=URL.createObjectURL(i)}return n}}class kd extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function ft(l){return typeof l=="object"&&l!==null&&"__isStorageError"in l}class Kw extends kd{constructor(a,n){super(a),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class nd extends kd{constructor(a,n){super(a),this.name="StorageUnknownError",this.originalError=n}}var Gw=function(l,a,n,i){function c(u){return u instanceof n?u:new n(function(h){h(u)})}return new(n||(n=Promise))(function(u,h){function g(p){try{x(i.next(p))}catch(v){h(v)}}function m(p){try{x(i.throw(p))}catch(v){h(v)}}function x(p){p.done?u(p.value):c(p.value).then(g,m)}x((i=i.apply(l,a||[])).next())})};const px=l=>{let a;return l?a=l:typeof fetch>"u"?a=(...n)=>Tl(async()=>{const{default:i}=await Promise.resolve().then(()=>nn);return{default:i}},void 0).then(({default:i})=>i(...n)):a=fetch,(...n)=>a(...n)},Iw=()=>Gw(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Tl(()=>Promise.resolve().then(()=>nn),void 0)).Response:Response}),ld=l=>{if(Array.isArray(l))return l.map(n=>ld(n));if(typeof l=="function"||l!==Object(l))return l;const a={};return Object.entries(l).forEach(([n,i])=>{const c=n.replace(/([-_][a-z])/gi,u=>u.toUpperCase().replace(/[-_]/g,""));a[c]=ld(i)}),a};var Za=function(l,a,n,i){function c(u){return u instanceof n?u:new n(function(h){h(u)})}return new(n||(n=Promise))(function(u,h){function g(p){try{x(i.next(p))}catch(v){h(v)}}function m(p){try{x(i.throw(p))}catch(v){h(v)}}function x(p){p.done?u(p.value):c(p.value).then(g,m)}x((i=i.apply(l,a||[])).next())})};const zu=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),Vw=(l,a,n)=>Za(void 0,void 0,void 0,function*(){const i=yield Iw();l instanceof i&&!n?.noResolveJson?l.json().then(c=>{a(new Kw(zu(c),l.status||500))}).catch(c=>{a(new nd(zu(c),c))}):a(new nd(zu(l),l))}),Qw=(l,a,n,i)=>{const c={method:l,headers:a?.headers||{}};return l==="GET"?c:(c.headers=Object.assign({"Content-Type":"application/json"},a?.headers),i&&(c.body=JSON.stringify(i)),Object.assign(Object.assign({},c),n))};function El(l,a,n,i,c,u){return Za(this,void 0,void 0,function*(){return new Promise((h,g)=>{l(n,Qw(a,i,c,u)).then(m=>{if(!m.ok)throw m;return i?.noResolveJson?m:m.json()}).then(m=>h(m)).catch(m=>Vw(m,g,i))})})}function ro(l,a,n,i){return Za(this,void 0,void 0,function*(){return El(l,"GET",a,n,i)})}function xa(l,a,n,i,c){return Za(this,void 0,void 0,function*(){return El(l,"POST",a,i,c,n)})}function Yw(l,a,n,i,c){return Za(this,void 0,void 0,function*(){return El(l,"PUT",a,i,c,n)})}function Fw(l,a,n,i){return Za(this,void 0,void 0,function*(){return El(l,"HEAD",a,Object.assign(Object.assign({},n),{noResolveJson:!0}),i)})}function yx(l,a,n,i,c){return Za(this,void 0,void 0,function*(){return El(l,"DELETE",a,i,c,n)})}var Dt=function(l,a,n,i){function c(u){return u instanceof n?u:new n(function(h){h(u)})}return new(n||(n=Promise))(function(u,h){function g(p){try{x(i.next(p))}catch(v){h(v)}}function m(p){try{x(i.throw(p))}catch(v){h(v)}}function x(p){p.done?u(p.value):c(p.value).then(g,m)}x((i=i.apply(l,a||[])).next())})};const Xw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},og={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Zw{constructor(a,n={},i,c){this.url=a,this.headers=n,this.bucketId=i,this.fetch=px(c)}uploadOrUpdate(a,n,i,c){return Dt(this,void 0,void 0,function*(){try{let u;const h=Object.assign(Object.assign({},og),c);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(h.upsert)});const m=h.metadata;typeof Blob<"u"&&i instanceof Blob?(u=new FormData,u.append("cacheControl",h.cacheControl),m&&u.append("metadata",this.encodeMetadata(m)),u.append("",i)):typeof FormData<"u"&&i instanceof FormData?(u=i,u.append("cacheControl",h.cacheControl),m&&u.append("metadata",this.encodeMetadata(m))):(u=i,g["cache-control"]=`max-age=${h.cacheControl}`,g["content-type"]=h.contentType,m&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),c?.headers&&(g=Object.assign(Object.assign({},g),c.headers));const x=this._removeEmptyFolders(n),p=this._getFinalPath(x),v=yield this.fetch(`${this.url}/object/${p}`,Object.assign({method:a,body:u,headers:g},h?.duplex?{duplex:h.duplex}:{})),j=yield v.json();return v.ok?{data:{path:x,id:j.Id,fullPath:j.Key},error:null}:{data:null,error:j}}catch(u){if(ft(u))return{data:null,error:u};throw u}})}upload(a,n,i){return Dt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,n,i)})}uploadToSignedUrl(a,n,i,c){return Dt(this,void 0,void 0,function*(){const u=this._removeEmptyFolders(a),h=this._getFinalPath(u),g=new URL(this.url+`/object/upload/sign/${h}`);g.searchParams.set("token",n);try{let m;const x=Object.assign({upsert:og.upsert},c),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(x.upsert)});typeof Blob<"u"&&i instanceof Blob?(m=new FormData,m.append("cacheControl",x.cacheControl),m.append("",i)):typeof FormData<"u"&&i instanceof FormData?(m=i,m.append("cacheControl",x.cacheControl)):(m=i,p["cache-control"]=`max-age=${x.cacheControl}`,p["content-type"]=x.contentType);const v=yield this.fetch(g.toString(),{method:"PUT",body:m,headers:p}),j=yield v.json();return v.ok?{data:{path:u,fullPath:j.Key},error:null}:{data:null,error:j}}catch(m){if(ft(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(a,n){return Dt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(a);const c=Object.assign({},this.headers);n?.upsert&&(c["x-upsert"]="true");const u=yield xa(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:c}),h=new URL(this.url+u.url),g=h.searchParams.get("token");if(!g)throw new kd("No token returned by API");return{data:{signedUrl:h.toString(),path:a,token:g},error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}})}update(a,n,i){return Dt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,n,i)})}move(a,n,i){return Dt(this,void 0,void 0,function*(){try{return{data:yield xa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:n,destinationBucket:i?.destinationBucket},{headers:this.headers}),error:null}}catch(c){if(ft(c))return{data:null,error:c};throw c}})}copy(a,n,i){return Dt(this,void 0,void 0,function*(){try{return{data:{path:(yield xa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:n,destinationBucket:i?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(c){if(ft(c))return{data:null,error:c};throw c}})}createSignedUrl(a,n,i){return Dt(this,void 0,void 0,function*(){try{let c=this._getFinalPath(a),u=yield xa(this.fetch,`${this.url}/object/sign/${c}`,Object.assign({expiresIn:n},i?.transform?{transform:i.transform}:{}),{headers:this.headers});const h=i?.download?`&download=${i.download===!0?"":i.download}`:"";return u={signedUrl:encodeURI(`${this.url}${u.signedURL}${h}`)},{data:u,error:null}}catch(c){if(ft(c))return{data:null,error:c};throw c}})}createSignedUrls(a,n,i){return Dt(this,void 0,void 0,function*(){try{const c=yield xa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:a},{headers:this.headers}),u=i?.download?`&download=${i.download===!0?"":i.download}`:"";return{data:c.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${u}`):null})),error:null}}catch(c){if(ft(c))return{data:null,error:c};throw c}})}download(a,n){return Dt(this,void 0,void 0,function*(){const c=typeof n?.transform<"u"?"render/image/authenticated":"object",u=this.transformOptsToQueryString(n?.transform||{}),h=u?`?${u}`:"";try{const g=this._getFinalPath(a);return{data:yield(yield ro(this.fetch,`${this.url}/${c}/${g}${h}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(g){if(ft(g))return{data:null,error:g};throw g}})}info(a){return Dt(this,void 0,void 0,function*(){const n=this._getFinalPath(a);try{const i=yield ro(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:ld(i),error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}})}exists(a){return Dt(this,void 0,void 0,function*(){const n=this._getFinalPath(a);try{return yield Fw(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(ft(i)&&i instanceof nd){const c=i.originalError;if([400,404].includes(c?.status))return{data:!1,error:i}}throw i}})}getPublicUrl(a,n){const i=this._getFinalPath(a),c=[],u=n?.download?`download=${n.download===!0?"":n.download}`:"";u!==""&&c.push(u);const g=typeof n?.transform<"u"?"render/image":"object",m=this.transformOptsToQueryString(n?.transform||{});m!==""&&c.push(m);let x=c.join("&");return x!==""&&(x=`?${x}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${i}${x}`)}}}remove(a){return Dt(this,void 0,void 0,function*(){try{return{data:yield yx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}list(a,n,i){return Dt(this,void 0,void 0,function*(){try{const c=Object.assign(Object.assign(Object.assign({},Xw),n),{prefix:a||""});return{data:yield xa(this.fetch,`${this.url}/object/list/${this.bucketId}`,c,{headers:this.headers},i),error:null}}catch(c){if(ft(c))return{data:null,error:c};throw c}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const n=[];return a.width&&n.push(`width=${a.width}`),a.height&&n.push(`height=${a.height}`),a.resize&&n.push(`resize=${a.resize}`),a.format&&n.push(`format=${a.format}`),a.quality&&n.push(`quality=${a.quality}`),n.join("&")}}const Jw="2.7.1",Ww={"X-Client-Info":`storage-js/${Jw}`};var Vr=function(l,a,n,i){function c(u){return u instanceof n?u:new n(function(h){h(u)})}return new(n||(n=Promise))(function(u,h){function g(p){try{x(i.next(p))}catch(v){h(v)}}function m(p){try{x(i.throw(p))}catch(v){h(v)}}function x(p){p.done?u(p.value):c(p.value).then(g,m)}x((i=i.apply(l,a||[])).next())})};class ej{constructor(a,n={},i){this.url=a,this.headers=Object.assign(Object.assign({},Ww),n),this.fetch=px(i)}listBuckets(){return Vr(this,void 0,void 0,function*(){try{return{data:yield ro(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(a){if(ft(a))return{data:null,error:a};throw a}})}getBucket(a){return Vr(this,void 0,void 0,function*(){try{return{data:yield ro(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}createBucket(a,n={public:!1}){return Vr(this,void 0,void 0,function*(){try{return{data:yield xa(this.fetch,`${this.url}/bucket`,{id:a,name:a,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}})}updateBucket(a,n){return Vr(this,void 0,void 0,function*(){try{return{data:yield Yw(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(ft(i))return{data:null,error:i};throw i}})}emptyBucket(a){return Vr(this,void 0,void 0,function*(){try{return{data:yield xa(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}deleteBucket(a){return Vr(this,void 0,void 0,function*(){try{return{data:yield yx(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}}class tj extends ej{constructor(a,n={},i){super(a,n,i)}from(a){return new Zw(this.url,this.headers,a,this.fetch)}}const sj="2.52.0";let hl="";typeof Deno<"u"?hl="deno":typeof document<"u"?hl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?hl="react-native":hl="node";const aj={"X-Client-Info":`supabase-js-${hl}/${sj}`},rj={headers:aj},nj={schema:"public"},lj={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ij={};var oj=function(l,a,n,i){function c(u){return u instanceof n?u:new n(function(h){h(u)})}return new(n||(n=Promise))(function(u,h){function g(p){try{x(i.next(p))}catch(v){h(v)}}function m(p){try{x(i.throw(p))}catch(v){h(v)}}function x(p){p.done?u(p.value):c(p.value).then(g,m)}x((i=i.apply(l,a||[])).next())})};const cj=l=>{let a;return l?a=l:typeof fetch>"u"?a=ix:a=fetch,(...n)=>a(...n)},uj=()=>typeof Headers>"u"?ox:Headers,dj=(l,a,n)=>{const i=cj(n),c=uj();return(u,h)=>oj(void 0,void 0,void 0,function*(){var g;const m=(g=yield a())!==null&&g!==void 0?g:l;let x=new c(h?.headers);return x.has("apikey")||x.set("apikey",l),x.has("Authorization")||x.set("Authorization",`Bearer ${m}`),i(u,Object.assign(Object.assign({},h),{headers:x}))})};var hj=function(l,a,n,i){function c(u){return u instanceof n?u:new n(function(h){h(u)})}return new(n||(n=Promise))(function(u,h){function g(p){try{x(i.next(p))}catch(v){h(v)}}function m(p){try{x(i.throw(p))}catch(v){h(v)}}function x(p){p.done?u(p.value):c(p.value).then(g,m)}x((i=i.apply(l,a||[])).next())})};function fj(l){return l.endsWith("/")?l:l+"/"}function mj(l,a){var n,i;const{db:c,auth:u,realtime:h,global:g}=l,{db:m,auth:x,realtime:p,global:v}=a,j={db:Object.assign(Object.assign({},m),c),auth:Object.assign(Object.assign({},x),u),realtime:Object.assign(Object.assign({},p),h),global:Object.assign(Object.assign(Object.assign({},v),g),{headers:Object.assign(Object.assign({},(n=v?.headers)!==null&&n!==void 0?n:{}),(i=g?.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>hj(this,void 0,void 0,function*(){return""})};return l.accessToken?j.accessToken=l.accessToken:delete j.accessToken,j}const vx="2.71.1",Zr=30*1e3,id=3,$u=id*Zr,gj="http://localhost:9999",xj="supabase.auth.token",pj={"X-Client-Info":`gotrue-js/${vx}`},od="X-Supabase-Api-Version",bx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},yj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,vj=600*1e3;class Td extends Error{constructor(a,n,i){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=i}}function Se(l){return typeof l=="object"&&l!==null&&"__isAuthError"in l}class bj extends Td{constructor(a,n,i){super(a,n,i),this.name="AuthApiError",this.status=n,this.code=i}}function wj(l){return Se(l)&&l.name==="AuthApiError"}class wx extends Td{constructor(a,n){super(a),this.name="AuthUnknownError",this.originalError=n}}class ba extends Td{constructor(a,n,i,c){super(a,i,c),this.name=n,this.status=i}}class ga extends ba{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function jj(l){return Se(l)&&l.name==="AuthSessionMissingError"}class Ii extends ba{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Vi extends ba{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class Qi extends ba{constructor(a,n=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Nj(l){return Se(l)&&l.name==="AuthImplicitGrantRedirectError"}class cg extends ba{constructor(a,n=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cd extends ba{constructor(a,n){super(a,"AuthRetryableFetchError",n,void 0)}}function Pu(l){return Se(l)&&l.name==="AuthRetryableFetchError"}class ug extends ba{constructor(a,n,i){super(a,"AuthWeakPasswordError",n,"weak_password"),this.reasons=i}}class ud extends ba{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const no="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),dg=` 	
\r=`.split(""),Sj=(()=>{const l=new Array(128);for(let a=0;a<l.length;a+=1)l[a]=-1;for(let a=0;a<dg.length;a+=1)l[dg[a].charCodeAt(0)]=-2;for(let a=0;a<no.length;a+=1)l[no[a].charCodeAt(0)]=a;return l})();function hg(l,a,n){if(l!==null)for(a.queue=a.queue<<8|l,a.queuedBits+=8;a.queuedBits>=6;){const i=a.queue>>a.queuedBits-6&63;n(no[i]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const i=a.queue>>a.queuedBits-6&63;n(no[i]),a.queuedBits-=6}}function jx(l,a,n){const i=Sj[l];if(i>-1)for(a.queue=a.queue<<6|i,a.queuedBits+=6;a.queuedBits>=8;)n(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(l)}"`)}}function fg(l){const a=[],n=h=>{a.push(String.fromCodePoint(h))},i={utf8seq:0,codepoint:0},c={queue:0,queuedBits:0},u=h=>{Tj(h,i,n)};for(let h=0;h<l.length;h+=1)jx(l.charCodeAt(h),c,u);return a.join("")}function _j(l,a){if(l<=127){a(l);return}else if(l<=2047){a(192|l>>6),a(128|l&63);return}else if(l<=65535){a(224|l>>12),a(128|l>>6&63),a(128|l&63);return}else if(l<=1114111){a(240|l>>18),a(128|l>>12&63),a(128|l>>6&63),a(128|l&63);return}throw new Error(`Unrecognized Unicode codepoint: ${l.toString(16)}`)}function kj(l,a){for(let n=0;n<l.length;n+=1){let i=l.charCodeAt(n);if(i>55295&&i<=56319){const c=(i-55296)*1024&65535;i=(l.charCodeAt(n+1)-56320&65535|c)+65536,n+=1}_j(i,a)}}function Tj(l,a,n){if(a.utf8seq===0){if(l<=127){n(l);return}for(let i=1;i<6;i+=1)if((l>>7-i&1)===0){a.utf8seq=i;break}if(a.utf8seq===2)a.codepoint=l&31;else if(a.utf8seq===3)a.codepoint=l&15;else if(a.utf8seq===4)a.codepoint=l&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(l<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|l&63,a.utf8seq-=1,a.utf8seq===0&&n(a.codepoint)}}function Ej(l){const a=[],n={queue:0,queuedBits:0},i=c=>{a.push(c)};for(let c=0;c<l.length;c+=1)jx(l.charCodeAt(c),n,i);return new Uint8Array(a)}function Cj(l){const a=[];return kj(l,n=>a.push(n)),new Uint8Array(a)}function Dj(l){const a=[],n={queue:0,queuedBits:0},i=c=>{a.push(c)};return l.forEach(c=>hg(c,n,i)),hg(null,n,i),a.join("")}function Aj(l){return Math.round(Date.now()/1e3)+l}function Mj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){const a=Math.random()*16|0;return(l=="x"?a:a&3|8).toString(16)})}const rs=()=>typeof window<"u"&&typeof document<"u",Ka={tested:!1,writable:!1},Nx=()=>{if(!rs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ka.tested)return Ka.writable;const l=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(l,l),globalThis.localStorage.removeItem(l),Ka.tested=!0,Ka.writable=!0}catch{Ka.tested=!0,Ka.writable=!1}return Ka.writable};function Oj(l){const a={},n=new URL(l);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((c,u)=>{a[u]=c})}catch{}return n.searchParams.forEach((i,c)=>{a[c]=i}),a}const Sx=l=>{let a;return l?a=l:typeof fetch>"u"?a=(...n)=>Tl(async()=>{const{default:i}=await Promise.resolve().then(()=>nn);return{default:i}},void 0).then(({default:i})=>i(...n)):a=fetch,(...n)=>a(...n)},Rj=l=>typeof l=="object"&&l!==null&&"status"in l&&"ok"in l&&"json"in l&&typeof l.json=="function",Jr=async(l,a,n)=>{await l.setItem(a,JSON.stringify(n))},Ga=async(l,a)=>{const n=await l.getItem(a);if(!n)return null;try{return JSON.parse(n)}catch{return n}},ma=async(l,a)=>{await l.removeItem(a)};class xo{constructor(){this.promise=new xo.promiseConstructor((a,n)=>{this.resolve=a,this.reject=n})}}xo.promiseConstructor=Promise;function Ku(l){const a=l.split(".");if(a.length!==3)throw new ud("Invalid JWT structure");for(let i=0;i<a.length;i++)if(!yj.test(a[i]))throw new ud("JWT not in base64url format");return{header:JSON.parse(fg(a[0])),payload:JSON.parse(fg(a[1])),signature:Ej(a[2]),raw:{header:a[0],payload:a[1]}}}async function Uj(l){return await new Promise(a=>{setTimeout(()=>a(null),l)})}function Lj(l,a){return new Promise((i,c)=>{(async()=>{for(let u=0;u<1/0;u++)try{const h=await l(u);if(!a(u,null,h)){i(h);return}}catch(h){if(!a(u,h)){c(h);return}}})()})}function Hj(l){return("0"+l.toString(16)).substr(-2)}function Bj(){const a=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let c="";for(let u=0;u<56;u++)c+=n.charAt(Math.floor(Math.random()*i));return c}return crypto.getRandomValues(a),Array.from(a,Hj).join("")}async function qj(l){const n=new TextEncoder().encode(l),i=await crypto.subtle.digest("SHA-256",n),c=new Uint8Array(i);return Array.from(c).map(u=>String.fromCharCode(u)).join("")}async function zj(l){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),l;const n=await qj(l);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Qr(l,a,n=!1){const i=Bj();let c=i;n&&(c+="/PASSWORD_RECOVERY"),await Jr(l,`${a}-code-verifier`,c);const u=await zj(i);return[u,i===u?"plain":"s256"]}const $j=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Pj(l){const a=l.headers.get(od);if(!a||!a.match($j))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function Kj(l){if(!l)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(l<=a)throw new Error("JWT has expired")}function Gj(l){switch(l){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ij=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Yr(l){if(!Ij.test(l))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gu(){const l={};return new Proxy(l,{get:(a,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function mg(l){return JSON.parse(JSON.stringify(l))}var Vj=function(l,a){var n={};for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&a.indexOf(i)<0&&(n[i]=l[i]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,i=Object.getOwnPropertySymbols(l);c<i.length;c++)a.indexOf(i[c])<0&&Object.prototype.propertyIsEnumerable.call(l,i[c])&&(n[i[c]]=l[i[c]]);return n};const Va=l=>l.msg||l.message||l.error_description||l.error||JSON.stringify(l),Qj=[502,503,504];async function gg(l){var a;if(!Rj(l))throw new cd(Va(l),0);if(Qj.includes(l.status))throw new cd(Va(l),l.status);let n;try{n=await l.json()}catch(u){throw new wx(Va(u),u)}let i;const c=Pj(l);if(c&&c.getTime()>=bx["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?i=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(i=n.error_code),i){if(i==="weak_password")throw new ug(Va(n),l.status,((a=n.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(i==="session_not_found")throw new ga}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((u,h)=>u&&typeof h=="string",!0))throw new ug(Va(n),l.status,n.weak_password.reasons);throw new bj(Va(n),l.status||500,i)}const Yj=(l,a,n,i)=>{const c={method:l,headers:a?.headers||{}};return l==="GET"?c:(c.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),c.body=JSON.stringify(i),Object.assign(Object.assign({},c),n))};async function Me(l,a,n,i){var c;const u=Object.assign({},i?.headers);u[od]||(u[od]=bx["2024-01-01"].name),i?.jwt&&(u.Authorization=`Bearer ${i.jwt}`);const h=(c=i?.query)!==null&&c!==void 0?c:{};i?.redirectTo&&(h.redirect_to=i.redirectTo);const g=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",m=await Fj(l,a,n+g,{headers:u,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(m):{data:Object.assign({},m),error:null}}async function Fj(l,a,n,i,c,u){const h=Yj(a,i,c,u);let g;try{g=await l(n,Object.assign({},h))}catch(m){throw console.error(m),new cd(Va(m),0)}if(g.ok||await gg(g),i?.noResolveJson)return g;try{return await g.json()}catch(m){await gg(m)}}function Hs(l){var a;let n=null;Wj(l)&&(n=Object.assign({},l),l.expires_at||(n.expires_at=Aj(l.expires_in)));const i=(a=l.user)!==null&&a!==void 0?a:l;return{data:{session:n,user:i},error:null}}function xg(l){const a=Hs(l);return!a.error&&l.weak_password&&typeof l.weak_password=="object"&&Array.isArray(l.weak_password.reasons)&&l.weak_password.reasons.length&&l.weak_password.message&&typeof l.weak_password.message=="string"&&l.weak_password.reasons.reduce((n,i)=>n&&typeof i=="string",!0)&&(a.data.weak_password=l.weak_password),a}function ya(l){var a;return{data:{user:(a=l.user)!==null&&a!==void 0?a:l},error:null}}function Xj(l){return{data:l,error:null}}function Zj(l){const{action_link:a,email_otp:n,hashed_token:i,redirect_to:c,verification_type:u}=l,h=Vj(l,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:n,hashed_token:i,redirect_to:c,verification_type:u},m=Object.assign({},h);return{data:{properties:g,user:m},error:null}}function Jj(l){return l}function Wj(l){return l.access_token&&l.refresh_token&&l.expires_in}const Iu=["global","local","others"];var eN=function(l,a){var n={};for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&a.indexOf(i)<0&&(n[i]=l[i]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,i=Object.getOwnPropertySymbols(l);c<i.length;c++)a.indexOf(i[c])<0&&Object.prototype.propertyIsEnumerable.call(l,i[c])&&(n[i[c]]=l[i[c]]);return n};class tN{constructor({url:a="",headers:n={},fetch:i}){this.url=a,this.headers=n,this.fetch=Sx(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(a,n=Iu[0]){if(Iu.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Iu.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Se(i))return{data:null,error:i};throw i}}async inviteUserByEmail(a,n={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ya})}catch(i){if(Se(i))return{data:{user:null},error:i};throw i}}async generateLink(a){try{const{options:n}=a,i=eN(a,["options"]),c=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(c.new_email=i?.newEmail,delete c.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:c,headers:this.headers,xform:Zj,redirectTo:n?.redirectTo})}catch(n){if(Se(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(a){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:ya})}catch(n){if(Se(n))return{data:{user:null},error:n};throw n}}async listUsers(a){var n,i,c,u,h,g,m;try{const x={nextPage:null,lastPage:0,total:0},p=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=a?.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(u=(c=a?.perPage)===null||c===void 0?void 0:c.toString())!==null&&u!==void 0?u:""},xform:Jj});if(p.error)throw p.error;const v=await p.json(),j=(h=p.headers.get("x-total-count"))!==null&&h!==void 0?h:0,N=(m=(g=p.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&m!==void 0?m:[];return N.length>0&&(N.forEach(S=>{const _=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),D=JSON.parse(S.split(";")[1].split("=")[1]);x[`${D}Page`]=_}),x.total=parseInt(j)),{data:Object.assign(Object.assign({},v),x),error:null}}catch(x){if(Se(x))return{data:{users:[]},error:x};throw x}}async getUserById(a){Yr(a);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:ya})}catch(n){if(Se(n))return{data:{user:null},error:n};throw n}}async updateUserById(a,n){Yr(a);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:n,headers:this.headers,xform:ya})}catch(i){if(Se(i))return{data:{user:null},error:i};throw i}}async deleteUser(a,n=!1){Yr(a);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:n},xform:ya})}catch(i){if(Se(i))return{data:{user:null},error:i};throw i}}async _listFactors(a){Yr(a.userId);try{const{data:n,error:i}=await Me(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:c=>({data:{factors:c},error:null})});return{data:n,error:i}}catch(n){if(Se(n))return{data:null,error:n};throw n}}async _deleteFactor(a){Yr(a.userId),Yr(a.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}}}function pg(l={}){return{getItem:a=>l[a]||null,setItem:(a,n)=>{l[a]=n},removeItem:a=>{delete l[a]}}}function sN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Fr={debug:!!(globalThis&&Nx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class _x extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class aN extends _x{}async function rN(l,a,n){Fr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",l,a);const i=new globalThis.AbortController;return a>0&&setTimeout(()=>{i.abort(),Fr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",l)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(l,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async c=>{if(c){Fr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",l,c.name);try{return await n()}finally{Fr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",l,c.name)}}else{if(a===0)throw Fr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",l),new aN(`Acquiring an exclusive Navigator LockManager lock "${l}" immediately failed`);if(Fr.debug)try{const u=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(u,null,"  "))}catch(u){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",u)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}sN();const nN={url:gj,storageKey:xj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:pj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function yg(l,a,n){return await n()}const Xr={};class wl{constructor(a){var n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=wl.nextInstanceID,wl.nextInstanceID+=1,this.instanceID>0&&rs()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const c=Object.assign(Object.assign({},nN),a);if(this.logDebugMessages=!!c.debug,typeof c.debug=="function"&&(this.logger=c.debug),this.persistSession=c.persistSession,this.storageKey=c.storageKey,this.autoRefreshToken=c.autoRefreshToken,this.admin=new tN({url:c.url,headers:c.headers,fetch:c.fetch}),this.url=c.url,this.headers=c.headers,this.fetch=Sx(c.fetch),this.lock=c.lock||yg,this.detectSessionInUrl=c.detectSessionInUrl,this.flowType=c.flowType,this.hasCustomAuthorizationHeader=c.hasCustomAuthorizationHeader,c.lock?this.lock=c.lock:rs()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=rN:this.lock=yg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(c.storage?this.storage=c.storage:Nx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=pg(this.memoryStorage)),c.userStorage&&(this.userStorage=c.userStorage)):(this.memoryStorage={},this.storage=pg(this.memoryStorage)),rs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(u){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",u)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async u=>{this._debug("received broadcast notification from other tab or client",u),await this._notifyAllSubscribers(u.data.event,u.data.session,!1)})}this.initialize()}get jwks(){var a,n;return(n=(a=Xr[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(a){Xr[this.storageKey]=Object.assign(Object.assign({},Xr[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,n;return(n=(a=Xr[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){Xr[this.storageKey]=Object.assign(Object.assign({},Xr[this.storageKey]),{cachedAt:a})}_debug(...a){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${vx}) ${new Date().toISOString()}`,...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{const n=Oj(window.location.href);let i="none";if(this._isImplicitGrantCallback(n)?i="implicit":await this._isPKCECallback(n)&&(i="pkce"),rs()&&this.detectSessionInUrl&&i!=="none"){const{data:c,error:u}=await this._getSessionFromURL(n,i);if(u){if(this._debug("#_initialize()","error detecting session from URL",u),Nj(u)){const m=(a=u.details)===null||a===void 0?void 0:a.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:u}}return await this._removeSession(),{error:u}}const{session:h,redirectType:g}=c;return this._debug("#_initialize()","detected session in URL",h,"redirect type",g),await this._saveSession(h),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Se(n)?{error:n}:{error:new wx("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var n,i,c;try{const u=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(n=a?.options)===null||n===void 0?void 0:n.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(c=a?.options)===null||c===void 0?void 0:c.captchaToken}},xform:Hs}),{data:h,error:g}=u;if(g||!h)return{data:{user:null,session:null},error:g};const m=h.session,x=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:x,session:m},error:null}}catch(u){if(Se(u))return{data:{user:null,session:null},error:u};throw u}}async signUp(a){var n,i,c;try{let u;if("email"in a){const{email:p,password:v,options:j}=a;let N=null,S=null;this.flowType==="pkce"&&([N,S]=await Qr(this.storage,this.storageKey)),u=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:j?.emailRedirectTo,body:{email:p,password:v,data:(n=j?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:j?.captchaToken},code_challenge:N,code_challenge_method:S},xform:Hs})}else if("phone"in a){const{phone:p,password:v,options:j}=a;u=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:v,data:(i=j?.data)!==null&&i!==void 0?i:{},channel:(c=j?.channel)!==null&&c!==void 0?c:"sms",gotrue_meta_security:{captcha_token:j?.captchaToken}},xform:Hs})}else throw new Vi("You must provide either an email or phone number and a password");const{data:h,error:g}=u;if(g||!h)return{data:{user:null,session:null},error:g};const m=h.session,x=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:x,session:m},error:null}}catch(u){if(Se(u))return{data:{user:null,session:null},error:u};throw u}}async signInWithPassword(a){try{let n;if("email"in a){const{email:u,password:h,options:g}=a;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:u,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:xg})}else if("phone"in a){const{phone:u,password:h,options:g}=a;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:u,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:xg})}else throw new Vi("You must provide either an email or phone number and a password");const{data:i,error:c}=n;return c?{data:{user:null,session:null},error:c}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Ii}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:c})}catch(n){if(Se(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(a){var n,i,c,u;return await this._handleProviderSignIn(a.provider,{redirectTo:(n=a.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=a.options)===null||i===void 0?void 0:i.scopes,queryParams:(c=a.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:(u=a.options)===null||u===void 0?void 0:u.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:n}=a;if(n==="solana")return await this.signInWithSolana(a);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(a){var n,i,c,u,h,g,m,x,p,v,j,N;let S,_;if("message"in a)S=a.message,_=a.signature;else{const{chain:D,wallet:M,statement:E,options:A}=a;let G;if(rs())if(typeof M=="object")G=M;else{const H=window;if("solana"in H&&typeof H.solana=="object"&&("signIn"in H.solana&&typeof H.solana.signIn=="function"||"signMessage"in H.solana&&typeof H.solana.signMessage=="function"))G=H.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof M!="object"||!A?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=M}const q=new URL((n=A?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in G&&G.signIn){const H=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},A?.signInWithSolana),{version:"1",domain:q.host,uri:q.href}),E?{statement:E}:null));let R;if(Array.isArray(H)&&H[0]&&typeof H[0]=="object")R=H[0];else if(H&&typeof H=="object"&&"signedMessage"in H&&"signature"in H)R=H;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)S=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),_=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${q.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...E?["",E,""]:[""],"Version: 1",`URI: ${q.href}`,`Issued At: ${(c=(i=A?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&c!==void 0?c:new Date().toISOString()}`,...!((u=A?.signInWithSolana)===null||u===void 0)&&u.notBefore?[`Not Before: ${A.signInWithSolana.notBefore}`]:[],...!((h=A?.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${A.signInWithSolana.expirationTime}`]:[],...!((g=A?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${A.signInWithSolana.chainId}`]:[],...!((m=A?.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${A.signInWithSolana.nonce}`]:[],...!((x=A?.signInWithSolana)===null||x===void 0)&&x.requestId?[`Request ID: ${A.signInWithSolana.requestId}`]:[],...!((v=(p=A?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||v===void 0)&&v.length?["Resources",...A.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const H=await G.signMessage(new TextEncoder().encode(S),"utf8");if(!H||!(H instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=H}}try{const{data:D,error:M}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:Dj(_)},!((j=a.options)===null||j===void 0)&&j.captchaToken?{gotrue_meta_security:{captcha_token:(N=a.options)===null||N===void 0?void 0:N.captchaToken}}:null),xform:Hs});if(M)throw M;return!D||!D.session||!D.user?{data:{user:null,session:null},error:new Ii}:(D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),{data:Object.assign({},D),error:M})}catch(D){if(Se(D))return{data:{user:null,session:null},error:D};throw D}}async _exchangeCodeForSession(a){const n=await Ga(this.storage,`${this.storageKey}-code-verifier`),[i,c]=(n??"").split("/");try{const{data:u,error:h}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:i},xform:Hs});if(await ma(this.storage,`${this.storageKey}-code-verifier`),h)throw h;return!u||!u.session||!u.user?{data:{user:null,session:null,redirectType:null},error:new Ii}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:Object.assign(Object.assign({},u),{redirectType:c??null}),error:h})}catch(u){if(Se(u))return{data:{user:null,session:null,redirectType:null},error:u};throw u}}async signInWithIdToken(a){try{const{options:n,provider:i,token:c,access_token:u,nonce:h}=a,g=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:c,access_token:u,nonce:h,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:Hs}),{data:m,error:x}=g;return x?{data:{user:null,session:null},error:x}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Ii}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:x})}catch(n){if(Se(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(a){var n,i,c,u,h;try{if("email"in a){const{email:g,options:m}=a;let x=null,p=null;this.flowType==="pkce"&&([x,p]=await Qr(this.storage,this.storageKey));const{error:v}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(n=m?.data)!==null&&n!==void 0?n:{},create_user:(i=m?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:x,code_challenge_method:p},redirectTo:m?.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in a){const{phone:g,options:m}=a,{data:x,error:p}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(c=m?.data)!==null&&c!==void 0?c:{},create_user:(u=m?.shouldCreateUser)!==null&&u!==void 0?u:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},channel:(h=m?.channel)!==null&&h!==void 0?h:"sms"}});return{data:{user:null,session:null,messageId:x?.message_id},error:p}}throw new Vi("You must provide either an email or phone number.")}catch(g){if(Se(g))return{data:{user:null,session:null},error:g};throw g}}async verifyOtp(a){var n,i;try{let c,u;"options"in a&&(c=(n=a.options)===null||n===void 0?void 0:n.redirectTo,u=(i=a.options)===null||i===void 0?void 0:i.captchaToken);const{data:h,error:g}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:u}}),redirectTo:c,xform:Hs});if(g)throw g;if(!h)throw new Error("An error occurred on token verification.");const m=h.session,x=h.user;return m?.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:x,session:m},error:null}}catch(c){if(Se(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithSSO(a){var n,i,c;try{let u=null,h=null;return this.flowType==="pkce"&&([u,h]=await Qr(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(i=(n=a.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((c=a?.options)===null||c===void 0)&&c.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:Xj})}catch(u){if(Se(u))return{data:null,error:u};throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:n},error:i}=a;if(i)throw i;if(!n)throw new ga;const{error:c}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:c}})}catch(a){if(Se(a))return{data:{user:null,session:null},error:a};throw a}}async resend(a){try{const n=`${this.url}/resend`;if("email"in a){const{email:i,type:c,options:u}=a,{error:h}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},redirectTo:u?.emailRedirectTo});return{data:{user:null,session:null},error:h}}else if("phone"in a){const{phone:i,type:c,options:u}=a,{data:h,error:g}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:c,gotrue_meta_security:{captcha_token:u?.captchaToken}}});return{data:{user:null,session:null,messageId:h?.message_id},error:g}}throw new Vi("You must provide either an email or phone number and a type")}catch(n){if(Se(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(a,n){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),c=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await c}catch{}})()),c}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const c=[...this.pendingInLock];await Promise.all(c),this.pendingInLock.splice(0,c.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await a(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const n=await Ga(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?a=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const i=a.expires_at?a.expires_at*1e3-Date.now()<$u:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",a.expires_at),!i){if(this.userStorage){const h=await Ga(this.userStorage,this.storageKey+"-user");h?.user?a.user=h.user:a.user=Gu()}if(this.storage.isServer&&a.user){let h=this.suppressGetSessionWarning;a=new Proxy(a,{get:(m,x,p)=>(!h&&x==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),h=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,x,p))})}return{data:{session:a},error:null}}const{session:c,error:u}=await this._callRefreshToken(a.refresh_token);return u?{data:{session:null},error:u}:{data:{session:c},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:ya}):await this._useSession(async n=>{var i,c,u;const{data:h,error:g}=n;if(g)throw g;return!(!((i=h.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ga}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0,xform:ya})})}catch(n){if(Se(n))return jj(n)&&(await this._removeSession(),await ma(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(a,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,n))}async _updateUser(a,n={}){try{return await this._useSession(async i=>{const{data:c,error:u}=i;if(u)throw u;if(!c.session)throw new ga;const h=c.session;let g=null,m=null;this.flowType==="pkce"&&a.email!=null&&([g,m]=await Qr(this.storage,this.storageKey));const{data:x,error:p}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:m}),jwt:h.access_token,xform:ya});if(p)throw p;return h.user=x.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),{data:{user:h.user},error:null}})}catch(i){if(Se(i))return{data:{user:null},error:i};throw i}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new ga;const n=Date.now()/1e3;let i=n,c=!0,u=null;const{payload:h}=Ku(a.access_token);if(h.exp&&(i=h.exp,c=i<=n),c){const{session:g,error:m}=await this._callRefreshToken(a.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!g)return{data:{user:null,session:null},error:null};u=g}else{const{data:g,error:m}=await this._getUser(a.access_token);if(m)throw m;u={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)}return{data:{user:u.user,session:u},error:null}}catch(n){if(Se(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async n=>{var i;if(!a){const{data:h,error:g}=n;if(g)throw g;a=(i=h.session)!==null&&i!==void 0?i:void 0}if(!a?.refresh_token)throw new ga;const{session:c,error:u}=await this._callRefreshToken(a.refresh_token);return u?{data:{user:null,session:null},error:u}:c?{data:{user:c.user,session:c},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Se(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(a,n){try{if(!rs())throw new Qi("No browser detected.");if(a.error||a.error_description||a.error_code)throw new Qi(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new cg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qi("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new cg("No code detected.");const{data:E,error:A}=await this._exchangeCodeForSession(a.code);if(A)throw A;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:E.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:c,access_token:u,refresh_token:h,expires_in:g,expires_at:m,token_type:x}=a;if(!u||!g||!h||!x)throw new Qi("No session defined in URL");const p=Math.round(Date.now()/1e3),v=parseInt(g);let j=p+v;m&&(j=parseInt(m));const N=j-p;N*1e3<=Zr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${N}s, should have been closer to ${v}s`);const S=j-v;p-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,j,p):p-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,j,p);const{data:_,error:D}=await this._getUser(u);if(D)throw D;const M={provider_token:i,provider_refresh_token:c,access_token:u,expires_in:v,expires_at:j,refresh_token:h,token_type:x,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:M,redirectType:a.type},error:null}}catch(i){if(Se(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const n=await Ga(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&n)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:c,error:u}=n;if(u)return{error:u};const h=(i=c.session)===null||i===void 0?void 0:i.access_token;if(h){const{error:g}=await this.admin.signOut(h,a);if(g&&!(wj(g)&&(g.status===404||g.status===401||g.status===403)))return{error:g}}return a!=="others"&&(await this._removeSession(),await ma(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(a){const n=Mj(),i={id:n,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(a){return await this._useSession(async n=>{var i,c;try{const{data:{session:u},error:h}=n;if(h)throw h;await((i=this.stateChangeEmitters.get(a))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",u)),this._debug("INITIAL_SESSION","callback id",a,"session",u)}catch(u){await((c=this.stateChangeEmitters.get(a))===null||c===void 0?void 0:c.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",u),console.error(u)}})}async resetPasswordForEmail(a,n={}){let i=null,c=null;this.flowType==="pkce"&&([i,c]=await Qr(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:i,code_challenge_method:c,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(u){if(Se(u))return{data:null,error:u};throw u}}async getUserIdentities(){var a;try{const{data:n,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(a=n.user.identities)!==null&&a!==void 0?a:[]},error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}}async linkIdentity(a){var n;try{const{data:i,error:c}=await this._useSession(async u=>{var h,g,m,x,p;const{data:v,error:j}=u;if(j)throw j;const N=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(h=a.options)===null||h===void 0?void 0:h.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(m=a.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",N,{headers:this.headers,jwt:(p=(x=v.session)===null||x===void 0?void 0:x.access_token)!==null&&p!==void 0?p:void 0})});if(c)throw c;return rs()&&!(!((n=a.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(i?.url),{data:{provider:a.provider,url:i?.url},error:null}}catch(i){if(Se(i))return{data:{provider:a.provider,url:null},error:i};throw i}}async unlinkIdentity(a){try{return await this._useSession(async n=>{var i,c;const{data:u,error:h}=n;if(h)throw h;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(c=(i=u.session)===null||i===void 0?void 0:i.access_token)!==null&&c!==void 0?c:void 0})})}catch(n){if(Se(n))return{data:null,error:n};throw n}}async _refreshAccessToken(a){const n=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await Lj(async c=>(c>0&&await Uj(200*Math.pow(2,c-1)),this._debug(n,"refreshing attempt",c),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:Hs})),(c,u)=>{const h=200*Math.pow(2,c);return u&&Pu(u)&&Date.now()+h-i<Zr})}catch(i){if(this._debug(n,"error",i),Se(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,n){const i=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",n,"url",i),rs()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:a,url:i},error:null}}async _recoverAndRefresh(){var a,n;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const c=await Ga(this.storage,this.storageKey);if(c&&this.userStorage){let h=await Ga(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:c.user},await Jr(this.userStorage,this.storageKey+"-user",h)),c.user=(a=h?.user)!==null&&a!==void 0?a:Gu()}else if(c&&!c.user&&!c.user){const h=await Ga(this.storage,this.storageKey+"-user");h&&h?.user?(c.user=h.user,await ma(this.storage,this.storageKey+"-user"),await Jr(this.storage,this.storageKey,c)):c.user=Gu()}if(this._debug(i,"session from storage",c),!this._isValidSession(c)){this._debug(i,"session is not valid"),c!==null&&await this._removeSession();return}const u=((n=c.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<$u;if(this._debug(i,`session has${u?"":" not"} expired with margin of ${$u}s`),u){if(this.autoRefreshToken&&c.refresh_token){const{error:h}=await this._callRefreshToken(c.refresh_token);h&&(console.error(h),Pu(h)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(c.user&&c.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:g}=await this._getUser(c.access_token);!g&&h?.user?(c.user=h.user,await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(i,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",c)}catch(c){this._debug(i,"error",c),console.error(c);return}finally{this._debug(i,"end")}}async _callRefreshToken(a){var n,i;if(!a)throw new ga;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const c=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(c,"begin");try{this.refreshingDeferred=new xo;const{data:u,error:h}=await this._refreshAccessToken(a);if(h)throw h;if(!u.session)throw new ga;await this._saveSession(u.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",u.session);const g={session:u.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(u){if(this._debug(c,"error",u),Se(u)){const h={session:null,error:u};return Pu(u)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(h),h}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(u),u}finally{this.refreshingDeferred=null,this._debug(c,"end")}}async _notifyAllSubscribers(a,n,i=!0){const c=`#_notifyAllSubscribers(${a})`;this._debug(c,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:a,session:n});const u=[],h=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,n)}catch(m){u.push(m)}});if(await Promise.all(h),u.length>0){for(let g=0;g<u.length;g+=1)console.error(u[g]);throw u[0]}}finally{this._debug(c,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const n=Object.assign({},a),i=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&n.user&&await Jr(this.userStorage,this.storageKey+"-user",{user:n.user});const c=Object.assign({},n);delete c.user;const u=mg(c);await Jr(this.storage,this.storageKey,u)}else{const c=mg(n);await Jr(this.storage,this.storageKey,c)}}async _removeSession(){this._debug("#_removeSession()"),await ma(this.storage,this.storageKey),await ma(this.storage,this.storageKey+"-code-verifier"),await ma(this.storage,this.storageKey+"-user"),this.userStorage&&await ma(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&rs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),Zr);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const c=Math.floor((i.expires_at*1e3-a)/Zr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${c} ticks, a tick lasts ${Zr}ms, refresh threshold is ${id} ticks`),c<=id&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof _x)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!rs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const n=`#_onVisibilityChanged(${a})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,n,i){const c=[`provider=${encodeURIComponent(n)}`];if(i?.redirectTo&&c.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&c.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[u,h]=await Qr(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(u)}`,code_challenge_method:`${encodeURIComponent(h)}`});c.push(g.toString())}if(i?.queryParams){const u=new URLSearchParams(i.queryParams);c.push(u.toString())}return i?.skipBrowserRedirect&&c.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${a}?${c.join("&")}`}async _unenroll(a){try{return await this._useSession(async n=>{var i;const{data:c,error:u}=n;return u?{data:null,error:u}:await Me(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(i=c?.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(Se(n))return{data:null,error:n};throw n}}async _enroll(a){try{return await this._useSession(async n=>{var i,c;const{data:u,error:h}=n;if(h)return{data:null,error:h};const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:{issuer:a.issuer}),{data:m,error:x}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(i=u?.session)===null||i===void 0?void 0:i.access_token});return x?{data:null,error:x}:(a.factorType==="totp"&&(!((c=m?.totp)===null||c===void 0)&&c.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(n){if(Se(n))return{data:null,error:n};throw n}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:c,error:u}=n;if(u)return{data:null,error:u};const{data:h,error:g}=await Me(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:{code:a.code,challenge_id:a.challengeId},headers:this.headers,jwt:(i=c?.session)===null||i===void 0?void 0:i.access_token});return g?{data:null,error:g}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+h.expires_in},h)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",h),{data:h,error:g})})}catch(n){if(Se(n))return{data:null,error:n};throw n}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:c,error:u}=n;return u?{data:null,error:u}:await Me(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:{channel:a.channel},headers:this.headers,jwt:(i=c?.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(Se(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(a){const{data:n,error:i}=await this._challenge({factorId:a.factorId});return i?{data:null,error:i}:await this._verify({factorId:a.factorId,challengeId:n.id,code:a.code})}async _listFactors(){const{data:{user:a},error:n}=await this.getUser();if(n)return{data:null,error:n};const i=a?.factors||[],c=i.filter(h=>h.factor_type==="totp"&&h.status==="verified"),u=i.filter(h=>h.factor_type==="phone"&&h.status==="verified");return{data:{all:i,totp:c,phone:u},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async a=>{var n,i;const{data:{session:c},error:u}=a;if(u)return{data:null,error:u};if(!c)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=Ku(c.access_token);let g=null;h.aal&&(g=h.aal);let m=g;((i=(n=c.user.factors)===null||n===void 0?void 0:n.filter(v=>v.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(m="aal2");const p=h.amr||[];return{data:{currentLevel:g,nextLevel:m,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(a,n={keys:[]}){let i=n.keys.find(g=>g.kid===a);if(i)return i;const c=Date.now();if(i=this.jwks.keys.find(g=>g.kid===a),i&&this.jwks_cached_at+vj>c)return i;const{data:u,error:h}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!u.keys||u.keys.length===0||(this.jwks=u,this.jwks_cached_at=c,i=u.keys.find(g=>g.kid===a),!i)?null:i}async getClaims(a,n={}){try{let i=a;if(!i){const{data:N,error:S}=await this.getSession();if(S||!N.session)return{data:null,error:S};i=N.session.access_token}const{header:c,payload:u,signature:h,raw:{header:g,payload:m}}=Ku(i);n?.allowExpired||Kj(u.exp);const x=!c.alg||c.alg.startsWith("HS")||!c.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(c.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!x){const{error:N}=await this.getUser(i);if(N)throw N;return{data:{claims:u,header:c,signature:h},error:null}}const p=Gj(c.alg),v=await crypto.subtle.importKey("jwk",x,p,!0,["verify"]);if(!await crypto.subtle.verify(p,v,h,Cj(`${g}.${m}`)))throw new ud("Invalid JWT signature");return{data:{claims:u,header:c,signature:h},error:null}}catch(i){if(Se(i))return{data:null,error:i};throw i}}}wl.nextInstanceID=0;const lN=wl;class iN extends lN{constructor(a){super(a)}}var oN=function(l,a,n,i){function c(u){return u instanceof n?u:new n(function(h){h(u)})}return new(n||(n=Promise))(function(u,h){function g(p){try{x(i.next(p))}catch(v){h(v)}}function m(p){try{x(i.throw(p))}catch(v){h(v)}}function x(p){p.done?u(p.value):c(p.value).then(g,m)}x((i=i.apply(l,a||[])).next())})};class cN{constructor(a,n,i){var c,u,h;if(this.supabaseUrl=a,this.supabaseKey=n,!a)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const g=fj(a),m=new URL(g);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const x=`sb-${m.hostname.split(".")[0]}-auth-token`,p={db:nj,realtime:ij,auth:Object.assign(Object.assign({},lj),{storageKey:x}),global:rj},v=mj(i??{},p);this.storageKey=(c=v.auth.storageKey)!==null&&c!==void 0?c:"",this.headers=(u=v.global.headers)!==null&&u!==void 0?u:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(j,N)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(N)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=v.auth)!==null&&h!==void 0?h:{},this.headers,v.global.fetch),this.fetch=dj(n,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new Tw(new URL("rest/v1",m).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),v.accessToken||this._listenForAuthEvents()}get functions(){return new gw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new tj(this.storageUrl.href,this.headers,this.fetch)}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,n={},i={}){return this.rest.rpc(a,n,i)}channel(a,n={config:{}}){return this.realtime.channel(a,n)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var a,n;return oN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(n=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:n,detectSessionInUrl:i,storage:c,storageKey:u,flowType:h,lock:g,debug:m},x,p){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new iN({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),x),storageKey:u,autoRefreshToken:a,persistSession:n,detectSessionInUrl:i,storage:c,flowType:h,lock:g,debug:m,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(a){return new Pw(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i?.access_token)})}_handleTokenChanged(a,n,i){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:a==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const kx=(l,a,n)=>new cN(l,a,n),uN="https://fnakxavwxubnbucfoujd.supabase.co",dN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZuYWt4YXZ3eHVibmJ1Y2ZvdWpkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA1ODY2NjEsImV4cCI6MjA2NjE2MjY2MX0.Gj4RYtx-fnTHHoLe71mGvhVze5NgWy25PME4OVle22M",se=kx(uN,dN,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});class hN{constructor(){this.currentUserId=null}async setUserContext(a){try{this.currentUserId=a;const{error:n}=await se.rpc("set_user_context",{user_uuid:a});if(n)throw console.error("❌ Failed to set user context:",n),new Error("Failed to set user authentication context");console.log("✅ User context set successfully:",a)}catch(n){throw console.error("❌ Error setting user context:",n),n}}async clearUserContext(){try{this.currentUserId=null;const{error:a}=await se.rpc("set_user_context",{user_uuid:null});a&&console.warn("⚠️ Failed to clear user context:",a),console.log("✅ User context cleared")}catch(a){console.error("❌ Error clearing user context:",a)}}getCurrentUserId(){return this.currentUserId}async initializeFromStorage(){try{const a=localStorage.getItem("currentUserId");a&&await this.setUserContext(a)}catch(a){console.error("❌ Error initializing user context from storage:",a)}}async verifyUserContext(){try{const{data:a,error:n}=await se.from("tasks").select("id").limit(1);return n?(console.error("❌ User context verification failed:",n),!1):(console.log("✅ User context verified successfully"),!0)}catch(a){return console.error("❌ Error verifying user context:",a),!1}}getAuthenticatedClient(){if(!this.currentUserId)throw new Error("User context not set. Please login first.");return se}}const xl=new hN,fN=async l=>{if(!xl.getCurrentUserId()&&(await xl.initializeFromStorage(),!xl.getCurrentUserId()))throw new Error("User not authenticated. Please login again.");return await l()};class mN{async getUsers(){const{data:a,error:n}=await se.from("users").select("*").order("name");if(n)throw new Error(`Failed to fetch users: ${n.message}`);if(!a||a.length===0)return[];const i=[...new Set(a.map(u=>u.team_id))].filter(Boolean);let c=new Map;if(i.length>0){const{data:u}=await se.from("teams").select("id, name").in("id",i);u&&u.forEach(h=>c.set(h.id,h))}return a.map(u=>({...u,team:u.team_id&&c.get(u.team_id)||null}))}async getUsersByLocation(a){const{data:n,error:i}=await se.from("users").select(`
        *,
        team:teams(id, name)
      `).eq("location",a).order("name");if(i)throw new Error(`Failed to fetch users by location: ${i.message}`);return n||[]}async getUsersByTeamAndLocation(a,n){const{data:i,error:c}=await se.from("users").select("*").eq("team_id",a).eq("location",n).order("name");if(c)throw new Error(`Failed to fetch users by team and location: ${c.message}`);if(!i||i.length===0)return[];const{data:u,error:h}=await se.from("teams").select("id, name").eq("id",a).single();return h&&console.warn("Could not fetch team info:",h.message),i.map(g=>({...g,team:u||null}))}async getDirectors(){const{data:a,error:n}=await se.from("users").select("*").eq("role","retail_director").order("name");if(n)return console.error("Error fetching directors:",n),[];if(!a||a.length===0)return[];const i=[...new Set(a.map(u=>u.team_id))].filter(Boolean);let c=new Map;if(i.length>0){const{data:u}=await se.from("teams").select("id, name").in("id",i);u&&u.forEach(h=>c.set(h.id,h))}return a.map(u=>({...u,team:u.team_id&&c.get(u.team_id)||null}))}async getDirector(){const a=await this.getDirectors();return a.length>0?a[0]:null}async login(a){const{email:n,password:i}=a,{data:c,error:u}=await se.from("users").select("*").eq("email",n).single();if(u||!c)throw new Error("Email không tồn tại trong hệ thống");let h=!1;if(c.password_changed?h=i===c.password:h=i==="123456",!h)throw new Error("Mật khẩu không đúng");let g=null;if(c.team_id){const{data:x}=await se.from("teams").select("id, name").eq("id",c.team_id).single();g=x}await se.from("users").update({updated_at:new Date().toISOString()}).eq("id",c.id),localStorage.setItem("currentUserId",c.id),localStorage.setItem("currentUserEmail",c.email),localStorage.setItem("currentUserName",c.name),await xl.setUserContext(c.id);const m={...c,team:g};return localStorage.setItem("auth_user",JSON.stringify(m)),{...c,team:g}}async changePassword(a){const{email:n,currentPassword:i,newPassword:c}=a,{data:u,error:h}=await se.from("users").select("*").eq("email",n).single();if(h||!u)throw new Error("Người dùng không tồn tại");let g=!1;if(u.password_changed?g=i===u.password:g=i==="123456",!g)throw new Error("Mật khẩu hiện tại không đúng");const{error:m}=await se.from("users").update({password:c,password_changed:!0,updated_at:new Date().toISOString()}).eq("id",u.id);if(m)throw new Error(`Failed to update password: ${m.message}`)}async logout(){try{await xl.clearUserContext(),localStorage.removeItem("currentUserId"),localStorage.removeItem("currentUserEmail"),localStorage.removeItem("currentUserName"),localStorage.removeItem("auth_user"),console.log("✅ User logged out successfully")}catch(a){console.error("❌ Error during logout:",a)}}async getUserByEmail(a){const{data:n,error:i}=await se.from("users").select("*").eq("email",a).single();if(i||!n)return null;let c=null;if(n.team_id){const{data:u}=await se.from("teams").select("id, name").eq("id",n.team_id).single();c=u}return{...n,team:c}}async needsPasswordChange(a){return!(await this.getUserByEmail(a))?.password_changed||!1}async getTeams(){const{data:a,error:n}=await se.from("teams").select("*").order("name");if(n)throw new Error(`Failed to fetch teams: ${n.message}`);return a||[]}async getTeamsByLocation(a){const{data:n,error:i}=await se.from("users").select("team_id, name, role").eq("location",a);if(i)throw new Error(`Failed to fetch users by location: ${i.message}`);if(!n||n.length===0)return[];const c=[...new Set(n.map(m=>m.team_id))].filter(Boolean);if(c.length===0)return[];const{data:u,error:h}=await se.from("teams").select("id, name").in("id",c).order("name");if(h)throw new Error(`Failed to fetch teams: ${h.message}`);return u?u.map(m=>{const x=n.find(p=>p.team_id===m.id&&p.role==="team_leader");return{...m,leader_name:x?.name||null}}):[]}}const ys=new mN,gN={user:null,isAuthenticated:!1,isLoading:!0,error:null};function xN(l,a){switch(a.type){case"LOGIN_START":return{...l,isLoading:!0,error:null};case"LOGIN_SUCCESS":return{...l,user:a.payload,isAuthenticated:!0,isLoading:!1,error:null};case"LOGIN_ERROR":return{...l,user:null,isAuthenticated:!1,isLoading:!1,error:a.payload};case"LOGOUT":return{...l,user:null,isAuthenticated:!1,isLoading:!1,error:null};case"CLEAR_ERROR":return{...l,error:null};case"SET_LOADING":return{...l,isLoading:a.payload};default:return l}}const Tx=b.createContext(void 0);function pN({children:l}){const[a,n]=b.useReducer(xN,gN);b.useEffect(()=>{(()=>{const v=localStorage.getItem("auth_user");if(v)try{const j=JSON.parse(v);n({type:"LOGIN_SUCCESS",payload:j});return}catch{localStorage.removeItem("auth_user")}n({type:"SET_LOADING",payload:!1})})()},[]);const x={...a,login:async(p,v)=>{n({type:"LOGIN_START"});try{const j=await ys.login({email:p,password:v});localStorage.setItem("auth_user",JSON.stringify(j)),localStorage.setItem("currentUserId",j.id),n({type:"LOGIN_SUCCESS",payload:j})}catch(j){throw n({type:"LOGIN_ERROR",payload:j instanceof Error?j.message:"Đăng nhập thất bại"}),j}},logout:async()=>{try{await ys.logout(),n({type:"LOGOUT"})}catch(p){console.error("Error during logout:",p),n({type:"LOGOUT"})}},clearError:()=>{n({type:"CLEAR_ERROR"})},getUsers:async()=>await ys.getUsers(),needsPasswordChange:async p=>await ys.needsPasswordChange(p),changePassword:async(p,v,j)=>{await ys.changePassword({email:p,currentPassword:v,newPassword:j})}};return s.jsx(Tx.Provider,{value:x,children:l})}function ln(){const l=b.useContext(Tx);if(l===void 0)throw new Error("useAuth must be used within an AuthProvider");return l}const yN=b.createContext(void 0);function vN({children:l,defaultTheme:a="system"}){const[n,i]=b.useState(a),[c,u]=b.useState("light");b.useEffect(()=>{const g=window.document.documentElement,m=()=>{if(n==="system"){const x=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";u(x),g.classList.toggle("dark",x==="dark")}else u(n),g.classList.toggle("dark",n==="dark")};if(m(),n==="system"){const x=window.matchMedia("(prefers-color-scheme: dark)");return x.addEventListener("change",m),()=>x.removeEventListener("change",m)}},[n]);const h={theme:n,setTheme:i,actualTheme:c};return s.jsx(yN.Provider,{value:h,children:l})}class bN extends b.Component{constructor(a){super(a),this.state={hasError:!1}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,n){console.error("ErrorBoundary caught an error:",a,n)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h1",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Đã xảy ra lỗi"}),s.jsx("p",{className:"text-gray-600 text-center mb-6",children:"Xin lỗi, đã có lỗi xảy ra. Vui lòng thử lại sau."}),!1,s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>window.location.reload(),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Tải lại trang"}),s.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-300 transition-colors",children:"Thử lại"})]})]})}):this.props.children}}function xs({children:l,requireAuth:a=!0}){const{isAuthenticated:n,isLoading:i}=ln(),c=bs();if(i)return s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(a&&!n)return s.jsx(fl,{to:"/auth/login",state:{from:c},replace:!0});if(!a&&n){const u=c.state?.from?.pathname||"/dashboard";return s.jsx(fl,{to:u,replace:!0})}return s.jsx(s.Fragment,{children:l})}function wN(){const[l,a]=b.useState(""),[n,i]=b.useState(!1),[c,u]=b.useState(!1),h=ws(),[g]=fo(),m=g.get("email")||"",x=g.get("name")||"",{login:p}=ln(),v=async _=>{_.preventDefault(),u(!0);try{await p(m,l);const D=await ys.needsPasswordChange(m);h(D?`/auth/change-password?email=${encodeURIComponent(m)}&name=${encodeURIComponent(x)}`:"/dashboard")}catch(D){console.error("Lỗi đăng nhập:",D),alert("Đăng nhập thất bại. Vui lòng thử lại.")}finally{u(!1)}},j=()=>{h(-1)},N=()=>{h("/auth/forgot-password")},S=()=>{alert("Các tùy chọn khác sẽ được triển khai sau")};return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx("header",{className:"p-6"}),s.jsx("main",{className:"flex-1 flex items-center justify-center px-6",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsx("div",{className:"text-center mb-8",children:s.jsxs("h1",{className:"text-2xl font-medium text-gray-900 mb-2",children:["Chào mừng trở lại, ",x,"."]})}),s.jsxs("form",{onSubmit:v,className:"space-y-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:n?"text":"password",value:l,onChange:_=>a(_.target.value),placeholder:"••••••••••",className:"w-full px-4 py-4 text-lg border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 ease-in-out pr-12",required:!0}),s.jsx("button",{type:"button",onClick:()=>i(!n),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:n?s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):s.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("button",{type:"button",onClick:N,className:"text-sm text-gray-600 hover:text-gray-800 underline",children:"Tôi quên mật khẩu"}),s.jsx("button",{type:"button",onClick:S,className:"block text-sm text-gray-600 hover:text-gray-800 underline",children:"Tùy chọn khác"})]}),s.jsxs("div",{className:"flex items-center justify-between pt-6",children:[s.jsx("button",{type:"button",onClick:j,className:"p-3 rounded-full hover:bg-gray-100 transition-colors duration-200",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),s.jsx("button",{type:"submit",disabled:!l||c,className:"bg-black text-white py-3 px-8 rounded-full font-medium hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 ease-in-out transform hover:scale-[1.02] active:scale-[0.98]",children:c?s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Đang xử lý..."]}):"Tiếp tục →"})]})]})]})}),s.jsx("footer",{className:"p-6"})]})}function jN(){const[l,a]=b.useState([]),[n,i]=b.useState(!0),[c,u]=b.useState(null),[h,g]=b.useState(null),[m,x]=b.useState(!1),p=ws(),[v]=fo(),j=v.get("location")||"",N=v.get("teamId")||"";b.useEffect(()=>{j&&N&&(async()=>{try{i(!0);const H=(await ys.getUsersByTeamAndLocation(N,j)).sort((R,Z)=>R.role==="team_leader"&&Z.role!=="team_leader"?-1:R.role!=="team_leader"&&Z.role==="team_leader"?1:R.name.localeCompare(Z.name));a(H)}catch(q){u(q instanceof Error?q.message:"Không thể tải danh sách thành viên")}finally{i(!1)}})()},[j,N]);const S=G=>{if(m)return;const q=l.find(H=>H.email===G);q&&(g(G),x(!0),setTimeout(()=>{p(`/auth/password?email=${encodeURIComponent(G)}&name=${encodeURIComponent(q.name)}`)},600))},_=()=>{p(`/auth/team-selection?location=${encodeURIComponent(j)}`)},D=G=>{switch(G){case"team_leader":return"Trưởng nhóm";case"employee":return"Nhân viên";default:return"Nhân viên"}};if(n)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-600 border-t-transparent mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Đang tải danh sách thành viên..."})]})});if(c)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md",children:[s.jsx("div",{className:"bg-red-100 rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Lỗi kết nối"}),s.jsx("p",{className:"text-gray-600 mb-4",children:c}),s.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Thử lại"})]})});const M=l[0]?.team?.name||"Nhóm",E=l.find(G=>G.role==="team_leader"),A=E?E.name:M;return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx("header",{className:"p-6",children:s.jsxs("button",{onClick:_,className:"inline-flex items-center text-gray-700 hover:text-gray-900 transition-colors duration-200",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Quay lại"]})}),s.jsx("main",{className:"flex-1 flex items-center justify-center px-6",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-2xl font-medium text-gray-900 mb-2",children:A}),s.jsxs("p",{className:"text-gray-600",children:[j," • Chọn tài khoản của bạn"]})]}),l.length>0?s.jsx("div",{className:"space-y-3",children:l.map((G,q)=>s.jsx("button",{className:`
                    w-full p-4 text-left bg-white border border-gray-200 rounded-lg
                    hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 ease-in-out
                    transform hover:scale-[1.02] active:scale-[0.98]
                    ${h===G.email?"border-blue-500 bg-blue-50 scale-[1.02]":""}
                    ${m&&h!==G.email?"opacity-50":""}
                  `,style:{animationDelay:`${q*100}ms`},onClick:()=>S(G.email),disabled:m,children:s.jsxs("div",{className:"flex items-center",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 truncate",children:G.name}),s.jsx("p",{className:"text-sm text-gray-500 truncate",children:G.email}),s.jsx("div",{className:"flex items-center mt-1 text-xs",children:s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${G.role==="team_leader"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:D(G.role)})})]}),s.jsx("div",{className:`
                      flex-shrink-0 text-gray-400 transition-all duration-200
                      ${h===G.email?"text-blue-600 transform rotate-90":"group-hover:text-blue-600"}
                    `,children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},G.id))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-4xl mb-4",children:"😔"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Không tìm thấy thành viên nào"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Hiện tại chưa có thành viên nào trong nhóm này"})]}),m&&s.jsx("div",{className:"mt-6 text-center",children:s.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent mr-2"}),s.jsx("span",{className:"text-gray-700 text-sm",children:"Đang chuyển hướng..."})]})})]})}),s.jsx("footer",{className:"p-6"})]})}function NN(){const[l,a]=b.useState(null),[n,i]=b.useState(!1),c=ws(),u=[{id:"director",name:"Trưởng Phòng",description:"Khổng Đức Mạnh"},{id:"hanoi",name:"Hà Nội",description:"Khu vực miền Bắc"},{id:"hcm",name:"Hồ Chí Minh",description:"Khu vực miền Nam"}],h=g=>{n||(a(g),i(!0),setTimeout(()=>{switch(g){case"director":c("/auth/director-login");break;case"hanoi":c("/auth/team-selection?location=Hà Nội");break;case"hcm":c("/auth/team-selection?location=Hồ Chí Minh");break}},600))};return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx("header",{className:"p-6"}),s.jsx("main",{className:"flex-1 flex items-center justify-center px-6",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8 animate-fade-in",children:[s.jsx("h1",{className:"text-2xl font-medium text-gray-900 mb-2 animate-slide-down",children:"Chọn khu vực của bạn"}),s.jsx("p",{className:"text-gray-600 animate-fade-in animate-stagger-1",children:"Vui lòng chọn khu vực để tiếp tục"})]}),s.jsx("div",{className:"space-y-4",children:u.map((g,m)=>s.jsx("button",{className:`
                  w-full p-6 text-left bg-white border border-gray-200 rounded-lg
                  interactive-scale interactive-lift
                  hover:border-blue-300 hover:bg-blue-50
                  transition-all-smooth focus-ring
                  animate-slide-up
                  ${l===g.id?"border-blue-500 bg-blue-50 scale-[1.02] shadow-lg":"shadow-sm"}
                  ${n&&l!==g.id?"opacity-30 scale-95":""}
                  ${n&&l===g.id?"border-blue-600 bg-blue-100":""}
                `,style:{animationDelay:`${m*150}ms`},onClick:()=>h(g.id),disabled:n,children:s.jsxs("div",{className:"flex items-center relative",children:[s.jsxs("div",{className:"flex-1 transition-transform-smooth",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1 transition-colors-smooth",children:g.name}),s.jsx("p",{className:"text-sm text-gray-500 transition-colors-smooth",children:g.description})]}),s.jsx("div",{className:`
                    text-gray-400 transition-all-smooth
                    ${l===g.id?"text-blue-600 transform rotate-90 scale-110":"group-hover:text-blue-600 group-hover:translate-x-1"}
                  `,children:s.jsx("svg",{className:"w-5 h-5 transition-transform-smooth",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},g.id))}),n&&s.jsx("div",{className:"mt-8 text-center animate-scale-bounce",children:s.jsxs("div",{className:"inline-flex items-center px-6 py-3 bg-white rounded-xl shadow-lg border border-gray-200",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent mr-3"}),s.jsx("span",{className:"text-gray-700 font-medium",children:"Đang chuyển hướng..."})]})})]})}),s.jsx("footer",{className:"p-6"})]})}function SN(){const[l,a]=b.useState(""),[n,i]=b.useState(!1),[c,u]=b.useState(!1),[h,g]=b.useState([]),[m,x]=b.useState(null),[p,v]=b.useState(!0),j=ws(),{login:N}=ln();b.useEffect(()=>{(async()=>{try{const A=await ys.getDirectors();g(A),A.length===1&&(x(A[0]),v(!1))}catch(A){console.error("Failed to load directors:",A)}})()},[]);const S=E=>{x(E),v(!1)},_=()=>{x(null),v(!0),a("")},D=async E=>{if(E.preventDefault(),!!m){u(!0);try{await N(m.email,l);const A=await ys.needsPasswordChange(m.email);j(A?`/auth/change-password?email=${encodeURIComponent(m.email)}&name=${encodeURIComponent(m.name)}`:"/dashboard")}catch(A){console.error("Login failed:",A),alert(A instanceof Error?A.message:"Đăng nhập thất bại")}finally{u(!1)}}},M=()=>{j("/")};return h.length===0?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-600 border-t-transparent mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Đang tải thông tin..."})]})}):p&&h.length>1?s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx("header",{className:"p-6",children:s.jsxs("button",{onClick:M,className:"inline-flex items-center text-gray-700 hover:text-gray-900 transition-colors duration-200",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Quay lại"]})}),s.jsx("main",{className:"flex-1 flex items-center justify-center px-6",children:s.jsxs("div",{className:"w-full max-w-2xl",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-medium text-gray-900 mb-4",children:"Chọn Trưởng Phòng Kinh Doanh"}),s.jsx("p",{className:"text-gray-600",children:"Vui lòng chọn tài khoản để đăng nhập"})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:h.map(E=>s.jsx("button",{onClick:()=>S(E),className:"bg-white rounded-xl shadow-lg p-6 border border-gray-200 hover:shadow-xl hover:border-blue-300 transition-all duration-200 text-left group",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-medium text-lg",children:E.name.charAt(0)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 group-hover:text-blue-600 transition-colors",children:E.name}),s.jsx("p",{className:"text-sm text-gray-600",children:E.email}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[E.department_type," • ",E.location]})]}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},E.id))})]})}),s.jsx("footer",{className:"p-6"})]}):s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx("header",{className:"p-6",children:s.jsxs("button",{onClick:h.length>1?_:M,className:"inline-flex items-center text-gray-700 hover:text-gray-900 transition-colors duration-200",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),h.length>1?"Chọn lại":"Quay lại"]})}),s.jsx("main",{className:"flex-1 flex items-center justify-center px-6",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-8 mb-8 border border-gray-200 animate-scale-in interactive-lift",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-2xl font-medium text-gray-900 mb-6 animate-fade-in",children:"Retail Director"}),s.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 animate-slide-up animate-stagger-1",children:[s.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-2 animate-fade-in animate-stagger-2",children:m.name}),s.jsx("p",{className:"text-gray-600 text-sm animate-fade-in animate-stagger-3",children:m.email}),s.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:[m.department_type," • ",m.location]})]})]}),s.jsxs("form",{onSubmit:D,className:"space-y-6 animate-slide-up animate-stagger-2",children:[s.jsxs("div",{className:"relative animate-fade-in animate-stagger-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu"}),s.jsx("input",{type:n?"text":"password",value:l,onChange:E=>a(E.target.value),placeholder:"Nhập mật khẩu của bạn",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all-smooth interactive-scale pr-12",required:!0}),s.jsx("button",{type:"button",onClick:()=>i(!n),className:"absolute right-4 top-11 text-gray-500 hover:text-gray-700 transition-all-smooth interactive-scale p-1 rounded-md hover:bg-gray-100",children:n?s.jsx("svg",{className:"w-5 h-5 transition-transform-smooth",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):s.jsxs("svg",{className:"w-5 h-5 transition-transform-smooth",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),s.jsx("button",{type:"submit",disabled:!l||c,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 px-6 rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all-smooth interactive-scale focus-ring animate-fade-in animate-stagger-4",children:c?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-3"}),s.jsx("span",{children:"Đang xác thực..."})]}):s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("span",{children:"Đăng nhập"}),s.jsx("svg",{className:"w-5 h-5 ml-2 transition-transform-smooth group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]})})}),s.jsx("footer",{className:"p-6"})]})}function _N(){const[l,a]=b.useState([]),[n,i]=b.useState(!0),[c,u]=b.useState(null),[h,g]=b.useState(!1),m=ws(),[x]=fo(),p=x.get("location")||"";b.useEffect(()=>{p&&(async()=>{try{i(!0);const _=(await ys.getTeamsByLocation(p)).sort((D,M)=>{const E=q=>{const H=q.match(/\d+/);return H?parseInt(H[0]):0},A=E(D.name),G=E(M.name);return A&&G?A-G:D.name.localeCompare(M.name)});a(_)}catch(S){console.error("Failed to load teams:",S)}finally{i(!1)}})()},[p]);const v=N=>{h||(u(N),g(!0),setTimeout(()=>{m(`/auth/user-selection?location=${encodeURIComponent(p)}&teamId=${N}`)},600))},j=()=>{m("/")};return n?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-600 border-t-transparent mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Đang tải danh sách nhóm..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx("header",{className:"p-6",children:s.jsxs("button",{onClick:j,className:"inline-flex items-center text-gray-700 hover:text-gray-900 transition-colors duration-200",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Quay lại"]})}),s.jsx("main",{className:"flex-1 flex items-center justify-center px-6",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8 animate-fade-in",children:[s.jsxs("h1",{className:"text-2xl font-medium text-gray-900 mb-2 animate-slide-down",children:["Khu vực ",p]}),s.jsx("p",{className:"text-gray-600 animate-fade-in animate-stagger-1",children:"Chọn nhóm của bạn"})]}),l.length>0?s.jsx("div",{className:"space-y-4",children:l.map((N,S)=>s.jsx("button",{className:`
                    w-full p-6 text-left bg-white border border-gray-200 rounded-lg
                    interactive-scale interactive-lift
                    hover:border-blue-300 hover:bg-blue-50
                    transition-all-smooth focus-ring
                    animate-slide-up
                    ${c===N.id?"border-blue-500 bg-blue-50 scale-[1.02] shadow-lg":"shadow-sm"}
                    ${h&&c!==N.id?"opacity-30 scale-95":""}
                    ${h&&c===N.id?"border-blue-600 bg-blue-100":""}
                  `,style:{animationDelay:`${S*150}ms`},onClick:()=>v(N.id),disabled:h,children:s.jsxs("div",{className:"flex items-center relative",children:[s.jsxs("div",{className:"flex-1 transition-transform-smooth",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1 transition-colors-smooth",children:N.name}),s.jsx("p",{className:"text-sm text-gray-500 transition-colors-smooth",children:p})]}),s.jsx("div",{className:`
                      text-gray-400 transition-all-smooth
                      ${c===N.id?"text-blue-600 transform rotate-90 scale-110":"group-hover:text-blue-600 group-hover:translate-x-1"}
                    `,children:s.jsx("svg",{className:"w-5 h-5 transition-transform-smooth",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},N.id))}):s.jsxs("div",{className:"text-center py-12 animate-fade-in",children:[s.jsx("div",{className:"text-gray-400 mb-4 animate-float",children:s.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Không tìm thấy nhóm nào"}),s.jsxs("p",{className:"text-gray-600 text-sm",children:["Hiện tại chưa có nhóm nào tại khu vực ",p]})]}),h&&s.jsx("div",{className:"mt-6 text-center",children:s.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent mr-2"}),s.jsx("span",{className:"text-gray-700 text-sm",children:"Đang chuyển hướng..."})]})})]})}),s.jsx("footer",{className:"p-6"})]})}function kN(){const[l,a]=b.useState(""),[n,i]=b.useState(""),[c,u]=b.useState(""),[h,g]=b.useState(!1),[m,x]=b.useState(!1),p=ws(),[v]=fo(),j=v.get("email")||"",N=v.get("name")||"",{changePassword:S}=ln(),_=async D=>{if(D.preventDefault(),n!==c){alert("Mật khẩu mới và xác nhận mật khẩu không khớp");return}if(n.length<6){alert("Mật khẩu mới phải có ít nhất 6 ký tự");return}x(!0);try{await S(j,l,n),alert("Đổi mật khẩu thành công!"),p("/dashboard")}catch(M){console.error("Change password failed:",M),alert(M instanceof Error?M.message:"Đổi mật khẩu thất bại")}finally{x(!1)}};return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[s.jsx("header",{className:"p-6"}),s.jsx("main",{className:"flex-1 flex items-center justify-center px-6",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 border border-gray-200",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-2xl font-medium text-gray-900 mb-2",children:"Đổi mật khẩu lần đầu"}),s.jsxs("h2",{className:"text-lg font-medium text-gray-900 mb-2",children:["Chào ",N,"!"]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Vui lòng đổi mật khẩu để bảo mật tài khoản"})]}),s.jsxs("form",{onSubmit:_,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu hiện tại"}),s.jsx("div",{className:"relative",children:s.jsx("input",{type:h?"text":"password",value:l,onChange:D=>a(D.target.value),placeholder:"Nhập mật khẩu hiện tại",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu mới"}),s.jsx("div",{className:"relative",children:s.jsx("input",{type:h?"text":"password",value:n,onChange:D=>i(D.target.value),placeholder:"Nhập mật khẩu mới (tối thiểu 6 ký tự)",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0,minLength:6})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Xác nhận mật khẩu mới"}),s.jsx("div",{className:"relative",children:s.jsx("input",{type:h?"text":"password",value:c,onChange:D=>u(D.target.value),placeholder:"Nhập lại mật khẩu mới",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0})})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"showPasswords",checked:h,onChange:D=>g(D.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"showPasswords",className:"ml-2 block text-sm text-gray-700",children:"Hiển thị mật khẩu"})]}),n&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"text-sm text-gray-600",children:"Độ mạnh mật khẩu:"}),s.jsxs("div",{className:"flex space-x-1",children:[s.jsx("div",{className:`h-2 w-1/4 rounded ${n.length>=6?"bg-blue-500":"bg-gray-200"}`}),s.jsx("div",{className:`h-2 w-1/4 rounded ${n.length>=8?"bg-blue-500":"bg-gray-200"}`}),s.jsx("div",{className:`h-2 w-1/4 rounded ${/[A-Z]/.test(n)?"bg-blue-500":"bg-gray-200"}`}),s.jsx("div",{className:`h-2 w-1/4 rounded ${/[0-9]/.test(n)?"bg-blue-500":"bg-gray-200"}`})]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Gợi ý: Sử dụng ít nhất 8 ký tự, bao gồm chữ hoa và số"})]}),s.jsx("button",{type:"submit",disabled:!l||!n||!c||n!==c||m,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]",children:m?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Đang cập nhật..."]}):s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Cập nhật mật khẩu"]})})]}),s.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("svg",{className:"w-5 h-5 text-gray-600 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsx("p",{className:"font-medium mb-1",children:"Lưu ý quan trọng:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[s.jsx("li",{children:"Mật khẩu mới sẽ được sử dụng cho các lần đăng nhập tiếp theo"}),s.jsx("li",{children:"Hãy ghi nhớ mật khẩu mới của bạn"})]})]})]})})]})})}),s.jsx("footer",{className:"p-6"})]})}const TN=({title:l,newCount:a,oldCount:n,total:i,color:c})=>s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider",children:l}),s.jsx("div",{className:`w-2 h-2 ${c} rounded-full`})]}),s.jsxs("div",{className:"flex items-baseline space-x-2 mb-2",children:[s.jsx("span",{className:"text-3xl font-bold text-white",children:i}),s.jsx("span",{className:"text-sm text-gray-400",children:"Tổng"})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsxs("span",{className:"text-xs text-green-400",children:[i>0?"↑":"→"," ",i>0?"100%":"0%"]}),s.jsx("span",{className:"text-xs text-gray-400",children:"hoạt động"})]}),s.jsxs("div",{className:"h-8 flex items-end space-x-1",children:[s.jsx("div",{className:`w-2 ${c} h-4 rounded-sm`}),s.jsx("div",{className:`w-2 ${c} h-5 rounded-sm`}),s.jsx("div",{className:`w-2 ${c} h-6 rounded-sm`}),s.jsx("div",{className:`w-2 ${c} h-7 rounded-sm`}),s.jsx("div",{className:`w-2 ${c} h-8 rounded-sm`})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[s.jsxs("span",{children:["Mới: ",a]}),s.jsxs("span",{children:["Cũ: ",n]})]})]}),EN=()=>s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 animate-pulse",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"h-4 bg-gray-600 rounded w-24"}),s.jsx("div",{className:"w-2 h-2 bg-gray-600 rounded-full"})]}),s.jsxs("div",{className:"flex items-baseline space-x-2 mb-2",children:[s.jsx("div",{className:"h-8 bg-gray-600 rounded w-16"}),s.jsx("div",{className:"h-4 bg-gray-600 rounded w-8"})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("div",{className:"h-3 bg-gray-600 rounded w-12"}),s.jsx("div",{className:"h-3 bg-gray-600 rounded w-16"})]}),s.jsxs("div",{className:"h-8 flex items-end space-x-1",children:[s.jsx("div",{className:"w-2 bg-gray-600 h-4 rounded-sm"}),s.jsx("div",{className:"w-2 bg-gray-600 h-5 rounded-sm"}),s.jsx("div",{className:"w-2 bg-gray-600 h-6 rounded-sm"}),s.jsx("div",{className:"w-2 bg-gray-600 h-7 rounded-sm"}),s.jsx("div",{className:"w-2 bg-gray-600 h-8 rounded-sm"})]}),s.jsxs("div",{className:"flex justify-between text-xs mt-2",children:[s.jsx("div",{className:"h-3 bg-gray-600 rounded w-12"}),s.jsx("div",{className:"h-3 bg-gray-600 rounded w-12"})]})]}),Vu=({stats:l,title:a,isLoading:n=!1})=>{if(n)return s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:a}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((c,u)=>s.jsx(EN,{},u))})]});const i=[{title:"KTS CÁ NHÂN",newCount:l.ktsNew,oldCount:l.ktsOld,total:l.ktsNew+l.ktsOld,color:"bg-blue-400",icon:"🎯"},{title:"ĐỐI TÁC CÁ NHÂN",newCount:l.partnerNew,oldCount:l.partnerOld,total:l.partnerNew+l.partnerOld,color:"bg-green-400",icon:"🤝"},{title:"KHÁCH HÀNG CÁ NHÂN",newCount:l.customerNew,oldCount:l.customerOld,total:l.customerNew+l.customerOld,color:"bg-orange-400",icon:"👥"},{title:"SBG CÁ NHÂN",newCount:l.sbgNew,oldCount:l.sbgOld,total:l.sbgNew+l.sbgOld,color:"bg-purple-400",icon:"🏢"},{title:"CÔNG VIỆC KHÁC",newCount:Math.floor(l.other*.3),oldCount:Math.ceil(l.other*.7),total:l.other,color:"bg-gray-400",icon:"📋"}];return s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:a}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map((c,u)=>s.jsx(TN,{...c},u))})]})},CN={personal:{label:"Cá nhân",icon:"👤",description:"Thống kê công việc cá nhân"},team:{label:"Nhóm",icon:"👥",description:"Thống kê nhóm của bạn"},department:{label:"Toàn phòng",icon:"🏢",description:"Thống kê toàn bộ phòng ban"},locations:{label:"Theo khu vực",icon:"🗺️",description:"Thống kê theo Hà Nội/HCM"}},DN=({activeTab:l,onTabChange:a,availableTabs:n,className:i=""})=>n.length<=1?null:s.jsx("div",{className:`border-b border-gray-700 ${i}`,children:s.jsx("nav",{className:"flex space-x-8","aria-label":"Dashboard tabs",children:n.map(c=>{const u=CN[c],h=l===c;return s.jsxs("button",{onClick:()=>a(c),className:`group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm transition-colors ${h?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"}`,"aria-current":h?"page":void 0,children:[s.jsx("span",{className:"text-base mr-2",children:u.icon}),s.jsx("span",{children:u.label}),h&&s.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-500/20 text-blue-300",children:"Đang xem"})]},c)})})}),AN={"Hà Nội":"🏢","Hồ Chí Minh":"🏬",hanoi:"🏢",hcm:"🏬",HN:"🏢",HCM:"🏬"},vg=l=>AN[l]||"📍",MN={hanoi:{label:"Hà Nội",icon:vg("hanoi"),description:"Thống kê văn phòng Hà Nội"},hcm:{label:"Hồ Chí Minh",icon:vg("hcm"),description:"Thống kê văn phòng Hồ Chí Minh"}},ON=({activeLocation:l,onLocationChange:a,className:n=""})=>s.jsx("div",{className:`border-b border-gray-700 ${n}`,children:s.jsx("nav",{className:"flex space-x-8","aria-label":"Location tabs",children:Object.entries(MN).map(([i,c])=>{const u=l===i,h=i;return s.jsxs("button",{onClick:()=>a(h),className:`group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm transition-colors ${u?"text-blue-400 border-blue-500":"border-transparent text-gray-400 hover:text-gray-300 hover:border-gray-300"}`,"aria-current":u?"page":void 0,children:[s.jsx("span",{className:"text-base mr-2",children:c.icon}),s.jsx("span",{children:c.label}),u&&s.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-500/20 text-blue-300",children:"Đang xem"})]},i)})})}),RN=({member:l,onClick:a})=>{const n=Object.values(l.stats).reduce((c,u)=>c+u,0),i=[{label:"KTS",count:l.stats.ktsNew+l.stats.ktsOld,color:"bg-blue-400"},{label:"Đối tác",count:l.stats.partnerNew+l.stats.partnerOld,color:"bg-green-400"},{label:"KH",count:l.stats.customerNew+l.stats.customerOld,color:"bg-orange-400"},{label:"SBG",count:l.stats.sbgNew+l.stats.sbgOld,color:"bg-purple-400"}].sort((c,u)=>u.count-c.count).slice(0,3);return s.jsxs("div",{className:`bg-gray-800 rounded-xl p-4 border border-gray-700 transition-all duration-200 ${a?"cursor-pointer hover:border-gray-600 hover:bg-gray-750":""}`,onClick:a,children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm mr-3",children:l.userName.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-white font-medium text-sm",children:l.userName}),s.jsx("p",{className:"text-gray-400 text-xs",children:"Thành viên"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-bold text-white",children:n}),s.jsx("div",{className:"text-xs text-gray-400",children:"Tổng CV"})]})]}),s.jsxs("div",{className:"space-y-2",children:[i.map((c,u)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:`w-2 h-2 ${c.color} rounded-full mr-2`}),s.jsx("span",{className:"text-xs text-gray-300",children:c.label})]}),s.jsx("span",{className:"text-xs text-white font-medium",children:c.count})]},c.label)),l.stats.other>0&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),s.jsx("span",{className:"text-xs text-gray-300",children:"Khác"})]}),s.jsx("span",{className:"text-xs text-white font-medium",children:l.stats.other})]})]}),s.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700",children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1",children:[s.jsx("span",{children:"Hoạt động"}),s.jsx("span",{children:n>0?"100%":"0%"})]}),s.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5",children:s.jsx("div",{className:`h-1.5 rounded-full ${n>0?"bg-blue-400":"bg-gray-600"}`,style:{width:n>0?"100%":"0%"}})})]})]})},UN=()=>s.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 border border-gray-700 animate-pulse",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full mr-3"}),s.jsxs("div",{children:[s.jsx("div",{className:"h-4 bg-gray-600 rounded w-20 mb-1"}),s.jsx("div",{className:"h-3 bg-gray-600 rounded w-16"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"h-5 bg-gray-600 rounded w-8 mb-1"}),s.jsx("div",{className:"h-3 bg-gray-600 rounded w-12"})]})]}),s.jsx("div",{className:"space-y-2",children:Array.from({length:3}).map((l,a)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"h-3 bg-gray-600 rounded w-16"}),s.jsx("div",{className:"h-3 bg-gray-600 rounded w-6"})]},a))})]}),bg=({members:l,teamName:a,isLoading:n=!1,onMemberClick:i})=>n?s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Thống kê thành viên - ",a]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:Array.from({length:6}).map((c,u)=>s.jsx(UN,{},u))})]}):l.length===0?s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Thống kê thành viên - ",a]}),s.jsxs("div",{className:"text-center py-8 text-gray-400",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("span",{className:"text-2xl",children:"👥"})}),s.jsx("p",{children:"Nhóm này chưa có thành viên nào"})]})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Thống kê thành viên - ",a]}),s.jsxs("div",{className:"text-sm text-gray-400",children:[l.length," thành viên"]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:l.map(c=>s.jsx(RN,{member:c,onClick:i?()=>i(c.userId,c.userName):void 0},c.userId))})]});class LN{async getAllTeams(){try{const{data:a,error:n}=await se.from("teams").select(`
          id,
          name,
          location,
          leader_id,
          leader:users!teams_leader_id_fkey(id, name)
        `).order("location",{ascending:!0}).order("name",{ascending:!0});return n?(console.error("❌ Error fetching teams:",n),[]):a?.map(c=>({...c,leader:Array.isArray(c.leader)?c.leader[0]:c.leader}))||[]}catch(a){return console.error("❌ Error in getAllTeams:",a),[]}}async getTeamsByLocation(a){try{const{data:n,error:i}=await se.from("teams").select(`
          id,
          name,
          location,
          leader_id,
          leader:users!teams_leader_id_fkey(id, name)
        `).eq("location",a).order("name",{ascending:!0});return i?(console.error("❌ Error fetching teams by location:",i),[]):n?.map(u=>({...u,leader:Array.isArray(u.leader)?u.leader[0]:u.leader}))||[]}catch(n){return console.error("❌ Error in getTeamsByLocation:",n),[]}}async getTeamMembers(a){try{const{data:n,error:i}=await se.from("users").select(`
          id,
          name,
          email,
          role,
          team_id,
          location
        `).eq("team_id",a).order("role",{ascending:!1}).order("name",{ascending:!0});return i?(console.error("❌ Error fetching team members:",i),[]):n||[]}catch(n){return console.error("❌ Error in getTeamMembers:",n),[]}}async getTeamById(a){try{const{data:n,error:i}=await se.from("teams").select(`
          id,
          name,
          location,
          leader_id,
          leader:users!teams_leader_id_fkey(id, name)
        `).eq("id",a).single();return i||!n?(console.error("❌ Error fetching team by ID:",i),null):{...n,leader:Array.isArray(n.leader)?n.leader[0]:n.leader}}catch(n){return console.error("❌ Error in getTeamById:",n),null}}async isTeamLeader(a,n){try{const{data:i,error:c}=await se.from("teams").select("leader_id").eq("id",n).single();return c||!i?!1:i.leader_id===a}catch(i){return console.error("❌ Error in isTeamLeader:",i),!1}}async getTeamsLedByUser(a){try{const{data:n,error:i}=await se.from("teams").select(`
          id,
          name,
          location,
          leader_id,
          leader:users!teams_leader_id_fkey(id, name)
        `).eq("leader_id",a).order("location",{ascending:!0}).order("name",{ascending:!0});return i?(console.error("❌ Error fetching teams led by user:",i),[]):n?.map(u=>({...u,leader:Array.isArray(u.leader)?u.leader[0]:u.leader}))||[]}catch(n){return console.error("❌ Error in getTeamsLedByUser:",n),[]}}}const Ex=new LN,HN=({location:l,selectedTeamId:a,onTeamSelect:n,className:i=""})=>{const[c,u]=b.useState([]),[h,g]=b.useState(!1);b.useEffect(()=>{m()},[l]);const m=async()=>{g(!0);try{const x=await Ex.getTeamsByLocation(l);u(x)}catch(x){console.error("❌ Error loading teams:",x)}finally{g(!1)}};return h?s.jsx("div",{className:`${i}`,children:s.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:4}).map((x,p)=>s.jsx("div",{className:"px-4 py-2 bg-gray-700 rounded-lg animate-pulse",children:s.jsx("div",{className:"h-4 bg-gray-600 rounded w-20"})},p))})}):c.length===0?s.jsx("div",{className:`${i}`,children:s.jsxs("div",{className:"text-center py-8 text-gray-400",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("span",{className:"text-2xl",children:"👥"})}),s.jsxs("p",{children:["Không có nhóm nào tại ",l]})]})}):s.jsxs("div",{className:`${i}`,children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h3",{className:"text-lg font-medium text-white mb-2",children:["Chọn nhóm tại ",l]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Click vào nhóm để xem thống kê chi tiết của các thành viên"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:c.map(x=>{const p=a===x.id;return s.jsxs("button",{onClick:()=>n(x.id,x.name),className:`p-4 rounded-xl border-2 transition-all duration-200 text-left ${p?"border-blue-500 bg-blue-500/10 shadow-lg":"border-gray-600 bg-gray-800 hover:border-gray-500 hover:bg-gray-700"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${p?"bg-blue-400":"bg-gray-500"}`}),s.jsx("span",{className:`font-medium ${p?"text-blue-300":"text-white"}`,children:x.name})]}),p&&s.jsx("span",{className:"text-blue-400",children:"✓"})]}),s.jsx("div",{className:"text-xs text-gray-400",children:x.leader?.name?s.jsxs("span",{children:["Trưởng nhóm: ",x.leader.name]}):s.jsx("span",{children:"Chưa có trưởng nhóm"})}),s.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["📍 ",x.location]})]},x.id)})})]})};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=l=>l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qN=l=>l.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,n,i)=>i?i.toUpperCase():n.toLowerCase()),wg=l=>{const a=qN(l);return a.charAt(0).toUpperCase()+a.slice(1)},Cx=(...l)=>l.filter((a,n,i)=>!!a&&a.trim()!==""&&i.indexOf(a)===n).join(" ").trim(),zN=l=>{for(const a in l)if(a.startsWith("aria-")||a==="role"||a==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $N={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=b.forwardRef(({color:l="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:c="",children:u,iconNode:h,...g},m)=>b.createElement("svg",{ref:m,...$N,width:a,height:a,stroke:l,strokeWidth:i?Number(n)*24/Number(a):n,className:Cx("lucide",c),...!u&&!zN(g)&&{"aria-hidden":"true"},...g},[...h.map(([x,p])=>b.createElement(x,p)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=(l,a)=>{const n=b.forwardRef(({className:i,...c},u)=>b.createElement(PN,{ref:u,iconNode:a,className:Cx(`lucide-${BN(wg(l))}`,`lucide-${l}`,i),...c}));return n.displayName=wg(l),n};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],GN=je("arrow-right",KN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Dx=je("briefcase",IN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VN=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],qs=je("building",VN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],jg=je("calendar-days",QN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],At=je("calendar",YN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Fa=je("camera",FN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],jl=je("check",XN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ks=je("chevron-down",ZN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ax=je("chevron-left",JN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ya=je("chevron-right",WN);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e2=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],dd=je("chevron-up",e2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t2=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],on=je("circle-check-big",t2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s2=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Cl=je("clock",s2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a2=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],r2=je("download",a2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n2=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],l2=je("ellipsis-vertical",n2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i2=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],o2=je("eye-off",i2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ed=je("eye",c2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],d2=je("file-text",u2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],f2=je("funnel",h2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Mx=je("globe",m2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],x2=je("grid-3x3",g2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],y2=je("grip-vertical",p2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Ox=je("house",v2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],w2=je("image",b2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],N2=je("info",j2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Dl=je("lock",S2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Rx=je("log-out",_2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Cd=je("mail",k2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],E2=je("menu",T2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Qu=je("paperclip",C2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],en=je("pen-line",D2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],va=je("plus",A2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ux=je("rotate-ccw",M2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Nl=je("save",O2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Lx=je("search",R2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],L2=je("settings",U2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Yu=je("square-check-big",H2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],q2=je("square-pen",B2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Ng=je("square",z2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],vs=je("target",$2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Xa=je("trash-2",P2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],cn=je("triangle-alert",K2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Hx=je("upload",G2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],V2=je("user-check",I2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],$s=je("user",Q2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],qt=je("users",Y2);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fe=je("x",F2),Sg=[{value:"today",label:"Hôm nay",icon:"📅"},{value:"week",label:"Tuần này",icon:"📊"},{value:"month",label:"Tháng này",icon:"📈"},{value:"all",label:"Tất cả",icon:"🗂️"}],_g=({value:l,onChange:a,className:n=""})=>{const[i,c]=b.useState(!1),u=b.useRef(null);b.useEffect(()=>{const m=x=>{u.current&&!u.current.contains(x.target)&&c(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const h=Sg.find(m=>m.value===l.period),g=m=>{a({period:m}),c(!1)};return s.jsxs("div",{className:`relative ${n}`,ref:u,children:[s.jsxs("button",{type:"button",onClick:()=>c(!i),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 border border-gray-600 rounded-lg text-white text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx(At,{className:"w-4 h-4"}),s.jsx("span",{children:h?.label||"Chọn thời gian"}),s.jsx(Ks,{className:`w-4 h-4 transition-transform ${i?"rotate-180":""}`})]}),i&&s.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-gray-800 border border-gray-600 rounded-xl shadow-2xl z-50",children:s.jsx("div",{className:"py-2",children:Sg.map(m=>s.jsxs("button",{type:"button",onClick:()=>g(m.value),className:`w-full px-4 py-2.5 text-left text-sm transition-colors flex items-center gap-3 ${l.period===m.value?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[s.jsx("span",{className:"text-base",children:m.icon}),s.jsx("span",{children:m.label}),l.period===m.value&&s.jsx("span",{className:"ml-auto text-blue-300",children:"✓"})]},m.value))})})]})},Ye={managerStats:{totalTasks:0,completedTasks:0,completionRate:0,hanoiRevenue:0,hcmRevenue:0},teamStats:{totalMembers:12},categoryStats:{architects:{new:0,existing:0,total:0},partners:{new:0,existing:0,total:0},customers:{new:0,existing:0,total:0},quotes:{new:0,existing:0,total:0},otherTasks:0}},kg=l=>`${l.toLocaleString("vi-VN")} VNĐ`,X2=l=>`${l.toFixed(1)}%`,Z2={other:"Công việc khác","sbg-new":"SBG mới","sbg-old":"SBG cũ","partner-new":"Đối tác mới","partner-old":"Đối tác cũ","kts-new":"KTS mới","kts-old":"KTS cũ","customer-new":"Khách hàng mới","customer-old":"Khách hàng cũ"};class J2{async moveScheduledTasksToToday(){try{console.log("🤖 Auto-move: Checking for scheduled tasks to move...");const a=new Date().toISOString().split("T")[0],{data:n,error:i}=await se.from("tasks").select("*").eq("scheduled_date",a).eq("source","manual").not("scheduled_date","is",null);if(i)return console.error("Auto-move fetch error:",i),{success:!1,movedCount:0,error:i.message};if(!n||n.length===0)return console.log("🤖 Auto-move: No tasks to move today"),{success:!0,movedCount:0};console.log(`🤖 Auto-move: Found ${n.length} tasks to move`);const{error:c}=await se.from("tasks").update({source:"scheduled",updated_at:new Date().toISOString()}).in("id",n.map(u=>u.id));return c?(console.error("Auto-move update error:",c),{success:!1,movedCount:0,error:c.message}):(console.log(`✅ Auto-move: Successfully moved ${n.length} tasks`),{success:!0,movedCount:n.length})}catch(a){return console.error("Auto-move service error:",a),{success:!1,movedCount:0,error:a instanceof Error?a.message:"Unknown error"}}}async moveOverdueScheduledTasks(){try{console.log("🤖 Auto-move: Checking for overdue scheduled tasks...");const a=new Date().toISOString().split("T")[0],{data:n,error:i}=await se.from("tasks").select("*").lt("scheduled_date",a).eq("source","manual").not("scheduled_date","is",null);if(i)return console.error("Auto-move overdue fetch error:",i),{success:!1,movedCount:0,error:i.message};if(!n||n.length===0)return console.log("🤖 Auto-move: No overdue tasks to move"),{success:!0,movedCount:0};console.log(`🤖 Auto-move: Found ${n.length} overdue tasks to move`);const{error:c}=await se.from("tasks").update({source:"scheduled",status:"overdue",updated_at:new Date().toISOString()}).in("id",n.map(u=>u.id));return c?(console.error("Auto-move overdue update error:",c),{success:!1,movedCount:0,error:c.message}):(console.log(`✅ Auto-move: Successfully moved ${n.length} overdue tasks`),{success:!0,movedCount:n.length})}catch(a){return console.error("Auto-move overdue service error:",a),{success:!1,movedCount:0,error:a instanceof Error?a.message:"Unknown error"}}}async runAutoMove(){console.log("🤖 Starting auto-move process...");const a=await this.moveScheduledTasksToToday(),n=await this.moveOverdueScheduledTasks(),i=a.movedCount+n.movedCount;return i>0?console.log(`🎉 Auto-move completed: ${i} tasks moved`):console.log("✨ Auto-move completed: No tasks to move"),{today:a,overdue:n}}startAutoMoveScheduler(a=60){console.log(`🤖 Starting auto-move scheduler (every ${a} minutes)`),this.runAutoMove(),setInterval(()=>{this.runAutoMove()},a*60*1e3)}async triggerManualAutoMove(){const a=await this.runAutoMove(),n=a.today.movedCount,i=a.overdue.movedCount,c=n+i;if(c===0)return"Không có công việc nào cần chuyển.";let u=`Đã chuyển ${c} công việc:`;return n>0&&(u+=`
- ${n} công việc hôm nay`),i>0&&(u+=`
- ${i} công việc quá hạn`),u}}const W2=new J2,Tg=[],Bx=l=>{console.log("🔍 getUserById:",{id:l,mockUsersLength:Tg.length});const a=Tg.find(n=>n.id===l);return console.log("🔍 getUserById result:",a?.name||"NOT FOUND"),a},e1=l=>{const a=Bx(l)||$e(),n=a?.name==="Khổng Đức Mạnh",i=a?.role==="retail_director",c=n&&i;return console.log("🔍 isDirector check:",{userId:l,user:a?.name,role:a?.role,isDirectorByName:n,isDirectorByRole:i,isDirector:c}),c},$e=()=>{try{const l=localStorage.getItem("auth_user");if(l){const a=JSON.parse(l);if(!a.id||!a.name||!a.email)throw console.error("❌ Missing required user fields:",a),new Error("Invalid user data");const n={id:a.id,name:a.name,email:a.email,team_id:a.team_id||"director-team",location:a.location,role:a.role,team:a.team?{id:a.team.id,name:a.team.name,location:a.location==="Hà Nội"?"HN":"HCM"}:{id:"director-team",name:"Ban Giám Đốc",location:a.location==="Hà Nội"?"HN":"HCM"}};return console.log("✅ getCurrentUser success:",n.name),n}}catch(l){console.error("❌ Error in getCurrentUser:",l)}throw new Error("No authenticated user found")},t1={"kts-new":"ktsNew","kts-old":"ktsOld","partner-new":"partnerNew","partner-old":"partnerOld","customer-new":"customerNew","customer-old":"customerOld","sbg-new":"sbgNew","sbg-old":"sbgOld",other:"other"};function Dd(l){const a=new Date;let n,i=a;switch(l.period){case"today":n=new Date(a.getFullYear(),a.getMonth(),a.getDate());break;case"week":const c=a.getDay(),u=c===0?6:c-1;n=new Date(a),n.setDate(a.getDate()-u),n.setHours(0,0,0,0);break;case"month":n=new Date(a.getFullYear(),a.getMonth(),1);break;case"all":default:n=new Date(2020,0,1);break}return l.startDate&&l.endDate&&(n=new Date(l.startDate),i=new Date(l.endDate)),{startDate:n.toISOString(),endDate:i.toISOString()}}async function qx(l,a={period:"all"}){try{const{startDate:n,endDate:i}=Dd(a),{data:c,error:u}=await se.from("tasks").select("work_type").eq("created_by_id",l).gte("created_at",n).lte("created_at",i);return u?(console.error("❌ Error fetching personal stats:",u),Jt()):Ad(c||[])}catch(n){return console.error("❌ Error in getPersonalStats:",n),Jt()}}async function s1(l,a={period:"all"}){try{const{startDate:n,endDate:i}=Dd(a),{data:c,error:u}=await se.from("users").select("id").eq("team_id",l);if(u)return console.error("❌ Error fetching team members:",u),Jt();if(!c||c.length===0)return Jt();const h=c.map(x=>x.id),{data:g,error:m}=await se.from("tasks").select("work_type").in("created_by_id",h).gte("created_at",n).lte("created_at",i);return m?(console.error("❌ Error fetching team stats:",m),Jt()):Ad(g||[])}catch(n){return console.error("❌ Error in getTeamStats:",n),Jt()}}async function Eg(l,a={period:"all"}){try{const{startDate:n,endDate:i}=Dd(a),{data:c,error:u}=await se.from("users").select("id").eq("location",l);if(u)return console.error("❌ Error fetching users by location:",u),Jt();if(!c||c.length===0)return Jt();const h=c.map(x=>x.id),{data:g,error:m}=await se.from("tasks").select("work_type").in("created_by_id",h).gte("created_at",n).lte("created_at",i);return m?(console.error("❌ Error fetching location stats:",m),Jt()):Ad(g||[])}catch(n){return console.error("❌ Error in getLocationStats:",n),Jt()}}async function a1(l,a={period:"all"}){try{const n=await Ex.getTeamMembers(l);return!n||n.length===0?[]:await Promise.all(n.map(async c=>{const u=await qx(c.id,a);return{userId:c.id,userName:c.name,stats:u}}))}catch(n){return console.error("❌ Error in getTeamMembersStats:",n),[]}}function Ad(l){const a=Jt();return l.forEach(n=>{const i=t1[n.work_type];i&&a[i]++}),a}function Jt(){return{ktsNew:0,ktsOld:0,partnerNew:0,partnerOld:0,customerNew:0,customerOld:0,sbgNew:0,sbgOld:0,other:0}}async function r1(l={period:"all"}){const a=$e();if(!a)return{personal:Jt()};const n=await qx(a.id,l);if(a.name==="Khổng Đức Mạnh"||a.role==="retail_director"){const[i,c]=await Promise.all([Eg("Hà Nội",l),Eg("Hồ Chí Minh",l)]);return{personal:n,hanoi:i,hcm:c}}if(a.role==="team_leader"&&a.team_id){const[i,c]=await Promise.all([s1(a.team_id,l),a1(a.team_id,l)]);return{personal:n,team:i,teamMembers:c}}return{personal:n}}const n1=({isOpen:l,onClose:a,plan:n,onEdit:i,onDelete:c,onUpdate:u})=>{const[h,g]=b.useState(!1),[m,x]=b.useState(!1),[p,v]=b.useState({name:"",description:"",priority:"normal",scheduled_time:""});if(Wr.useEffect(()=>{n&&v({name:n.name||"",description:n.description||"",priority:n.priority||"normal",scheduled_time:n.scheduled_time||""})},[n]),console.log("🔍 PlanDetailModal render:",{isOpen:l,plan:n?.name||"null"}),!l||!n)return console.log("❌ PlanDetailModal not rendering:",{isOpen:l,hasPlan:!!n}),null;const j=E=>E?E.slice(0,5):"",N=E=>E?new Date(E).toLocaleDateString("vi-VN",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"",_=(E=>{switch(E){case"high":return{color:"text-red-400",bgColor:"bg-red-500/10",borderColor:"border-red-500/20",label:"Ưu tiên cao"};case"normal":return{color:"text-blue-400",bgColor:"bg-blue-500/10",borderColor:"border-blue-500/20",label:"Ưu tiên bình thường"};case"low":return{color:"text-gray-400",bgColor:"bg-gray-500/10",borderColor:"border-gray-500/20",label:"Ưu tiên thấp"};default:return{color:"text-blue-400",bgColor:"bg-blue-500/10",borderColor:"border-blue-500/20",label:"Ưu tiên bình thường"}}})(n.priority||"normal"),D=async()=>{if(!p.name.trim()){alert("Vui lòng nhập tên kế hoạch");return}x(!0);try{u&&await u({id:n.id,...p}),g(!1)}catch(E){console.error("Lỗi khi lưu kế hoạch:",E),alert("Không thể lưu kế hoạch. Vui lòng thử lại.")}finally{x(!1)}},M=()=>{v({name:n.name||"",description:n.description||"",priority:n.priority||"normal",scheduled_time:n.scheduled_time||""}),g(!1)};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-2xl max-h-[95vh] sm:max-h-[90vh] overflow-hidden shadow-2xl border border-gray-700 mx-2 sm:mx-0",children:[s.jsx("div",{className:`p-3 sm:p-4 border-b border-gray-700 ${h?"bg-gradient-to-r from-orange-600/20 to-yellow-600/20":"bg-gradient-to-r from-blue-600/10 to-purple-600/10"}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[s.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-500/20 rounded-lg flex items-center justify-center flex-shrink-0",children:s.jsx(vs,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400"})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h2",{className:"text-base sm:text-lg font-semibold text-white truncate",children:h?"Chỉnh sửa kế hoạch":"Chi tiết kế hoạch"}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-400 truncate",children:N(n.scheduled_date)})]})]}),s.jsx("button",{onClick:a,className:"p-1.5 sm:p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors flex-shrink-0",children:s.jsx(Fe,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})}),s.jsx("div",{className:"p-3 sm:p-4 overflow-y-auto max-h-[calc(95vh-180px)] sm:max-h-[calc(90vh-200px)]",children:h?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tên kế hoạch"}),s.jsx("input",{type:"text",value:p.name,onChange:E=>v({...p,name:E.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",placeholder:"Nhập tên kế hoạch..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mô tả"}),s.jsx("textarea",{value:p.description,onChange:E=>v({...p,description:E.target.value}),rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none resize-none",placeholder:"Nhập mô tả chi tiết..."})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Thời gian"}),s.jsx("input",{type:"time",value:p.scheduled_time,onChange:E=>v({...p,scheduled_time:E.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mức độ ưu tiên"}),s.jsxs("select",{value:p.priority,onChange:E=>v({...p,priority:E.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none",children:[s.jsx("option",{value:"low",children:"Ưu tiên thấp"}),s.jsx("option",{value:"normal",children:"Ưu tiên bình thường"}),s.jsx("option",{value:"high",children:"Ưu tiên cao"})]})]})]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:n.name}),n.description&&s.jsx("p",{className:"text-gray-300 leading-relaxed",children:n.description})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[n.scheduled_time&&s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-700/30 rounded-lg",children:[s.jsx(Cl,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"Thời gian"}),s.jsx("p",{className:"text-sm sm:text-base text-white font-medium",children:j(n.scheduled_time)})]})]}),s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-700/30 rounded-lg",children:[s.jsx(cn,{className:`w-4 h-4 sm:w-5 sm:h-5 ${_.color} flex-shrink-0`}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"Mức độ ưu tiên"}),s.jsx("p",{className:`text-sm sm:text-base font-medium ${_.color}`,children:_.label})]})]}),n.createdBy&&s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-700/30 rounded-lg",children:[s.jsx($s,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-400 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"Người tạo"}),s.jsx("p",{className:"text-sm sm:text-base text-white font-medium truncate",children:n.createdBy})]})]}),s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-gray-700/30 rounded-lg",children:[s.jsx(At,{className:"w-4 h-4 sm:w-5 sm:h-5 text-purple-400 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"Ngày lên lịch"}),s.jsx("p",{className:"text-sm sm:text-base text-white font-medium",children:N(n.scheduled_date)})]})]})]})]})}),s.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-700 bg-gray-800/50",children:h?s.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-2 sm:gap-3",children:[s.jsx("button",{onClick:M,disabled:m,className:"px-3 sm:px-4 py-2 text-gray-400 hover:text-white transition-colors disabled:opacity-50 text-sm sm:text-base",children:"Hủy"}),s.jsx("button",{onClick:D,disabled:m||!p.name.trim(),className:"px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm sm:text-base",children:m?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Đang lưu..."]}):"Lưu thay đổi"})]}):s.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 sm:gap-0",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("button",{onClick:()=>g(!0),className:"flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm sm:text-base",children:[s.jsx(q2,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Chỉnh sửa"]})}),s.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-3 sm:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm sm:text-base",children:[s.jsx(Xa,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Xóa"]})]})})]})})};class l1{async scheduleTask(a){try{if(!$e())return{success:!1,error:"User not authenticated"};const i=new Date(a.scheduledDate);if(isNaN(i.getTime()))return{success:!1,error:"Invalid scheduled date"};const c=new Date,u=new Date(c.getFullYear(),c.getMonth(),c.getDate());if(new Date(i.getFullYear(),i.getMonth(),i.getDate())<u)return{success:!1,error:"Scheduled date cannot be in the past"};if(a.scheduledTime&&!/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(a.scheduledTime))return{success:!1,error:"Invalid time format. Use HH:MM"};const{data:g,error:m}=await se.from("tasks").select("*").eq("id",a.taskId).single();if(m||!g)return{success:!1,error:"Task not found"};const x={scheduled_date:a.scheduledDate,source:"manual"};a.scheduledTime&&(x.scheduled_time=a.scheduledTime);const{data:p,error:v}=await se.from("tasks").update(x).eq("id",a.taskId).select().single();return v?(console.error("Error scheduling task:",v),{success:!1,error:"Failed to schedule task"}):{success:!0,task:p}}catch(n){return console.error("Schedule task error:",n),{success:!1,error:"Unexpected error during scheduling"}}}async unscheduleTask(a){try{const n=$e();if(!n)return{success:!1,error:"User not authenticated"};const{data:i,error:c}=await se.from("tasks").select("*").eq("id",a).single();if(c||!i)return{success:!1,error:"Task not found"};if(i.created_by_id!==n.id&&i.assigned_to_id!==n.id)return{success:!1,error:"Not authorized to modify this task"};const{data:u,error:h}=await se.from("tasks").update({scheduled_date:null,scheduled_time:null,source:"manual"}).eq("id",a).select().single();return h?(console.error("Error unscheduling task:",h),{success:!1,error:"Failed to unschedule task"}):{success:!0,task:u}}catch(n){return console.error("Unschedule task error:",n),{success:!1,error:"Unexpected error during unscheduling"}}}async getScheduledTasks(a,n){try{const i=$e();if(!i)throw new Error("User not authenticated");const c=i.name==="Khổng Đức Mạnh"||i.email==="manh.khong@company.com",u=n||i.id;if(!c&&u!==i.id)throw new Error("Permission denied: Cannot view other users schedules");const h=new Date(a).toISOString().split("T")[0];console.log("🔍 Getting scheduled tasks for date:",{targetDate:h,userId:u,requestedBy:i.id,isAdmin:c});let g=se.from("tasks").select("*").not("scheduled_date","is",null).eq("scheduled_date",h);n?g=g.or(`created_by_id.eq.${n},assigned_to_id.eq.${n}`):c||(g=g.or(`created_by_id.eq.${i.id},assigned_to_id.eq.${i.id}`));const{data:m,error:x}=await g.order("scheduled_time",{ascending:!0});if(x)throw console.error("Error fetching scheduled tasks:",x),new Error("Failed to fetch scheduled tasks");return m||[]}catch(i){throw console.error("Get scheduled tasks error:",i),i}}async getMyScheduledTasks(){try{const a=$e();if(!a)throw new Error("User not authenticated");const{data:n,error:i}=await se.from("tasks").select("*").not("scheduled_date","is",null).or(`created_by_id.eq.${a.id},assigned_to_id.eq.${a.id}`).order("scheduled_date",{ascending:!0}).order("scheduled_time",{ascending:!0});if(i)throw console.error("Error fetching my scheduled tasks:",i),new Error("Failed to fetch scheduled tasks");return n||[]}catch(a){throw console.error("Get my scheduled tasks error:",a),a}}async moveScheduledTasksToToday(){try{const a=new Date().toISOString().split("T")[0],{data:n,error:i}=await se.from("tasks").select("*").eq("scheduled_date",a).eq("source","manual").not("scheduled_date","is",null);if(i)throw console.error("Error fetching tasks to move:",i),new Error("Failed to fetch tasks to move");if(!n||n.length===0)return{movedCount:0,tasks:[]};const c=n.map(g=>g.id),{data:u,error:h}=await se.from("tasks").update({source:"scheduled"}).in("id",c).select();if(h)throw console.error("Error moving scheduled tasks:",h),new Error("Failed to move scheduled tasks");return{movedCount:u?.length||0,tasks:u||[]}}catch(a){throw console.error("Move scheduled tasks error:",a),a}}isTaskScheduled(a){return a.scheduled_date!==null&&a.scheduled_date!==void 0}isTaskFromSchedule(a){return a.source==="scheduled"}formatScheduledDate(a,n){const c=new Date(a).toLocaleDateString("vi-VN",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return n?`${c} lúc ${n}`:c}async getUpcomingScheduledTasks(){try{const a=$e();if(!a)throw new Error("User not authenticated");const n=new Date,i=new Date(n.getTime()+10080*60*1e3),{data:c,error:u}=await se.from("tasks").select("*").not("scheduled_date","is",null).gte("scheduled_date",n.toISOString().split("T")[0]).lte("scheduled_date",i.toISOString().split("T")[0]).or(`created_by.eq.${a.id},assigned_to.eq.${a.id}`).order("scheduled_date",{ascending:!0}).order("scheduled_time",{ascending:!0});if(u)throw console.error("Error fetching upcoming scheduled tasks:",u),new Error("Failed to fetch upcoming scheduled tasks");return c||[]}catch(a){throw console.error("Get upcoming scheduled tasks error:",a),a}}async getScheduledTasksByUser(a){try{const n=$e();if(!n)throw new Error("User not authenticated");if(!(n.name==="Khổng Đức Mạnh"||n.email==="manh.khong@company.com")&&a!==n.id)throw new Error("Permission denied: Cannot view other users schedules");console.log("🔍 Getting scheduled tasks for user:",{userId:a,requestedBy:n.id});const{data:c,error:u}=await se.from("tasks").select("*").or(`created_by_id.eq.${a},assigned_to_id.eq.${a}`).not("scheduled_date","is",null).order("scheduled_date",{ascending:!0}).order("scheduled_time",{ascending:!0});if(u)throw console.error("❌ Supabase error in getScheduledTasksByUser:",u),new Error(`Failed to fetch user scheduled tasks: ${u.message}`);return console.log(`📊 Scheduled tasks for user ${a}:`,c?.length||0),this.processScheduledTasks(c||[])}catch(n){throw console.error("❌ Error in getScheduledTasksByUser:",n),n}}async getScheduledTasksInRange(a,n,i){try{const c=$e();if(!c)throw new Error("User not authenticated");const u=c.name==="Khổng Đức Mạnh"||c.email==="manh.khong@company.com",h=i||c.id;if(!u&&h!==c.id)throw new Error("Permission denied: Cannot view other users schedules");console.log("🔍 Getting scheduled tasks in range:",{startDate:a,endDate:n,userId:h,requestedBy:c.id,isAdmin:u});let g=se.from("tasks").select("*").not("scheduled_date","is",null).gte("scheduled_date",a).lte("scheduled_date",n);i?g=g.or(`created_by_id.eq.${i},assigned_to_id.eq.${i}`):u||(g=g.or(`created_by_id.eq.${c.id},assigned_to_id.eq.${c.id}`));const{data:m,error:x}=await g.order("scheduled_date",{ascending:!0}).order("scheduled_time",{ascending:!0});if(x)throw console.error("❌ Supabase error in getScheduledTasksInRange:",x),new Error(`Failed to fetch scheduled tasks: ${x.message}`);return console.log("📊 Raw scheduled tasks from database:",m?.length||0),this.processScheduledTasks(m||[])}catch(c){throw console.error("❌ Error in getScheduledTasksInRange:",c),c}}processScheduledTasks(a){return!a||a.length===0?[]:(console.log("📋 Processing scheduled tasks:",a.map(n=>({name:n.name,date:n.scheduled_date,time:n.scheduled_time,dateOnly:n.scheduled_date?.split("T")[0]}))),a.map(n=>({...n,source:"scheduled"})))}}const dl=new l1,Fu=(l,a)=>{const n=a==="Hà Nội"?"HN":"HCM";switch(l){case"retail_director":return{canViewAllTeams:!0,canViewCrossLocation:!0,canCreateTasks:!0,canEditAllTasks:!0,canDeleteAllTasks:!0,allowedTaskScopes:["my-tasks","team-tasks","department-tasks"],defaultLocation:n};case"team_leader":return{canViewAllTeams:!1,canViewCrossLocation:!1,canCreateTasks:!0,canEditAllTasks:!1,canDeleteAllTasks:!1,allowedTaskScopes:["my-tasks","team-tasks","department-tasks"],defaultLocation:n};case"employee":return{canViewAllTeams:!1,canViewCrossLocation:!1,canCreateTasks:!0,canEditAllTasks:!1,canDeleteAllTasks:!1,allowedTaskScopes:["my-tasks","team-tasks","department-tasks"],defaultLocation:n};default:return{canViewAllTeams:!1,canViewCrossLocation:!1,canCreateTasks:!1,canEditAllTasks:!1,canDeleteAllTasks:!1,allowedTaskScopes:["my-tasks"],defaultLocation:n}}},zx=()=>{try{const l=localStorage.getItem("auth_user");if(l){const n=JSON.parse(l);return Fu(n.role,n.location)}const a=$e();return Fu(a.role,a.location)}catch(l){return console.error("Error getting current user permissions:",l),Fu("employee","Hà Nội")}},i1=l=>l.location==="Hà Nội"?"hanoi":"hcm",o1=l=>l==="retail_director",Yi=l=>l==="retail_director";class c1{filterScheduledTasks(a){const n=new Date().toISOString().split("T")[0];return a.filter(i=>{if(i.scheduled_date){const c=i.scheduled_date.split("T")[0];if(i.source==="checklist_item"||i.source==="manual"||i.source==="scheduled")return c<=n}return!0})}cleanDateFields(a){const n={...a};return["start_date","end_date","due_date","scheduled_date","created_at","updated_at"].forEach(c=>{if(c in n){const u=n[c];if(u==="")n[c]=null;else if(u&&typeof u=="string"){const h=/^(\d{2})\/(\d{2})\/(\d{4})$/,g=u.match(h);if(g){const[,m,x,p]=g,v=`${p}-${x}-${m}`;console.log(`🔧 Converting date format: ${u} → ${v}`),n[c]=v}else u.includes("-")||u.includes("T")?n[c]=u:console.warn(`⚠️  Unknown date format for ${c}:`,u)}}}),n}async getUserInfo(a){if(!a)return null;try{const{data:n,error:i}=await se.from("users").select("id, name, email, team_id, location, role").eq("id",a).single();return i?(console.warn("Error fetching user info:",i),null):n}catch(n){return console.error("Error in getUserInfo:",n),null}}async createTask(a,n){try{const i=await this.getUserInfo(n);if(!i)throw new Error("Không tìm thấy thông tin người dùng");const c={name:a.name,description:a.description||"",work_type:Array.isArray(a.workTypes)&&a.workTypes.length>0?a.workTypes:a.workType?[a.workType]:["other"],priority:a.priority||"normal",status:"new-requests",campaign_type:a.campaignType||"",platform:a.platform||[],start_date:a.startDate||new Date().toISOString(),end_date:a.endDate||null,due_date:a.dueDate||null,created_by_id:n,assigned_to_id:a.assignedToId||n,team_id:i.team_id||null,department:a.department||(i.location==="Hà Nội"?"HN":"HCM"),share_scope:a.shareScope||"team"},{data:u,error:h}=await se.from("tasks").insert(c).select().single();if(h)throw console.error("Supabase error:",h),new Error("Không thể tạo công việc mới");const[g,m]=await Promise.all([this.getUserInfo(u.created_by_id),this.getUserInfo(u.assigned_to_id)]);return this.mapDbTaskToTask(u,g,m)}catch(i){throw console.error("Error creating task:",i),new Error("Không thể tạo công việc mới")}}async getTasks(){return await fN(async()=>{try{console.log("🔄 About to query Supabase tasks table...");const{data:a,error:n}=await se.from("tasks").select("*").order("created_at",{ascending:!1});if(console.log("🔍 Supabase response:",{data:a,error:n,dataLength:a?.length||0}),n)return console.error("❌ Error fetching tasks:",n),console.error("❌ Error details:",JSON.stringify(n,null,2)),[];if(console.log("🔍 Raw tasks from database:",a?.length||0),console.log("🔍 Sample tasks:",a?.slice(0,3)),!a||a.length===0)return console.log("⚠️ No tasks found in database"),[];const i=a;console.log("📅 Task filtering in getTasks:",{totalTasks:a.length,filteredTasks:i.length,today:new Date().toISOString().split("T")[0],hiddenScheduledTasks:a.length-i.length});const c=new Set;i.forEach(g=>{g.created_by_id&&c.add(g.created_by_id),g.assigned_to_id&&c.add(g.assigned_to_id)});const{data:u}=await se.from("users").select("id, name, email, team_id, location").in("id",Array.from(c)),h=new Map;return u?.forEach(g=>h.set(g.id,g)),i.map(g=>this.mapDbTaskToTask(g,h.get(g.created_by_id),h.get(g.assigned_to_id)))}catch(a){return console.error("Error fetching tasks:",a),[]}})}async getTasksByUser(a){try{const{data:n,error:i}=await se.from("tasks").select("*").or(`created_by_id.eq.${a},assigned_to_id.eq.${a}`).order("created_at",{ascending:!1});if(i)return console.error("Error fetching user tasks:",i),[];if(!n||n.length===0)return[];const c=new Set;n.forEach(g=>{g.created_by_id&&c.add(g.created_by_id),g.assigned_to_id&&c.add(g.assigned_to_id)});const{data:u}=await se.from("users").select("id, name, email, team_id, location").in("id",Array.from(c)),h=new Map;return u?.forEach(g=>h.set(g.id,g)),n.map(g=>this.mapDbTaskToTask(g,h.get(g.created_by_id),h.get(g.assigned_to_id)))}catch(n){return console.error("Error fetching user tasks:",n),[]}}async updateTask(a){try{console.log("🔧 TaskService.updateTask called with:",a);const n={};a.name!==void 0&&(n.name=a.name),a.description!==void 0&&(n.description=a.description),a.priority!==void 0&&(n.priority=a.priority),a.status!==void 0&&(n.status=a.status),a.workTypes!==void 0?n.work_type=a.workTypes:a.workType!==void 0&&(n.work_type=[a.workType]),a.campaignType!==void 0&&(n.campaign_type=a.campaignType),a.platform!==void 0&&(n.platform=a.platform),a.startDate!==void 0&&(n.start_date=a.startDate===""?null:a.startDate),a.endDate!==void 0&&(n.end_date=a.endDate===""?null:a.endDate),a.dueDate!==void 0&&(n.due_date=a.dueDate===""?null:a.dueDate),a.assignedToId!==void 0&&(n.assigned_to_id=a.assignedToId),a.department!==void 0&&(n.department=a.department),a.shareScope!==void 0&&(n.share_scope=a.shareScope),"scheduledDate"in a&&a.scheduledDate!==void 0&&(n.scheduled_date=a.scheduledDate===""?null:a.scheduledDate),"scheduledTime"in a&&a.scheduledTime!==void 0&&(n.scheduled_time=a.scheduledTime===""?null:a.scheduledTime);const i=this.cleanDateFields(n);console.log("🔧 Mapped update data for database:",i);const{data:c,error:u}=await se.from("tasks").update(i).eq("id",a.id).select().single();if(u)throw console.error("❌ Supabase update error:",u),console.error("❌ Failed update data:",i),console.error("❌ Task ID:",a.id),new Error(`Không thể cập nhật công việc: ${u.message}`);console.log("✅ Task updated successfully in database:",c.id);const[h,g]=await Promise.all([this.getUserInfo(c.created_by_id),this.getUserInfo(c.assigned_to_id)]);return this.mapDbTaskToTask(c,h,g)}catch(n){throw console.error("Error updating task:",n),new Error("Không thể cập nhật công việc")}}async deleteTask(a){try{console.log("🗑️ TaskService: Deleting task with ID:",a);const{error:n}=await se.from("tasks").delete().eq("id",a);if(n)throw console.error("❌ Supabase delete error:",n),new Error(`Không thể xóa công việc: ${n.message}`);console.log("✅ TaskService: Task deleted successfully from database")}catch(n){throw console.error("❌ TaskService: Error deleting task:",n),n}}async getTaskById(a){try{const{data:n,error:i}=await se.from("tasks").select("*").eq("id",a).single();if(i){if(i.code==="PGRST116")return null;throw i}const[c,u]=await Promise.all([this.getUserInfo(n.created_by_id),this.getUserInfo(n.assigned_to_id)]);return this.mapDbTaskToTask(n,c,u)}catch(n){throw console.error("Error fetching task by ID:",n),new Error("Không thể tải thông tin công việc")}}filterTasksByScope(a,n,i){const c=Bx(n)||$e(),u=e1(n),h=c?.team_id,g=c?.location==="Hà Nội"?"HN":"HCM";console.log("🔍 filterTasksByScope debug:",{scope:i,currentUserId:n,currentUser:c?.name,currentUserRole:c?.role,isUserDirector:u,userTeamId:h,userDepartment:g,totalTasks:a.length}),console.log(u?"✅ User IS director, using simplified logic":"⚠️ User is NOT director, using regular filter logic");const m=x=>x.shareScope?(console.log(`✅ Task ${x.id} has shareScope: ${x.shareScope}`),x.shareScope):x.createdBy?.id===n||x.assignedTo?.id===n?(console.log(`🔄 Task ${x.id} fallback to private (own task)`),"private"):(console.log(`🔄 Task ${x.id} fallback to team (default)`),"team");return a.filter(x=>{const p=m(x),v=(()=>{switch(i){case"my-tasks":const j=x.createdBy?.id===n,N=x.assignedTo?.id===n,S=x.createdBy?.name===c?.name,_=x.assignedTo?.name===c?.name;console.log(`🔍 my-tasks filter for "${x.name}":`,{currentUserId:n,currentUserName:c?.name,taskCreatedById:x.createdBy?.id,taskCreatedByName:x.createdBy?.name,taskAssignedToId:x.assignedTo?.id,taskAssignedToName:x.assignedTo?.name,createdByMatch:j,assignedToMatch:N,createdByNameMatch:S,assignedToNameMatch:_,effectiveShareScope:p,isUserDirector:u});const D=j||N||S||_;return console.log(`🔍 my-tasks result (${u?"Director":"Regular"}): ${D?"INCLUDED":"EXCLUDED"}`),D;case"team-tasks":return u?(console.log(`🔍 Director sees all tasks: ${x.name}`),!0):p==="team"&&(x.createdBy?.team_id===h||x.assignedTo?.team_id===h)&&x.department===g;case"department-tasks":return u?(console.log(`🔍 Director sees all department tasks: ${x.name}`),!0):p==="public"&&x.department===g;default:return!1}})();return(i==="my-tasks"||i==="team-tasks"||i==="department-tasks")&&console.log(`🔍 Task "${x.name}" (shareScope: ${x.shareScope}) - ${i}: ${v?"INCLUDED":"EXCLUDED"}`),v})}async getFilteredTasks(a,n){try{const i=await this.getTasks(),c=n||$e().id;return this.filterTasksByScope(i,c,a)}catch(i){return console.error("Error fetching filtered tasks:",i),[]}}mapDbTaskToTask(a,n,i){console.log("🔍 mapDbTaskToTask - dbTask.work_type:",a.work_type,"Type:",typeof a.work_type,"IsArray:",Array.isArray(a.work_type));const c=g=>g.replace(/_/g,"-"),h=(g=>{if(!g)return["other"];if(Array.isArray(g))return g.map(c);if(typeof g=="string"&&g.startsWith("[")&&g.endsWith("]"))try{const m=JSON.parse(g);if(Array.isArray(m))return m.map(c)}catch(m){console.warn("Failed to parse work_type JSON:",g,m)}return typeof g=="string"?[c(g)]:["other"]})(a.work_type);return console.log("✅ Normalized workTypes:",h),{id:a.id,name:a.name||"",description:a.description||"",workType:h[0],workTypes:h,priority:a.priority,status:a.status,campaignType:a.campaign_type||"",platform:a.platform||[],startDate:a.start_date?new Date(a.start_date).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):a.created_at?new Date(a.created_at).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):new Date().toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),endDate:a.end_date?new Date(a.end_date).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"",dueDate:a.due_date?new Date(a.due_date).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"",createdAt:a.created_at||new Date().toISOString(),department:a.department||"HN",group:"",shareScope:a.share_scope||"team",createdBy:n?{id:n.id,name:n.name,email:n.email,team_id:n.team_id,location:n.location}:null,assignedTo:i?{id:i.id,name:i.name,email:i.email,team_id:i.team_id,location:i.location}:null}}async getMyTasks(a){try{const n=a?await this.getUserInfo(a):$e();if(!n)throw new Error("User not found");const i=await this.getTasks();console.log("📅 getMyTasks - Filtering tasks for user:",{totalTasks:i.length,userId:n.id,userName:n.name,userRole:n.role});const c=this.filterTasksByScope(i,n.id,"my-tasks");return console.log("📅 ShareScope filtering in getMyTasks:",{totalTasks:i.length,filteredTasks:c.length,userId:n.id,scope:"my-tasks"}),c}catch(n){throw console.error("Error in getMyTasks:",n),n}}async getTeamTasks(a,n){try{const i=$e(),c=await this.getTasks(),u=this.filterTasksByScope(c,i.id,"team-tasks");return console.log("📅 ShareScope filtering in getTeamTasks:",{totalTasks:c.length,filteredTasks:u.length,userId:i.id,scope:"team-tasks"}),u}catch(i){throw console.error("Error in getTeamTasks:",i),i}}async getDepartmentTasks(a){try{const n=$e(),i=await this.getTasks(),c=this.filterTasksByScope(i,n.id,"department-tasks");return console.log("📅 ShareScope filtering in getDepartmentTasks:",{totalTasks:i.length,filteredTasks:c.length,userId:n.id,scope:"department-tasks"}),c}catch(n){throw console.error("Error in getDepartmentTasks:",n),n}}async getAvailableTeams(){try{const a=$e();if(zx().canViewAllTeams){const{data:i,error:c}=await se.from("teams").select("*").order("name");return c?(console.error("Error fetching all teams:",c),[]):i||[]}else{const{data:i,error:c}=await se.from("teams").select("*").eq("id",a.team_id).single();return c?(console.error("Error fetching user team:",c),[]):i?[i]:[]}}catch(a){return console.error("Error in getAvailableTeams:",a),[]}}async mapDbTasksToTasks(a){return!a||a.length===0?[]:await Promise.all(a.map(async i=>{const[c,u]=await Promise.all([this.getUserInfo(i.created_by_id),this.getUserInfo(i.assigned_to_id)]);return this.mapDbTaskToTask(i,c,u)}))}async createScheduledChecklistItem(a){try{const n=localStorage.getItem("currentUserId"),i=localStorage.getItem("currentUserEmail"),c=localStorage.getItem("currentUserName");if(!n||!i)throw new Error("Người dùng chưa đăng nhập");console.log("👤 Current user for checklist scheduling:",{id:n,email:i,name:c});const{data:u,error:h}=await se.from("users").select("team_id, location, department_type").eq("id",n).single();h&&console.warn("⚠️  Could not get user details:",h.message),console.log("👤 User details from database:",u);const{data:g,error:m}=await se.from("tasks").select("name").eq("id",a.parentTaskId).single();m&&console.warn("⚠️  Could not get parent task name:",m.message);const x=g?.name||"Unknown Task";console.log("📋 Parent task name:",x),console.log("📅 Creating scheduled task for checklist item:",a);const p={name:a.itemTitle,description:`Từ: ${x}`,scheduled_date:a.scheduledDate,scheduled_time:a.scheduledTime||null,source:"checklist_item",priority:"medium",status:"new-requests",work_type:"other",created_by_id:n,assigned_to_id:n,team_id:u?.team_id||null,department:u?.location||"unknown"};console.log("📋 Task data before cleaning:",p);const v=this.cleanDateFields(p),{data:j,error:N}=await se.from("tasks").insert([v]).select("*").single();if(N)throw console.error("❌ Supabase error creating scheduled checklist item:",N),console.error("❌ Error details:",{code:N.code,message:N.message,details:N.details,hint:N.hint}),new Error(`Không thể tạo lịch: ${N.message}`);return console.log("✅ Scheduled checklist item created:",j),j}catch(n){throw console.error("❌ Error creating scheduled checklist item:",n),n}}}const is=new c1;function u1({onClose:l}){const[a,n]=b.useState([]),[i,c]=b.useState([]),[u,h]=b.useState(new Date),[g,m]=b.useState(!1),[x,p]=b.useState(null),[v,j]=b.useState(!1),N=$e(),S=N?.name==="Khổng Đức Mạnh"||N?.email==="manh.khong@company.com",_=[{id:"8h-17h30",label:"8h-17h30",type:"day"},{id:"17h30-10h",label:"17h30-10h",type:"night"},{id:"8h30-18h",label:"8h30-18h",type:"day"},{id:"9h-17h30",label:"9h-17h30",type:"day"}],D=[{key:"monday",label:"Thứ 2",short:"T2"},{key:"tuesday",label:"Thứ 3",short:"T3"},{key:"wednesday",label:"Thứ 4",short:"T4"},{key:"thursday",label:"Thứ 5",short:"T5"},{key:"friday",label:"Thứ 6",short:"T6"},{key:"saturday",label:"Thứ 7",short:"T7"},{key:"sunday",label:"Chủ nhật",short:"CN"}];b.useEffect(()=>{S&&(M(),E())},[S,u]);const M=async()=>{try{const{data:Y,error:ie}=await se.from("users").select("id, name, email, role, location").order("name");if(ie)throw ie;n(Y||[]),console.log("👥 Loaded employees:",Y?.length||0)}catch(Y){console.error("Error loading employees:",Y)}},E=async()=>{try{m(!0);const Y=A(u),ie=G(u),{data:L,error:Q}=await se.from("schedule_assignments").select("*").gte("date",Y.toISOString().split("T")[0]).lte("date",ie.toISOString().split("T")[0]);if(Q)throw Q;const ae=(L||[]).map(ye=>({id:ye.id,employeeId:ye.employee_id,employeeName:ye.employee_name,date:ye.date,timeSlot:ye.time_slot,location:ye.location}));c(ae),console.log("📅 Loaded weekly assignments:",ae.length)}catch(Y){console.error("Error loading weekly assignments:",Y)}finally{m(!1)}},A=Y=>{const ie=new Date(Y),L=ie.getDay(),Q=ie.getDate()-L+(L===0?-6:1);return ie.setDate(Q),ie},G=Y=>{const ie=A(Y);return ie.setDate(ie.getDate()+6),ie},q=Y=>{const ie=A(u),L=new Date(ie);return L.setDate(L.getDate()+Y),L},H=(Y,ie)=>{p(ie),Y.dataTransfer.effectAllowed="move",Y.dataTransfer.setData("text/plain",ie.id);const L=Y.currentTarget.cloneNode(!0);L.style.opacity="0.8",L.style.transform="rotate(5deg)",Y.dataTransfer.setDragImage(L,0,0)},R=Y=>{Y.preventDefault(),Y.dataTransfer.dropEffect="move"},Z=Y=>{Y.preventDefault(),Y.currentTarget.classList.add("border-blue-400","bg-blue-500/10")},ue=Y=>{Y.preventDefault(),Y.currentTarget.classList.remove("border-blue-400","bg-blue-500/10")},re=(Y,ie,L)=>{if(Y.preventDefault(),Y.currentTarget.classList.remove("border-blue-400","bg-blue-500/10"),!x)return;const ae=q(ie).toISOString().split("T")[0];if(i.find(C=>C.employeeId===x.id&&C.date===ae&&C.timeSlot===L)){alert("Nhân viên đã được phân công vào ca này!"),p(null);return}const k=i.find(C=>C.employeeId===x.id&&C.date===ae&&C.timeSlot!==L);if(k)if(window.confirm(`${x.name} đã được phân công ca ${k.timeSlot} trong ngày này. Bạn có muốn thay đổi không?`))c(I=>I.filter(oe=>oe.id!==k.id));else{p(null);return}const V={id:`temp-${Date.now()}`,employeeId:x.id,employeeName:x.name,date:ae,timeSlot:L,location:x.location};c(C=>[...C,V]),j(!0),p(null),console.log(`✅ Assigned ${x.name} to ${L} on ${ae}`)},ee=Y=>{c(ie=>ie.filter(L=>L.id!==Y)),j(!0)},le=async()=>{try{m(!0);const Y=A(u),ie=G(u);console.log("🗑️ Deleting existing assignments for week:",{start:Y.toISOString().split("T")[0],end:ie.toISOString().split("T")[0]});const{error:L}=await se.from("schedule_assignments").delete().gte("date",Y.toISOString().split("T")[0]).lte("date",ie.toISOString().split("T")[0]);if(L)throw L;const Q=i.filter(ae=>!ae.id.startsWith("temp-")).concat(i.filter(ae=>ae.id.startsWith("temp-"))).map(ae=>({employee_id:ae.employeeId,employee_name:ae.employeeName,date:ae.date,time_slot:ae.timeSlot,location:ae.location,created_by:N?.id||"admin"}));if(console.log("💾 Saving assignments:",Q.length),Q.length>0){const{data:ae,error:ye}=await se.from("schedule_assignments").insert(Q).select();if(ye)throw ye;if(ae){const k=ae.map(V=>({id:V.id,employeeId:V.employee_id,employeeName:V.employee_name,date:V.date,timeSlot:V.time_slot,location:V.location}));c(k)}}else c([]);j(!1),alert("✅ Lưu lịch thành công!"),console.log("✅ Schedule saved successfully")}catch(Y){console.error("❌ Error saving schedule:",Y),alert("❌ Lỗi khi lưu lịch: "+Y.message)}finally{m(!1)}},ne=()=>{E(),j(!1)};return S?s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-7xl h-full max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(At,{className:"w-6 h-6 text-blue-400"}),s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Quản Lý Lịch Showroom"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[v&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:ne,className:"px-3 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700",children:[s.jsx(Ux,{className:"w-4 h-4 inline mr-1"}),"Reset"]}),s.jsxs("button",{onClick:le,disabled:g,className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 disabled:opacity-50",children:[s.jsx(Nl,{className:"w-4 h-4 inline mr-1"}),"Lưu Lịch"]})]}),s.jsx("button",{onClick:l,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Đóng"})]})]}),s.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-center gap-4",children:[s.jsx("button",{onClick:()=>{const Y=new Date(u);Y.setDate(Y.getDate()-7),h(Y)},className:"px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700",children:"← Tuần trước"}),s.jsxs("div",{className:"text-white font-medium",children:["Tuần ",A(u).toLocaleDateString("vi-VN")," - ",G(u).toLocaleDateString("vi-VN")]}),s.jsx("button",{onClick:()=>{const Y=new Date(u);Y.setDate(Y.getDate()+7),h(Y)},className:"px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Tuần sau →"})]}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsxs("div",{className:"w-64 border-r border-gray-700 p-4",children:[s.jsxs("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[s.jsx(qt,{className:"w-4 h-4"}),"Nhân Viên (",a.length,")"]}),s.jsxs("div",{className:"space-y-2 max-h-full overflow-y-auto",children:[a.map(Y=>{const ie=A(u),L=G(u),Q=i.filter(ae=>ae.employeeId===Y.id&&new Date(ae.date)>=ie&&new Date(ae.date)<=L).length;return s.jsxs("div",{draggable:!0,onDragStart:ae=>H(ae,Y),className:"p-2 bg-gray-700 rounded cursor-move hover:bg-gray-600 transition-colors border-l-4 border-blue-500 relative",children:[s.jsx("div",{className:"text-white text-sm font-medium",children:Y.name}),s.jsx("div",{className:"text-gray-400 text-xs",children:Y.location}),Q>0&&s.jsx("div",{className:"absolute top-1 right-1 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:Q})]},Y.id)}),a.length===0&&s.jsx("div",{className:"text-gray-400 text-sm text-center py-4",children:"Đang tải danh sách nhân viên..."})]})]}),s.jsx("div",{className:"flex-1 p-4 overflow-auto",children:s.jsxs("div",{className:"grid grid-cols-8 gap-2 min-w-max",children:[s.jsx("div",{className:"text-gray-400 text-sm font-medium p-2",children:"Ca làm việc"}),D.map((Y,ie)=>{const L=q(ie);return s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-white font-medium",children:Y.short}),s.jsxs("div",{className:"text-gray-400 text-xs",children:[L.getDate(),"/",L.getMonth()+1]})]},Y.key)}),_.map(Y=>s.jsxs(Wr.Fragment,{children:[s.jsxs("div",{className:"p-2 bg-gray-700 rounded text-white text-sm font-medium flex items-center",children:[s.jsx(Cl,{className:"w-3 h-3 mr-1"}),Y.label]}),D.map((ie,L)=>{const ae=q(L).toISOString().split("T")[0],ye=i.filter(k=>k.date===ae&&k.timeSlot===Y.id);return s.jsxs("div",{onDragOver:R,onDragEnter:Z,onDragLeave:ue,onDrop:k=>re(k,L,Y.id),className:"min-h-[80px] border-2 border-dashed border-gray-600 rounded p-1 hover:border-blue-400 transition-all duration-200 relative",children:[ye.map(k=>s.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white text-xs p-2 rounded mb-1 relative group shadow-sm hover:shadow-md transition-all",children:[s.jsx("div",{className:"font-medium",children:k.employeeName}),s.jsx("div",{className:"text-blue-200 text-xs",children:k.location}),s.jsx("button",{onClick:()=>ee(k.id),className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 flex items-center justify-center",title:"Xóa phân công",children:"×"})]},k.id)),ye.length===0&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500 text-xs pointer-events-none",children:"Kéo nhân viên vào đây"})]},`${ie.key}-${Y.id}`)})]},Y.id))]})})]})]})}):s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsx("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ed,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Không có quyền truy cập"}),s.jsx("p",{className:"text-gray-400 mb-4",children:"Chỉ Khổng Đức Mạnh mới có thể quản lý lịch làm việc."}),s.jsx("button",{onClick:l,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Đóng"})]})})})}function d1(){const[l,a]=b.useState(new Date),[n,i]=b.useState([]),[c,u]=b.useState([]),[h,g]=b.useState(!1),[m,x]=b.useState(new Date),[p,v]=b.useState(null),[j,N]=b.useState(null),S=$e(),[_,D]=b.useState(null),[M,E]=b.useState([]),A=S?.name==="Khổng Đức Mạnh"||S?.email==="manh.khong@company.com",[G,q]=b.useState(!1),[H,R]=b.useState(!1),[Z,ue]=b.useState({name:"",description:"",scheduledDate:"",scheduledTime:"",priority:"normal"}),[re,ee]=b.useState(!1),[le,ne]=b.useState(null),[Y,ie]=b.useState(!1);console.log("📅 PlanningTab: Initial state:",{selectedDate:l.toISOString().split("T")[0],currentMonth:m.toISOString().split("T")[0],scheduledTasksCount:n.length}),b.useEffect(()=>{A&&L()},[A]),b.useEffect(()=>{console.log("📅 PlanningTab: Loading tasks for month:",m.toISOString().split("T")[0]),Q()},[m,_]),b.useEffect(()=>{ae()},[l,_]);const L=async()=>{try{const{data:J,error:fe}=await se.from("users").select("id, name, email, role, location").order("name");if(fe)throw fe;E(J||[]),console.log("👥 Loaded users for admin view:",J?.length||0)}catch(J){console.error("Error loading users:",J)}},Q=async()=>{try{g(!0);const J=new Date(m.getFullYear(),m.getMonth(),1),fe=new Date(m.getFullYear(),m.getMonth()+1,0),Ee=J.toISOString().split("T")[0],Ce=fe.toISOString().split("T")[0];console.log("📅 PlanningTab: Loading monthly tasks for range:",{month:m.toLocaleDateString("vi-VN",{month:"long",year:"numeric"}),startDate:Ee,endDate:Ce});let Re;A&&_?(Re=await dl.getScheduledTasksInRange(Ee,Ce,_),console.log(`📅 PlanningTab: Loaded tasks for user ${_}:`,Re?.length||0)):A&&!_?(Re=await dl.getScheduledTasksInRange(Ee,Ce),console.log("📅 PlanningTab: Loaded all tasks for admin:",Re?.length||0)):(Re=await dl.getScheduledTasksInRange(Ee,Ce),console.log("📅 PlanningTab: Loaded current user tasks:",Re?.length||0)),console.log("📅 PlanningTab: Loaded monthly tasks:",Re?.length||0),Re&&Re.length>0?console.log("📋 Monthly tasks:",Re.map(tt=>({name:tt.name,date:tt.scheduled_date,time:tt.scheduled_time}))):console.log("📋 No monthly tasks found for range:",Ee,"to",Ce),i(Re)}catch(J){console.error("❌ Error loading monthly tasks:",J),J.message?.includes("Failed to fetch")?(console.error("🌐 Network error - check internet connection"),alert("❌ Lỗi mạng: Không thể tải dữ liệu. Vui lòng kiểm tra kết nối internet và thử lại.")):(console.error("🔧 API error:",J.message),alert("❌ Lỗi: "+(J.message||"Không thể tải dữ liệu kế hoạch"))),i([])}finally{g(!1)}},ae=async()=>{try{const J=l.getFullYear()+"-"+String(l.getMonth()+1).padStart(2,"0")+"-"+String(l.getDate()).padStart(2,"0");console.log("📅 PlanningTab: Loading daily tasks for local date:",{selectedDate:l.toLocaleDateString("vi-VN"),localDateStr:J,isoWouldBe:l.toISOString().split("T")[0]});const fe=await dl.getScheduledTasks(J,_||void 0);console.log("📅 PlanningTab: Loaded daily tasks for",J,":",fe?.length||0),fe&&fe.length>0&&console.log("📋 Daily tasks:",fe.map(Ee=>({name:Ee.name,time:Ee.scheduled_time,scheduled_date:Ee.scheduled_date}))),u(fe)}catch(J){console.error("Error loading daily tasks:",J)}},ye=J=>{const fe=J.getFullYear()+"-"+String(J.getMonth()+1).padStart(2,"0")+"-"+String(J.getDate()).padStart(2,"0");console.log("🔍 PlanningTab: Getting tasks for date:",{inputDate:J.toLocaleDateString("vi-VN"),localString:fe,tasksToCheck:n.map(Ce=>({name:Ce.name,scheduled_date:Ce.scheduled_date,dateOnly:Ce.scheduled_date?.split("T")[0]}))});const Ee=n.filter(Ce=>{if(!Ce.scheduled_date)return!1;const Re=Ce.scheduled_date.split("T")[0],tt=Re===fe;return tt&&console.log("✅ Task matches date:",{taskName:Ce.name,taskDate:Re,searchDate:fe}),tt});return console.log("🎯 Found matching tasks:",Ee.length),Ee},k=J=>{console.log("🎯 handlePlanClick called with plan:",J),ne(J),ee(!0),v(null),console.log("📋 Modal state updated - showPlanDetailModal: true")},V=()=>{ee(!1),ne(null)},C=async J=>{try{const{error:fe}=await se.from("scheduled_tasks").update({name:J.name,description:J.description,priority:J.priority,scheduled_time:J.scheduled_time}).eq("id",J.id);if(fe)throw fe;i(Ee=>Ee.map(Ce=>Ce.id===J.id?{...Ce,...J}:Ce)),u(Ee=>Ee.map(Ce=>Ce.id===J.id?{...Ce,...J}:Ce)),le&&le.id===J.id&&ne({...le,...J}),console.log("✅ Kế hoạch đã được cập nhật thành công")}catch(fe){console.error("❌ Lỗi khi cập nhật kế hoạch:",fe),alert("Không thể cập nhật kế hoạch. Vui lòng thử lại.")}},I=async()=>{le&&confirm(`Bạn có chắc chắn muốn xóa kế hoạch "${le.name}"?`)&&(await Be(le.id),V())},oe=J=>J?J.slice(0,5):"",he=J=>{const fe=new Date;return J.toDateString()===fe.toDateString()},xe=J=>{const fe=new Date;return fe.setHours(0,0,0,0),J<fe},mt=async J=>{try{await is.updateTask({id:J,source:"scheduled"}),await Q(),await ae(),alert("✅ Công việc đã được chuyển về danh sách công việc hôm nay!")}catch(fe){console.error("Error moving task:",fe),alert("❌ Không thể chuyển công việc. Vui lòng thử lại.")}},Be=async J=>{if(confirm("🗑️ Bạn có chắc chắn muốn xóa công việc này?"))try{N(J),await is.deleteTask(J),await Q(),await ae(),v(null),alert("✅ Công việc đã được xóa thành công!")}catch(fe){console.error("❌ Error deleting task:",fe),alert("❌ Không thể xóa công việc. Vui lòng thử lại.")}finally{N(null)}},zt=(J,fe)=>{fe.stopPropagation(),v(p===J?null:J)};b.useEffect(()=>{const J=()=>v(null);return document.addEventListener("click",J),()=>document.removeEventListener("click",J)},[]);const Wa=async()=>{if(!Z.name.trim()){alert("❌ Vui lòng nhập tên kế hoạch!");return}if(!Z.scheduledDate){alert("❌ Vui lòng chọn ngày thực hiện!");return}const J=new Date(Z.scheduledDate),fe=new Date;if(fe.setHours(0,0,0,0),J.setHours(0,0,0,0),J<fe){alert("❌ Không thể tạo kế hoạch cho ngày trong quá khứ!");return}try{ie(!0);const Ee={name:Z.name,description:Z.description,priority:Z.priority,startDate:Z.scheduledDate,dueDate:Z.scheduledDate,workType:"other"},Ce=await is.createTask(Ee,S?.id||""),Re=await dl.scheduleTask({taskId:Ce.id,scheduledDate:Z.scheduledDate,scheduledTime:Z.scheduledTime||void 0});if(Re.success)ue({name:"",description:"",scheduledDate:"",scheduledTime:"",priority:"normal"}),R(!1),await Q(),await ae(),alert(`✅ Kế hoạch "${Z.name}" đã được tạo thành công!`);else throw new Error(Re.error||"Không thể lên lịch cho kế hoạch")}catch(Ee){console.error("Error creating plan:",Ee);const Ce=Ee.message;Ce.includes("Scheduled date cannot be in the past")?alert("❌ Không thể tạo kế hoạch cho ngày trong quá khứ. Vui lòng chọn ngày hôm nay hoặc ngày trong tương lai."):alert("❌ Không thể tạo kế hoạch: "+Ce)}finally{ie(!1)}},us=()=>{const fe=new Date().toISOString().split("T")[0],Ee=l.toISOString().split("T")[0],Ce=Ee!==fe;ue(Re=>({...Re,scheduledDate:Ce?Ee:fe})),R(!0)};return s.jsxs("div",{className:"h-full bg-gray-900 text-white",children:[s.jsx("div",{className:"p-3 sm:p-6 border-b border-gray-700",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500/20 rounded-full flex items-center justify-center",children:s.jsx(jg,{className:"w-4 h-4 text-blue-400"})}),s.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-white",children:"Kế Hoạch"})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4",children:[A&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qt,{className:"w-4 h-4 text-purple-400"}),s.jsxs("select",{value:_||"",onChange:J=>D(J.target.value||null),className:"bg-gray-800 border border-gray-600 rounded px-2 py-1 text-xs text-white focus:border-purple-400 focus:outline-none",children:[s.jsx("option",{value:"",children:"Tất cả nhân viên"}),M.map(J=>s.jsxs("option",{value:J.id,children:[J.name," (",J.location,")"]},J.id))]})]}),s.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[s.jsxs("div",{className:"text-xs sm:text-sm text-gray-400",children:[s.jsxs("span",{className:"hidden sm:inline",children:[n.length," công việc đã lên lịch",A&&_&&s.jsxs("span",{className:"text-purple-400 ml-1",children:["(",M.find(J=>J.id===_)?.name,")"]})]}),s.jsxs("span",{className:"sm:hidden",children:[n.length," việc"]})]}),A&&s.jsxs("button",{onClick:()=>q(!0),className:"px-2 sm:px-3 py-1 bg-green-500/20 text-green-400 rounded text-xs hover:bg-green-500/30 transition-colors flex items-center gap-1",children:[s.jsx(x2,{className:"w-3 h-3"}),s.jsx("span",{className:"hidden sm:inline",children:"Lịch Showroom"}),s.jsx("span",{className:"sm:hidden",children:"Lịch"})]}),s.jsxs("button",{onClick:us,className:"px-2 sm:px-3 py-1 bg-green-500/20 text-green-400 rounded text-xs hover:bg-green-500/30 transition-colors flex items-center gap-1",children:[s.jsx(va,{className:"w-3 h-3"}),s.jsx("span",{className:"hidden sm:inline",children:"Thêm Kế Hoạch"}),s.jsx("span",{className:"sm:hidden",children:"Thêm"})]}),s.jsxs("button",{onClick:()=>{console.log("🔄 Manual refresh triggered"),Q(),ae()},className:"px-2 sm:px-3 py-1 bg-blue-500/20 text-blue-400 rounded text-xs hover:bg-blue-500/30 transition-colors",children:[s.jsx("span",{className:"hidden sm:inline",children:"🔄 Refresh"}),s.jsx("span",{className:"sm:hidden",children:"🔄"})]})]})]})]})}),s.jsxs("div",{className:"flex flex-col lg:flex-row h-full",children:[s.jsx("div",{className:"w-full lg:w-1/2 p-3 sm:p-6 lg:border-r border-gray-700",children:s.jsxs("div",{className:"bg-gray-800/50 rounded-xl sm:rounded-2xl p-3 sm:p-6",children:[s.jsxs("h2",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[s.jsx(At,{className:"w-4 sm:w-5 h-4 sm:h-5 text-blue-400"}),s.jsx("span",{className:"hidden sm:inline",children:"Lịch Tháng"}),s.jsx("span",{className:"sm:hidden",children:"Lịch"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("button",{onClick:()=>x(new Date(m.getFullYear(),m.getMonth()-1)),className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:"←"}),s.jsx("h3",{className:"text-lg font-medium",children:m.toLocaleDateString("vi-VN",{month:"long",year:"numeric"})}),s.jsx("button",{onClick:()=>x(new Date(m.getFullYear(),m.getMonth()+1)),className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:"→"})]}),s.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["CN","T2","T3","T4","T5","T6","T7"].map(J=>s.jsx("div",{className:"p-2 text-center text-sm font-medium text-gray-400",children:J},J)),Array.from({length:42},(J,fe)=>{const Ee=new Date(m.getFullYear(),m.getMonth(),1),Ce=new Date(Ee);Ce.setDate(Ce.getDate()-Ee.getDay());const Re=new Date(Ce);Re.setDate(Re.getDate()+fe);const tt=Re.getMonth()===m.getMonth(),er=Re.toDateString()===l.toDateString(),wa=ye(Re),tr=he(Re);return s.jsxs("button",{onClick:()=>a(Re),className:`
                        p-2 text-sm rounded-lg transition-all relative
                        ${er?"bg-blue-500 text-white":""}
                        ${tr&&!er?"bg-green-500/20 text-green-400":""}
                        ${tt?"text-gray-300 hover:bg-gray-700":"text-gray-600"}
                        ${wa.length>0?"font-medium":""}
                      `,children:[Re.getDate(),wa.length>0&&s.jsx("div",{className:"absolute bottom-0 right-0 w-2 h-2 bg-blue-400 rounded-full"})]},fe)})]})]})]})}),s.jsx("div",{className:"w-full lg:w-1/2 p-3 sm:p-6",children:s.jsxs("div",{className:"bg-gray-800/50 rounded-xl sm:rounded-2xl p-3 sm:p-6 h-full",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3 sm:mb-4",children:[s.jsxs("h2",{className:"text-base sm:text-lg font-semibold flex items-center gap-2",children:[s.jsx(vs,{className:"w-4 sm:w-5 h-4 sm:h-5 text-green-400"}),s.jsxs("span",{className:"hidden sm:inline",children:["Công việc ngày ",l.toLocaleDateString("vi-VN")]}),s.jsx("span",{className:"sm:hidden",children:l.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[he(l)&&s.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full",children:"Hôm nay"}),c.length>0&&s.jsxs("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full",children:[c.length," việc"]})]})]}),s.jsx("div",{className:"space-y-2 sm:space-y-3 max-h-[400px] sm:max-h-[600px] overflow-y-auto",children:c.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(jg,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-400 mb-2",children:"Không có công việc nào"}),s.jsx("p",{className:"text-sm text-gray-500",children:he(l)?"Hôm nay bạn không có công việc nào được lên lịch":"Ngày này chưa có công việc nào được lên lịch"})]}):c.map(J=>s.jsx("div",{className:`
                      relative p-3 sm:p-4 rounded-xl border transition-all group cursor-pointer
                      ${xe(l)?"bg-gray-800/40 border-gray-600/50 hover:bg-gray-800/60":"bg-white/5 border-gray-700/50 hover:bg-white/10 hover:border-gray-600"}
                    `,onClick:()=>k(J),children:s.jsx("div",{className:"flex items-start justify-between gap-3",children:s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsx("h3",{className:"font-medium text-white text-sm sm:text-base leading-tight",children:J.name}),s.jsxs("div",{className:"relative flex-shrink-0",children:[s.jsx("button",{onClick:fe=>zt(J.id,fe),className:"p-1.5 text-gray-400 hover:text-white hover:bg-gray-700/50 rounded-lg transition-colors",title:"Tùy chọn",children:s.jsx(l2,{className:"w-4 h-4"})}),p===J.id&&s.jsxs("div",{className:"absolute right-0 top-8 z-10 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-xl py-1",onClick:fe=>fe.stopPropagation(),children:[s.jsxs("button",{onClick:fe=>{fe.stopPropagation(),k(J)},className:"w-full px-3 py-2 text-left text-sm text-blue-400 hover:bg-gray-700/50 flex items-center gap-2",children:[s.jsx(vs,{className:"w-4 h-4"}),"Xem chi tiết"]}),he(l)&&J.source!=="scheduled"&&s.jsxs("button",{onClick:fe=>{fe.stopPropagation(),mt(J.id)},className:"w-full px-3 py-2 text-left text-sm text-green-400 hover:bg-gray-700/50 flex items-center gap-2",children:[s.jsx(GN,{className:"w-4 h-4"}),"Chuyển về hôm nay"]}),s.jsxs("button",{onClick:fe=>{fe.stopPropagation(),Be(J.id)},disabled:j===J.id,className:"w-full px-3 py-2 text-left text-sm text-red-400 hover:bg-gray-700/50 flex items-center gap-2 disabled:opacity-50",children:[s.jsx(Xa,{className:"w-4 h-4"}),j===J.id?"Đang xóa...":"Xóa kế hoạch"]})]})]})]}),J.description&&s.jsx("p",{className:"text-xs sm:text-sm text-gray-400 mb-3 line-clamp-2",children:J.description}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[J.scheduled_time&&s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-700/50 rounded-full",children:[s.jsx(Cl,{className:"w-3 h-3"}),s.jsx("span",{className:"hidden sm:inline",children:oe(J.scheduled_time)}),s.jsxs("span",{className:"sm:hidden",children:[oe(J.scheduled_time).split(":")[0],":",oe(J.scheduled_time).split(":")[1]]})]}),s.jsx("div",{className:`px-2 py-1 rounded-full text-xs ${J.priority==="high"?"bg-red-500/20 text-red-400":J.priority==="normal"?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:J.priority==="high"?"Cao":J.priority==="normal"?"TB":"Thấp"}),J.source==="scheduled"&&s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-500/20 text-green-400 rounded-full",children:[s.jsx(on,{className:"w-3 h-3"}),s.jsx("span",{className:"hidden sm:inline",children:"Đã chuyển"}),s.jsx("span",{className:"sm:hidden",children:"✓"})]}),J.source==="recurring"&&s.jsxs("div",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 rounded-full",children:[s.jsx("span",{className:"hidden sm:inline",children:"Checklist"}),s.jsx("span",{className:"sm:hidden",children:"☑"})]})]})]})})},J.id))}),c.length>0&&s.jsx("div",{className:"mt-6 pt-4 border-t border-gray-700",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-blue-400",children:c.length}),s.jsx("div",{className:"text-xs text-gray-500",children:"Tổng số"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-green-400",children:c.filter(J=>J.source==="scheduled").length}),s.jsx("div",{className:"text-xs text-gray-500",children:"Đã chuyển"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-yellow-400",children:c.filter(J=>J.priority==="high").length}),s.jsx("div",{className:"text-xs text-gray-500",children:"Ưu tiên cao"})]})]})})]})})]}),!!H&&s.jsx(Wr.Fragment,{children:s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[s.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[s.jsx(va,{className:"w-5 h-5 text-green-400"}),"Thêm Kế Hoạch Mới"]}),s.jsx("button",{onClick:()=>R(!1),className:"p-1 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:s.jsx(Fe,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tên kế hoạch *"}),s.jsx("input",{type:"text",value:Z.name,onChange:J=>ue(fe=>({...fe,name:J.target.value})),placeholder:"Nhập tên kế hoạch...",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-green-400 focus:outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mô tả"}),s.jsx("textarea",{value:Z.description,onChange:J=>ue(fe=>({...fe,description:J.target.value})),placeholder:"Mô tả chi tiết kế hoạch...",rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-green-400 focus:outline-none resize-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ngày thực hiện *"}),s.jsx("input",{type:"date",value:Z.scheduledDate,onChange:J=>ue(fe=>({...fe,scheduledDate:J.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-green-400 focus:outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Thời gian (tùy chọn)"}),s.jsx("input",{type:"time",value:Z.scheduledTime,onChange:J=>ue(fe=>({...fe,scheduledTime:J.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-green-400 focus:outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mức độ ưu tiên"}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{value:Z.priority,onChange:J=>ue(fe=>({...fe,priority:J.target.value})),className:"w-full pl-10 pr-10 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-green-400 focus:outline-none appearance-none cursor-pointer",children:[s.jsx("option",{value:"low",className:"bg-gray-700 text-green-400",children:"🡇 Thấp"}),s.jsx("option",{value:"normal",className:"bg-gray-700 text-blue-400",children:"⸺ Bình thường"}),s.jsx("option",{value:"high",className:"bg-gray-700 text-red-400",children:"🡅 Cao"})]}),s.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),s.jsxs("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:[Z.priority==="high"&&s.jsx("span",{className:"text-red-400",children:"🡅"}),Z.priority==="normal"&&s.jsx("span",{className:"text-blue-400",children:"⸺"}),Z.priority==="low"&&s.jsx("span",{className:"text-green-400",children:"🡇"})]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-700",children:[s.jsx("button",{onClick:()=>R(!1),className:"px-4 py-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:"Hủy"}),s.jsx("button",{onClick:()=>Wa(),disabled:Y||!Z.name.trim()||!Z.scheduledDate,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:Y?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Đang tạo..."]}):s.jsxs(s.Fragment,{children:[s.jsx(va,{className:"w-4 h-4"}),"Tạo Kế Hoạch"]})})]})]})})}),G&&s.jsx(u1,{onClose:()=>q(!1)}),s.jsx(n1,{isOpen:re,onClose:V,plan:le,onUpdate:C,onDelete:I})]})}const h1=({onSetupComplete:l})=>{const[a,n]=b.useState(!1),[i,c]=b.useState(null),u=async()=>{n(!0),c(null);try{console.log("🚀 Bắt đầu tạo NHÓM 5...");const{data:g,error:m}=await se.from("teams").upsert([{name:"NHÓM 5 - Mai Tiến Đạt",description:"Nhóm kinh doanh Hà Nội 5"}],{onConflict:"name"}).select().single();if(m)throw new Error(`Lỗi tạo team: ${m.message}`);const{data:x,error:p}=await se.from("users").upsert([{name:"Mai Tiến Đạt",email:"dat.mai@company.com",password:"123456",password_changed:!1,team_id:g.id,location:"Hà Nội",role:"team_leader",department_type:"Kinh doanh"}],{onConflict:"email"}).select().single();if(p)throw new Error(`Lỗi tạo user: ${p.message}`);c(`✅ Thành công! Đã tạo ${g.name} với trưởng nhóm ${x.name}`),l&&setTimeout(l,1e3)}catch(g){console.error("Error:",g),c(`❌ Lỗi: ${g.message}`)}finally{n(!1)}},h=`-- Script tạo NHÓM 5 và Mai Tiến Đạt
-- Copy và paste vào Supabase SQL Editor

-- 1. Tạo NHÓM 5
INSERT INTO teams (name, description, created_at, updated_at)
VALUES (
  'NHÓM 5 - Mai Tiến Đạt',
  'Nhóm kinh doanh Hà Nội 5',
  NOW(),
  NOW()
) ON CONFLICT (name) DO UPDATE SET
  description = EXCLUDED.description,
  updated_at = NOW();

-- 2. Thêm Mai Tiến Đạt làm trưởng nhóm
INSERT INTO users (
  name, email, password, password_changed,
  team_id, location, role, department_type,
  created_at, updated_at
) VALUES (
  'Mai Tiến Đạt',
  'dat.mai@company.com',
  '123456',
  false,
  (SELECT id FROM teams WHERE name = 'NHÓM 5 - Mai Tiến Đạt' LIMIT 1),
  'Hà Nội',
  'team_leader',
  'Kinh doanh',
  NOW(),
  NOW()
) ON CONFLICT (email) DO UPDATE SET
  name = EXCLUDED.name,
  team_id = EXCLUDED.team_id,
  role = EXCLUDED.role,
  updated_at = NOW();

-- 3. Kiểm tra kết quả
SELECT t.name as team_name, u.name as leader_name, u.role
FROM teams t
LEFT JOIN users u ON t.id = u.team_id
WHERE t.name = 'NHÓM 5 - Mai Tiến Đạt';`;return s.jsx("div",{className:"bg-yellow-900/20 border border-yellow-600 rounded-lg p-6",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("svg",{className:"w-6 h-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-yellow-400 mb-2",children:"Thiết lập NHÓM 5 - Mai Tiến Đạt"}),s.jsx("p",{className:"text-yellow-200 mb-4",children:"NHÓM 5 chưa được tạo trong database. Bạn có thể tạo tự động hoặc thủ công."}),s.jsxs("div",{className:"mb-6",children:[s.jsx("button",{onClick:u,disabled:a,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:a?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Đang tạo..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),s.jsx("span",{children:"Tạo tự động"})]})}),i&&s.jsx("div",{className:`mt-3 p-3 rounded-lg ${i.includes("✅")?"bg-green-900/20 border border-green-600 text-green-200":"bg-red-900/20 border border-red-600 text-red-200"}`,children:i})]}),s.jsxs("div",{className:"border-t border-yellow-600 pt-4",children:[s.jsx("h4",{className:"font-semibold text-yellow-300 mb-3",children:"Hoặc tạo thủ công:"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-yellow-200 mb-2",children:"📌 Cách 1: Supabase Dashboard"}),s.jsxs("ol",{className:"list-decimal list-inside text-sm text-yellow-100 space-y-1 ml-4",children:[s.jsx("li",{children:"Truy cập Supabase Dashboard của dự án"}),s.jsx("li",{children:"Vào SQL Editor"}),s.jsx("li",{children:"Copy script SQL bên dưới và chạy"}),s.jsx("li",{children:"Refresh trang này để thấy NHÓM 5"})]})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-yellow-200 mb-2",children:"📌 Cách 2: Local Database"}),s.jsxs("ol",{className:"list-decimal list-inside text-sm text-yellow-100 space-y-1 ml-4",children:[s.jsx("li",{children:"Khởi động Docker Desktop"}),s.jsxs("li",{children:["Chạy: ",s.jsx("code",{className:"bg-gray-800 px-2 py-1 rounded",children:"npm run db:start"})]}),s.jsxs("li",{children:["Chạy:"," ",s.jsx("code",{className:"bg-gray-800 px-2 py-1 rounded",children:"node scripts/auto-create-team5.js"})]})]})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-yellow-200 mb-2",children:"📝 Script SQL:"}),s.jsx("div",{className:"bg-gray-900 rounded-lg p-4 overflow-x-auto",children:s.jsx("pre",{className:"text-sm text-gray-300 whitespace-pre-wrap",children:h})}),s.jsx("button",{onClick:()=>navigator.clipboard.writeText(h),className:"mt-2 text-sm bg-gray-700 text-gray-300 px-3 py-1 rounded hover:bg-gray-600 transition-colors",children:"📋 Copy SQL"})]})]})]}),s.jsxs("div",{className:"border-t border-yellow-600 pt-4 mt-4",children:[s.jsx("h4",{className:"font-semibold text-yellow-300 mb-2",children:"🎯 Kết quả mong đợi:"}),s.jsxs("div",{className:"text-sm text-yellow-100 space-y-1",children:[s.jsxs("p",{children:["• ",s.jsx("strong",{children:"NHÓM 5 - Mai Tiến Đạt"})," sẽ xuất hiện trong danh sách nhóm"]}),s.jsx("p",{children:"• Mai Tiến Đạt có thể đăng nhập với:"}),s.jsxs("div",{className:"ml-4 bg-gray-800 p-2 rounded text-gray-300",children:[s.jsx("p",{children:"Email: dat.mai@company.com"}),s.jsx("p",{children:"Mật khẩu: 123456"})]}),s.jsx("p",{children:'• Bạn có thể quản lý nhân viên qua tab "Quản lý"'})]})]})]})]})})},f1=({currentUser:l})=>{const[a,n]=b.useState([]),[i,c]=b.useState([]),[u,h]=b.useState(!0),[g,m]=b.useState(!1),[x,p]=b.useState(!1),[v,j]=b.useState({name:"",email:"",role:"employee",team_id:"",location:"Hà Nội",department_type:"Kinh doanh",password:"123456"}),[N,S]=b.useState({name:"",location:"HN",description:""});b.useEffect(()=>{_()},[]);const _=async()=>{try{h(!0);const[H,R]=await Promise.all([se.from("users").select("*").order("name"),se.from("teams").select("*").order("name")]);if(H.error)throw H.error;if(R.error)throw R.error;n(H.data||[]),c(R.data||[])}catch(H){console.error("Error loading data:",H)}finally{h(!1)}},D=async H=>{H.preventDefault();try{const{error:R}=await se.from("users").insert([{name:v.name,email:v.email,password:v.password,password_changed:!1,role:v.role,team_id:v.team_id||null,location:v.location,department_type:v.department_type}]);if(R)throw R;m(!1),j({name:"",email:"",role:"employee",team_id:"",location:"Hà Nội",department_type:"Kinh doanh",password:"123456"}),_()}catch(R){console.error("Error adding employee:",R),alert("Lỗi thêm nhân viên: "+(R instanceof Error?R.message:"Unknown error"))}},M=async H=>{H.preventDefault();try{const{error:R}=await se.from("teams").insert([{name:N.name,description:N.description}]);if(R)throw R;p(!1),S({name:"",location:"HN",description:""}),_()}catch(R){console.error("Error adding team:",R),alert("Lỗi thêm nhóm: "+(R instanceof Error?R.message:"Unknown error"))}},E=async H=>{if(confirm("Bạn có chắc chắn muốn xóa nhân viên này?"))try{const{error:R}=await se.from("users").delete().eq("id",H);if(R)throw R;_()}catch(R){console.error("Error deleting employee:",R),alert("Lỗi xóa nhân viên: "+(R instanceof Error?R.message:"Unknown error"))}},A=async H=>{if(confirm("Bạn có chắc chắn muốn xóa nhóm này? Các thành viên sẽ không còn nhóm."))try{await se.from("users").update({team_id:null}).eq("team_id",H);const{error:R}=await se.from("teams").delete().eq("id",H);if(R)throw R;_()}catch(R){console.error("Error deleting team:",R),alert("Lỗi xóa nhóm: "+(R instanceof Error?R.message:"Unknown error"))}},G=H=>H?i.find(Z=>Z.id===H)?.name||"Không xác định":"Chưa có nhóm",q=H=>{switch(H){case"retail_director":return"Giám đốc";case"team_leader":return"Trưởng nhóm";case"employee":return"Nhân viên";default:return H}};return l?.role!=="retail_director"?s.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:s.jsxs("div",{className:"text-center text-gray-400",children:[s.jsx("p",{children:"Bạn không có quyền quản lý nhân viên."}),s.jsx("p",{className:"text-sm mt-2",children:"Chỉ Giám đốc mới có thể thêm/xóa nhân viên và nhóm."})]})}):u?s.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:s.jsx("div",{className:"text-center text-gray-400",children:"Đang tải..."})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Quản lý Nhân viên & Nhóm"}),s.jsx("p",{className:"text-gray-400 mt-1",children:"Thêm, sửa, xóa nhân viên và nhóm trong hệ thống"})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>p(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:"+ Thêm Nhóm"}),s.jsx("button",{onClick:()=>m(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"+ Thêm Nhân viên"})]})]})}),g&&s.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Thêm Nhân viên Mới"}),s.jsxs("form",{onSubmit:D,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tên"}),s.jsx("input",{type:"text",value:v.name,onChange:H=>j({...v,name:H.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),s.jsx("input",{type:"email",value:v.email,onChange:H=>j({...v,email:H.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Vai trò"}),s.jsxs("select",{value:v.role,onChange:H=>j({...v,role:H.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",children:[s.jsx("option",{value:"employee",children:"Nhân viên"}),s.jsx("option",{value:"team_leader",children:"Trưởng nhóm"}),s.jsx("option",{value:"retail_director",children:"Giám đốc"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nhóm"}),s.jsxs("select",{value:v.team_id,onChange:H=>j({...v,team_id:H.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",children:[s.jsx("option",{value:"",children:"Chưa có nhóm"}),i.map(H=>s.jsx("option",{value:H.id,children:H.name},H.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Khu vực"}),s.jsxs("select",{value:v.location,onChange:H=>j({...v,location:H.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",children:[s.jsx("option",{value:"Hà Nội",children:"Hà Nội"}),s.jsx("option",{value:"Hồ Chí Minh",children:"Hồ Chí Minh"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phòng ban"}),s.jsx("input",{type:"text",value:v.department_type,onChange:H=>j({...v,department_type:H.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",required:!0})]}),s.jsxs("div",{className:"md:col-span-2 flex space-x-3",children:[s.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Thêm Nhân viên"}),s.jsx("button",{type:"button",onClick:()=>m(!1),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Hủy"})]})]})]}),x&&s.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Thêm Nhóm Mới"}),s.jsxs("form",{onSubmit:M,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tên nhóm"}),s.jsx("input",{type:"text",value:N.name,onChange:H=>S({...N,name:H.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"VD: NHÓM 5 - Mai Tiến Đạt",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Khu vực"}),s.jsx("div",{className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-gray-400",children:"Hà Nội (mặc định)"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mô tả"}),s.jsx("input",{type:"text",value:N.description,onChange:H=>S({...N,description:H.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",placeholder:"VD: Nhóm kinh doanh Hà Nội 5"})]}),s.jsxs("div",{className:"md:col-span-2 flex space-x-3",children:[s.jsx("button",{type:"submit",className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Thêm Nhóm"}),s.jsx("button",{type:"button",onClick:()=>p(!1),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Hủy"})]})]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[s.jsx("div",{className:"bg-gray-900 px-6 py-4 border-b border-gray-700",children:s.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Danh sách Nhóm (",i.length,")"]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-900",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Tên nhóm"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Khu vực"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Mô tả"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Thành viên"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Thao tác"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-700",children:i.map(H=>{const R=a.filter(Z=>Z.team_id===H.id);return s.jsxs("tr",{className:"hover:bg-gray-700",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:H.name}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:"Hà Nội"}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:H.description||"-"}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:[R.length," người"]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsx("button",{onClick:()=>A(H.id),className:"text-red-400 hover:text-red-300 transition-colors",children:"Xóa"})})]},H.id)})})]})})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[s.jsx("div",{className:"bg-gray-900 px-6 py-4 border-b border-gray-700",children:s.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Danh sách Nhân viên (",a.length,")"]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-900",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Tên"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Email"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Vai trò"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Nhóm"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Khu vực"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Thao tác"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-700",children:a.map(H=>s.jsxs("tr",{className:"hover:bg-gray-700",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:H.name}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:H.email}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:q(H.role)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:G(H.team_id)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:H.location}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsx("button",{onClick:()=>E(H.id),className:"text-red-400 hover:text-red-300 transition-colors",disabled:H.id===l?.id,children:H.id===l?.id?"Bản thân":"Xóa"})})]},H.id))})]})})]})]})},m1={blue:{bg:"bg-blue-500/20",icon:"text-blue-400",button:"bg-blue-600 hover:bg-blue-700"},green:{bg:"bg-green-500/20",icon:"text-green-400",button:"bg-green-600 hover:bg-green-700"},yellow:{bg:"bg-yellow-500/20",icon:"text-yellow-400",button:"bg-yellow-600 hover:bg-yellow-700"},purple:{bg:"bg-purple-500/20",icon:"text-purple-400",button:"bg-purple-600 hover:bg-purple-700"},indigo:{bg:"bg-indigo-500/20",icon:"text-indigo-400",button:"bg-indigo-600 hover:bg-indigo-700"},red:{bg:"bg-red-500/20",icon:"text-red-400",button:"bg-red-600 hover:bg-red-700"}};function Zt({icon:l,title:a,description:n,buttonText:i,buttonColor:c,onClick:u,fullWidth:h=!1,children:g}){const m=m1[c];return s.jsxs("div",{className:`bg-gray-800 rounded-lg border ${c==="red"?"border-red-700":"border-gray-700"} p-4 md:p-6 hover:bg-gray-700 transition-all ${h?"md:col-span-2":""}`,children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx("div",{className:`w-10 h-10 ${m.bg} rounded-lg flex items-center justify-center mr-3`,children:s.jsx("div",{className:m.icon,children:l})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-lg font-semibold text-white",children:a}),!g&&s.jsx("p",{className:"text-gray-400 text-sm",children:n})]}),g]}),!g&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:n}),s.jsx("button",{onClick:u,className:`w-full ${m.button} text-white py-2 px-4 rounded-lg transition-colors text-sm font-medium`,children:i})]})]})}function $x(){const{user:l}=ln(),[a,n]=b.useState([]),[i,c]=b.useState(!0),[,u]=b.useState([]),[h,g]=b.useState("overview"),[m,x]=b.useState(!1);b.useEffect(()=>{p()},[]);const p=async()=>{try{c(!0);const[A,G]=await Promise.all([se.from("users").select("*").order("name"),se.from("teams").select("*").order("id")]);if(A.error)throw A.error;if(G.error)throw G.error;const q=A.data||[],H=G.data||[];u(H);const R=H.some(re=>re.name&&re.name.includes("NHÓM 5"));x(R);const Z=new Map;H.forEach(re=>{Z.set(re.id.toString(),re.name)});const ue=q.map(re=>{const ee=Y=>{switch(Y){case"retail_director":return"Retail Director";case"team_leader":return"Trưởng nhóm";case"employee":return"Nhân viên";default:return Y}},le=Y=>Y==="0"?"PHÒNG KINH DOANH":Z.get(Y)||`Nhóm ${Y}`,ne=(Y,ie)=>ie==="0"?"Toàn quốc":`${le(ie)} - ${Y}`;return{id:re.id,name:re.name,email:re.email,role:ee(re.role),department:ne(re.location,re.team_id),status:"Đang làm việc",joinDate:new Date(re.created_at).toLocaleDateString("vi-VN"),team_name:le(re.team_id)}});n(ue)}catch(A){console.error("Error fetching employees:",A)}finally{c(!1)}},v=()=>{console.log("Thêm nhân viên mới")},j=()=>{console.log("Quản lý vai trò")},N=()=>{console.log("Quản lý phòng ban")},S=()=>{console.log("Xem báo cáo nhân sự")},_=()=>{console.log("Quản lý nghỉ phép")},D=()=>{console.log("Quản lý lương")},M=A=>{switch(A){case"Đang làm việc":return"bg-green-500/20 text-green-400";case"Nghỉ phép":return"bg-yellow-500/20 text-yellow-400";case"Nghỉ việc":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}};if(i)return s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),s.jsx("span",{className:"ml-3 text-gray-400",children:"Đang tải dữ liệu nhân sự..."})]});const E={total:a.length,directors:a.filter(A=>A.role==="Retail Director").length,teamLeaders:a.filter(A=>A.role==="Trưởng nhóm").length,employees:a.filter(A=>A.role==="Nhân viên").length,hanoi:a.filter(A=>A.department.includes("Hà Nội")).length,hcm:a.filter(A=>A.department.includes("Hồ Chí Minh")).length};return s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Quản lý Nhân sự"}),s.jsx("p",{className:"text-gray-400 mt-1",children:"Quản lý thông tin nhân viên, vai trò và phòng ban"})]}),l?.role==="retail_director"&&s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>g("overview"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="overview"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Tổng quan"}),s.jsx("button",{onClick:()=>g("management"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${h==="management"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Quản lý"})]})]})}),!m&&l?.role==="retail_director"&&s.jsx(h1,{onSetupComplete:p}),h==="management"&&l?.role==="retail_director"?s.jsx(f1,{currentUser:l}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[s.jsx("div",{className:"text-2xl font-bold text-white",children:E.total}),s.jsx("div",{className:"text-sm text-gray-400",children:"Tổng nhân viên"})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-400",children:E.directors}),s.jsx("div",{className:"text-sm text-gray-400",children:"Retail Director"})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[s.jsx("div",{className:"text-2xl font-bold text-green-400",children:E.teamLeaders}),s.jsx("div",{className:"text-sm text-gray-400",children:"Trưởng nhóm"})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-400",children:E.employees}),s.jsx("div",{className:"text-sm text-gray-400",children:"Nhân viên"})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-400",children:E.hanoi}),s.jsx("div",{className:"text-sm text-gray-400",children:"Hà Nội"})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[s.jsx("div",{className:"text-2xl font-bold text-cyan-400",children:E.hcm}),s.jsx("div",{className:"text-sm text-gray-400",children:"Hồ Chí Minh"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),title:"Thêm nhân viên",description:"Thêm nhân viên mới vào hệ thống",buttonText:"Thêm mới",buttonColor:"blue",onClick:v}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})}),title:"Quản lý vai trò",description:"Phân quyền và quản lý vai trò nhân viên",buttonText:"Quản lý",buttonColor:"green",onClick:j}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h3M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),title:"Quản lý phòng ban",description:"Tổ chức và quản lý các phòng ban",buttonText:"Quản lý",buttonColor:"purple",onClick:N}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),title:"Báo cáo nhân sự",description:"Xem báo cáo và thống kê nhân sự",buttonText:"Xem báo cáo",buttonColor:"indigo",onClick:S}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),title:"Quản lý nghỉ phép",description:"Duyệt và quản lý đơn nghỉ phép",buttonText:"Quản lý",buttonColor:"yellow",onClick:_}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),title:"Quản lý lương",description:"Tính lương và quản lý bảng lương",buttonText:"Quản lý",buttonColor:"green",onClick:D})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[s.jsx("div",{className:"bg-gray-900 px-6 py-4 border-b border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Danh sách nhân viên"}),s.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Tổng cộng: ",a.length," nhân viên"]})]}),s.jsxs("button",{onClick:v,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium flex items-center space-x-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),s.jsx("span",{children:"Thêm nhân viên"})]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-900",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Tên"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Email"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Vai trò"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Phòng ban"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Trạng thái"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Ngày vào"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Thao tác"})]})}),s.jsx("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:a.map(A=>s.jsxs("tr",{className:"hover:bg-gray-700 transition-colors",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:A.name.split(" ").map(G=>G.charAt(0)).join("").slice(0,2)}),s.jsx("div",{className:"ml-4",children:s.jsx("div",{className:"text-sm font-medium text-white",children:A.name})})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:A.email}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:A.role}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:A.department}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${M(A.status)}`,children:A.status})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:A.joinDate}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[s.jsx("button",{className:"text-blue-400 hover:text-blue-300 mr-3",children:"Sửa"}),s.jsx("button",{className:"text-red-400 hover:text-red-300",children:"Xóa"})]})]},A.id))})]})})]})]})]})}const Px=({isOpen:l,onClose:a,onSuccess:n})=>{const[i,c]=b.useState(null),[u,h]=b.useState(""),[g,m]=b.useState(!1),[x,p]=b.useState([]),[v,j]=b.useState(!1),N=b.useRef(null);if(!l)return null;const _=(()=>{try{const re=localStorage.getItem("auth_user");if(re)return JSON.parse(re).avatar||null}catch(re){console.error("Error getting current avatar:",re)}return null})(),D=()=>{try{const re=localStorage.getItem("auth_user");if(re)return JSON.parse(re).name?.split(" ").map(le=>le[0]).join("").toUpperCase().slice(0,2)||"U"}catch(re){console.error("Error getting user name:",re)}return"U"},M=re=>{const ee=[];["image/jpeg","image/jpg","image/png","image/gif"].includes(re.type)||ee.push("Chỉ hỗ trợ file JPG, PNG, GIF");const ne=5*1024*1024;return re.size>ne&&ee.push("Kích thước file không được vượt quá 5MB"),ee},E=re=>{const ee=M(re);if(ee.length>0){p(ee);return}p([]),c(re);const le=new FileReader;le.onload=ne=>{ne.target?.result&&h(ne.target.result)},le.readAsDataURL(re)},A=re=>{const ee=re.target.files?.[0];ee&&E(ee)},G=re=>{re.preventDefault(),j(!0)},q=re=>{re.preventDefault(),j(!1)},H=re=>{re.preventDefault(),j(!1);const ee=re.dataTransfer.files[0];ee&&E(ee)},R=async()=>{if(!i){p(["Vui lòng chọn ảnh để upload"]);return}m(!0),p([]);try{await new Promise(re=>setTimeout(re,2e3));try{const re=localStorage.getItem("auth_user");if(re){const ee=JSON.parse(re);ee.avatar=u,localStorage.setItem("auth_user",JSON.stringify(ee))}}catch(re){console.error("Error updating localStorage:",re)}alert(`✅ Đổi avatar thành công!

📷 Avatar mới đã được cập nhật và sẽ hiển thị trên toàn bộ hệ thống.`),n(),a(),c(null),h("")}catch(re){console.error("Error uploading avatar:",re),p(["Có lỗi xảy ra khi upload avatar. Vui lòng thử lại."])}finally{m(!1)}},Z=()=>{c(null),h(""),p([]),N.current&&(N.current.value="")},ue=re=>{if(re===0)return"0 Bytes";const ee=1024,le=["Bytes","KB","MB","GB"],ne=Math.floor(Math.log(re)/Math.log(ee));return parseFloat((re/Math.pow(ee,ne)).toFixed(2))+" "+le[ne]};return kl.createPortal(s.jsx("div",{className:"fixed inset-0 modal-backdrop-enhanced modal-container-responsive",style:{zIndex:1e6},children:s.jsxs("div",{className:"create-task-modal bg-[#1a1f2e] rounded-2xl w-full max-w-md overflow-hidden shadow-2xl border border-gray-700/50 modal-animate-in",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center",children:s.jsx(Fa,{className:"w-4 h-4 text-white"})}),s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Đổi avatar"})]}),s.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx(Fe,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"create-task-modal-content overflow-y-auto modal-scrollbar",children:s.jsxs("div",{className:"p-6 space-y-6",children:[x.length>0&&s.jsx("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(cn,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-red-400 font-medium mb-2",children:"Có lỗi xảy ra:"}),s.jsx("ul",{className:"text-red-300 text-sm space-y-1",children:x.map((re,ee)=>s.jsxs("li",{children:["• ",re]},ee))})]})]})}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Avatar hiện tại:"}),s.jsx("div",{className:"w-20 h-20 mx-auto mb-4",children:_?s.jsx("img",{src:_,alt:"Current avatar",className:"w-full h-full rounded-full object-cover border-2 border-gray-600"}):s.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-lg font-bold",children:D()})})]}),s.jsx("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${v?"border-blue-500 bg-blue-500/10":"border-gray-600 hover:border-gray-500"}`,onDragOver:G,onDragLeave:q,onDrop:H,children:u?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"w-32 h-32 mx-auto",children:s.jsx("img",{src:u,alt:"Preview",className:"w-full h-full rounded-full object-cover border-2 border-blue-500"})}),i&&s.jsxs("div",{className:"text-gray-400 text-sm",children:[s.jsx("p",{className:"font-medium",children:i.name}),s.jsx("p",{children:ue(i.size)})]}),s.jsxs("button",{type:"button",onClick:Z,className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:[s.jsx(Ux,{className:"w-4 h-4"}),"Chọn ảnh khác"]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"w-16 h-16 mx-auto bg-gray-700 rounded-full flex items-center justify-center",children:s.jsx(Hx,{className:"w-8 h-8 text-gray-400"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-white font-medium mb-2",children:"Kéo thả ảnh vào đây hoặc"}),s.jsxs("button",{type:"button",onClick:()=>N.current?.click(),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[s.jsx(Fa,{className:"w-4 h-4"}),"Chọn ảnh"]})]}),s.jsxs("div",{className:"text-gray-400 text-sm",children:[s.jsx("p",{children:"Hỗ trợ: JPG, PNG, GIF"}),s.jsx("p",{children:"Kích thước tối đa: 5MB"}),s.jsx("p",{children:"Khuyến nghị: 200x200px"})]})]})}),s.jsx("input",{ref:N,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:A,className:"hidden"}),s.jsx("div",{className:"bg-blue-900/20 border border-blue-500/30 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Fa,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-blue-300 text-sm",children:[s.jsx("p",{className:"font-medium mb-1",children:"Mẹo chọn ảnh đẹp:"}),s.jsxs("ul",{className:"space-y-1",children:[s.jsx("li",{children:"• Chọn ảnh có khuôn mặt rõ nét, không bị mờ"}),s.jsx("li",{children:"• Ảnh vuông (1:1) sẽ hiển thị đẹp nhất"}),s.jsx("li",{children:"• Tránh ảnh quá tối hoặc quá sáng"}),s.jsx("li",{children:"• Avatar sẽ hiển thị trên toàn bộ hệ thống"})]})]})]})}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",disabled:g,children:"Hủy"}),s.jsx("button",{type:"button",onClick:R,disabled:g||!i,className:"flex-1 px-4 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-800 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:g?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Đang upload..."]}):s.jsxs(s.Fragment,{children:[s.jsx(jl,{className:"w-4 h-4"}),"Cập nhật avatar"]})})]})]})})]})}),document.body)},Kx=({isOpen:l,onClose:a,onSuccess:n})=>{const[i,c]=b.useState(""),[u,h]=b.useState(!1),[g,m]=b.useState([]);if(!l)return null;const p=(()=>{try{const N=localStorage.getItem("auth_user");if(N)return JSON.parse(N).email||"user@example.com"}catch(N){console.error("Error getting current email:",N)}return"user@example.com"})(),v=N=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(N),j=async N=>{if(N.preventDefault(),m([]),!i.trim()){m(["Vui lòng nhập email mới"]);return}if(!v(i)){m(["Email không hợp lệ"]);return}if(i===p){m(["Email mới phải khác email hiện tại"]);return}h(!0);try{await new Promise(_=>setTimeout(_,1e3));const S=localStorage.getItem("auth_user");if(S){const _=JSON.parse(S);_.email=i,localStorage.setItem("auth_user",JSON.stringify(_))}alert(`✅ Đổi email thành công!

📧 Email đã được cập nhật từ:
${p}

Thành:
${i}`),console.log("Email changed successfully"),n(),a()}catch(S){console.error("Error changing email:",S),m(["Có lỗi xảy ra khi đổi email. Vui lòng thử lại."])}finally{h(!1)}};return kl.createPortal(s.jsx("div",{className:"fixed inset-0 modal-backdrop-enhanced modal-container-responsive",style:{zIndex:1e6},children:s.jsxs("div",{className:"create-task-modal bg-[#1a1f2e] rounded-2xl w-full max-w-md overflow-hidden shadow-2xl border border-gray-700/50 modal-animate-in",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:s.jsx(Cd,{className:"w-4 h-4 text-white"})}),s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Đổi email"})]}),s.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx(Fe,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:j,className:"p-6",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("p",{className:"text-gray-300 mb-2",children:[s.jsx("span",{className:"text-white font-medium",children:"Email hiện tại:"}),s.jsx("span",{className:"ml-2 text-blue-400",children:p})]})}),g.length>0&&s.jsx("div",{className:"mb-4 p-3 bg-red-600/20 border border-red-600/50 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[s.jsx(cn,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("div",{className:"text-sm",children:g.map((N,S)=>s.jsx("div",{children:N},S))})]})}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("label",{className:"block text-white font-medium mb-2",children:["Email mới ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsx("input",{type:"email",value:i,onChange:N=>c(N.target.value),placeholder:"Nhập email mới",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:u})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",disabled:u,children:"Hủy"}),s.jsx("button",{type:"submit",disabled:u||!i.trim(),className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:u?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Đang cập nhật..."]}):s.jsxs(s.Fragment,{children:[s.jsx(on,{className:"w-4 h-4"}),"Đổi email"]})})]})]})]})}),document.body)},Gx=({isOpen:l,onClose:a,onSuccess:n})=>{const[i,c]=b.useState(""),[u,h]=b.useState(""),[g,m]=b.useState(!1),[x,p]=b.useState(!1),[v,j]=b.useState([]);if(!l)return null;const N=async S=>{if(S.preventDefault(),j([]),!i.trim()){j(["Vui lòng nhập mật khẩu mới"]);return}if(i!==u){j(["Mật khẩu xác nhận không khớp"]);return}if(i.length<6){j(["Mật khẩu phải có ít nhất 6 ký tự"]);return}p(!0);try{await new Promise(_=>setTimeout(_,1e3)),alert(`✅ Đổi mật khẩu thành công!

🔒 Mật khẩu đã được cập nhật.`),console.log("Password changed successfully"),n(),a(),c(""),h("")}catch(_){console.error("Error changing password:",_),j(["Có lỗi xảy ra khi đổi mật khẩu. Vui lòng thử lại."])}finally{p(!1)}};return kl.createPortal(s.jsx("div",{className:"fixed inset-0 modal-backdrop-enhanced modal-container-responsive",style:{zIndex:1e6},children:s.jsxs("div",{className:"create-task-modal bg-[#1a1f2e] rounded-2xl w-full max-w-md overflow-hidden shadow-2xl border border-gray-700/50 modal-animate-in",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:s.jsx(Dl,{className:"w-4 h-4 text-white"})}),s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Đổi mật khẩu"})]}),s.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors",children:s.jsx(Fe,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:N,className:"p-6",children:[v.length>0&&s.jsx("div",{className:"mb-4 p-3 bg-red-600/20 border border-red-600/50 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[s.jsx(cn,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("div",{className:"text-sm",children:v.map((S,_)=>s.jsx("div",{children:S},_))})]})}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{className:"block text-white font-medium mb-2",children:["Mật khẩu mới ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:g?"text":"password",value:i,onChange:S=>c(S.target.value),placeholder:"Nhập mật khẩu mới",className:"w-full px-4 py-3 pr-12 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:x}),s.jsx("button",{type:"button",onClick:()=>m(!g),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white transition-colors",children:g?s.jsx(o2,{className:"w-5 h-5"}):s.jsx(Ed,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("label",{className:"block text-white font-medium mb-2",children:["Xác nhận mật khẩu ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsx("input",{type:"password",value:u,onChange:S=>h(S.target.value),placeholder:"Nhập lại mật khẩu mới",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:x})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",disabled:x,children:"Hủy"}),s.jsx("button",{type:"submit",disabled:x||!i.trim()||!u.trim(),className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:x?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Đang cập nhật..."]}):s.jsxs(s.Fragment,{children:[s.jsx(on,{className:"w-4 h-4"}),"Đổi mật khẩu"]})})]})]})]})}),document.body)},g1=({isOpen:l,onClose:a,onLogout:n,onNavigate:i})=>{const[c,u]=b.useState("main"),[h,g]=b.useState(!1),[m,x]=b.useState(!1),[p,v]=b.useState(!1),[j,N]=b.useState(!1);b.useEffect(()=>{l&&g(!0)},[l]);const _=(()=>{try{const R=localStorage.getItem("auth_user");return R?JSON.parse(R):$e()}catch(R){return console.error("❌ Error getting current user in ProfileModal:",R),{name:"Test User",email:"test@example.com",role:"employee",location:"Hà Nội"}}})();if(console.log("🔧 ProfileModal isOpen:",l,"user:",_.name),console.log("🔧 Modal states:",{showChangePasswordModal:j,showChangeEmailModal:p,showChangeAvatarModal:m}),!l)return null;const D=R=>{switch(R){case"retail_director":return"Giám đốc";case"team_leader":return"Trưởng nhóm";case"employee":return"Nhân viên";default:return"Người dùng"}},M=R=>R.split(" ").map(Z=>Z.charAt(0)).join("").toUpperCase().slice(0,2),E=R=>{i(R),a()},A=()=>{n(),a()},G=()=>s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-gray-700 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:M(_.name)}),s.jsx("button",{onClick:()=>x(!0),className:"absolute -bottom-1 -right-1 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors hover:scale-110",title:"Đổi avatar",children:s.jsx(Fa,{className:"w-3 h-3 text-white"})})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-white font-semibold text-lg",children:_.name}),s.jsx("p",{className:"text-gray-400 text-sm",children:_.email}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"px-2 py-1 bg-blue-600/20 text-blue-400 rounded-full text-xs font-medium",children:D(_.role)}),s.jsx("span",{className:"px-2 py-1 bg-green-600/20 text-green-400 rounded-full text-xs font-medium",children:_.location})]})]})]})}),s.jsxs("div",{className:"space-y-2",children:[(_.role==="retail_director"||_.role==="team_leader")&&s.jsxs("button",{onClick:()=>E("hr"),className:"w-full flex items-center justify-between p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(qt,{className:"w-5 h-5 text-green-400"}),s.jsx("span",{className:"text-white font-medium",children:"Quản lý Nhân viên"})]}),s.jsx(Ya,{className:"w-4 h-4 text-gray-400"})]}),s.jsxs("button",{onClick:()=>u("settings"),className:"w-full flex items-center justify-between p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(L2,{className:"w-5 h-5 text-gray-400"}),s.jsx("span",{className:"text-white font-medium",children:"Cài đặt"})]}),s.jsx(Ya,{className:"w-4 h-4 text-gray-400"})]}),s.jsxs("button",{onClick:A,className:"w-full flex items-center gap-3 p-3 bg-red-600/20 hover:bg-red-600/30 rounded-lg transition-colors",children:[s.jsx(Rx,{className:"w-5 h-5 text-red-400"}),s.jsx("span",{className:"text-red-400 font-medium",children:"Đăng xuất"})]})]})]}),q=()=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:()=>u("main"),className:"flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors",children:[s.jsx(Ya,{className:"w-4 h-4 rotate-180"}),s.jsx("span",{children:"Quay lại"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("button",{onClick:()=>{console.log("🔐 Change password button clicked"),N(!0)},className:"w-full flex items-center gap-3 p-3 bg-gray-700 hover:bg-gray-600 active:bg-gray-500 rounded-lg transition-colors touch-manipulation",children:[s.jsx(Dl,{className:"w-5 h-5 text-yellow-400"}),s.jsx("span",{className:"text-white",children:"Đổi mật khẩu"})]}),s.jsxs("button",{onClick:()=>{console.log("📧 Change email button clicked"),v(!0)},className:"w-full flex items-center gap-3 p-3 bg-gray-700 hover:bg-gray-600 active:bg-gray-500 rounded-lg transition-colors touch-manipulation",children:[s.jsx(Cd,{className:"w-5 h-5 text-blue-400"}),s.jsx("span",{className:"text-white",children:"Đổi email"})]}),s.jsxs("button",{onClick:()=>{console.log("📷 Change avatar button clicked"),x(!0)},className:"w-full flex items-center gap-3 p-3 bg-gray-700 hover:bg-gray-600 active:bg-gray-500 rounded-lg transition-colors touch-manipulation",children:[s.jsx(Fa,{className:"w-5 h-5 text-purple-400"}),s.jsx("span",{className:"text-white",children:"Đổi avatar"})]}),s.jsxs("button",{onClick:()=>{alert(`Thông tin cá nhân bao gồm:

• Họ và tên
• Email
• Số điện thoại
• Địa chỉ
• Ngày sinh
• Giới tính
• Phòng ban
• Chức vụ
• Ngày vào làm
• Trạng thái làm việc`)},className:"w-full flex items-center gap-3 p-3 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:[s.jsx($s,{className:"w-5 h-5 text-green-400"}),s.jsx("span",{className:"text-white",children:"Thông tin cá nhân"})]})]})]}),H=()=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:()=>u("main"),className:"flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors",children:[s.jsx(Ya,{className:"w-4 h-4 rotate-180"}),s.jsx("span",{children:"Quay lại"})]}),s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("h3",{className:"text-white font-semibold mb-2",children:"Quản lý Nhân viên"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Chức năng này cho phép bạn quản lý thông tin nhân viên, phân quyền và theo dõi hiệu suất làm việc."})]}),s.jsxs("button",{onClick:()=>E("hr"),className:"w-full flex items-center justify-between p-3 bg-green-600/20 hover:bg-green-600/30 rounded-lg transition-colors border border-green-500/30",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(qt,{className:"w-5 h-5 text-green-400"}),s.jsx("span",{className:"text-white font-medium",children:"Mở trang Quản lý Nhân viên"})]}),s.jsx(Ya,{className:"w-4 h-4 text-gray-400"})]})]});return kl.createPortal(s.jsxs("div",{className:"profile-modal-container md:hidden",style:{zIndex:999999},children:[s.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:a,style:{zIndex:999998}}),s.jsxs("div",{className:`profile-modal-content bg-gray-800/95 backdrop-blur-xl rounded-2xl overflow-hidden shadow-2xl border border-gray-600/50 transform transition-all duration-300 ease-out ${h?"scale-100 opacity-100":"scale-95 opacity-0"}`,style:{zIndex:999999},children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-600/50",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:c==="main"?"Tài khoản":c==="settings"?"Cài đặt":"Quản lý Nhân viên"}),s.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-700/50 rounded-xl transition-all duration-200 hover:scale-110",children:s.jsx(Fe,{className:"w-5 h-5 text-gray-400 hover:text-white transition-colors"})})]}),s.jsxs("div",{className:"p-6 pb-8 overflow-y-auto max-h-[calc(75vh-120px)]",children:[c==="main"&&G(),c==="settings"&&q(),c==="hr"&&H()]})]}),s.jsx(Px,{isOpen:m,onClose:()=>x(!1),onSuccess:()=>{x(!1)}}),s.jsx(Kx,{isOpen:p,onClose:()=>v(!1),onSuccess:()=>{v(!1)}}),s.jsx(Gx,{isOpen:j,onClose:()=>N(!1),onSuccess:()=>{N(!1)}})]}),document.body)};function x1({activeTab:l,onTabChange:a,isModalOpen:n=!1,onLogout:i}){const[c,u]=b.useState(!0),[h,g]=b.useState(0),[m,x]=b.useState("up"),[p,v]=b.useState(!1),j=b.useRef(null),N=b.useRef(null);b.useEffect(()=>{const M=()=>{const E=window.scrollY,A=Math.abs(E-h);if(document.documentElement.scrollHeight,A>3){const G=E>h?"down":"up";x(G),g(E),j.current&&clearTimeout(j.current),N.current&&clearTimeout(N.current),G==="down"?u(!1):G==="up"&&u(!0),N.current=setTimeout(()=>{u(!0)},1500)}};return window.addEventListener("scroll",M,{passive:!0}),()=>{window.removeEventListener("scroll",M),j.current&&clearTimeout(j.current),N.current&&clearTimeout(N.current)}},[h]),b.useEffect(()=>{n||p?u(!1):(m==="up"||h===0)&&u(!0)},[n,p,m,h]),b.useEffect(()=>{u(!0),j.current&&clearTimeout(j.current),N.current&&clearTimeout(N.current)},[l]);const S=(()=>{try{return $e()}catch(M){return console.error("❌ MobileDock: Error getting current user:",M),{id:"unknown",name:"Unknown User",email:"unknown@email.com",team_id:"0",location:"Hà Nội",role:"employee",team:{id:"0",name:"Unknown Team",location:"HN"}}}})(),_=M=>M.split(" ").map(E=>E.charAt(0)).join("").toUpperCase().slice(0,2),D=[{id:"home",label:"Trang Chủ",icon:Ox,color:"text-blue-400",activeColor:"text-blue-500"},{id:"work",label:"Công Việc",icon:Dx,color:"text-green-400",activeColor:"text-green-500"},{id:"plan",label:"Kế Hoạch",icon:At,color:"text-purple-400",activeColor:"text-purple-500"},{id:"customers",label:"Khách Hàng",icon:qt,color:"text-orange-400",activeColor:"text-orange-500"},{id:"profile",label:"Tài khoản",icon:$s,color:"text-purple-400",activeColor:"text-purple-500",isProfile:!0}];return s.jsxs("div",{className:`lg:hidden fixed bottom-0 left-0 right-0 z-40 transition-all duration-300 ease-in-out ${c?"translate-y-0 opacity-100":"translate-y-full opacity-0"}`,style:{pointerEvents:c?"auto":"none"},children:[s.jsx("div",{className:"mx-3 mb-1",children:s.jsx("div",{className:"bg-gray-800/90 backdrop-blur-xl border border-gray-600/30 rounded-xl shadow-2xl",children:s.jsx("div",{className:"flex items-center justify-around px-1 py-1",children:D.map(M=>{const E=l===M.id,A=M.icon;return s.jsxs("button",{onClick:()=>M.isProfile?v(!0):a(M.id),className:`
                  flex flex-col items-center justify-center p-1 rounded-lg min-w-[40px] min-h-[40px]
                  transition-all duration-300 ease-out transform
                  ${E?"bg-white/15 scale-105 shadow-lg shadow-black/20":"hover:bg-white/8 hover:scale-102 active:scale-95"}
                `,children:[s.jsxs("div",{className:`
                  relative mb-0.5 transition-all duration-300
                  ${E?"scale-105":"group-hover:scale-102"}
                `,children:[M.isProfile?s.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-xs",children:_(S.name)}):s.jsx(A,{className:`
                        w-4 h-4 transition-all duration-300
                        ${E?`${M.activeColor} drop-shadow-lg`:`${M.color} group-hover:text-white`}
                      `,strokeWidth:E?2.5:2}),E&&s.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full animate-pulse shadow-lg"})]}),s.jsx("span",{className:`
                  text-xs font-medium transition-all duration-300
                  ${E?"text-white scale-102 font-semibold":"text-gray-400 group-hover:text-gray-200"}
                `,children:M.label})]},M.id)})})})}),s.jsx("div",{className:"h-safe"}),s.jsx(g1,{isOpen:p,onClose:()=>v(!1),onLogout:i||(()=>{}),onNavigate:a})]})}function p1({onLogout:l}){const[a,n]=b.useState("account"),i=()=>{console.log("Chỉnh sửa thông tin tài khoản")},c=()=>{console.log("Đổi email")},u=()=>{console.log("Đổi mật khẩu")},h=()=>{console.log("Đổi avatar")},g=()=>{console.log("Đổi ảnh bìa")},m=()=>{switch(a){case"account":return s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),title:"Thông tin tài khoản",description:"Quản lý thông tin cá nhân và tài khoản của bạn",buttonText:"Chỉnh sửa thông tin",buttonColor:"blue",onClick:i}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),title:"Đổi Email",description:"Cập nhật địa chỉ email của tài khoản",buttonText:"Thay đổi email",buttonColor:"green",onClick:c}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),title:"Đổi mật khẩu",description:"Cập nhật mật khẩu để bảo mật tài khoản",buttonText:"Đổi mật khẩu",buttonColor:"yellow",onClick:u}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),title:"Đổi Avatar",description:"Thay đổi ảnh đại diện của bạn",buttonText:"Tải ảnh lên",buttonColor:"purple",onClick:h}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2m-9 0h10a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})}),title:"Đổi ảnh bìa",description:"Cập nhật ảnh bìa cho hồ sơ của bạn",buttonText:"Thay đổi ảnh bìa",buttonColor:"indigo",onClick:g}),s.jsx(Zt,{icon:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),title:"Đăng xuất",description:"Thoát khỏi tài khoản hiện tại",buttonText:"Đăng xuất",buttonColor:"red",fullWidth:!0,children:s.jsx("button",{onClick:l,className:"bg-red-600 text-white py-2 px-6 rounded-lg hover:bg-red-700 transition-colors text-sm font-medium ml-4",children:"Đăng xuất"})})]});case"hr":return s.jsx($x,{});default:return null}};return s.jsx("div",{className:"py-6 md:py-8",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4 md:px-0",children:[s.jsx("h3",{className:"text-xl md:text-2xl font-bold text-white mb-6 md:mb-8",children:"Cài đặt"}),s.jsxs("div",{className:"flex space-x-1 bg-gray-800 p-1 rounded-lg mb-8",children:[s.jsxs("button",{onClick:()=>n("account"),className:`px-6 py-3 rounded-md text-sm font-medium transition-colors flex items-center space-x-2 ${a==="account"?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),s.jsx("span",{children:"Tài khoản"})]}),s.jsxs("button",{onClick:()=>n("hr"),className:`px-6 py-3 rounded-md text-sm font-medium transition-colors flex items-center space-x-2 ${a==="hr"?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),s.jsx("span",{children:"Nhân sự"})]})]}),s.jsx("div",{className:"mt-8",children:m()})]})})}class y1{async getAllEmployees(){try{const{data:a,error:n}=await se.from("users").select(`
          id,
          name,
          email,
          role,
          team_id,
          location,
          department_type,
          team:teams(id, name)
        `).order("name");return n?(console.error("Error fetching employees:",n),[]):a||[]}catch(a){return console.error("Error in getAllEmployees:",a),[]}}async getAssignableEmployees(a,n,i){try{const c=await this.getAllEmployees();return n==="retail_director"?c.filter(u=>u.id!==a):n==="team_leader"?c.filter(u=>u.role==="employee"&&u.location===i&&u.id!==a):[]}catch(c){return console.error("Error in getAssignableEmployees:",c),[]}}async getTaggableEmployees(a,n){try{return(await this.getAllEmployees()).filter(c=>!(c.id===a||n&&c.location!==n)).map(c=>({id:c.id,name:c.name,email:c.email,role:this.getRoleDisplay(c.role),location:c.location,team_name:Array.isArray(c.team)?c.team[0]?.name:c.team?.name||"Không có nhóm"}))}catch(i){return console.error("Error in getTaggableEmployees:",i),[]}}async getEmployeesByLocation(a){try{const{data:n,error:i}=await se.from("users").select(`
          id,
          name,
          email,
          role,
          team_id,
          location,
          department_type,
          team:teams(id, name)
        `).eq("location",a).order("name");return i?(console.error("Error fetching employees by location:",i),[]):n||[]}catch(n){return console.error("Error in getEmployeesByLocation:",n),[]}}async getEmployeesByTeam(a){try{const{data:n,error:i}=await se.from("users").select(`
          id,
          name,
          email,
          role,
          team_id,
          location,
          department_type,
          team:teams(id, name)
        `).eq("team_id",a).order("name");return i?(console.error("Error fetching employees by team:",i),[]):n||[]}catch(n){return console.error("Error in getEmployeesByTeam:",n),[]}}async getEmployeeById(a){try{const{data:n,error:i}=await se.from("users").select(`
          id,
          name,
          email,
          role,
          team_id,
          location,
          department_type,
          team:teams(id, name)
        `).eq("id",a).single();return i||!n?null:n}catch(n){return console.error("Error in getEmployeeById:",n),null}}getRoleDisplay(a){switch(a){case"retail_director":return"Giám đốc";case"team_leader":return"Trưởng nhóm";case"employee":return"Nhân viên";default:return a}}async searchEmployees(a,n,i){try{const c=await this.getTaggableEmployees(n,i);if(!a.trim())return c.slice(0,8);const u=a.toLowerCase();return c.filter(h=>h.name.toLowerCase().includes(u)||h.email.toLowerCase().includes(u)).slice(0,8)}catch(c){return console.error("Error in searchEmployees:",c),[]}}async getCurrentEmployee(){try{const a=localStorage.getItem("auth_user");if(!a)return null;const n=JSON.parse(a);return await this.getEmployeeById(n.id)}catch(a){return console.error("Error in getCurrentEmployee:",a),null}}}const Md=new y1,Cg=({value:l,onChange:a,placeholder:n="Chọn ngày",label:i,required:c=!1,minDate:u})=>{const[h,g]=b.useState(!1),[m,x]=b.useState(new Date),[p,v]=b.useState(l?new Date(l):null),j=b.useRef(null);b.useEffect(()=>{const R=Z=>{j.current&&!j.current.contains(Z.target)&&g(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const N=R=>R?R.toLocaleDateString("vi-VN",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"",S=R=>R.toISOString().split("T")[0],_=R=>{const Z=R.getFullYear(),ue=R.getMonth(),re=new Date(Z,ue,1),le=new Date(Z,ue+1,0).getDate(),ne=re.getDay(),Y=[];for(let ie=0;ie<ne;ie++)Y.push(null);for(let ie=1;ie<=le;ie++)Y.push(new Date(Z,ue,ie));return Y},D=R=>{v(R),a(S(R)),g(!1)},M=R=>{x(Z=>{const ue=new Date(Z);return R==="prev"?ue.setMonth(Z.getMonth()-1):ue.setMonth(Z.getMonth()+1),ue})},E=R=>{if(!u)return!1;const Z=new Date(u).getTime();return R.getTime()<Z},A=R=>{const Z=new Date;return R.toDateString()===Z.toDateString()},G=R=>p?R.toDateString()===p.toDateString():!1,q=_(m),H=["CN","T2","T3","T4","T5","T6","T7"];return s.jsxs("div",{className:"relative",ref:j,children:[i&&s.jsxs("label",{className:"block text-white font-medium mb-2",children:[i," ",c&&s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsx("div",{onClick:()=>g(!h),className:"w-full p-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white cursor-pointer hover:border-gray-500 transition-colors relative",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:p?"text-white":"text-gray-400",children:p?N(p):n}),s.jsx(At,{className:"w-5 h-5 text-gray-400"})]})}),h&&s.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800 border border-gray-600 rounded-xl shadow-2xl z-50 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[s.jsx("button",{onClick:()=>M("prev"),className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:s.jsx(Ax,{className:"w-5 h-5 text-gray-400"})}),s.jsx("h3",{className:"text-white font-semibold",children:m.toLocaleDateString("vi-VN",{month:"long",year:"numeric"})}),s.jsx("button",{onClick:()=>M("next"),className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:s.jsx(Ya,{className:"w-5 h-5 text-gray-400"})})]}),s.jsx("div",{className:"grid grid-cols-7 border-b border-gray-700",children:H.map(R=>s.jsx("div",{className:"p-3 text-center text-gray-400 text-sm font-medium",children:R},R))}),s.jsx("div",{className:"grid grid-cols-7 p-2",children:q.map((R,Z)=>s.jsx("div",{className:"aspect-square p-1",children:R&&s.jsx("button",{onClick:()=>D(R),disabled:E(R),className:`
                      w-full h-full rounded-lg text-sm font-medium transition-all duration-200
                      ${G(R)?"bg-blue-500 text-white shadow-lg scale-105":A(R)?"bg-blue-500/20 text-blue-400 border border-blue-500/30":E(R)?"text-gray-600 cursor-not-allowed":"text-gray-300 hover:bg-gray-700 hover:text-white"}
                    `,children:R.getDate()})},Z))}),s.jsxs("div",{className:"p-3 border-t border-gray-700 flex gap-2",children:[s.jsx("button",{onClick:()=>D(new Date),className:"px-3 py-2 text-sm bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors",children:"Hôm nay"}),s.jsx("button",{onClick:()=>{const R=new Date;R.setDate(R.getDate()+1),D(R)},className:"px-3 py-2 text-sm bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors",children:"Ngày mai"})]})]})]})},Xu=({value:l,onChange:a,options:n,placeholder:i="Chọn...",label:c,required:u=!1})=>{const[h,g]=b.useState(!1),m=b.useRef(null);b.useEffect(()=>{const v=j=>{m.current&&!m.current.contains(j.target)&&g(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const x=n.find(v=>v.value===l),p=v=>{a(v),g(!1)};return s.jsxs("div",{className:"relative",ref:m,children:[c&&s.jsxs("label",{className:"block text-white font-medium mb-2",children:[c," ",u&&s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsx("button",{type:"button",onClick:()=>g(!h),className:"w-full p-3 bg-gray-800/50 border border-gray-600 rounded-lg text-left hover:border-gray-500 transition-colors focus:border-blue-500 focus:outline-none",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-2",children:x?s.jsxs(s.Fragment,{children:[x.color&&s.jsx("div",{className:`w-3 h-3 rounded-full ${x.color}`}),x.icon&&s.jsx(x.icon,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-white",children:x.label})]}):s.jsx("span",{className:"text-gray-400",children:i})}),s.jsx(Ks,{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${h?"rotate-180":""}`})]})}),h&&s.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl z-50 overflow-hidden",children:s.jsx("div",{className:"py-2 max-h-60 overflow-y-auto modal-scrollbar",children:n.map(v=>s.jsxs("button",{onClick:()=>p(v.value),className:`
                  w-full px-4 py-3 text-left hover:bg-gray-700 transition-colors flex items-center gap-3
                  ${l===v.value?"bg-gray-700":""}
                `,children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[v.color&&s.jsx("div",{className:`w-3 h-3 rounded-full ${v.color}`}),v.icon&&s.jsx(v.icon,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-white",children:v.label})]}),l===v.value&&s.jsx(jl,{className:"w-4 h-4 text-blue-400"})]},v.value))})})]})},v1=({value:l,onChange:a,label:n="Phạm vi chia sẻ",required:i=!1})=>{const[c,u]=b.useState(!1),h=b.useRef(null),g=[{value:"public",label:"Chung",description:"Mọi người trong công ty có thể xem",icon:Mx,color:"text-green-400"},{value:"team",label:"Nhóm",description:"Chỉ thành viên trong nhóm có thể xem",icon:qt,color:"text-blue-400"},{value:"private",label:"Tôi",description:"Chỉ mình tôi có thể xem",icon:Dl,color:"text-gray-400"}];b.useEffect(()=>{const p=v=>{h.current&&!h.current.contains(v.target)&&u(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const m=g.find(p=>p.value===l),x=p=>{a(p),u(!1)};return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-white font-medium",children:[n," ",i&&s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsxs("div",{ref:h,className:"relative",children:[s.jsx("button",{type:"button",onClick:()=>u(!c),className:"w-full p-3 bg-gray-800/50 border border-gray-600 rounded-lg hover:border-gray-500 transition-colors focus:border-blue-500 focus:outline-none",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-3",children:m&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`w-5 h-5 ${m.color}`,children:s.jsx(m.icon,{className:"w-full h-full"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-white font-medium text-sm",children:m.label}),s.jsx("div",{className:"text-gray-400 text-xs",children:m.description})]})]})}),s.jsx(Ks,{className:`w-4 h-4 text-gray-400 transition-transform duration-200 ${c?"rotate-180":""}`})]})}),c&&s.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl z-50 overflow-hidden",children:s.jsx("div",{className:"py-2",children:g.map(p=>s.jsxs("button",{onClick:()=>x(p.value),className:`
                    w-full px-4 py-3 text-left hover:bg-gray-700 transition-colors flex items-center gap-3
                    ${l===p.value?"bg-gray-700/50":""}
                  `,children:[s.jsx("div",{className:`w-5 h-5 ${p.color} flex-shrink-0`,children:s.jsx(p.icon,{className:"w-full h-full"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-white font-medium text-sm",children:p.label}),s.jsx("div",{className:"text-gray-400 text-xs mt-0.5",children:p.description})]}),l===p.value&&s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"})]},p.value))})})]}),s.jsxs("div",{className:"text-gray-400 text-sm",children:[m?.value==="public"&&"Tất cả nhân viên trong công ty có thể xem công việc này",m?.value==="team"&&"Chỉ thành viên trong nhóm của bạn có thể xem",m?.value==="private"&&"Chỉ bạn có thể xem công việc này"]})]})},b1=({label:l,value:a,onChange:n,placeholder:i="Nhập tên để tag người dùng...",required:c=!1,currentUserId:u,currentUserLocation:h})=>{const[g,m]=b.useState(!1),[x,p]=b.useState(""),[v,j]=b.useState([]),[N,S]=b.useState(!1),_=b.useRef(null),D=b.useRef(null);b.useEffect(()=>{(async()=>{if(u){S(!0);try{const ue=(await Md.searchEmployees(x,u,h)).filter(re=>!a.some(ee=>ee.id===re.id));j(ue)}catch(Z){console.error("Error searching employees:",Z),j([])}finally{S(!1)}}})()},[x,a,u,h]),b.useEffect(()=>{const R=Z=>{D.current&&!D.current.contains(Z.target)&&(m(!1),p(""))};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const M=R=>R.split(" ").map(Z=>Z[0]).join("").toUpperCase().slice(0,2),E=R=>{n([...a,R]),p(""),m(!1),setTimeout(()=>{_.current?.focus()},100)},A=R=>{n(a.filter(Z=>Z.id!==R))},G=R=>{const Z=R.target.value;p(Z),m(Z.length>0)},q=()=>{x.length>0&&m(!0)},H=R=>{R.key==="Escape"&&(m(!1),p(""))};return s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"block text-white font-medium text-sm",children:[l," ",c&&s.jsx("span",{className:"text-red-400",children:"*"})]}),a.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2 p-2 bg-gray-700/20 rounded-lg border border-gray-600/30",children:a.map(R=>s.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-blue-600/20 border border-blue-500/30 rounded-full text-sm font-medium text-blue-300 hover:bg-blue-600/30 transition-colors group",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0",children:M(R.name)}),s.jsx("span",{className:"max-w-32 truncate",children:R.name}),s.jsx("button",{type:"button",onClick:()=>A(R.id),className:"w-4 h-4 rounded-full bg-blue-500/20 hover:bg-red-500/20 flex items-center justify-center transition-colors group-hover:bg-red-500/30",title:`Xóa ${R.name}`,children:s.jsx(Fe,{className:"w-3 h-3 text-blue-300 group-hover:text-red-300"})})]},R.id))}),s.jsxs("div",{ref:D,className:"relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{ref:_,type:"text",value:x,onChange:G,onFocus:q,onKeyDown:H,placeholder:i,className:"w-full p-2.5 pl-9 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none transition-colors text-sm"}),s.jsx(Lx,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"})]}),g&&v.length>0&&s.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl z-50 overflow-hidden",children:s.jsx("div",{className:"py-2 max-h-64 overflow-y-auto modal-scrollbar",children:v.map(R=>s.jsxs("button",{type:"button",onClick:()=>E(R),className:"w-full px-4 py-3 text-left hover:bg-gray-700 transition-colors flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-sm font-bold flex-shrink-0",children:M(R.name)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-white font-medium truncate",children:R.name}),s.jsx("div",{className:"text-gray-400 text-sm truncate",children:R.email}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:R.role}),s.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:R.location}),R.team_name&&s.jsx("span",{className:"px-2 py-0.5 bg-blue-700 text-blue-300 rounded text-xs",children:R.team_name})]})]})]},R.id))})}),g&&x&&v.length===0&&s.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800 border border-gray-600 rounded-lg shadow-2xl z-50 p-4 text-center",children:s.jsxs("div",{className:"text-gray-400 text-sm",children:['Không tìm thấy người dùng nào với từ khóa "',x,'"']})})]}),a.length>0&&s.jsxs("div",{className:"text-gray-400 text-xs",children:["Đã tag ",a.length," người dùng"]})]})},po=({value:l=[],onChange:a,placeholder:n="Chọn danh mục công việc",label:i,required:c=!1,disabled:u=!1,helperText:h})=>{const[g,m]=b.useState(!1),[x,p]=b.useState(""),v=b.useRef(null),j=[{value:"sbg-new",label:"SBG mới",icon:qs,color:"bg-blue-500",category:"SBG"},{value:"sbg-old",label:"SBG cũ",icon:qs,color:"bg-blue-600",category:"SBG"},{value:"partner-new",label:"Đối tác mới",icon:qt,color:"bg-green-500",category:"ĐỐI TÁC"},{value:"partner-old",label:"Đối tác cũ",icon:qt,color:"bg-green-600",category:"ĐỐI TÁC"},{value:"kts-new",label:"KTS mới",icon:vs,color:"bg-purple-500",category:"KTS"},{value:"kts-old",label:"KTS cũ",icon:vs,color:"bg-purple-600",category:"KTS"},{value:"customer-new",label:"Khách hàng mới",icon:$s,color:"bg-orange-500",category:"KHÁCH HÀNG"},{value:"customer-old",label:"Khách hàng cũ",icon:$s,color:"bg-orange-600",category:"KHÁCH HÀNG"},{value:"other",label:"Công việc khác",icon:qs,color:"bg-gray-500",category:"KHÁC"}],N=j.reduce((q,H)=>{const R=H.category||"Khác";return q[R]||(q[R]=[]),q[R].push(H),q},{}),S=Object.entries(N).reduce((q,[H,R])=>{const Z=R.filter(ue=>ue.label.toLowerCase().includes(x.toLowerCase()));return Z.length>0&&(q[H]=Z),q},{});b.useEffect(()=>{const q=H=>{v.current&&!v.current.contains(H.target)&&m(!1)};return document.addEventListener("mousedown",q),()=>{document.removeEventListener("mousedown",q)}},[]);const _=q=>{l.includes(q)?a(l.filter(H=>H!==q)):a([...l,q])},D=q=>{a(l.filter(H=>H!==q))},M=()=>{a([])},E=j.filter(q=>l.includes(q.value)),A=E.slice(0,3),G=E.length-3;return s.jsxs("div",{className:"relative",ref:v,children:[i&&s.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[i,c&&s.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),s.jsx("button",{type:"button",onClick:()=>{u||(m(!g),g||p(""))},disabled:u,className:`w-full px-3 py-2.5 bg-gray-700 border border-gray-600 rounded-lg text-left focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors min-h-[44px] ${u?"opacity-50 cursor-not-allowed":"cursor-pointer hover:border-gray-500"}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex-1 min-w-0",children:E.length===0?s.jsx("span",{className:"text-gray-400 text-sm",children:n}):s.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[A.map(q=>s.jsxs("span",{className:`dropdown-badge inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium text-white ${q.color}`,children:[s.jsx("span",{className:"truncate max-w-[120px]",children:q.label}),s.jsx("span",{onClick:H=>{H.stopPropagation(),D(q.value)},className:"ml-1.5 hover:bg-white/20 rounded-full p-0.5 transition-colors cursor-pointer inline-flex items-center justify-center",role:"button",tabIndex:0,onKeyDown:H=>{(H.key==="Enter"||H.key===" ")&&(H.preventDefault(),H.stopPropagation(),D(q.value))},children:s.jsx(Fe,{className:"w-3 h-3"})})]},q.value)),G>0&&s.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-gray-600 text-gray-200",children:["+",G]})]})}),s.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[E.length>0&&s.jsx("span",{onClick:q=>{q.stopPropagation(),M()},className:"text-gray-400 hover:text-gray-200 transition-colors cursor-pointer inline-flex items-center justify-center",role:"button",tabIndex:0,onKeyDown:q=>{(q.key==="Enter"||q.key===" ")&&(q.preventDefault(),q.stopPropagation(),M())},title:"Xóa tất cả",children:s.jsx(Fe,{className:"w-4 h-4"})}),s.jsx(Ks,{className:`w-4 h-4 text-gray-400 transition-transform ${g?"rotate-180":""}`})]})]})}),g&&s.jsxs("div",{className:"absolute left-0 right-0 bg-gray-800 border border-gray-600 rounded-xl shadow-2xl z-50 top-full mt-2 max-h-[70vh] md:max-h-[400px] flex flex-col",children:[s.jsx("div",{className:"p-3 border-b border-gray-600 bg-gray-700/30 flex-shrink-0",children:s.jsxs("div",{className:"flex items-center justify-between",children:[E.length>0&&s.jsxs("div",{className:"text-xs text-gray-400",children:["Đã chọn: ",E.length," loại công việc"]}),s.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"Xong"})]})}),s.jsxs("div",{className:"dropdown-options-list overflow-y-auto flex-1 min-h-0",children:[Object.entries(S).map(([q,H])=>H.length===0?null:s.jsxs("div",{children:[s.jsx("div",{className:"px-3 py-1.5 bg-gray-750/30",children:s.jsx("span",{className:"text-xs font-medium text-gray-400 uppercase tracking-wider",children:q})}),s.jsx("div",{className:"dropdown-grid p-3",children:H.map(R=>{const Z=l.includes(R.value);return s.jsxs("button",{type:"button",onClick:()=>_(R.value),className:`dropdown-badge btn-touch px-3 py-2.5 rounded-full text-center min-h-[44px] flex items-center justify-center text-sm font-medium ${Z?`${R.color} text-white selected`:"bg-gray-700/50 text-gray-300 hover:bg-gray-600/70 hover:text-white"}`,children:[s.jsx("span",{className:"truncate",children:R.label}),Z&&s.jsx(jl,{className:"w-3 h-3 ml-1 flex-shrink-0"})]},R.value)})})]},q)),Object.values(S).every(q=>q.length===0)&&s.jsx("div",{className:"text-center py-8 text-gray-400",children:"Không tìm thấy loại công việc phù hợp"})]})]}),h&&s.jsx("div",{className:"text-gray-400 text-sm mt-2",children:h})]})},w1=({isOpen:l,onClose:a,onSubmit:n})=>{const[i,c]=Wr.useState(null),[u,h]=Wr.useState(!0),[g,m]=b.useState({name:"",description:"",workTypes:[],priority:"normal",status:"new-requests",startDate:new Date().toISOString().split("T")[0],dueDate:"",taggedUsers:[],department:"HN",platform:[],campaignType:"",shareScope:"team"}),x=[{value:"new-requests",label:"Chưa tiến hành",color:"bg-yellow-500",icon:Cl},{value:"approved",label:"Đang tiến hành",color:"bg-blue-500",icon:cn},{value:"live",label:"Đã hoàn thành",color:"bg-green-500",icon:on}],p=[{value:"low",label:"Thấp",color:"bg-green-500"},{value:"normal",label:"Bình thường",color:"bg-yellow-500"},{value:"high",label:"Cao",color:"bg-red-500"}];if(Wr.useEffect(()=>{l&&(async()=>{try{h(!0);const D=await Md.getCurrentEmployee();if(D){c(D);const M=D.location==="Hà Nội"?"HN":"HCM";m(E=>({...E,department:M}))}}catch(D){console.error("Error loading user data:",D)}finally{h(!1)}})()},[l]),!l)return null;if(u||!i)return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:s.jsx("div",{className:"bg-[#1a1f2e] rounded-lg sm:rounded-2xl w-full max-w-md overflow-hidden shadow-2xl border border-gray-700/50",children:s.jsxs("div",{className:"p-6 sm:p-8 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 sm:h-8 sm:w-8 border-b-2 border-blue-500 mx-auto mb-3 sm:mb-4"}),s.jsx("p",{className:"text-gray-400 text-sm sm:text-base",children:"Đang tải thông tin người dùng..."})]})})});const v=i.role==="retail_director",j=_=>{m(D=>({...D,workTypes:_}))},N=_=>{if(_.preventDefault(),!i){console.error("No current user found");return}const D=g.workTypes.length>0?g.workTypes[0]:"other";n({...g,workTypes:[D],id:`task-${Date.now()}`,createdBy:{id:i.id,name:i.name,email:i.email},assignedTo:g.taggedUsers.length>0?g.taggedUsers[0]:null,endDate:g.dueDate}),S(),a()},S=()=>{if(!i)return;const _=i.location==="Hà Nội"?"HN":"HCM";m({name:"",description:"",workTypes:[],priority:"normal",status:"new-requests",startDate:new Date().toISOString().split("T")[0],dueDate:"",taggedUsers:[],department:_,platform:[],campaignType:"",shareScope:"team"})};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:s.jsxs("div",{className:"bg-[#1a1f2e] rounded-lg sm:rounded-2xl w-full max-w-2xl max-h-[95vh] sm:max-h-[90vh] overflow-hidden shadow-2xl border border-gray-700/50 flex flex-col",children:[s.jsx("div",{className:"flex-shrink-0 p-3 sm:p-4 md:p-6 border-b border-gray-700 bg-gradient-to-r from-blue-600/10 to-purple-600/10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[s.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center shadow-lg flex-shrink-0",children:s.jsx(va,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-white truncate",children:"Tạo công việc mới"}),s.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mt-0.5 sm:mt-1 hidden sm:block",children:"Tạo và quản lý công việc hiệu quả"})]})]}),s.jsx("button",{type:"button",onClick:a,className:"flex-shrink-0 p-1.5 sm:p-2 text-gray-400 hover:text-white hover:bg-gray-700/50 rounded-lg transition-colors",children:s.jsx(Fe,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("form",{id:"create-task-form",onSubmit:N,className:"p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-6",children:[s.jsx(po,{label:"Danh mục công việc",value:g.workTypes,onChange:j,placeholder:"Chọn danh mục công việc",required:!0}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-white font-medium mb-2",children:["Tiêu đề công việc ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsx("input",{type:"text",value:g.name,onChange:_=>m({...g,name:_.target.value}),placeholder:"Nhập tiêu đề công việc...",className:"w-full p-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-white font-medium mb-2",children:["Mô tả chi tiết ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsx("textarea",{value:g.description,onChange:_=>m({...g,description:_.target.value}),placeholder:"Mô tả chi tiết về công việc, yêu cầu, mục tiêu...",rows:4,className:"w-full p-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none resize-none",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsx(Xu,{label:"Trạng thái",value:g.status,onChange:_=>m({...g,status:_}),options:x,placeholder:"Chọn trạng thái"}),s.jsx(Xu,{label:"Mức độ ưu tiên",value:g.priority,onChange:_=>m({...g,priority:_}),options:p,placeholder:"Chọn mức độ ưu tiên"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsx(Cg,{label:"Ngày thực hiện",value:g.startDate,onChange:_=>m({...g,startDate:_}),placeholder:"Chọn ngày thực hiện",required:!0}),s.jsx(Cg,{label:"Hạn chót",value:g.dueDate,onChange:_=>m({...g,dueDate:_}),placeholder:"Chọn hạn chót",minDate:g.startDate})]}),v&&s.jsxs("div",{children:[s.jsx(Xu,{label:"Chi nhánh",value:g.department,onChange:_=>m({...g,department:_,taggedUsers:[]}),options:[{value:"HN",label:"Hà Nội",icon:qs},{value:"HCM",label:"Hồ Chí Minh",icon:qs}],placeholder:"Chọn chi nhánh (tùy chọn)"}),s.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Tùy chọn - Chỉ chọn khi cần giao việc cho chi nhánh cụ thể"})]}),s.jsxs("div",{className:"bg-gray-800/30 rounded-lg p-4 border border-gray-600/50",children:[s.jsx(b1,{label:"Thêm người cùng làm việc",value:g.taggedUsers,onChange:_=>m({...g,taggedUsers:_}),placeholder:"Nhập tên để thêm đồng nghiệp cùng làm việc...",currentUserId:i.id,currentUserLocation:v&&g.department?g.department==="HN"?"Hà Nội":"Hồ Chí Minh":i.location}),s.jsx("div",{className:"text-gray-400 text-xs mt-2",children:v?g.department?`Chỉ hiển thị nhân viên tại ${g.department==="HN"?"Hà Nội":"Hồ Chí Minh"}`:`Chỉ hiển thị nhân viên tại ${i.location} (chưa chọn chi nhánh)`:`Chỉ hiển thị nhân viên tại ${i.location}`})]}),s.jsx(v1,{value:g.shareScope,onChange:_=>m({...g,shareScope:_}),label:"Phạm vi chia sẻ",required:!0})]})}),s.jsx("div",{className:"flex-shrink-0 p-3 sm:p-4 md:p-6 border-t border-gray-700/50 bg-[#1a1f2e]",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-3",children:[s.jsx("button",{type:"button",onClick:a,className:"w-full sm:w-auto px-4 sm:px-6 py-2.5 sm:py-3 text-gray-300 hover:text-white hover:bg-gray-700/30 rounded-lg transition-colors font-medium text-sm sm:text-base",children:"Hủy bỏ"}),s.jsxs("button",{type:"submit",form:"create-task-form",className:"w-full sm:w-auto px-4 sm:px-6 py-2.5 sm:py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg transition-all duration-200 flex items-center justify-center gap-2 font-medium shadow-lg hover:shadow-xl transform hover:scale-[1.02] text-sm sm:text-base",children:[s.jsx(va,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Lưu Công Việc"]})]})})]})})},j1=({isOpen:l,onClose:a,onConfirm:n,title:i="Delete Items",message:c="Are you sure you want to permanently delete this item?",itemName:u})=>{if(!l)return null;const h=()=>{n(),a()};return s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6 max-w-md w-full mx-4 shadow-2xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:i}),s.jsx("button",{onClick:a,className:"p-1 hover:bg-gray-700 rounded-lg transition-colors",children:s.jsx(Fe,{className:"w-5 h-5 text-gray-400"})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("p",{className:"text-gray-300 mb-2",children:c}),u&&s.jsxs("p",{className:"text-sm text-gray-400",children:["Item: ",s.jsx("span",{className:"text-white font-medium",children:u})]})]}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors",children:"Close"}),s.jsx("button",{onClick:h,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:"Delete"})]})]})})},pl=new Map,N1=300*1e3;function S1(l,a,n,i){const c={timestamp:new Date().toISOString(),action:l,taskId:a,taskName:i,userId:n,type:"UNAUTHORIZED_ACCESS"};console.warn("🚨 Truy cập trái phép:",c)}function _1(l){return l==="admin"||l==="manager"||l==="retail_director"}function Ja(l,a){try{const n=$e(),i=a||n?.id;if(!i||!l)return console.warn("⚠️ isTaskOwner: Missing userId or task"),!1;if(_1(n?.role))return console.log("👑 Admin/Manager có quyền chỉnh sửa tất cả tasks"),!0;const c=l.createdBy?.id===i;return console.log("🔐 Task permission check:",{taskId:l.id,taskName:l.name,createdBy:l.createdBy?.id,currentUser:i,userRole:n?.role,isOwner:c}),c}catch(n){return console.error("❌ Error checking task ownership:",n),!1}}function k1(l,a){return Ja(l,a)}function T1(l,a){return Ja(l,a)}function E1(l,a){return Ja(l,a)}function C1(l,a){return Ja(l,a)}function D1(l,a){return Ja(l,a)}function A1(l,a){return Ja(l,a)}function hd(l,a){const n=$e()?.id,i=`${l.id}-${n}`,c=pl.get(i);if(c&&Date.now()-c.timestamp<N1)return console.log("📦 Sử dụng cache cho permissions của task:",l.name),c.permissions;const h={isOwner:Ja(l,a),canEdit:k1(l,a),canDelete:T1(l,a),canChangeStatus:E1(l,a),canChangePriority:C1(l,a),canChangeWorkType:D1(l,a),canAssign:A1(l,a),canView:!0};return pl.set(i,{permissions:h,timestamp:Date.now()}),h}function Dg(l){if(l){for(const a of pl.keys())a.startsWith(l)&&pl.delete(a);console.log("🗑️ Đã xóa cache permissions cho task:",l)}else pl.clear(),console.log("🗑️ Đã xóa toàn bộ cache permissions")}function M1(l,a,n){const i=$e();return n&&i?.id&&S1(l,n,i.id,a),`❌ Bạn không có quyền ${l} công việc "${a}". Chỉ người tạo công việc hoặc Admin/Manager mới có quyền thực hiện hành động này.`}const O1=({isOpen:l,onClose:a,onSubmit:n,task:i})=>{const[c,u]=b.useState({name:"",description:"",workTypes:[],priority:"normal",status:"new-requests",dueDate:"",assignedTo:"",department:"HN",campaignType:""});b.useEffect(()=>{l&&i&&u({name:i.name||"",description:i.description||"",workTypes:i.workType?[i.workType]:[],priority:i.priority||"normal",status:i.status||"new-requests",dueDate:i.dueDate||"",assignedTo:i.assignedTo?.name||"",department:i.department||"HN",campaignType:i.campaignType||""})},[l,i]);const h=j=>{if(j.preventDefault(),!i)return;if(!hd(i).canEdit){alert(M1("chỉnh sửa",i.name,i.id));return}n({...c,id:i.id,workType:c.workTypes[0]||"other",startDate:i.startDate,dueDate:c.dueDate,assignedToId:i.assignedTo?.id}),a()},g=j=>{u(N=>({...N,workTypes:j}))},m=(j,N)=>{u(S=>({...S,[j]:N}))};if(!l||!i)return null;const p=hd(i).canEdit,v=[{value:"new-requests",label:"Chưa tiến hành"},{value:"approved",label:"Đang tiến hành"},{value:"live",label:"Đã hoàn thành"}];return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:s.jsxs("div",{className:"bg-[#1a1f2e] rounded-lg sm:rounded-2xl w-full max-w-2xl max-h-[95vh] sm:max-h-[90vh] overflow-hidden shadow-2xl border border-gray-700/50 flex flex-col",children:[s.jsx("div",{className:"flex-shrink-0 p-3 sm:p-4 md:p-6 border-b border-gray-700 bg-gradient-to-r from-blue-600/10 to-purple-600/10",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[s.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center shadow-lg flex-shrink-0",children:s.jsx(Nl,{className:"w-3 h-3 sm:w-4 sm:h-4 text-white"})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-white truncate",children:p?"Chỉnh sửa công việc":"Xem chi tiết công việc"}),s.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mt-0.5 sm:mt-1 hidden sm:block",children:p?"Cập nhật thông tin công việc":"Chỉ người tạo công việc mới có quyền chỉnh sửa"})]})]}),s.jsx("button",{type:"button",onClick:a,className:"flex-shrink-0 p-1.5 sm:p-2 text-gray-400 hover:text-white hover:bg-gray-700/50 rounded-lg transition-colors",children:s.jsx(Fe,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("form",{id:"edit-task-form",onSubmit:h,className:"p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-6",children:[s.jsx(po,{label:"Loại công việc",value:c.workTypes,onChange:g,placeholder:"Chọn loại công việc",disabled:!p,required:!0}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-white font-medium mb-2",children:["Tên công việc ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsx("input",{type:"text",value:c.name,onChange:j=>m("name",j.target.value),disabled:!p,className:`w-full p-3 border rounded-lg text-white placeholder-gray-400 focus:outline-none ${p?"bg-gray-800/50 border-gray-600 focus:border-blue-500":"bg-gray-700/30 border-gray-700 cursor-not-allowed opacity-60"}`,placeholder:"Nhập tên công việc...",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-white font-medium mb-2",children:"Mô tả chi tiết"}),s.jsx("textarea",{value:c.description,onChange:j=>m("description",j.target.value),disabled:!p,rows:4,className:`w-full p-3 border rounded-lg text-white placeholder-gray-400 focus:outline-none resize-none ${p?"bg-gray-800/50 border-gray-600 focus:border-blue-500":"bg-gray-700/30 border-gray-700 cursor-not-allowed opacity-60"}`,placeholder:"Mô tả chi tiết về công việc, yêu cầu, mục tiêu..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-white font-medium mb-2",children:"Mức độ ưu tiên"}),s.jsxs("select",{value:c.priority,onChange:j=>m("priority",j.target.value),disabled:!p,className:`w-full p-3 border rounded-lg text-white focus:outline-none ${p?"bg-gray-800/50 border-gray-600 focus:border-blue-500":"bg-gray-700/30 border-gray-700 cursor-not-allowed opacity-60"}`,children:[s.jsx("option",{value:"low",children:"Thấp"}),s.jsx("option",{value:"normal",children:"Bình thường"}),s.jsx("option",{value:"high",children:"Cao"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-white font-medium mb-2",children:"Trạng thái"}),s.jsx("select",{value:c.status,onChange:j=>m("status",j.target.value),disabled:!p,className:`w-full p-3 border rounded-lg text-white focus:outline-none ${p?"bg-gray-800/50 border-gray-600 focus:border-blue-500":"bg-gray-700/30 border-gray-700 cursor-not-allowed opacity-60"}`,children:v.map(j=>s.jsx("option",{value:j.value,children:j.label},j.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-white font-medium mb-2",children:"Ngày hoàn thành"}),s.jsx("input",{type:"date",value:c.dueDate,onChange:j=>m("dueDate",j.target.value),disabled:!p,className:`w-full p-3 border rounded-lg text-white focus:outline-none ${p?"bg-gray-800/50 border-gray-600 focus:border-blue-500":"bg-gray-700/30 border-gray-700 cursor-not-allowed opacity-60"}`})]})]})]})}),s.jsx("div",{className:"flex-shrink-0 p-3 sm:p-4 md:p-6 border-t border-gray-700/50 bg-[#1a1f2e]",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-3",children:[s.jsx("button",{type:"button",onClick:a,className:"w-full sm:w-auto px-4 sm:px-6 py-2.5 sm:py-3 text-gray-300 hover:text-white hover:bg-gray-700/30 rounded-lg transition-colors font-medium text-sm sm:text-base",children:p?"Hủy":"Đóng"}),p&&s.jsxs("button",{type:"submit",form:"edit-task-form",className:"w-full sm:w-auto px-4 sm:px-6 py-2.5 sm:py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg transition-all duration-200 flex items-center justify-center gap-2 font-medium shadow-lg hover:shadow-xl transform hover:scale-[1.02] text-sm sm:text-base",children:[s.jsx(Nl,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Lưu thay đổi"]})]})})]})})},Ag={"sbg-new":{label:"SBG mới",color:"bg-blue-500/20 text-blue-300 border-blue-500/30"},"sbg-old":{label:"SBG cũ",color:"bg-blue-600/20 text-blue-400 border-blue-600/30"},"partner-new":{label:"Đối tác mới",color:"bg-green-500/20 text-green-300 border-green-500/30"},"partner-old":{label:"Đối tác cũ",color:"bg-green-600/20 text-green-400 border-green-600/30"},"kts-new":{label:"KTS mới",color:"bg-purple-500/20 text-purple-300 border-purple-500/30"},"kts-old":{label:"KTS cũ",color:"bg-purple-600/20 text-purple-400 border-purple-600/30"},"customer-new":{label:"Khách hàng mới",color:"bg-orange-500/20 text-orange-300 border-orange-500/30"},"customer-old":{label:"Khách hàng cũ",color:"bg-orange-600/20 text-orange-400 border-orange-600/30"},other:{label:"Công việc khác",color:"bg-gray-500/20 text-gray-300 border-gray-500/30"}},R1=({value:l,onChange:a,className:n=""})=>{const i=Ag[l]||Ag.other;return s.jsxs("div",{className:`relative inline-flex items-center ${n}`,children:[s.jsx("div",{"data-testid":"work-type-badge",className:`px-2 py-1 rounded-full text-xs font-medium border ${i.color} bg-gray-800/50`,title:i.label,children:i.label}),a&&s.jsxs("select",{"aria-label":"Đổi danh mục công việc",value:l,onChange:c=>a(c.target.value),className:"absolute inset-0 opacity-0 cursor-pointer",children:[s.jsx("option",{value:"sbg-new",children:"SBG mới"}),s.jsx("option",{value:"sbg-old",children:"SBG cũ"}),s.jsx("option",{value:"partner-new",children:"Đối tác mới"}),s.jsx("option",{value:"partner-old",children:"Đối tác cũ"}),s.jsx("option",{value:"kts-new",children:"KTS mới"}),s.jsx("option",{value:"kts-old",children:"KTS cũ"}),s.jsx("option",{value:"customer-new",children:"Khách hàng mới"}),s.jsx("option",{value:"customer-old",children:"Khách hàng cũ"}),s.jsx("option",{value:"other",children:"Công việc khác"})]})]})},U1=["sbg-new","sbg-old","partner-new","partner-old","kts-new","kts-old","customer-new","customer-old","other"],lo=({workTypes:l,onChange:a,maxDisplay:n=3,className:i=""})=>{const c=(()=>{if(console.log("🏷️ MultiWorkTypeBadges received workTypes:",l,"Type:",typeof l),!l)return["other"];if(Array.isArray(l))return l;if(typeof l=="string"){if(l.startsWith("[")&&l.endsWith("]"))try{const v=JSON.parse(l);return Array.isArray(v)?v:[l]}catch{return[l]}return[l]}return["other"]})();console.log("🏷️ Normalized workTypes:",c);const u=c.slice(0,n),h=c.length-n,g=U1.filter(v=>!c.includes(v)),m=v=>{if(a){const j=c.filter(N=>N!==v);a(j)}},x=v=>{a&&!c.includes(v)&&a([...c,v])},p=(v,j)=>{if(a){const N=c.map(S=>S===v?j:S);a(N)}};return s.jsxs("div",{className:`flex items-center gap-1 flex-wrap ${i}`,children:[u.map((v,j)=>s.jsxs("div",{className:"relative group",children:[s.jsx(R1,{value:v,onChange:a?N=>p(v,N):void 0}),a&&c.length>1&&s.jsx("button",{onClick:N=>{N.stopPropagation(),m(v)},className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 hover:bg-red-600 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",title:"Xóa danh mục",children:s.jsx(Fe,{className:"w-2 h-2 text-white"})})]},`${v}-${j}`)),h>0&&s.jsxs("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium text-white bg-gray-600 border border-gray-500/30",title:`+${h} danh mục khác`,children:["+",h]}),a&&g.length>0&&s.jsxs("div",{className:"relative inline-flex items-center",children:[s.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium text-gray-300 bg-gray-700/50 hover:bg-gray-600/50 border border-gray-600/30 transition-colors cursor-pointer",title:"Thêm danh mục",children:s.jsx(va,{className:"w-3 h-3"})}),s.jsxs("select",{value:"",onChange:v=>{v.target.value&&(x(v.target.value),v.target.value="")},className:"absolute inset-0 opacity-0 cursor-pointer",children:[s.jsx("option",{value:"",children:"Thêm danh mục"}),g.map(v=>s.jsxs("option",{value:v,children:[v==="sbg-new"&&"SBG mới",v==="sbg-old"&&"SBG cũ",v==="partner-new"&&"Đối tác mới",v==="partner-old"&&"Đối tác cũ",v==="kts-new"&&"KTS mới",v==="kts-old"&&"KTS cũ",v==="customer-new"&&"Khách hàng mới",v==="customer-old"&&"Khách hàng cũ",v==="other"&&"Công việc khác"]},v))]})]})]})},Mg={high:{label:"Cao",color:"bg-red-500/20 text-red-300 border-red-500/30"},normal:{label:"Bình thường",color:"bg-blue-500/20 text-blue-300 border-blue-500/30"},low:{label:"Thấp",color:"bg-gray-500/20 text-gray-300 border-gray-500/30"}},io=({value:l,onChange:a,className:n=""})=>{const i=Mg[l]||Mg.normal;return s.jsxs("div",{className:`relative inline-flex items-center ${n}`,children:[s.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium border ${i.color} bg-gray-800/50`,title:`Ưu tiên ${i.label}`,children:i.label}),a&&s.jsxs("select",{"aria-label":"Đổi ưu tiên",value:l,onChange:c=>a(c.target.value),className:"absolute inset-0 opacity-0 cursor-pointer",children:[s.jsx("option",{value:"low",children:"Thấp"}),s.jsx("option",{value:"normal",children:"Bình thường"}),s.jsx("option",{value:"high",children:"Cao"})]})]})},L1=({tasks:l,activeFilter:a,onFilterChange:n,compact:i=!1})=>{const c={all:l.length,"new-requests":l.filter(h=>h.status==="new-requests").length,approved:l.filter(h=>h.status==="approved").length,live:l.filter(h=>h.status==="live").length},u=[{key:"all",label:"Tất cả",icon:null,count:c.all,color:"text-gray-400",bgColor:"bg-gray-700/50",activeColor:"text-white",activeBgColor:"bg-gray-600",borderColor:"border-gray-600",activeBorderColor:"border-gray-500"},{key:"new-requests",label:i?"Chưa bắt đầu":"Chưa tiến hành",icon:Cl,count:c["new-requests"],color:"text-yellow-400",bgColor:"bg-yellow-500/10",activeColor:"text-yellow-300",activeBgColor:"bg-yellow-500/20",borderColor:"border-yellow-500/30",activeBorderColor:"border-yellow-400"},{key:"approved",label:i?"Đang làm":"Đang tiến hành",icon:cn,count:c.approved,color:"text-blue-400",bgColor:"bg-blue-500/10",activeColor:"text-blue-300",activeBgColor:"bg-blue-500/20",borderColor:"border-blue-500/30",activeBorderColor:"border-blue-400"},{key:"live",label:i?"Hoàn thành":"Đã hoàn thành",icon:on,count:c.live,color:"text-green-400",bgColor:"bg-green-500/10",activeColor:"text-green-300",activeBgColor:"bg-green-500/20",borderColor:"border-green-500/30",activeBorderColor:"border-green-400"}];return s.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-lg border border-gray-700/50 p-3 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),s.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Lọc nhanh theo trạng thái"})]}),s.jsx("div",{className:`grid gap-2 ${i?"grid-cols-2 sm:grid-cols-4":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-4"}`,children:u.map(h=>{const g=a===h.key,m=h.icon;return s.jsxs("button",{onClick:()=>n(h.key),className:`
                relative flex items-center gap-2 p-3 rounded-lg border transition-all duration-200
                hover:scale-[1.02] hover:shadow-lg
                ${g?`${h.activeBgColor} ${h.activeBorderColor} ${h.activeColor}`:`${h.bgColor} ${h.borderColor} ${h.color} hover:${h.activeBgColor}`}
                ${i?"text-xs":"text-sm"}
              `,children:[m&&s.jsx(m,{className:`${i?"w-3 h-3":"w-4 h-4"} flex-shrink-0`}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("div",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:h.label}),s.jsxs("div",{className:"text-xs opacity-75",children:[h.count," công việc"]})]}),s.jsx("div",{className:`
                px-2 py-1 rounded-full text-xs font-bold
                ${g?"bg-white/20 text-white":"bg-gray-700/50 text-gray-300"}
              `,children:h.count}),g&&s.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-white rounded-full opacity-75"})]},h.key)})}),s.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700/50",children:s.jsxs("div",{className:"text-xs text-gray-400 text-center",children:["Tổng cộng: ",s.jsx("span",{className:"font-medium text-gray-300",children:c.all})," công việc",a!=="all"&&s.jsxs("span",{className:"ml-2",children:["• Đang hiển thị: ",s.jsx("span",{className:"font-medium text-blue-300",children:c[a]})]})]})})]})},Og={private:{label:"Cá nhân",icon:Dl,color:"bg-gray-500/20 text-gray-300 border-gray-500/30"},team:{label:"Nhóm",icon:qt,color:"bg-blue-500/20 text-blue-300 border-blue-500/30"},public:{label:"Công khai",icon:Mx,color:"bg-green-500/20 text-green-300 border-green-500/30"}},oo=({value:l,onChange:a,className:n=""})=>{const i=Og[l]||Og.team,c=i.icon;return s.jsxs("div",{className:`relative inline-flex items-center ${n}`,children:[s.jsx("div",{className:`w-6 h-6 rounded-full border flex items-center justify-center ${i.color} bg-gray-800/50`,title:i.label,children:s.jsx(c,{className:"w-3 h-3"})}),a&&s.jsxs("select",{"aria-label":"Đổi phạm vi chia sẻ",value:l,onChange:u=>a(u.target.value),className:"absolute inset-0 opacity-0 cursor-pointer",children:[s.jsx("option",{value:"private",children:"Cá nhân"}),s.jsx("option",{value:"team",children:"Nhóm"}),s.jsx("option",{value:"public",children:"Công khai"})]})]})},Rg={"new-requests":{label:"Chưa tiến hành",color:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30"},approved:{label:"Đang tiến hành",color:"bg-blue-500/20 text-blue-300 border-blue-500/30"},live:{label:"Đã hoàn thành",color:"bg-green-500/20 text-green-300 border-green-500/30"}},co=({value:l,onChange:a,className:n=""})=>{const i=Rg[l]||Rg["new-requests"];return s.jsxs("div",{className:`relative inline-flex items-center ${n}`,children:[s.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium border ${i.color} bg-gray-800/50`,title:i.label,children:i.label}),a&&s.jsxs("select",{"aria-label":"Đổi trạng thái",value:l,onChange:c=>a(c.target.value),className:"absolute inset-0 opacity-0 cursor-pointer",children:[s.jsx("option",{value:"new-requests",children:"Chưa tiến hành"}),s.jsx("option",{value:"approved",children:"Đang tiến hành"}),s.jsx("option",{value:"live",children:"Đã hoàn thành"})]})]})},pa=({task:l,onEdit:a,onDelete:n,compact:i=!1})=>{const c=l?hd(l):{canEdit:!0,canDelete:!0};if(!c.canEdit&&!c.canDelete)return null;const u=g=>{g.stopPropagation(),a&&a(g)},h=g=>{g.stopPropagation(),n&&n(g)};return i?s.jsxs("div",{className:"flex items-center gap-1 bg-gray-800/90 backdrop-blur-sm rounded-lg p-1 shadow-lg border border-gray-600/50",children:[c.canEdit&&s.jsx("button",{onClick:u,className:`
              p-2 rounded-md
              bg-blue-500/20 border border-blue-500/30
              text-blue-300 hover:text-blue-200
              hover:bg-blue-500/30 hover:border-blue-400/50
              hover:scale-105 hover:shadow-md
              transition-all duration-200
              backdrop-blur-sm
              min-h-[44px] min-w-[44px] md:min-h-[auto] md:min-w-[auto]
              active:scale-95 active:bg-blue-500/40
            `,title:"Chỉnh sửa công việc",children:s.jsx(en,{className:"w-4 h-4"})}),c.canDelete&&s.jsx("button",{onClick:h,className:`
              p-2 rounded-md
              bg-red-500/20 border border-red-500/30
              text-red-300 hover:text-red-200
              hover:bg-red-500/30 hover:border-red-400/50
              hover:scale-105 hover:shadow-md
              transition-all duration-200
              backdrop-blur-sm
              min-h-[44px] min-w-[44px] md:min-h-[auto] md:min-w-[auto]
              active:scale-95 active:bg-red-500/40
            `,title:"Xóa công việc",children:s.jsx(Xa,{className:"w-4 h-4"})})]}):s.jsxs("div",{className:"flex flex-col gap-2",children:[c.canEdit&&s.jsx("button",{onClick:u,className:"p-2 rounded-lg bg-blue-500/10 border border-blue-500/20 text-blue-400 hover:bg-blue-500/20 hover:text-blue-300 transition-all duration-200 group",title:"Chỉnh sửa công việc",children:s.jsx(en,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})}),c.canDelete&&s.jsx("button",{onClick:h,className:"p-2 rounded-lg bg-red-500/10 border border-red-500/20 text-red-400 hover:bg-red-500/20 hover:text-red-300 transition-all duration-200 group",title:"Xóa công việc",children:s.jsx(Xa,{className:"w-4 h-4 group-hover:scale-110 transition-transform"})})]})},Fi=({task:l,onUpdateTask:a,compact:n=!1,maxWorkTypes:i=2})=>n?s.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[s.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:s.jsx(lo,{workTypes:l.workTypes||[l.workType],onChange:c=>{a({id:l.id,workTypes:c})},maxDisplay:i})}),s.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[s.jsx(co,{value:l.status,onChange:c=>a({id:l.id,status:c})}),s.jsx(io,{value:l.priority,onChange:c=>a({id:l.id,priority:c})})]}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsx(oo,{value:l.shareScope||"team",onChange:c=>a({id:l.id,shareScope:c})})})]}):s.jsxs("div",{className:"flex items-center gap-2 flex-wrap w-full",children:[s.jsx(lo,{workTypes:l.workTypes||[l.workType],onChange:c=>{a({id:l.id,workTypes:c})},maxDisplay:i}),s.jsx(co,{value:l.status,onChange:c=>a({id:l.id,status:c})}),s.jsx(io,{value:l.priority,onChange:c=>a({id:l.id,priority:c})}),s.jsx(oo,{value:l.shareScope||"team",onChange:c=>a({id:l.id,shareScope:c})})]}),Ug=({value:l,onChange:a,placeholder:n="Chọn ngày",label:i,required:c=!1,minDate:u,maxDate:h,isOpen:g,onToggle:m,onClose:x,buttonClassName:p="",color:v="blue"})=>{const[j,N]=b.useState(new Date),[S,_]=b.useState(l?new Date(l):null),D=b.useRef(null),E={green:{button:"hover:border-green-500 focus:border-green-500",accent:"bg-green-500 text-white",hover:"hover:bg-green-500/10"},red:{button:"hover:border-red-500 focus:border-red-500",accent:"bg-red-500 text-white",hover:"hover:bg-red-500/10"},blue:{button:"hover:border-blue-500 focus:border-blue-500",accent:"bg-blue-500 text-white",hover:"hover:bg-blue-500/10"},purple:{button:"hover:border-purple-500 focus:border-purple-500",accent:"bg-purple-500 text-white",hover:"hover:bg-purple-500/10"}}[v];b.useEffect(()=>{if(l){const ne=new Date(l);_(ne),N(ne)}},[l]),b.useEffect(()=>{const ne=Y=>{D.current&&!D.current.contains(Y.target)&&x()};if(g)return document.addEventListener("mousedown",ne),()=>document.removeEventListener("mousedown",ne)},[g,x]),b.useEffect(()=>{const ne=Y=>{Y.key==="Escape"&&g&&x()};if(g)return document.addEventListener("keydown",ne),()=>document.removeEventListener("keydown",ne)},[g,x]);const A=ne=>ne?ne.toLocaleDateString("vi-VN",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"}):n,G=ne=>ne.toISOString().split("T")[0],q=ne=>{const Y=ne.getFullYear(),ie=ne.getMonth(),L=new Date(Y,ie,1),ae=new Date(Y,ie+1,0).getDate(),ye=L.getDay(),k=[];for(let V=0;V<ye;V++)k.push(null);for(let V=1;V<=ae;V++)k.push(new Date(Y,ie,V));return k},H=ne=>{_(ne),a(G(ne)+"T00:00:00.000Z"),x()},R=ne=>{N(Y=>{const ie=new Date(Y);return ne==="prev"?ie.setMonth(Y.getMonth()-1):ie.setMonth(Y.getMonth()+1),ie})},Z=ne=>{const Y=ne.getTime();if(u){const ie=new Date(u).getTime();if(Y<ie)return!0}if(h){const ie=new Date(h).getTime();if(Y>ie)return!0}return!1},ue=ne=>{const Y=new Date;return ne.toDateString()===Y.toDateString()},re=ne=>S?ne.toDateString()===S.toDateString():!1,ee=q(j),le=["CN","T2","T3","T4","T5","T6","T7"];return s.jsxs("div",{className:"relative",ref:D,children:[i&&s.jsxs("label",{className:"block text-white font-medium mb-2 text-sm",children:[i," ",c&&s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsx("button",{type:"button",onClick:m,className:`w-full p-2.5 bg-gray-800/50 border border-gray-600 rounded-lg text-white text-left transition-all duration-200 ${E.button} ${p}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:S?"text-white":"text-gray-400",children:A(S)}),s.jsx(At,{className:"w-4 h-4 text-gray-400"})]})}),g&&s.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800/95 backdrop-blur-xl border border-gray-600/50 rounded-2xl shadow-2xl z-50 overflow-hidden animate-in slide-in-from-top-2 duration-300 min-w-[320px] md:min-w-[380px]",children:[s.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-700/50 bg-gray-800/80",children:[s.jsx("button",{onClick:()=>R("prev"),className:"p-3 hover:bg-gray-700/50 rounded-xl transition-all duration-200 hover:scale-105",children:s.jsx(Ax,{className:"w-5 h-5 text-gray-300"})}),s.jsx("h3",{className:"text-white font-semibold text-xl tracking-wide",children:j.toLocaleDateString("vi-VN",{month:"long",year:"numeric"})}),s.jsx("button",{onClick:()=>R("next"),className:"p-3 hover:bg-gray-700/50 rounded-xl transition-all duration-200 hover:scale-105",children:s.jsx(Ya,{className:"w-5 h-5 text-gray-300"})})]}),s.jsx("div",{className:"grid grid-cols-7 border-b border-gray-700/30 bg-gray-800/60",children:le.map(ne=>s.jsx("div",{className:"p-4 text-center text-gray-400 text-sm font-semibold",children:ne},ne))}),s.jsx("div",{className:"grid grid-cols-7 p-4 gap-2",children:ee.map((ne,Y)=>s.jsx("div",{className:"aspect-square",children:ne&&s.jsx("button",{onClick:()=>H(ne),disabled:Z(ne),className:`
                      w-full h-full rounded-xl text-base font-semibold transition-all duration-200 transform min-h-[44px]
                      ${re(ne)?`${E.accent} shadow-lg scale-105 ring-2 ring-white/20`:ue(ne)?`${E.hover} text-${v}-400 border border-${v}-500/30 scale-105`:Z(ne)?"text-gray-600 cursor-not-allowed":"text-gray-300 hover:bg-gray-700/50 hover:text-white hover:scale-105"}
                    `,children:ne.getDate()})},Y))}),s.jsxs("div",{className:"p-4 border-t border-gray-700/30 flex gap-3 bg-gray-800/60",children:[s.jsx("button",{onClick:()=>H(new Date),className:"px-5 py-3 text-sm font-medium bg-gray-700/50 hover:bg-gray-600/50 text-gray-300 hover:text-white rounded-xl transition-all duration-200 hover:scale-105",children:"Hôm nay"}),s.jsx("button",{onClick:()=>{const ne=new Date;ne.setDate(ne.getDate()+1),H(ne)},className:"px-5 py-3 text-sm font-medium bg-gray-700/50 hover:bg-gray-600/50 text-gray-300 hover:text-white rounded-xl transition-all duration-200 hover:scale-105",children:"Ngày mai"}),s.jsx("div",{className:"flex-1"}),s.jsx("button",{onClick:x,className:"p-3 hover:bg-gray-700/50 rounded-xl transition-all duration-200 hover:scale-105",title:"Đóng",children:s.jsx(Fe,{className:"w-5 h-5 text-gray-400 hover:text-white"})})]})]})]})},H1=({status:l,priority:a,onStatusChange:n,onPriorityChange:i,isEditMode:c})=>{const u=x=>{switch(x){case"new-requests":return{label:"Yêu cầu mới",color:"bg-yellow-500/20 text-yellow-300 border-yellow-500/30"};case"approved":return{label:"Đã duyệt",color:"bg-blue-500/20 text-blue-300 border-blue-500/30"};case"live":return{label:"Đang thực hiện",color:"bg-green-500/20 text-green-300 border-green-500/30"};default:return{label:"Không xác định",color:"bg-gray-500/20 text-gray-300 border-gray-500/30"}}},h=x=>{switch(x){case"low":return{label:"Thấp",color:"bg-gray-500/20 text-gray-300 border-gray-500/30"};case"normal":return{label:"Bình thường",color:"bg-blue-500/20 text-blue-300 border-blue-500/30"};case"high":return{label:"Cao",color:"bg-red-500/20 text-red-300 border-red-500/30"};default:return{label:"Bình thường",color:"bg-blue-500/20 text-blue-300 border-blue-500/30"}}},g=u(l),m=h(a);return c?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"relative",children:s.jsxs("div",{className:`relative px-3 py-1 rounded-full text-xs font-medium border cursor-pointer ${g.color} bg-gray-800/50`,children:[s.jsxs("select",{value:l,onChange:x=>n(x.target.value),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",children:[s.jsx("option",{value:"new-requests",children:"Yêu cầu mới"}),s.jsx("option",{value:"approved",children:"Đã duyệt"}),s.jsx("option",{value:"live",children:"Đang thực hiện"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:g.label}),s.jsx(Ks,{className:"w-3 h-3 ml-1"})]})]})}),s.jsx("div",{className:"relative",children:s.jsxs("div",{className:`relative px-3 py-1 rounded-full text-xs font-medium border cursor-pointer ${m.color} bg-gray-800/50`,children:[s.jsxs("select",{value:a,onChange:x=>i(x.target.value),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",children:[s.jsx("option",{value:"low",children:"Thấp"}),s.jsx("option",{value:"normal",children:"Bình thường"}),s.jsx("option",{value:"high",children:"Cao"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:m.label}),s.jsx(Ks,{className:"w-3 h-3 ml-1"})]})]})})]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${g.color}`,children:g.label}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${m.color}`,children:m.label})]})},B1="https://fnakxavwxubnbucfoujd.supabase.co",q1="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZuYWt4YXZ3eHVibmJ1Y2ZvdWpkIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MDU4NjY2MSwiZXhwIjoyMDY2MTYyNjYxfQ.Xwa7Zz2pgg9wp-pqukoGSKy2IMg11kExKolbrBSQfAM",Xi=kx(B1,q1,{auth:{autoRefreshToken:!1,persistSession:!1}});class z1{constructor(){this.BUCKET_NAME="task-attachments"}get storage(){return Xi.storage}async uploadFile(a,n){try{const{data:i,error:c}=await Xi.storage.from(this.BUCKET_NAME).upload(a,n,{cacheControl:"3600",upsert:!1});return c?(console.error("Storage upload error:",c),{success:!1,error:c.message}):{success:!0,data:i}}catch(i){return console.error("Upload error:",i),{success:!1,error:"Upload failed"}}}async getSignedUrl(a,n=3600){try{const{data:i,error:c}=await Xi.storage.from(this.BUCKET_NAME).createSignedUrl(a,n);return c?(console.error("Signed URL error:",c),null):i.signedUrl}catch(i){return console.error("Signed URL error:",i),null}}async deleteFile(a){try{const{error:n}=await Xi.storage.from(this.BUCKET_NAME).remove([a]);return n?(console.error("Delete error:",n),{success:!1,error:n.message}):{success:!0}}catch(n){return console.error("Delete error:",n),{success:!1,error:"Delete failed"}}}}const Zi=new z1;class $1{constructor(){this.BUCKET_NAME="task-attachments",this.MAX_FILE_SIZE=50*1024*1024,this.ALLOWED_TYPES=["image/jpeg","image/png","image/gif","image/webp","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","text/csv"]}validateFile(a){return a.size>this.MAX_FILE_SIZE?{valid:!1,error:"File size exceeds 50MB limit"}:this.ALLOWED_TYPES.includes(a.type)?{valid:!0}:{valid:!1,error:"File type not allowed"}}generateFilePath(a,n,i){const c=Date.now(),u=n.replace(/[^a-zA-Z0-9.-]/g,"_");return`tasks/${a}/${i}/${c}_${u}`}async uploadAttachment(a){try{const n=$e();if(!n)return{success:!1,error:"User not authenticated"};const i=this.validateFile(a.file);if(!i.valid)return{success:!1,error:i.error};const c=this.generateFilePath(a.taskId,a.file.name,n.id),{data:u,error:h}=await Zi.storage.from(this.BUCKET_NAME).upload(c,a.file,{cacheControl:"3600",upsert:!1});if(h)return console.error("Storage upload error:",h),{success:!1,error:"Failed to upload file to storage"};const{data:g,error:m}=await se.from("task_attachments").insert({task_id:a.taskId,file_name:a.file.name,file_path:c,file_size:a.file.size,file_type:a.file.type,uploaded_by:n.id}).select().single();return m?(console.error("Database insert error:",m),await Zi.storage.from(this.BUCKET_NAME).remove([c]),{success:!1,error:"Failed to save attachment record"}):{success:!0,attachment:g}}catch(n){return console.error("Upload attachment error:",n),{success:!1,error:"Unexpected error during upload"}}}async getTaskAttachments(a){try{const{data:n,error:i}=await se.from("task_attachments").select("*").eq("task_id",a).order("created_at",{ascending:!1});if(i)throw console.error("Error fetching attachments:",i),new Error("Failed to fetch attachments");return n||[]}catch(n){throw console.error("Get task attachments error:",n),n}}async getAttachmentUrl(a,n=3600){try{const{data:i,error:c}=await Zi.storage.from(this.BUCKET_NAME).createSignedUrl(a,n);return c?(console.error("Error creating signed URL:",c),null):i.signedUrl}catch(i){return console.error("Get attachment URL error:",i),null}}async deleteAttachment(a){try{const n=$e();if(!n)return{success:!1,error:"User not authenticated"};const{data:i,error:c}=await se.from("task_attachments").select("*").eq("id",a).single();if(c||!i)return{success:!1,error:"Attachment not found"};if(i.uploaded_by!==n.id)return{success:!1,error:"Not authorized to delete this attachment"};const{error:u}=await Zi.storage.from(this.BUCKET_NAME).remove([i.file_path]);u&&console.error("Storage delete error:",u);const{error:h}=await se.from("task_attachments").delete().eq("id",a);return h?(console.error("Database delete error:",h),{success:!1,error:"Failed to delete attachment record"}):{success:!0}}catch(n){return console.error("Delete attachment error:",n),{success:!1,error:"Unexpected error during deletion"}}}getFileTypeIcon(a){return a.startsWith("image/")?"🖼️":a==="application/pdf"?"📄":a.includes("word")?"📝":a.includes("excel")||a.includes("spreadsheet")?"📊":a.startsWith("text/")?"📄":"📎"}formatFileSize(a){if(a===0)return"0 Bytes";const n=1024,i=["Bytes","KB","MB","GB"],c=Math.floor(Math.log(a)/Math.log(n));return parseFloat((a/Math.pow(n,c)).toFixed(2))+" "+i[c]}isImageFile(a){return a.startsWith("image/")}}const ps=new $1,P1=({taskId:l,onAttachmentsChange:a})=>{const[n,i]=b.useState([]),[c,u]=b.useState(!1),[h,g]=b.useState(!0),[m,x]=b.useState(!1),[p,v]=b.useState(null),[j,N]=b.useState(null),[S,_]=b.useState(!0),D=b.useRef(null);b.useEffect(()=>{M()},[l]),b.useEffect(()=>{const ee=le=>{le.key==="Escape"&&p&&(v(null),N(null))};if(p)return document.addEventListener("keydown",ee),()=>document.removeEventListener("keydown",ee)},[p]);const M=async()=>{try{g(!0);const ee=await ps.getTaskAttachments(l);i(ee),a?.(ee)}catch(ee){console.error("Error loading attachments:",ee)}finally{g(!1)}},E=ee=>{ee&&Array.from(ee).forEach(le=>{A(le)})},A=async ee=>{try{u(!0);const le=await ps.uploadAttachment({taskId:l,file:ee});le.success&&le.attachment?(i(ne=>[le.attachment,...ne]),a?.([le.attachment,...n])):alert(le.error||"Failed to upload file")}catch(le){console.error("Upload error:",le),alert("Failed to upload file")}finally{u(!1)}},G=async ee=>{if(confirm("Bạn có chắc muốn xóa file này?"))try{const le=await ps.deleteAttachment(ee);if(le.success){const ne=n.filter(Y=>Y.id!==ee);i(ne),a?.(ne)}else alert(le.error||"Failed to delete file")}catch(le){console.error("Delete error:",le),alert("Failed to delete file")}},q=async ee=>{if(!ps.isImageFile(ee.file_type)){H(ee);return}try{const le=await ps.getAttachmentUrl(ee.file_path);le&&(v(le),N(ee))}catch(le){console.error("Preview error:",le)}},H=async ee=>{try{const le=await ps.getAttachmentUrl(ee.file_path);if(le){const ne=document.createElement("a");ne.href=le,ne.download=ee.file_name,document.body.appendChild(ne),ne.click(),document.body.removeChild(ne)}}catch(le){console.error("Download error:",le)}},R=ee=>{ee.preventDefault(),x(!0)},Z=ee=>{ee.preventDefault(),x(!1)},ue=ee=>{ee.preventDefault(),x(!1),E(ee.dataTransfer.files)},re=ee=>ee.startsWith("image/")?s.jsx(w2,{className:"w-4 h-4"}):ee==="application/pdf"?s.jsx(d2,{className:"w-4 h-4"}):s.jsx(Qu,{className:"w-4 h-4"});return h?s.jsxs("div",{className:"bg-white/5 rounded-2xl border border-gray-700/30 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-full flex items-center justify-center",children:s.jsx(Qu,{className:"w-4 h-4 text-purple-400"})}),s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Tệp đính kèm"})]}),s.jsx("div",{className:"text-center py-8 text-gray-400",children:"Đang tải..."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white/5 rounded-xl border border-gray-700/30",children:[s.jsx("div",{className:"p-3 border-b border-gray-700/20",children:s.jsxs("button",{onClick:()=>_(!S),className:"w-full flex items-center justify-between hover:bg-gray-800/30 rounded-lg p-2 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-5 h-5 bg-purple-500/20 rounded-full flex items-center justify-center",children:s.jsx(Qu,{className:"w-3 h-3 text-purple-400"})}),s.jsx("h3",{className:"text-sm font-medium text-white",children:"Tệp đính kèm"}),s.jsx("span",{className:"text-xs text-gray-400 bg-gray-800/50 px-2 py-0.5 rounded-full",children:n.length})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[c&&s.jsx("div",{className:"w-3 h-3 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"}),S?s.jsx(Ks,{className:"w-4 h-4 text-gray-400"}):s.jsx(dd,{className:"w-4 h-4 text-gray-400"})]})]})}),S&&n.length>0&&s.jsx("div",{className:"px-4 pb-3",children:s.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-4",children:[s.jsxs("span",{children:[n.length," tệp đính kèm"]}),s.jsx("span",{children:"•"}),s.jsx("span",{children:"Click để xem chi tiết"})]})}),!S&&s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:`border-2 border-dashed rounded-lg p-4 text-center transition-colors ${m?"border-purple-400 bg-purple-500/10":"border-gray-600 hover:border-gray-500"}`,onDragOver:R,onDragLeave:Z,onDrop:ue,children:[s.jsx(Hx,{className:"w-6 h-6 text-gray-400 mx-auto mb-2"}),s.jsxs("p",{className:"text-sm text-gray-300 mb-1",children:["Kéo thả file hoặc"," ",s.jsx("button",{onClick:()=>D.current?.click(),className:"text-purple-400 hover:text-purple-300 underline",disabled:c,children:"chọn file"})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Ảnh, PDF, Word, Excel, Text (≤50MB)"}),c&&s.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"}),s.jsx("span",{className:"text-xs text-gray-400",children:"Đang tải lên..."})]})]}),s.jsx("input",{ref:D,type:"file",multiple:!0,className:"hidden",onChange:ee=>E(ee.target.files),accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.txt,.csv"}),n.length>0&&s.jsx("div",{className:"mt-4 space-y-2",children:n.map(ee=>s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-800/30 rounded-lg border border-gray-700/20 hover:bg-gray-800/50 transition-colors",children:[s.jsx("div",{className:"text-gray-400 flex-shrink-0",children:re(ee.file_type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm text-white font-medium truncate",children:ee.file_name}),s.jsxs("p",{className:"text-xs text-gray-400",children:[ps.formatFileSize(ee.file_size)," •"," ",new Date(ee.created_at).toLocaleDateString("vi-VN")]})]}),s.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[s.jsx("button",{onClick:()=>q(ee),className:"p-1.5 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 rounded transition-colors",title:ps.isImageFile(ee.file_type)?"Xem trước":"Tải xuống",children:ps.isImageFile(ee.file_type)?s.jsx(Ed,{className:"w-3.5 h-3.5"}):s.jsx(r2,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:()=>G(ee.id),className:"p-1.5 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded transition-colors",title:"Xóa",children:s.jsx(Xa,{className:"w-3.5 h-3.5"})})]})]},ee.id))})]})]}),p&&j&&s.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4",onClick:()=>{v(null),N(null)},children:s.jsxs("div",{className:"relative max-w-4xl max-h-full",onClick:ee=>ee.stopPropagation(),children:[s.jsx("button",{onClick:()=>{v(null),N(null)},className:"absolute -top-12 right-0 bg-black/50 hover:bg-black/70 text-white hover:text-gray-300 rounded-full p-2 transition-all duration-200 backdrop-blur-sm border border-gray-600",title:"Đóng (ESC)",children:s.jsx(Fe,{className:"w-6 h-6"})}),s.jsx("button",{onClick:()=>{v(null),N(null)},className:"absolute top-2 right-2 bg-black/70 hover:bg-black/90 text-white rounded-full p-1.5 transition-all duration-200 z-10",title:"Đóng",children:s.jsx(Fe,{className:"w-4 h-4"})}),s.jsx("img",{src:p,alt:j.file_name,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent text-white p-4 rounded-b-lg",children:[s.jsx("p",{className:"font-medium",children:j.file_name}),s.jsxs("p",{className:"text-sm text-gray-300",children:[ps.formatFileSize(j.file_size)," •"," ",new Date(j.created_at).toLocaleDateString("vi-VN")]})]})]})})]})};class K1{async createChecklistItem(a){try{if(!$e())throw new Error("User not authenticated");const{data:i,error:c}=await se.from("tasks").select("id").eq("id",a.taskId).single();if(c||!i)throw new Error("Task not found");let u=a.orderIndex;if(u===void 0){const{data:m}=await se.from("task_checklist_items").select("order_index").eq("task_id",a.taskId).order("order_index",{ascending:!1}).limit(1).single();u=m?m.order_index+1:0}const{data:h,error:g}=await se.from("task_checklist_items").insert({task_id:a.taskId,title:a.title,order_index:u}).select().single();if(g)throw console.error("Error creating checklist item:",g),new Error("Failed to create checklist item");return h}catch(n){throw console.error("Create checklist item error:",n),n}}async getTaskChecklistItems(a){try{const{data:n,error:i}=await se.from("task_checklist_items").select("*").eq("task_id",a).order("order_index",{ascending:!0});if(i)throw console.error("Error fetching checklist items:",i),new Error("Failed to fetch checklist items");return n||[]}catch(n){throw console.error("Get task checklist items error:",n),n}}async updateChecklistItem(a){try{const{data:n,error:i}=await se.from("task_checklist_items").select("id").eq("id",a.id).single();if(i||!n)throw new Error("Checklist item not found");const c={updated_at:new Date().toISOString()};a.title!==void 0&&(c.title=a.title),a.isCompleted!==void 0&&(c.is_completed=a.isCompleted),a.orderIndex!==void 0&&(c.order_index=a.orderIndex);const{data:u,error:h}=await se.from("task_checklist_items").update(c).eq("id",a.id).select().single();if(h)throw console.error("Error updating checklist item:",h),new Error("Failed to update checklist item");return u}catch(n){throw console.error("Update checklist item error:",n),n}}async deleteChecklistItem(a){try{const{data:n,error:i}=await se.from("task_checklist_items").select("id").eq("id",a).single();if(i||!n)throw new Error("Checklist item not found");const{error:c}=await se.from("task_checklist_items").delete().eq("id",a);if(c)throw console.error("Error deleting checklist item:",c),new Error("Failed to delete checklist item")}catch(n){throw console.error("Delete checklist item error:",n),n}}async reorderChecklistItems(a,n){try{const{data:i,error:c}=await se.from("tasks").select("id").eq("id",a).single();if(c||!i)throw new Error("Task not found");const u=n.map((h,g)=>se.from("task_checklist_items").update({order_index:g}).eq("id",h).eq("task_id",a));await Promise.all(u)}catch(i){throw console.error("Reorder checklist items error:",i),i}}async getChecklistProgress(a){try{const{data:n,error:i}=await se.rpc("get_task_checklist_progress",{task_uuid:a});if(i)throw console.error("Error getting checklist progress:",i),new Error("Failed to get checklist progress");return n||{total:0,completed:0,percentage:0}}catch(n){console.error("Get checklist progress error:",n);try{const i=await this.getTaskChecklistItems(a),c=i.length,u=i.filter(g=>g.is_completed).length,h=c>0?Math.round(u/c*100):0;return{total:c,completed:u,percentage:h}}catch(i){return console.error("Fallback progress calculation error:",i),{total:0,completed:0,percentage:0}}}}async toggleChecklistItem(a){try{const{data:n,error:i}=await se.from("task_checklist_items").select("is_completed").eq("id",a).single();if(i||!n)throw new Error("Checklist item not found");return await this.updateChecklistItem({id:a,isCompleted:!n.is_completed})}catch(n){throw console.error("Toggle checklist item error:",n),n}}async bulkUpdateChecklistItems(a){try{return await Promise.all(a.map(i=>this.updateChecklistItem(i)))}catch(n){throw console.error("Bulk update checklist items error:",n),n}}}const Ia=new K1,G1=({taskId:l,onProgressChange:a})=>{const[n,i]=b.useState([]),[c,u]=b.useState({total:0,completed:0,percentage:0}),[h,g]=b.useState(!0),[m,x]=b.useState(""),[p,v]=b.useState(null),[j,N]=b.useState(""),[S,_]=b.useState(!1),[D,M]=b.useState(null),[E,A]=b.useState(""),[G,q]=b.useState(""),H=b.useRef(null),R=b.useRef(null),Z=C=>{try{return new Date(C).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"N/A"}};b.useEffect(()=>{ue()},[l]),b.useEffect(()=>{S&&H.current&&H.current.focus()},[S]),b.useEffect(()=>{!h&&n.length===0&&!S&&_(!0)},[h,n.length,S]),b.useEffect(()=>{p&&R.current&&R.current.focus()},[p]);const ue=async()=>{try{g(!0);const[C,I]=await Promise.all([Ia.getTaskChecklistItems(l),Ia.getChecklistProgress(l)]);i(C),u(I),a?.(I)}catch(C){console.error("Error loading checklist:",C)}finally{g(!1)}},re=async()=>{try{const C=await Ia.getChecklistProgress(l);u(C),a?.(C)}catch(C){console.error("Error updating progress:",C)}},ee=async()=>{if(m.trim())try{const C=await Ia.createChecklistItem({taskId:l,title:m.trim()});i(I=>[...I,C]),x(""),_(!1),re()}catch(C){console.error("Error adding item:",C),alert("Không thể thêm mục mới")}},le=async C=>{try{const I=await Ia.toggleChecklistItem(C);i(oe=>oe.map(he=>he.id===C?I:he)),re()}catch(I){console.error("Error toggling item:",I),alert("Không thể cập nhật trạng thái")}},ne=async C=>{if(j.trim())try{const I=await Ia.updateChecklistItem({id:C,title:j.trim()});i(oe=>oe.map(he=>he.id===C?I:he)),v(null),N("")}catch(I){console.error("Error editing item:",I),alert("Không thể cập nhật mục")}},Y=async C=>{if(confirm("Bạn có chắc muốn xóa mục này?"))try{await Ia.deleteChecklistItem(C),i(I=>I.filter(oe=>oe.id!==C)),re()}catch(I){console.error("Error deleting item:",I),alert("Không thể xóa mục")}},ie=C=>{v(C.id),N(C.title)},L=()=>{v(null),N("")},Q=C=>{M(C.id),A(""),q("")},ae=()=>{M(null),A(""),q("")},ye=async()=>{if(!D||!E){alert("Vui lòng chọn ngày");return}try{const C=n.find(I=>I.id===D);if(!C)return;console.log("🗓️ Scheduling checklist item:",{itemId:D,itemTitle:C.title,scheduleDate:E,scheduleTime:G}),await is.createScheduledChecklistItem({itemTitle:C.title,parentTaskId:l,checklistItemId:D,scheduledDate:E,scheduledTime:G||void 0}),alert(`✅ Đã lên lịch "${C.title}" vào ${E} ${G||""}`),ae()}catch(C){console.error("Error scheduling checklist item:",C),alert("❌ Không thể lên lịch. Vui lòng thử lại.")}},k=()=>{const C=new Date;return C.setDate(C.getDate()+1),C.toISOString().split("T")[0]},V=()=>{_(!1),x("")};return h?s.jsxs("div",{className:"bg-white/5 rounded-2xl border border-gray-700/30 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-8 h-8 bg-green-500/20 rounded-full flex items-center justify-center",children:s.jsx(Yu,{className:"w-4 h-4 text-green-400"})}),s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Danh sách công việc con"})]}),s.jsx("div",{className:"text-center py-8 text-gray-400",children:"Đang tải..."})]}):s.jsxs("div",{className:"bg-white/5 rounded-2xl border border-gray-700/30",children:[s.jsxs("div",{className:"p-6 border-b border-gray-700/20",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-green-500/20 rounded-full flex items-center justify-center",children:s.jsx(Yu,{className:"w-4 h-4 text-green-400"})}),s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Danh sách công việc con"}),s.jsxs("span",{className:"text-sm text-gray-400",children:["(",c.completed,"/",c.total,")"]})]}),s.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-2 px-3 py-2 bg-green-500/20 text-green-400 rounded-lg hover:bg-green-500/30 transition-colors",children:[s.jsx(va,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Thêm mục"})]})]}),c.total>0&&s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400 mb-2",children:[s.jsx("span",{children:"Tiến độ hoàn thành"}),s.jsxs("span",{children:[c.percentage,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${c.percentage}%`}})})]})]}),s.jsxs("div",{className:"p-6",children:[S&&s.jsx("div",{className:"mb-4 p-3 bg-gray-800/30 rounded-lg border border-gray-700/20",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ng,{className:"w-5 h-5 text-gray-400"}),s.jsx("input",{ref:H,type:"text",value:m,onChange:C=>x(C.target.value),placeholder:"Nhập nội dung công việc con...",className:"flex-1 bg-transparent text-white placeholder-gray-400 border-none outline-none",onKeyDown:C=>{C.key==="Enter"&&ee(),C.key==="Escape"&&V()}}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:ee,className:"p-1 text-green-400 hover:text-green-300 transition-colors",title:"Lưu",children:s.jsx(jl,{className:"w-4 h-4"})}),s.jsx("button",{onClick:V,className:"p-1 text-gray-400 hover:text-gray-300 transition-colors",title:"Hủy",children:s.jsx(Fe,{className:"w-4 h-4"})})]})]})}),n.length>0?s.jsx("div",{className:"space-y-2",children:n.map(C=>s.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border transition-colors ${C.is_completed?"bg-green-500/10 border-green-500/20":"bg-gray-800/30 border-gray-700/20 hover:bg-gray-800/50"}`,children:[s.jsx(y2,{className:"w-4 h-4 text-gray-500 cursor-grab"}),s.jsx("button",{onClick:()=>le(C.id),className:`flex-shrink-0 transition-colors ${C.is_completed?"text-green-400 hover:text-green-300":"text-gray-400 hover:text-gray-300"}`,children:C.is_completed?s.jsx(Yu,{className:"w-5 h-5"}):s.jsx(Ng,{className:"w-5 h-5"})}),s.jsx("div",{className:"flex-1 min-w-0",children:p===C.id?s.jsx("input",{ref:R,type:"text",value:j,onChange:I=>N(I.target.value),className:"w-full bg-transparent text-white border-none outline-none",onKeyDown:I=>{I.key==="Enter"&&ne(C.id),I.key==="Escape"&&L()}}):s.jsxs("div",{children:[s.jsx("span",{className:`block ${C.is_completed?"text-gray-400 line-through":"text-white"}`,children:C.title}),s.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-600",children:"📅"}),"Tạo: ",Z(C.created_at)]}),C.is_completed&&s.jsxs("span",{className:"text-green-500 flex items-center gap-1",children:[s.jsx("span",{children:"✅"}),"Hoàn thành: ",Z(C.updated_at)]})]})]})}),s.jsx("div",{className:"flex items-center gap-1",children:p===C.id?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>ne(C.id),className:"p-1 text-green-400 hover:text-green-300 transition-colors",title:"Lưu",children:s.jsx(jl,{className:"w-4 h-4"})}),s.jsx("button",{onClick:L,className:"p-1 text-gray-400 hover:text-gray-300 transition-colors",title:"Hủy",children:s.jsx(Fe,{className:"w-4 h-4"})})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>Q(C),className:"p-1 text-gray-400 hover:text-purple-400 transition-colors",title:"Lên lịch",children:s.jsx(At,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>ie(C),className:"p-1 text-gray-400 hover:text-blue-400 transition-colors",title:"Sửa",children:s.jsx(en,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>Y(C.id),className:"p-1 text-gray-400 hover:text-red-400 transition-colors",title:"Xóa",children:s.jsx(Xa,{className:"w-4 h-4"})})]})})]},C.id))}):null]}),D&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-gray-800 rounded-2xl border border-gray-700 p-6 w-full max-w-md mx-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[s.jsx(At,{className:"w-5 h-5 text-purple-400"}),"Lên lịch công việc con"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Công việc"}),s.jsx("div",{className:"p-3 bg-gray-700/50 rounded-lg text-white",children:n.find(C=>C.id===D)?.title})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Chọn ngày *"}),s.jsx("input",{type:"date",value:E,onChange:C=>A(C.target.value),min:k(),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-500 focus:outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Chọn giờ (tùy chọn)"}),s.jsx("input",{type:"time",value:G,onChange:C=>q(C.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-500 focus:outline-none"})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:ye,disabled:!E,className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Lưu lịch"}),s.jsx("button",{onClick:ae,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Hủy"})]})]})})]})},I1=({isOpen:l,onClose:a,task:n,onDelete:i,onUpdate:c})=>{const[u,h]=b.useState([]),[g,m]=b.useState({total:0,completed:0,percentage:0}),[x,p]=b.useState(!1),[v,j]=b.useState(!1),[N,S]=b.useState({name:"",description:"",priority:"normal",status:"new-requests",startDate:"",dueDate:"",assignedUsers:[]}),[_,D]=b.useState(!1),[M,E]=b.useState(!1),[A,G]=b.useState(!1),[q,H]=b.useState([]),[R,Z]=b.useState(!1),ue=async()=>{try{Z(!0);const C=$e();if(!C){console.warn("No current user found");return}console.log("🔍 Loading users for current user:",C.name,C.role);const I=await Md.getAllEmployees();console.log("📋 All users from database:",I.length);const oe=I.filter(he=>he.id===C.id?!0:C.role==="retail_director"?he.location===C.location:(C.role==="team_leader",he.team_id===C.team_id&&he.location===C.location));console.log("✅ Filtered users for assignment:",oe.length),H(oe)}catch(C){console.error("❌ Error loading available users:",C),H([])}finally{Z(!1)}};b.useEffect(()=>{n&&S({name:n.name||"",description:n.description||"",priority:n.priority||"normal",status:n.status||"new-requests",startDate:n.startDate||n.createdAt||"",dueDate:n.dueDate||"",assignedUsers:[n.assignedTo?.id||n.createdBy?.id||""]})},[n]),b.useEffect(()=>{l&&ue()},[l]),b.useEffect(()=>{if(l)return document.body.classList.add("modal-open"),()=>{document.body.classList.remove("modal-open")}},[l]),b.useEffect(()=>{const C=I=>{v&&(I.ctrlKey||I.metaKey)&&I.key==="s"&&(I.preventDefault(),ne()),v&&I.key==="Escape"&&(I.preventDefault(),le())};if(l)return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[v,l]);const re=C=>{h(C)},ee=C=>{m(C)},le=()=>{v&&n&&S({name:n.name||"",description:n.description||"",priority:n.priority||"normal",status:n.status||"new-requests",startDate:n.startDate||n.createdAt||"",dueDate:n.dueDate||"",assignedUsers:[n.assignedTo?.id||n.createdBy?.id||""]}),j(!v),D(!1),E(!1),G(!1)},ne=async()=>{if(n&&c)try{await c({...n,...N,id:n.id}),j(!1)}catch(C){console.error("Failed to save task:",C)}},Y=(C,I)=>{S(oe=>({...oe,[C]:I}))},ie=C=>{N.assignedUsers.includes(C)||S(I=>({...I,assignedUsers:[...I.assignedUsers,C]})),G(!1)},L=C=>{S(I=>({...I,assignedUsers:I.assignedUsers.filter(oe=>oe!==C)}))},Q=C=>{if(!C)return"Chưa đặt";try{const I=new Date(C);if(isNaN(I.getTime()))return"Ngày không hợp lệ";const oe=I.getDate().toString().padStart(2,"0"),he=(I.getMonth()+1).toString().padStart(2,"0"),xe=I.getFullYear();return`${oe}/${he}/${xe}`}catch{return"Ngày không hợp lệ"}};if(!l||!n)return null;console.log("TaskDetailModal task data:",{id:n.id,name:n.name,startDate:n.startDate,createdAt:n.createdAt,dueDate:n.dueDate});const ae=[{value:"other",label:"Công việc khác",icon:qs,color:"bg-gray-500"},{value:"sbg-new",label:"SBG mới",icon:qs,color:"bg-blue-500"},{value:"sbg-old",label:"SBG cũ",icon:qs,color:"bg-blue-400"},{value:"partner-new",label:"Đối tác mới",icon:qt,color:"bg-green-500"},{value:"partner-old",label:"Đối tác cũ",icon:qt,color:"bg-green-400"},{value:"kts-new",label:"KTS mới",icon:vs,color:"bg-purple-500"},{value:"kts-old",label:"KTS cũ",icon:vs,color:"bg-purple-400"},{value:"customer-new",label:"Khách hàng mới",icon:$s,color:"bg-orange-500"},{value:"customer-old",label:"Khách hàng cũ",icon:$s,color:"bg-orange-400"}],k=(C=>ae.find(I=>I.value===C)||ae[0])(n.workType),V=k.icon;return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:s.jsx("div",{className:"bg-[#1a1f2e] rounded-lg sm:rounded-2xl w-full max-w-2xl md:max-w-3xl lg:max-w-4xl h-[95vh] sm:h-[90vh] shadow-2xl border border-gray-700/50 flex flex-col",children:s.jsxs("div",{className:`border-b border-gray-700 flex-shrink-0 ${v?"bg-gradient-to-r from-orange-600/20 to-yellow-600/20":"bg-gradient-to-r from-blue-600/10 to-purple-600/10"}`,children:[s.jsxs("div",{className:"p-3 sm:p-4 md:p-6",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 md:gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3 md:gap-4 flex-1 min-w-0",children:[s.jsxs("div",{className:`inline-flex items-center gap-1 md:gap-2 px-2 md:px-3 py-1 rounded-full text-white text-xs font-medium ${k.color} flex-shrink-0`,children:[s.jsx(V,{className:"w-3 h-3"}),s.jsx("span",{className:"hidden sm:inline",children:k.label})]}),v?s.jsx("input",{type:"text",value:N.name,onChange:C=>Y("name",C.target.value),className:"text-base md:text-lg font-bold text-white bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-1 flex-1 min-w-0 focus:border-blue-500 focus:outline-none",placeholder:"Tên công việc..."}):s.jsx("h2",{className:"text-base md:text-lg font-bold text-white break-words leading-tight flex-1 min-w-0",children:n.name}),v&&s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-orange-500/20 rounded-full border border-orange-500/30",children:[s.jsx(en,{className:"w-3 h-3 text-orange-400"}),s.jsx("span",{className:"text-xs text-orange-300 hidden sm:inline",children:"Đang chỉnh sửa"})]}),s.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors flex-shrink-0 md:hidden",children:s.jsx(Fe,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx(H1,{status:v?N.status:n.status,priority:v?N.priority:n.priority,onStatusChange:C=>Y("status",C),onPriorityChange:C=>Y("priority",C),isEditMode:v})}),s.jsx("div",{className:"flex md:hidden items-center gap-1",children:v?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:ne,className:"p-2 text-gray-400 hover:text-green-400 hover:bg-green-500/10 rounded-lg transition-colors",title:"Lưu",children:s.jsx(Nl,{className:"w-4 h-4"})}),s.jsx("button",{onClick:le,className:"p-2 text-gray-400 hover:text-gray-300 hover:bg-gray-700 rounded-lg transition-colors",title:"Hủy",children:s.jsx(Fe,{className:"w-4 h-4"})})]}):s.jsx("button",{onClick:le,className:"p-2 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 rounded-lg transition-colors",title:"Chỉnh sửa",children:s.jsx(en,{className:"w-4 h-4"})})}),s.jsxs("div",{className:"hidden md:flex items-center gap-1 flex-shrink-0",children:[v?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:ne,className:"p-2 text-gray-400 hover:text-green-400 hover:bg-green-500/10 rounded-lg transition-colors",title:"Lưu thay đổi",children:s.jsx(Nl,{className:"w-4 h-4"})}),s.jsx("button",{onClick:le,className:"p-2 text-gray-400 hover:text-gray-300 hover:bg-gray-700 rounded-lg transition-colors",title:"Hủy",children:s.jsx(Fe,{className:"w-4 h-4"})})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:le,className:"p-2 text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 rounded-lg transition-colors",title:"Chỉnh sửa",children:s.jsx(en,{className:"w-4 h-4"})}),s.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Xóa",children:s.jsx(Xa,{className:"w-4 h-4"})})]}),s.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:s.jsx(Fe,{className:"w-4 h-4"})})]})]})]}),s.jsx("div",{className:"task-detail-meta-mobile mt-2 md:mt-3",children:s.jsxs("div",{className:`${v?"grid grid-cols-1 md:grid-cols-2 gap-4":"space-y-3"}`,children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(At,{className:"w-4 h-4 text-green-400 mt-1"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-gray-400 text-sm block mb-1",children:"Bắt đầu:"}),v?s.jsx(Ug,{value:N.startDate?N.startDate.split("T")[0]:"",onChange:C=>Y("startDate",C),placeholder:"Chọn ngày bắt đầu",isOpen:_,onToggle:()=>{D(!_),E(!1),G(!1)},onClose:()=>D(!1),color:"green",buttonClassName:"text-sm"}):s.jsx("span",{className:"text-white text-sm",children:Q(n.startDate||n.createdAt||"")})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qt,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-gray-400 text-sm",children:"Tạo bởi:"}),s.jsx("span",{className:"text-white text-sm",children:n.createdBy?.name||"Phạm Thị Hương"})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx($s,{className:"w-4 h-4 text-purple-400 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-gray-400 text-sm",children:"Thực hiện:"}),s.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[N.assignedUsers.map(C=>{const I=q.find(oe=>oe.id===C);return I?s.jsxs("div",{className:"flex items-center gap-1 bg-purple-500/20 text-purple-300 px-2 py-1 rounded-full text-xs",children:[s.jsx("span",{children:I.name}),v&&N.assignedUsers.length>1&&s.jsx("button",{onClick:()=>L(C),className:"hover:text-red-400 transition-colors",children:s.jsx(Fe,{className:"w-3 h-3"})})]},C):null}),v&&s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>G(!A),className:"flex items-center gap-1 bg-gray-700 hover:bg-gray-600 text-gray-300 px-2 py-1 rounded-full text-xs transition-colors",children:[s.jsx(va,{className:"w-3 h-3"}),s.jsx("span",{children:"Thêm"})]}),A&&s.jsx("div",{className:"absolute top-full left-0 mt-1 bg-gray-800 border border-gray-600 rounded-lg shadow-xl z-50 min-w-64 max-w-80",children:R?s.jsxs("div",{className:"px-3 py-4 text-center text-gray-400 text-sm",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-purple-400 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),"Đang tải danh sách..."]}):q.length===0?s.jsx("div",{className:"px-3 py-4 text-center text-gray-400 text-sm",children:"Không có người dùng khả dụng"}):s.jsxs("div",{className:"max-h-64 overflow-y-auto",children:[q.filter(C=>!N.assignedUsers.includes(C.id)).map(C=>s.jsx("button",{onClick:()=>ie(C.id),className:"w-full text-left px-3 py-2 hover:bg-gray-700 text-white text-sm first:rounded-t-lg last:rounded-b-lg transition-colors",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0",children:C.name.charAt(0).toUpperCase()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium truncate",children:C.name}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[C.email," • ",C.location,C.team&&typeof C.team=="object"&&!Array.isArray(C.team)&&s.jsxs("span",{children:[" • ",C.team.name]})]})]})]})},C.id)),q.filter(C=>!N.assignedUsers.includes(C.id)).length===0&&s.jsx("div",{className:"px-3 py-4 text-center text-gray-400 text-sm",children:"Tất cả người dùng đã được gán"})]})})]})]})]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(At,{className:"w-4 h-4 text-red-400 mt-1"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-gray-400 text-sm block mb-1",children:"Hạn chót:"}),v?s.jsx(Ug,{value:N.dueDate?N.dueDate.split("T")[0]:"",onChange:C=>Y("dueDate",C),placeholder:"Chọn hạn chót",isOpen:M,onToggle:()=>{E(!M),D(!1),G(!1)},onClose:()=>E(!1),color:"red",buttonClassName:"text-sm",minDate:N.startDate?N.startDate.split("T")[0]:void 0}):s.jsx("span",{className:"text-white text-sm",children:Q(n.dueDate||"")})]})]}),g.total>0&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(vs,{className:"w-3 h-3 text-green-400"}),s.jsx("span",{className:"hidden sm:inline",children:"Checklist: "}),s.jsxs("span",{children:[g.completed,"/",g.total," (",g.percentage,"%)"]})]}),u.length>0&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(qs,{className:"w-3 h-3 text-purple-400"}),s.jsx("span",{className:"hidden sm:inline",children:"Tệp đính kèm: "}),s.jsx("span",{children:u.length})]}),x&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(At,{className:"w-3 h-3 text-blue-400"}),s.jsx("span",{children:"Đã lên lịch"})]})]})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden bg-gray-900/50 p-4 md:p-6",style:{WebkitOverflowScrolling:"touch",scrollBehavior:"smooth",overscrollBehavior:"contain"},children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-4 md:space-y-8",children:[s.jsxs("div",{className:"task-detail-section-mobile bg-white/5 rounded-xl md:rounded-2xl border border-gray-700/30",children:[s.jsx("div",{className:"p-4 md:p-6 border-b border-gray-700/20",children:s.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[s.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-blue-500/20 rounded-full flex items-center justify-center",children:s.jsx(vs,{className:"w-3 h-3 md:w-4 md:h-4 text-blue-400"})}),s.jsx("h3",{className:"text-base md:text-lg font-semibold text-white",children:"Thông tin công việc chi tiết"})]})}),s.jsx("div",{className:"p-4 md:p-8 flex-1 flex flex-col",children:v?s.jsxs("div",{className:"flex-1 flex flex-col",children:[s.jsx("label",{className:"block text-white font-medium mb-2",children:"Mô tả công việc"}),s.jsx("textarea",{value:N.description,onChange:C=>Y("description",C.target.value),className:"flex-1 min-h-[200px] p-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none resize-none",placeholder:"Nhập mô tả chi tiết về công việc..."})]}):s.jsx(s.Fragment,{children:n.description?s.jsx("div",{className:"prose prose-invert prose-sm md:prose-lg max-w-none flex-1",children:s.jsx("div",{className:"task-detail-text-mobile text-gray-200 leading-relaxed whitespace-pre-wrap font-normal h-full",children:n.description})}):s.jsxs("div",{className:"text-center py-8 md:py-16 flex-1 flex flex-col justify-center",children:[s.jsx("div",{className:"w-12 h-12 md:w-16 md:h-16 bg-gray-700/30 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4",children:s.jsx(vs,{className:"w-6 h-6 md:w-8 md:h-8 text-gray-500"})}),s.jsx("p",{className:"text-gray-500 text-base md:text-lg",children:"Chưa có mô tả chi tiết"}),s.jsx("p",{className:"text-gray-600 text-xs md:text-sm mt-2",children:"Thêm mô tả để cung cấp thông tin chi tiết về công việc này"})]})})})]}),s.jsx(G1,{taskId:n.id,onProgressChange:ee}),s.jsx(P1,{taskId:n.id,onAttachmentsChange:re})]})})]})})})},V1=({onFilterChange:l})=>{const[a,n]=b.useState({searchTerm:"",dateFilter:"all",workTypeFilter:"all",priorityFilter:"all"}),[i,c]=b.useState(!1),[u,h]=b.useState(!1),g=[{value:"all",label:"Tất cả ngày"},{value:"today",label:"Hôm nay"},{value:"yesterday",label:"Hôm qua"},{value:"tomorrow",label:"Ngày mai"},{value:"last3days",label:"3 ngày trước"},{value:"last5days",label:"5 ngày trước"},{value:"last7days",label:"7 ngày trước"},{value:"next3days",label:"3 ngày tới"},{value:"next5days",label:"5 ngày tới"},{value:"next7days",label:"7 ngày tới"},{value:"thisWeek",label:"Tuần này"},{value:"thisMonth",label:"Tháng này"},{value:"thisYear",label:"Năm này"},{value:"custom",label:"Tùy chọn"}],m=[{value:"all",label:"Tất cả mức độ"},{value:"high",label:"Ưu tiên cao"},{value:"normal",label:"Ưu tiên bình thường"},{value:"low",label:"Ưu tiên thấp"}],x=[{value:"all",label:"Tất cả loại công việc"},...Object.entries(Z2).map(([N,S])=>({value:N,label:S}))],p=N=>{const S={...a,...N};n(S),l(S)},v=()=>{const N={searchTerm:"",dateFilter:"all",workTypeFilter:"all",priorityFilter:"all"};n(N),l(N)},j=a.searchTerm||a.dateFilter!=="all"||a.workTypeFilter!=="all"||a.priorityFilter!=="all";return s.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-lg border border-gray-700/50 mb-4 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center gap-2 p-3",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Lx,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tìm kiếm...",value:a.searchTerm,onChange:N=>p({searchTerm:N.target.value}),className:"w-full pl-9 pr-3 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white text-sm placeholder-gray-400 focus:border-blue-500 focus:outline-none focus:bg-gray-700"})]}),s.jsxs("button",{onClick:()=>h(!u),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${j?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-gray-700/50 text-gray-300 border border-gray-600/50 hover:bg-gray-700"}`,children:[s.jsx(f2,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Bộ lọc"}),j&&s.jsx("span",{className:"bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded-full min-w-[18px] text-center",children:Object.values(a).filter(N=>N&&N!=="all").length}),u?s.jsx(dd,{className:"w-4 h-4"}):s.jsx(Ks,{className:"w-4 h-4"})]})]}),u&&s.jsxs("div",{className:"border-t border-gray-700/50 p-3 space-y-3 animate-in slide-in-from-top-2 duration-200",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Thời gian"}),s.jsx("select",{value:a.dateFilter,onChange:N=>p({dateFilter:N.target.value}),className:"w-full px-2 py-1.5 bg-gray-700/50 border border-gray-600/50 rounded text-white text-sm focus:border-blue-500 focus:outline-none",children:g.slice(0,8).map(N=>s.jsx("option",{value:N.value,children:N.label},N.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Loại công việc"}),s.jsx("select",{value:a.workTypeFilter,onChange:N=>p({workTypeFilter:N.target.value}),className:"w-full px-2 py-1.5 bg-gray-700/50 border border-gray-600/50 rounded text-white text-sm focus:border-blue-500 focus:outline-none",children:x.map(N=>s.jsx("option",{value:N.value,children:N.label},N.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Mức độ ưu tiên"}),s.jsx("select",{value:a.priorityFilter,onChange:N=>p({priorityFilter:N.target.value}),className:"w-full px-2 py-1.5 bg-gray-700/50 border border-gray-600/50 rounded text-white text-sm focus:border-blue-500 focus:outline-none",children:m.map(N=>s.jsx("option",{value:N.value,children:N.label},N.value))})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 pt-2 border-t border-gray-700/30",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("button",{onClick:()=>c(!i),className:`flex items-center gap-1.5 px-2 py-1.5 rounded text-xs transition-colors ${i?"bg-blue-500/20 text-blue-400":"text-gray-400 hover:text-gray-300"}`,children:[s.jsx(At,{className:"w-3 h-3"}),"Nâng cao",i?s.jsx(dd,{className:"w-3 h-3"}):s.jsx(Ks,{className:"w-3 h-3"})]})}),j&&s.jsxs("button",{onClick:v,className:"flex items-center gap-1.5 px-2 py-1.5 text-xs text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded transition-colors",children:[s.jsx(Fe,{className:"w-3 h-3"}),"Xóa bộ lọc"]})]}),i&&a.dateFilter==="custom"&&s.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t border-gray-700/30",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Từ ngày"}),s.jsx("input",{type:"date",value:a.customDateRange?.start||"",onChange:N=>p({customDateRange:{...a.customDateRange,start:N.target.value,end:a.customDateRange?.end||""}}),className:"w-full px-2 py-1.5 bg-gray-700/50 border border-gray-600/50 rounded text-white text-sm focus:border-blue-500 focus:outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-gray-400 text-xs mb-1",children:"Đến ngày"}),s.jsx("input",{type:"date",value:a.customDateRange?.end||"",onChange:N=>p({customDateRange:{...a.customDateRange,start:a.customDateRange?.start||"",end:N.target.value}}),className:"w-full px-2 py-1.5 bg-gray-700/50 border border-gray-600/50 rounded text-white text-sm focus:border-blue-500 focus:outline-none"})]})]})]})]})};function Q1(l){if(!l)return null;try{const a={Th1:1,Th2:2,Th3:3,Th4:4,Th5:5,Th6:6,Th7:7,Th8:8,Th9:9,Th10:10,Th11:11,Th12:12,th1:1,th2:2,th3:3,th4:4,th5:5,th6:6,th7:7,th8:8,th9:9,th10:10,th11:11,th12:12},n=/^(\d{1,2})\s+(Th\d{1,2}),?\s+(\d{4})$/i,i=l.match(n);if(!i){const x=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,p=l.match(x);if(p){const v=parseInt(p[1],10),j=parseInt(p[2],10),N=parseInt(p[3],10),S=new Date(N,j-1,v);if(!isNaN(S.getTime()))return S}return null}const c=parseInt(i[1],10),u=i[2],h=parseInt(i[3],10),g=a[u];if(!g)return null;const m=new Date(h,g-1,c);return m.getFullYear()!==h||m.getMonth()!==g-1||m.getDate()!==c?null:m}catch{return null}}function Ji(l){if(!l||isNaN(l.getTime()))return"N/A";const a=l.getDate().toString().padStart(2,"0"),n=(l.getMonth()+1).toString().padStart(2,"0");return`${a} thg ${n}`}function Wi(l){if(!l)return null;const a=Q1(l);if(a)return a;try{const n=new Date(l);if(!isNaN(n.getTime()))return n}catch{}return null}const Y1=({userRole:l,currentUser:a,onModalStateChange:n})=>{const i=(()=>{try{return $e()}catch(K){return console.error("❌ TaskList: Error getting current user:",K),localStorage.getItem("auth_user")?{id:"unknown",name:"Unknown User",email:"unknown@email.com",team_id:"0",location:"Hà Nội",role:"employee",team:{id:"0",name:"Unknown Team",location:"HN"}}:(console.error("❌ No auth_user found in localStorage - user needs to login"),window.location.href="/login",null)}})();if(!i)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-gray-400",children:"Đang chuyển hướng đến trang đăng nhập..."})});zx();const[c,u]=b.useState("my-tasks"),[h,g]=b.useState(i1(i)),[m,x]=b.useState(null),[p,v]=b.useState(!1),[j,N]=b.useState(!1),[S,_]=b.useState(!1),[D,M]=b.useState(!1);b.useEffect(()=>{n?.(p||j||S||D)},[p,j,S,D,n]);const[E,A]=b.useState(null),[G,q]=b.useState(null),[H,R]=b.useState([]),[Z,ue]=b.useState(!1),[re,ee]=b.useState([]),[le,ne]=b.useState([]),[Y,ie]=b.useState({searchTerm:"",dateFilter:"all",workTypeFilter:"all",priorityFilter:"all"}),[L,Q]=b.useState(null),[ae,ye]=b.useState("all"),k=K=>{const ce=new Date;return(K.dueDate?new Date(K.dueDate):new Date(K.startDate)).toDateString()===ce.toDateString()&&K.status!=="live"};b.useEffect(()=>{i&&i.id&&i.id!=="unknown"?(V(),C()):(console.warn("⚠️ TaskList: User not authenticated, skipping task load"),R([]),ue(!1))},[c,h,m,i.id]);const V=async()=>{try{ue(!0),console.log("🔄 Loading tasks for tab:",c),console.log("🔄 Current user:",i?.name,i?.id),console.log("🔄 Department tab:",h),console.log("🔄 Selected team ID:",m);let K=[];switch(c){case"my-tasks":console.log("📋 Loading my tasks for user ID:",i?.id),i?.id?K=await is.getMyTasks(i.id):(console.error("❌ No user ID found"),K=[]),console.log("📋 My tasks loaded:",K.length,"tasks");break;case"team-tasks":const ce=h==="hanoi"?"HN":"HCM";console.log("👥 Loading team tasks for location:",ce,"team:",m),K=await is.getTeamTasks(m||void 0,ce),console.log("👥 Team tasks loaded:",K.length,"tasks");break;case"department-tasks":const te=h==="hanoi"?"HN":"HCM";console.log("🏢 Loading department tasks for location:",te),K=await is.getDepartmentTasks(te),console.log("🏢 Department tasks loaded:",K.length,"tasks");break;default:console.log("📋 Loading all tasks"),K=await is.getTasks(),console.log("📋 All tasks loaded:",K.length,"tasks")}console.log("🔄 Setting tasks state with:",K.length,"tasks"),console.log("🔍 Task IDs:",K.map(ce=>ce.id).slice(0,5)),R(K),console.log("✅ Tasks state updated successfully")}catch(K){console.error("❌ Error loading tasks:",K),console.error("❌ Error details:",K),R([])}finally{ue(!1)}},C=async()=>{try{const[K,ce]=await Promise.all([se.from("teams").select("*").order("id"),se.from("users").select("*").order("name")]);if(K.error)throw K.error;if(ce.error)throw ce.error;ee(K.data||[]),ne(ce.data||[])}catch(K){console.error("Error loading teams and users:",K)}},I=async K=>{try{ue(!0);const ce=i?.id;if(!ce)throw new Error("Không tìm thấy thông tin đăng nhập");console.log("🎯 Creating task with data:",K),console.log("🎯 Current tab:",c),console.log("🎯 Current user:",i);const te=await is.createTask({name:K.name,description:K.description,workTypes:K.workTypes,priority:K.priority,campaignType:K.campaignType,platform:K.platform,startDate:K.startDate,endDate:K.endDate,dueDate:K.dueDate,assignedToId:K.assignedTo?.id||ce,department:K.department,createdAt:K.startDate?new Date(K.startDate).toISOString():new Date().toISOString(),shareScope:K.shareScope},ce);console.log("✅ Task created successfully:",te);let we=c;K.taggedUsers&&K.taggedUsers.length>0?c==="my-tasks"&&(we="my-tasks"):we="my-tasks",we!==c&&(console.log(`🔄 Switching from ${c} to ${we} to show new task`),u(we),await new Promise(He=>setTimeout(He,100))),await V();const de=we==="my-tasks"?"Của Tôi":we==="team-tasks"?"Của Nhóm":"Của Phòng Ban";console.log("🔄 Tasks reloaded, should be visible in tab:",we)}catch(ce){console.error("Error creating task:",ce),alert("Không thể tạo công việc mới. Vui lòng thử lại.")}finally{ue(!1)}},oe=K=>{const ce=H.find(te=>te.id===K);ce&&(A(ce),N(!0))},he=async K=>{try{ue(!0),console.log("🔧 Updating task with data:",K),await is.updateTask(K),Dg(K.id),await V()}catch(ce){console.error("❌ Error updating task:",ce),console.error("❌ Task data that failed:",K),alert("Không thể cập nhật công việc. Vui lòng thử lại.")}finally{ue(!1)}},xe=K=>{const ce=H.find(te=>te.id===K);ce&&(q(ce),_(!0))},mt=async()=>{if(G)try{ue(!0),console.log("🗑️ Deleting task:",G.id,G.name),await is.deleteTask(G.id),console.log("✅ Task deleted successfully from database"),Dg(G.id),console.log("🔄 Reloading tasks after delete..."),await V(),console.log("✅ Tasks reloaded after delete")}catch(K){console.error("❌ Error deleting task:",K),alert("Không thể xóa công việc. Vui lòng thử lại.")}finally{ue(!1),q(null),_(!1)}},Be=(K,ce)=>K.filter(we=>{if(ae!=="all"&&we.status!==ae)return!1;if(ce.searchTerm){const de=ce.searchTerm.toLowerCase();if(!(we.name.toLowerCase().includes(de)||we.description?.toLowerCase().includes(de)||we.createdBy?.name.toLowerCase().includes(de)||we.assignedTo?.name.toLowerCase().includes(de)))return!1}if(ce.dateFilter!=="all"){const de=new Date,He=new Date(we.startDate);switch(ce.dateFilter){case"today":if(He.toDateString()!==de.toDateString())return!1;break;case"week":const Ne=new Date(de.getTime()-10080*60*1e3);if(He<Ne)return!1;break;case"month":const $t=new Date(de.getTime()-720*60*60*1e3);if(He<$t)return!1;break}}return!(ce.workTypeFilter!=="all"&&we.workType!==ce.workTypeFilter||ce.priorityFilter!=="all"&&we.priority!==ce.priorityFilter)}).sort((we,de)=>{const He={approved:0,"new-requests":1,live:2},Ne=He[we.status]-He[de.status];if(Ne!==0)return Ne;const $t=new Date(we.createdAt||we.startDate).getTime();return new Date(de.createdAt||de.startDate).getTime()-$t}),zt=K=>[{id:"new-requests",name:"Chưa tiến hành",status:"new-requests",isExpanded:!0,tasks:K.filter(te=>te.status==="new-requests")},{id:"approved",name:"Đang tiến hành",status:"approved",isExpanded:!0,tasks:K.filter(te=>te.status==="approved")},{id:"live",name:"Đã hoàn thành",status:"live",isExpanded:!0,tasks:K.filter(te=>te.status==="live")}].sort((te,we)=>{const de=["new-requests","approved","live"];return de.indexOf(te.id)-de.indexOf(we.id)}).filter(te=>te.tasks.length>0),us=Be(H,Y),J=zt(us),Ee=c!=="team-tasks"?[]:re.filter(te=>le.filter(de=>de.team_id===te.id.toString()).some(de=>de.location===(h==="hanoi"?"Hà Nội":"Hồ Chí Minh"))).sort((te,we)=>{const de=He=>{const Ne=He.match(/\d+/);return Ne?parseInt(Ne[0]):999};return de(te.name)-de(we.name)}).map(te=>{const we=le.filter(Ne=>Ne.team_id===te.id.toString()&&Ne.location===(h==="hanoi"?"Hà Nội":"Hồ Chí Minh"));let de=us.filter(Ne=>{const $t=le.find(Gs=>Gs.name===Ne.assignedTo?.name),es=le.find(Gs=>Gs.name===Ne.createdBy?.name);return $t&&$t.team_id===te.id.toString()||es&&es.team_id===te.id.toString()});if(L){const Ne=le.find($t=>$t.id===L);if(console.log("🔍 Member filter debug:",{selectedMemberId:L,selectedMember:Ne?.name,totalTeamTasks:de.length}),Ne){const $t=de.length;de=de.filter(es=>{const Gs=es.assignedTo?.name===Ne.name,Na=es.createdBy?.name===Ne.name,Sa=Gs||Na;return console.log(`🔍 Task "${es.name}":`,{assignedTo:es.assignedTo?.name,createdBy:es.createdBy?.name,selectedMember:Ne.name,assignedMatch:Gs,createdMatch:Na,result:Sa?"INCLUDED":"EXCLUDED"}),Sa}),console.log(`🔍 Member filter result: ${$t} -> ${de.length} tasks`)}}const He=[{id:"new-requests",name:"Chưa tiến hành",status:"new-requests",isExpanded:!0,tasks:de.filter(Ne=>Ne.status==="new-requests")},{id:"approved",name:"Đang tiến hành",status:"approved",isExpanded:!0,tasks:de.filter(Ne=>Ne.status==="approved")},{id:"live",name:"Đã hoàn thành",status:"live",isExpanded:!0,tasks:de.filter(Ne=>Ne.status==="live")}].filter(Ne=>Ne.tasks.length>0);return{id:te.id.toString(),name:te.name,members:we,taskGroups:He,totalTasks:de.length}}),Ce=K=>{A(K),M(!0)},Re=()=>{M(!1),N(!0)},tt=()=>{M(!1),E&&(q(E),_(!0))},er=K=>{Q(L===K?null:K)},wa=K=>{u(K),Q(null)},tr=()=>{const K=[{id:"my-tasks",label:"Của Tôi"},{id:"team-tasks",label:"Của Nhóm"},{id:"department-tasks",label:"Công việc chung"}];return s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[s.jsx("nav",{className:"mobile-tab-nav",children:K.map(ce=>{const te=c===ce.id;return s.jsx("button",{onClick:()=>wa(ce.id),className:`
                  relative transition-all duration-300
                  ${te?"text-white bg-gradient-to-r from-cyan-600 to-blue-700 shadow-md":"text-gray-300 hover:text-white hover:bg-gray-700/50"}
                `,children:ce.label},ce.id)})}),s.jsxs("button",{onClick:()=>{"vibrate"in navigator&&navigator.vibrate(50);try{const ce=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT");ce.volume=.05,ce.play().catch(()=>{})}catch{}v(!0)},className:`
            premium-create-button
            ${Z?"premium-loading":""}
            group relative overflow-hidden
            flex items-center justify-center gap-3
            px-6 py-3
            border-0
            text-white font-bold
            text-sm
            rounded-2xl
            transition-all duration-500 ease-out
            shadow-2xl hover:shadow-blue-500/30
            transform hover:scale-105 active:scale-95
            w-full lg:w-auto
            min-w-[160px]
            disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none
            focus:outline-none focus:ring-4 focus:ring-blue-500/50
          `,disabled:Z,children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/30 via-purple-400/30 to-cyan-400/30 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),s.jsx("div",{className:"relative z-10 flex items-center justify-center w-5 h-5",children:Z?s.jsxs("svg",{className:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):s.jsx("svg",{className:"premium-icon w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2.5",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})}),s.jsx("span",{className:"premium-text relative z-10",children:Z?"Đang xử lý...":"Tạo công việc"}),s.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500",children:[s.jsx("div",{className:"absolute top-2 left-4 w-1 h-1 bg-white/60 rounded-full animate-ping",style:{animationDelay:"0s"}}),s.jsx("div",{className:"absolute top-4 right-6 w-1 h-1 bg-white/40 rounded-full animate-ping",style:{animationDelay:"0.5s"}}),s.jsx("div",{className:"absolute bottom-3 left-8 w-1 h-1 bg-white/50 rounded-full animate-ping",style:{animationDelay:"1s"}}),s.jsx("div",{className:"absolute bottom-2 right-4 w-1 h-1 bg-white/30 rounded-full animate-ping",style:{animationDelay:"1.5s"}})]})]})]})},ja=K=>{g(K),Q(null)},yo=()=>c!=="department-tasks"&&c!=="team-tasks"||!o1(i.role)?null:s.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[s.jsx("span",{className:"text-xs text-gray-400 font-medium uppercase tracking-wider",children:"Khu vực:"}),s.jsxs("div",{className:"flex items-center gap-1 p-0.5 bg-gray-900/80 backdrop-blur-md rounded-full shadow",children:[s.jsx("button",{onClick:()=>ja("hanoi"),className:`
              px-3 py-1.5 text-xs font-medium rounded-full
              transition-all duration-300
              ${h==="hanoi"?"text-blue-400 bg-blue-900/50 shadow-inner ":"text-gray-300 hover:text-white hover:bg-gray-700"}
            `,children:"Hà Nội"}),s.jsx("button",{onClick:()=>ja("hcm"),className:`
              px-3 py-1.5 text-xs font-medium rounded-full
              transition-all duration-300
              ${h==="hcm"?"text-blue-400 bg-blue-900/50 shadow-inner":"text-gray-300 hover:text-white hover:bg-gray-700"}
            `,children:"Hồ Chí Minh"})]})]});return s.jsxs("div",{className:"relative mobile-scroll-container mobile-safe-container",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 opacity-50"}),s.jsxs("div",{className:"relative space-y-4 md:space-y-6 mobile-text-optimize",children:[s.jsxs("div",{className:"mobile-header-container",children:[tr(),yo()]}),s.jsx("div",{className:"mobile-task-container bg-gray-900/80 backdrop-blur-md rounded-lg shadow",children:s.jsx(V1,{onFilterChange:ie})}),s.jsx(L1,{tasks:H,activeFilter:ae,onFilterChange:ye,compact:!1}),c==="team-tasks"&&Ee.length>0&&Yi(i.role)&&s.jsx("div",{className:"mb-4",children:s.jsx("div",{className:"flex flex-wrap gap-2",children:Ee.map(K=>{const ce=m===K.id;return s.jsx("button",{onClick:()=>x(ce?null:K.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${ce?"bg-blue-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700 hover:text-white border border-gray-700"}`,children:K.name},K.id)})})}),s.jsx("div",{className:"space-y-3 md:space-y-4",children:c==="team-tasks"?Ee.length===0?s.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:s.jsxs("div",{className:"text-gray-400",children:["Không có nhóm nào tại ",h==="hanoi"?"Hà Nội":"Hồ Chí Minh"]})}):m||!Yi(i.role)?(()=>{let K;return m?K=Ee.find(ce=>ce.id===m):Yi(i.role)||(K=Ee.find(ce=>ce.id===i.team_id)),K?s.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[s.jsxs("div",{className:"bg-gray-900 px-6 py-4 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:K.name}),s.jsxs("span",{className:"text-sm text-gray-400",children:["(",K.members.length," thành viên)"]}),L&&s.jsxs("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded-full text-xs font-medium",children:["Lọc theo: ",le.find(ce=>ce.id===L)?.name]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("span",{className:"text-sm text-gray-400",children:[K.totalTasks," công việc"]}),L&&K.totalTasks>0&&s.jsx("span",{className:"text-xs text-blue-400",children:"(đã lọc)"})]})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[K.members.sort((ce,te)=>ce.role==="team_leader"&&te.role!=="team_leader"?-1:ce.role!=="team_leader"&&te.role==="team_leader"?1:ce.name.localeCompare(te.name)).map(ce=>{const te=L===ce.id,we=K.taskGroups.reduce((de,He)=>de+He.tasks.filter(Ne=>Ne.assignedTo?.name===ce.name||Ne.createdBy?.name===ce.name).length,0);return s.jsxs("button",{"data-testid":"team-member-button",onClick:()=>er(ce.id),className:`px-3 py-1 rounded-full text-xs font-medium transition-all duration-200 hover:scale-105 ${te?"bg-blue-600 text-white ring-2 ring-blue-400":ce.role==="team_leader"?"bg-blue-500/20 text-blue-400 hover:bg-blue-500/30":"bg-gray-500/20 text-gray-400 hover:bg-gray-500/30"}`,title:`Click để lọc công việc của ${ce.name} (${we} công việc)`,children:[ce.name," ",ce.role==="team_leader"&&"(Trưởng nhóm)",we>0&&s.jsx("span",{className:`ml-1 px-1 py-0.5 rounded text-xs ${te?"bg-white/20":"bg-black/20"}`,children:we})]},ce.id)}),L&&s.jsx("button",{onClick:()=>Q(null),className:"px-2 py-1 rounded-full text-xs font-medium bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors",title:"Xóa bộ lọc thành viên",children:"✕ Bỏ lọc"})]})]}),s.jsx("div",{className:"p-6 space-y-4",children:K.taskGroups.length===0?s.jsx("div",{className:"text-center py-8",children:s.jsx("div",{className:"text-gray-400 text-sm",children:"Nhóm này chưa có công việc nào"})}):(()=>{const ce=K.taskGroups.flatMap(te=>te.tasks);return s.jsx("div",{className:"mobile-task-list",children:s.jsx("div",{children:ce.map(te=>{const we=k(te);return s.jsxs("div",{className:`mobile-task-item group hover:bg-gray-700/30 transition-all duration-200 cursor-pointer relative ${we?"border-l-4 border-red-500 bg-red-500/5 hover:bg-red-500/10":""}`,onClick:()=>Ce(te),children:[we&&s.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-xs text-red-400 font-medium",children:"Hôm nay"})]}),s.jsx("div",{className:"hidden md:block w-full mb-3",children:s.jsx(Fi,{task:te,onUpdateTask:he,compact:!1,maxWorkTypes:2})}),s.jsx("div",{className:"md:hidden w-full mb-3",children:s.jsx(Fi,{task:te,onUpdateTask:he,compact:!0,maxWorkTypes:1})}),s.jsxs("div",{className:"mobile-task-content",children:[s.jsxs("div",{className:"hidden md:flex items-center w-full",children:[s.jsx("span",{className:"mobile-assignee",title:te.assignedTo?.name||te.createdBy?.name||"Chưa giao",children:te.assignedTo?.name||te.createdBy?.name||"Chưa giao"}),s.jsxs("h5",{className:"font-bold text-white group-hover:text-blue-300 transition-colors text-base min-w-0 flex-1 ml-8",title:te.name,children:[te.name,te.description&&s.jsxs("span",{className:"text-gray-300 font-normal",children:[" - ",te.description]})]})]}),s.jsxs("div",{className:"md:hidden w-full",children:[s.jsx("h5",{className:"mobile-task-title",title:te.name,children:te.name}),te.description&&s.jsx("p",{className:"mobile-task-description",title:te.description,children:te.description}),s.jsxs("div",{className:"mobile-task-meta",children:[s.jsx(lo,{workTypes:te.workTypes||[te.workType],onChange:de=>{console.log("WorkTypes changed:",de),he({id:te.id,workTypes:de})},maxDisplay:2,className:"mobile-task-badge"}),s.jsx(co,{value:te.status,onChange:de=>he({id:te.id,status:de})}),s.jsx(io,{value:te.priority,onChange:de=>he({id:te.id,priority:de})}),s.jsx(oo,{value:te.shareScope||"team",onChange:de=>he({id:te.id,shareScope:de})}),s.jsx("span",{className:"mobile-assignee",title:te.assignedTo?.name||te.createdBy?.name||"Chưa giao",children:te.assignedTo?.name||te.createdBy?.name||"Chưa giao"}),s.jsx("span",{className:"text-xs text-gray-400 font-medium",children:(()=>{const de=te.startDate||te.createdAt||te.dueDate;if(de){const He=Wi(de);if(He)return Ji(He)}return"N/A"})()})]})]})]}),s.jsx("div",{className:"hidden md:block flex-shrink-0 text-xs text-gray-400 font-medium min-w-0",style:{width:"60px",textAlign:"right"},children:(()=>{const de=te.startDate||te.createdAt||te.dueDate;if(de){const He=Wi(de);if(He)return Ji(He)}return"N/A"})()}),s.jsx("div",{className:"hidden md:flex flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200 absolute right-4 top-1/2 -translate-y-1/2",children:s.jsx(pa,{task:te,onEdit:de=>{de?.stopPropagation(),oe(te.id)},onDelete:de=>{de?.stopPropagation(),xe(te.id)},compact:!0})})]},te.id)})})})})()})]},K.id):null})():Yi(i.role)?s.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:s.jsxs("div",{className:"text-gray-400",children:[s.jsx("div",{className:"mb-2",children:s.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),s.jsx("p",{className:"text-lg font-medium mb-1",children:"Vui lòng chọn một nhóm"}),s.jsx("p",{className:"text-sm",children:"Chọn nhóm từ các nút ở trên để xem danh sách công việc"})]})}):null:J.length===0?s.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-8 text-center",children:s.jsx("div",{className:"text-gray-400",children:H.length===0?"Không có công việc nào":"Không tìm thấy công việc phù hợp với bộ lọc"})}):s.jsx("div",{className:"mobile-task-list",children:s.jsx("div",{children:us.map(K=>{const ce=k(K);return s.jsxs("div",{"data-testid":"task-item",className:`mobile-task-item mobile-touch-feedback mobile-optimized group hover:bg-gray-700/30 transition-all duration-200 cursor-pointer relative ${ce?"border-l-4 border-red-500 bg-red-500/5 hover:bg-red-500/10":""}`,onClick:()=>Ce(K),children:[ce&&s.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-xs text-red-400 font-medium",children:"Hôm nay"})]}),s.jsx("div",{className:"hidden md:block w-full mb-3",children:s.jsx(Fi,{task:K,onUpdateTask:he,compact:!1,maxWorkTypes:2})}),s.jsx("div",{className:"md:hidden w-full mb-3",children:s.jsx(Fi,{task:K,onUpdateTask:he,compact:!0,maxWorkTypes:1})}),s.jsxs("div",{className:"mobile-task-content",children:[s.jsxs("div",{className:"hidden md:flex items-center w-full",children:[s.jsx("span",{className:"mobile-assignee",title:K.assignedTo?.name||K.createdBy?.name||"Chưa giao",children:K.assignedTo?.name||K.createdBy?.name||"Chưa giao"}),s.jsxs("h5",{className:"font-bold text-white group-hover:text-blue-300 transition-colors text-base min-w-0 flex-1 ml-8",title:K.name+(K.description?" - "+K.description:""),children:[K.name,K.description&&s.jsxs("span",{className:"text-gray-300 font-normal",children:[" - ",K.description.length>50?K.description.substring(0,50)+"...":K.description]})]})]}),s.jsxs("div",{className:"md:hidden w-full",children:[s.jsx("h5",{className:"mobile-task-title",title:K.name,children:K.name}),K.description&&s.jsx("p",{className:"mobile-task-description",title:K.description,children:K.description.length>80?K.description.substring(0,80)+"...":K.description}),s.jsxs("div",{className:"mobile-task-meta",children:[s.jsx(lo,{workTypes:K.workTypes||[K.workType],onChange:te=>{console.log("WorkTypes changed:",te),he({id:K.id,workTypes:te})},maxDisplay:2,className:"mobile-task-badge"}),s.jsx(co,{value:K.status,onChange:te=>he({id:K.id,status:te})}),s.jsx(io,{value:K.priority,onChange:te=>he({id:K.id,priority:te})}),s.jsx(oo,{value:K.shareScope||"team",onChange:te=>he({id:K.id,shareScope:te})}),s.jsx("span",{className:"mobile-assignee",title:K.assignedTo?.name||K.createdBy?.name||"Chưa giao",children:K.assignedTo?.name||K.createdBy?.name||"Chưa giao"}),s.jsx("span",{className:"text-xs text-gray-400 font-medium",children:(()=>{const te=K.startDate||K.createdAt||K.dueDate;if(te){const we=Wi(te);if(we)return Ji(we)}return"N/A"})()})]})]})]}),s.jsx("div",{className:"hidden md:block flex-shrink-0 text-xs text-gray-400 font-medium min-w-0",style:{width:"60px",textAlign:"right"},children:(()=>{const te=K.startDate||K.createdAt||K.dueDate;if(te){const we=Wi(te);if(we)return Ji(we)}return"N/A"})()}),s.jsx("div",{className:"hidden md:flex flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200 absolute right-4 top-1/2 -translate-y-1/2",children:s.jsx(pa,{task:K,onEdit:te=>{te?.stopPropagation(),oe(K.id)},onDelete:te=>{te?.stopPropagation(),xe(K.id)},compact:!0})})]},K.id)})})})})]}),s.jsx(w1,{isOpen:p,onClose:()=>v(!1),onSubmit:I}),s.jsx(O1,{isOpen:j,onClose:()=>{N(!1),A(null)},onSubmit:he,task:E}),s.jsx(j1,{isOpen:S,onClose:()=>{_(!1),q(null)},onConfirm:mt,title:"Xóa công việc",message:"Bạn có chắc chắn muốn xóa công việc này vĩnh viễn?",itemName:G?.name}),s.jsx(I1,{isOpen:D,onClose:()=>{M(!1),A(null)},task:E,onEdit:Re,onDelete:tt,onUpdate:he})]})},F1=({onLogout:l,className:a="",isCollapsed:n=!1})=>{const[i,c]=b.useState(!1),[u,h]=b.useState({top:0,left:0}),[g,m]=b.useState(null),x=b.useRef(null),p=b.useRef(null),j=(()=>{try{const E=localStorage.getItem("auth_user");return E?JSON.parse(E):{name:"Test User",email:"test@example.com",role:"employee",location:"Hà Nội"}}catch(E){return console.error("❌ Error getting user data:",E),{name:"Unknown User",email:"unknown@example.com",role:"employee",location:"Hà Nội"}}})();b.useEffect(()=>{const E=A=>{p.current&&!p.current.contains(A.target)&&c(!1)};if(i)return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[i]);const N=E=>{switch(E){case"retail_director":return"Giám đốc";case"team_leader":return"Trưởng nhóm";case"employee":return"Nhân viên";default:return"Người dùng"}},S=E=>E.split(" ").map(A=>A.charAt(0)).join("").toUpperCase().slice(0,2),_=()=>{if(!x.current)return;const E=x.current.getBoundingClientRect(),A=window.innerWidth,G=window.innerHeight,q=384,H=400;let R=E.bottom+8,Z=E.left;n?(Z=E.right+8,R=E.top):(R+H>G&&(R=E.top-H-8),Z+q>A&&(Z=A-q-16)),R<16&&(R=16),Z<16&&(Z=16),h({top:R,left:Z})},D=E=>{E.preventDefault(),E.stopPropagation(),i||_(),c(!i)},M=E=>{E.preventDefault(),E.stopPropagation(),c(!1),setTimeout(()=>{l()},100)};return b.useEffect(()=>{const E=()=>{i&&_()};return window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[i,n]),s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`relative ${a}`,ref:p,children:s.jsxs("button",{ref:x,onClick:D,className:`flex items-center gap-3 p-2 rounded-lg hover:bg-gray-700 transition-all duration-200 w-full ${n?"justify-center":""} ${i?"bg-gray-700 ring-2 ring-blue-500/50":""}`,title:n?j.name:void 0,"data-testid":"user-avatar-button",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",children:S(j.name)}),!n&&s.jsxs("div",{className:"text-left flex-1",children:[s.jsx("div",{className:"text-white font-medium text-sm",children:j.name}),s.jsx("div",{className:"text-gray-400 text-xs",children:N(j.role)})]})]})}),i&&kl.createPortal(s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-[9998] bg-black/30 backdrop-blur-sm animate-in fade-in duration-200",onClick:()=>c(!1),"data-testid":"user-avatar-backdrop"}),s.jsxs("div",{ref:p,className:"fixed w-96 max-w-[calc(100vw-2rem)] bg-gray-800/95 backdrop-blur-xl border border-gray-600/50 rounded-2xl shadow-2xl z-[9999] max-h-[85vh] overflow-hidden animate-in slide-in-from-top-2 fade-in duration-300",style:{top:`${u.top}px`,left:`${u.left}px`},"data-testid":"user-avatar-dropdown",children:[s.jsx("div",{className:"p-6 border-b border-gray-600/50",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative flex-shrink-0",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg",children:S(j.name)}),s.jsx("button",{onClick:E=>{E.preventDefault(),E.stopPropagation(),c(!1),m("avatar")},className:"absolute -bottom-1 -right-1 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center hover:bg-blue-700 transition-all duration-200 shadow-lg hover:scale-110",title:"Đổi avatar",children:s.jsx(Fa,{className:"w-3 h-3 text-white"})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-white font-semibold text-lg truncate",children:j.name}),s.jsx("p",{className:"text-gray-400 text-sm truncate",children:j.email}),s.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[s.jsx("span",{className:"px-3 py-1 bg-blue-600/20 text-blue-400 rounded-full text-xs font-medium border border-blue-500/20",children:N(j.role)}),s.jsx("span",{className:"px-3 py-1 bg-green-600/20 text-green-400 rounded-full text-xs font-medium border border-green-500/20",children:j.location})]})]})]})}),s.jsxs("div",{className:"p-4 space-y-2",children:[s.jsxs("button",{onClick:E=>{E.preventDefault(),E.stopPropagation(),c(!1),m("password")},className:"w-full flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-700/50 rounded-xl transition-all duration-200 hover:text-white group",children:[s.jsx(Dl,{className:"w-5 h-5 group-hover:text-yellow-400 transition-colors"}),s.jsx("span",{className:"font-medium",children:"Đổi mật khẩu"})]}),s.jsxs("button",{onClick:E=>{E.preventDefault(),E.stopPropagation(),c(!1),m("email")},className:"w-full flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-700/50 rounded-xl transition-all duration-200 hover:text-white group",children:[s.jsx(Cd,{className:"w-5 h-5 group-hover:text-green-400 transition-colors"}),s.jsx("span",{className:"font-medium",children:"Đổi email"})]}),s.jsxs("button",{onClick:E=>{E.preventDefault(),E.stopPropagation(),c(!1),m("avatar")},className:"w-full flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-700/50 rounded-xl transition-all duration-200 hover:text-white group",children:[s.jsx(Fa,{className:"w-5 h-5 group-hover:text-purple-400 transition-colors"}),s.jsx("span",{className:"font-medium",children:"Đổi avatar"})]}),s.jsxs("button",{onClick:E=>{E.preventDefault(),E.stopPropagation(),alert(`Thông tin cá nhân bao gồm:

• Họ và tên
• Email
• Số điện thoại
• Địa chỉ
• Ngày sinh
• Giới tính
• Phòng ban
• Chức vụ
• Ngày vào làm
• Trạng thái làm việc`),console.log("Profile info clicked")},className:"w-full flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-700/50 rounded-xl transition-all duration-200 hover:text-white group",children:[s.jsx($s,{className:"w-5 h-5 group-hover:text-blue-400 transition-colors"}),s.jsx("span",{className:"font-medium",children:"Thông tin cá nhân"})]}),s.jsx("div",{className:"border-t border-gray-600/50 my-3"}),s.jsxs("button",{onClick:M,className:"w-full flex items-center gap-3 px-4 py-3 text-red-400 hover:bg-red-600/20 hover:text-red-300 rounded-xl transition-all duration-200 group font-medium","data-testid":"logout-button",children:[s.jsx(Rx,{className:"w-5 h-5 group-hover:scale-110 transition-transform"}),s.jsx("span",{children:"Đăng xuất"})]})]})]})]}),document.body),s.jsx(Gx,{isOpen:g==="password",onClose:()=>m(null),onSuccess:()=>{console.log("Password changed successfully")}}),s.jsx(Kx,{isOpen:g==="email",onClose:()=>m(null),onSuccess:()=>{console.log("Email changed successfully")}}),s.jsx(Px,{isOpen:g==="avatar",onClose:()=>m(null),onSuccess:()=>{console.log("Avatar changed successfully"),window.location.reload()}})]})};function X1({activeTab:l,setActiveTab:a,sidebarOpen:n,setSidebarOpen:i,onLogout:c,isModalOpen:u=!1}){const[h,g]=b.useState(!1),[m,x]=b.useState(!1),[p,v]=b.useState(!1);b.useEffect(()=>{const M=E=>{E.clientX<=80&&m&&!u&&x(!1)};return document.addEventListener("mousemove",M,{passive:!0}),()=>{document.removeEventListener("mousemove",M)}},[m,u]);const j=()=>{v(!0),x(!1)},N=()=>{v(!1),!(u||h)&&x(!0)},S=(()=>{try{return $e()}catch(M){return console.error("❌ YouTubeSidebar: Error getting current user:",M),{name:"Unknown User"}}})(),_=[{id:"home",label:"Trang Chủ",icon:s.jsx(Ox,{className:"w-5 h-5"})},{id:"work",label:"Công Việc",icon:s.jsx(Dx,{className:"w-5 h-5"})},{id:"plan",label:"Kế Hoạch",icon:s.jsx(At,{className:"w-5 h-5"})},{id:"customers",label:"Khách Hàng",icon:s.jsx(qt,{className:"w-5 h-5"})},...S.name==="Khổng Đức Mạnh"?[{id:"hr",label:"Nhân Viên",icon:s.jsx(V2,{className:"w-5 h-5"})}]:[]],D=(M,E)=>{const A=h||m;return s.jsxs("button",{onClick:()=>a(M.id),className:`w-full flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ${E?"bg-gray-700 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"} ${A?"justify-center":""}`,title:A?M.label:void 0,children:[s.jsx("span",{className:`${E?"text-white":"text-gray-400"} ${A?"":"mr-3"}`,children:M.icon}),!A&&M.label]},M.id)};return s.jsxs(s.Fragment,{children:[n&&s.jsx("div",{className:"fixed inset-0 z-40 lg:hidden",children:s.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>i(!1)})}),s.jsxs("div",{className:`fixed inset-y-0 left-0 z-50 ${h||m?"w-16":"w-64"} bg-gray-800 shadow-lg transform ${n?"translate-x-0":"-translate-x-full"} transition-all duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0`,onMouseEnter:j,onMouseLeave:N,children:[s.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:()=>g(!h),className:"hidden lg:block p-2 rounded-md text-gray-400 hover:text-gray-300 hover:bg-gray-700",children:s.jsx(E2,{className:"w-6 h-6"})}),!(h||m)&&s.jsx("img",{src:"/incanto-logo.svg",alt:"INCANTO",className:"h-8 w-auto ml-2"})]}),s.jsx("button",{onClick:()=>i(!1),className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-300 hover:bg-gray-700",children:s.jsx(Fe,{className:"w-6 h-6"})})]}),s.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1 overflow-y-auto",children:s.jsx("div",{className:"space-y-1",children:_.map(M=>D(M,l===M.id))})}),s.jsx("div",{className:"border-t border-gray-700 p-4",children:s.jsx(F1,{onLogout:c,className:`w-full ${h||m?"flex justify-center":""}`,isCollapsed:h||m})})]})]})}function Lg(){const{user:l,logout:a}=ln(),n=ws(),{tab:i}=Gv(),[c,u]=b.useState("home"),[h,g]=b.useState(!1),[m,x]=b.useState(!1),[p,v]=b.useState(null),[j,N]=b.useState(!1),[S,_]=b.useState({period:"month"}),[D,M]=b.useState("personal"),[E,A]=b.useState("hanoi"),[G,q]=b.useState(""),[H,R]=b.useState("");b.useEffect(()=>{if(i&&["home","work","plan","customers","hr","settings"].includes(i))u(i);else if(!i){const Q=localStorage.getItem("dashboard-active-tab");Q&&["home","work","plan","customers","hr","settings"].includes(Q)?(u(Q),n(`/dashboard/${Q}`,{replace:!0})):(u("home"),n("/dashboard/home",{replace:!0}))}},[i,n]),b.useEffect(()=>{console.log("🤖 Initializing auto-move scheduler..."),W2.startAutoMoveScheduler(60)},[]),b.useEffect(()=>{Z()},[S]);const Z=async()=>{N(!0);try{const Q=await r1(S);v(Q),Q.hanoi||Q.hcm?M("locations"):Q.team?M("team"):M("personal")}catch(Q){console.error("❌ Error loading dashboard stats:",Q)}finally{N(!1)}},ue=Q=>{u(Q),n(`/dashboard/${Q}`,{replace:!0}),localStorage.setItem("dashboard-active-tab",Q),g(!1)},re=()=>{a()},ee=Q=>({home:"Trang Chủ",work:"Công Việc",plan:"Kế Hoạch",customers:"Khách Hàng",hr:"Quản Lý Nhân Viên",settings:"Cài đặt"})[Q]||"Trang Chủ",le=()=>{const Q=["personal"];return p?.team&&Q.push("team"),(p?.hanoi||p?.hcm)&&Q.push("locations"),Q},ne=()=>{if(!p)return{ktsNew:0,ktsOld:0,partnerNew:0,partnerOld:0,customerNew:0,customerOld:0,sbgNew:0,sbgOld:0,other:0};switch(D){case"locations":return E==="hanoi"?p.hanoi||p.personal:p.hcm||p.personal;case"team":return p.team||p.personal;case"personal":default:return p.personal}},Y=()=>{switch(D){case"locations":return`Thống kê ${E==="hanoi"?"Hà Nội":"Hồ Chí Minh"}`;case"team":return"Thống kê nhóm";case"personal":default:return"Thống kê cá nhân"}},ie=(Q,ae)=>{q(Q),R(ae)},L=()=>!p?.teamMembers||!G?[]:p.teamMembers;return s.jsxs("div",{className:"flex h-screen bg-gray-900",children:[s.jsx(X1,{activeTab:c,setActiveTab:ue,sidebarOpen:h,setSidebarOpen:g,onLogout:re,isModalOpen:m}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden lg:ml-0",children:[s.jsx("header",{className:"bg-gray-800 shadow-sm border-b border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between h-16 px-6",children:[s.jsx("div",{className:"flex items-center",children:s.jsx("h1",{className:"text-2xl font-semibold text-white",children:ee(c)})}),c==="home"&&s.jsx(_g,{value:S,onChange:_,className:"hidden md:block"})]})}),s.jsxs("main",{className:"flex-1 overflow-y-auto bg-gray-900 p-6 pb-16 md:pb-6",children:[c==="home"&&s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"md:hidden",children:s.jsx(_g,{value:S,onChange:_,className:"w-full"})}),s.jsx(DN,{activeTab:D,onTabChange:M,availableTabs:le()}),D==="locations"?s.jsxs("div",{className:"space-y-6",children:[s.jsx(ON,{activeLocation:E,onLocationChange:A}),s.jsx(Vu,{stats:ne(),title:Y(),isLoading:j}),s.jsx(HN,{location:E==="hanoi"?"Hà Nội":"Hồ Chí Minh",selectedTeamId:G,onTeamSelect:ie}),G&&H&&s.jsx(bg,{members:L(),teamName:H,isLoading:j})]}):D==="team"&&p?.teamMembers?s.jsxs("div",{className:"space-y-6",children:[s.jsx(Vu,{stats:ne(),title:Y(),isLoading:j}),s.jsx(bg,{members:p.teamMembers,teamName:l?.team?.name||"Nhóm của bạn",isLoading:j})]}):s.jsx(Vu,{stats:ne(),title:Y(),isLoading:j}),s.jsxs("div",{className:"hidden",children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Thống kê chi tiết (Legacy)"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider",children:"KTS CÁ NHÂN"}),s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"})]}),s.jsxs("div",{className:"flex items-baseline space-x-2 mb-2",children:[s.jsx("span",{className:"text-3xl font-bold text-white",children:Ye.categoryStats.architects.total}),s.jsxs("span",{className:"text-sm text-gray-400",children:["Trước: ",Ye.categoryStats.architects.existing]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("span",{className:"text-xs text-green-400",children:"↑ 0%"}),s.jsx("span",{className:"text-xs text-gray-400",children:"vs kế hoạch"})]}),s.jsxs("div",{className:"h-8 flex items-end space-x-1",children:[s.jsx("div",{className:"w-2 bg-blue-400 h-4 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-5 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-6 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-7 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-8 rounded-sm"})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[s.jsxs("span",{children:["Mới: ",Ye.categoryStats.architects.new]}),s.jsxs("span",{children:["Cũ: ",Ye.categoryStats.architects.existing]})]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider",children:"ĐỐI TÁC CÁ NHÂN"}),s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"})]}),s.jsxs("div",{className:"flex items-baseline space-x-2 mb-2",children:[s.jsx("span",{className:"text-3xl font-bold text-white",children:Ye.categoryStats.partners.total}),s.jsxs("span",{className:"text-sm text-gray-400",children:["Trước: ",Ye.categoryStats.partners.existing]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("span",{className:"text-xs text-green-400",children:"↑ 0%"}),s.jsx("span",{className:"text-xs text-gray-400",children:"vs kế hoạch"})]}),s.jsxs("div",{className:"h-8 flex items-end space-x-1",children:[s.jsx("div",{className:"w-2 bg-blue-400 h-3 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-4 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-6 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-7 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-8 rounded-sm"})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[s.jsxs("span",{children:["Mới: ",Ye.categoryStats.partners.new]}),s.jsxs("span",{children:["Cũ: ",Ye.categoryStats.partners.existing]})]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider",children:"KHÁCH HÀNG CÁ NHÂN"}),s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"})]}),s.jsxs("div",{className:"flex items-baseline space-x-2 mb-2",children:[s.jsx("span",{className:"text-3xl font-bold text-white",children:Ye.categoryStats.customers.total}),s.jsxs("span",{className:"text-sm text-gray-400",children:["Trước: ",Ye.categoryStats.customers.existing]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("span",{className:"text-xs text-green-400",children:"↑ 0%"}),s.jsx("span",{className:"text-xs text-gray-400",children:"vs kế hoạch"})]}),s.jsxs("div",{className:"h-8 flex items-end space-x-1",children:[s.jsx("div",{className:"w-2 bg-blue-400 h-5 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-6 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-7 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-8 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-8 rounded-sm"})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[s.jsxs("span",{children:["Mới: ",Ye.categoryStats.customers.new]}),s.jsxs("span",{children:["Cũ: ",Ye.categoryStats.customers.existing]})]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider",children:"BÁO GIÁ CÁ NHÂN"}),s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"})]}),s.jsxs("div",{className:"flex items-baseline space-x-2 mb-2",children:[s.jsx("span",{className:"text-3xl font-bold text-white",children:Ye.categoryStats.quotes.total}),s.jsxs("span",{className:"text-sm text-gray-400",children:["Trước: ",Ye.categoryStats.quotes.existing]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("span",{className:"text-xs text-green-400",children:"↑ 0%"}),s.jsx("span",{className:"text-xs text-gray-400",children:"vs kế hoạch"})]}),s.jsxs("div",{className:"h-8 flex items-end space-x-1",children:[s.jsx("div",{className:"w-2 bg-blue-400 h-4 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-5 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-6 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-7 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-8 rounded-sm"})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[s.jsxs("span",{children:["Mới: ",Ye.categoryStats.quotes.new]}),s.jsxs("span",{children:["Cũ: ",Ye.categoryStats.quotes.existing]})]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider",children:"CÔNG VIỆC KHÁC CÁ NHÂN"}),s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"})]}),s.jsxs("div",{className:"flex items-baseline space-x-2 mb-2",children:[s.jsx("span",{className:"text-3xl font-bold text-white",children:Ye.categoryStats.otherTasks}),s.jsx("span",{className:"text-sm text-gray-400",children:"Trước: 0"})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("span",{className:"text-xs text-green-400",children:"↑ 0%"}),s.jsx("span",{className:"text-xs text-gray-400",children:"vs kế hoạch"})]}),s.jsxs("div",{className:"h-8 flex items-end space-x-1",children:[s.jsx("div",{className:"w-2 bg-blue-400 h-3 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-4 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-5 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-6 rounded-sm"}),s.jsx("div",{className:"w-2 bg-blue-400 h-8 rounded-sm"})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[s.jsxs("span",{children:["Mới: ",Math.floor(Ye.categoryStats.otherTasks*.3)]}),s.jsxs("span",{children:["Cũ: ",Math.floor(Ye.categoryStats.otherTasks*.7)]})]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-300 uppercase tracking-wider",children:"DOANH SỐ CÁ NHÂN"}),s.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full"})]}),s.jsxs("div",{className:"flex items-baseline space-x-2 mb-2",children:[s.jsx("span",{className:"text-3xl font-bold text-white",children:"0"}),s.jsx("span",{className:"text-sm text-orange-400",children:"VNĐ"}),s.jsx("span",{className:"text-sm text-gray-400",children:"Trước: 0 VNĐ"})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("span",{className:"text-xs text-green-400",children:"↑ 0%"}),s.jsx("span",{className:"text-xs text-gray-400",children:"vs kế hoạch"})]}),s.jsxs("div",{className:"h-8 flex items-end space-x-1",children:[s.jsx("div",{className:"w-2 bg-orange-400 h-2 rounded-sm"}),s.jsx("div",{className:"w-2 bg-orange-400 h-3 rounded-sm"}),s.jsx("div",{className:"w-2 bg-orange-400 h-4 rounded-sm"}),s.jsx("div",{className:"w-2 bg-orange-400 h-5 rounded-sm"}),s.jsx("div",{className:"w-2 bg-orange-400 h-6 rounded-sm"})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[s.jsx("span",{children:"Mới: 0"}),s.jsx("span",{children:"Cũ: 0"})]})]})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Tổng quan hệ thống"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-slate-600 via-slate-700 to-slate-800 p-6 h-64 group hover:scale-105 transition-transform duration-300",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-purple-600/20"}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:"text-xs text-gray-300 uppercase tracking-wider mb-2",children:"TASK MANAGEMENT"}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"TỔNG CÔNG VIỆC"}),s.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:Ye.managerStats.totalTasks}),s.jsx("div",{className:"text-sm text-gray-300",children:"Công việc"})]}),s.jsx("div",{className:"absolute bottom-4 right-4 w-16 h-16 bg-blue-500/20 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-2xl",children:"📋"})}),s.jsx("div",{className:"absolute top-4 right-4 w-2 h-2 bg-green-400 rounded-full"})]}),s.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-600 via-purple-700 to-pink-600 p-6 h-64 group hover:scale-105 transition-transform duration-300",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/30 to-pink-500/30"}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:"text-xs text-purple-200 uppercase tracking-wider mb-2",children:"COMPLETED"}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"HOÀN THÀNH"}),s.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:Ye.managerStats.completedTasks}),s.jsx("div",{className:"text-sm text-purple-200",children:"Công việc"})]}),s.jsx("div",{className:"absolute bottom-4 right-4 w-16 h-16 bg-pink-500/20 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-2xl",children:"✅"})}),s.jsx("div",{className:"absolute top-4 right-4 w-2 h-2 bg-pink-400 rounded-full"})]}),s.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-emerald-600 via-teal-700 to-cyan-800 p-6 h-64 group hover:scale-105 transition-transform duration-300",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-500/20 to-cyan-500/20"}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:"text-xs text-emerald-200 uppercase tracking-wider mb-2",children:"COMPLETION RATE"}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"TỶ LỆ HOÀN THÀNH"}),s.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:X2(Ye.managerStats.completionRate)}),s.jsx("div",{className:"text-sm text-emerald-200",children:"Hiệu suất"})]}),s.jsx("div",{className:"absolute bottom-4 right-4 w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-2xl",children:"📊"})}),s.jsx("div",{className:"absolute top-4 right-4 w-2 h-2 bg-emerald-400 rounded-full"})]}),s.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-amber-600 via-orange-700 to-red-700 p-6 h-64 group hover:scale-105 transition-transform duration-300",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/20 to-orange-500/20"}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:"text-xs text-amber-200 uppercase tracking-wider mb-2",children:"HANOI REVENUE"}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"DOANH SỐ HÀ NỘI"}),s.jsx("div",{className:"text-2xl font-bold text-white mb-2",children:kg(Ye.managerStats.hanoiRevenue)}),s.jsx("div",{className:"text-sm text-amber-200",children:"Doanh thu"})]}),s.jsx("div",{className:"absolute bottom-4 right-4 w-16 h-16 bg-amber-500/20 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-2xl",children:"🏢"})}),s.jsx("div",{className:"absolute top-4 right-4 w-2 h-2 bg-amber-400 rounded-full"})]}),s.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-rose-600 via-pink-700 to-purple-700 p-6 h-64 group hover:scale-105 transition-transform duration-300",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-rose-500/20 to-purple-500/20"}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:"text-xs text-rose-200 uppercase tracking-wider mb-2",children:"HCM REVENUE"}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"DOANH SỐ HCM"}),s.jsx("div",{className:"text-2xl font-bold text-white mb-2",children:kg(Ye.managerStats.hcmRevenue)}),s.jsx("div",{className:"text-sm text-rose-200",children:"Doanh thu"})]}),s.jsx("div",{className:"absolute bottom-4 right-4 w-16 h-16 bg-rose-500/20 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-2xl",children:"🏬"})}),s.jsx("div",{className:"absolute top-4 right-4 w-2 h-2 bg-rose-400 rounded-full"})]}),s.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-violet-600 via-purple-700 to-indigo-700 p-6 h-64 group hover:scale-105 transition-transform duration-300",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-violet-500/20 to-indigo-500/20"}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:"text-xs text-violet-200 uppercase tracking-wider mb-2",children:"TEAM"}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"PERFORMANCE"}),s.jsxs("div",{className:"text-sm text-violet-200 mb-4",children:[Ye.teamStats.totalMembers," Members"]})]}),s.jsx("div",{className:"absolute bottom-4 right-4 w-16 h-16 bg-violet-500/20 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-2xl",children:"👥"})}),s.jsx("div",{className:"absolute top-4 right-4 w-2 h-2 bg-violet-400 rounded-full"})]})]})]})]}),c==="work"&&s.jsx("div",{className:"space-y-8",children:s.jsx(Y1,{userRole:l?.role==="retail_director"?"manager":"employee",currentUser:l?.name||"Unknown User",onModalStateChange:x})}),c==="plan"&&s.jsx(d1,{}),c==="customers"&&s.jsx("div",{className:"space-y-8",children:s.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-sm p-8 text-center border border-gray-700",children:[s.jsx("div",{className:"w-16 h-16 bg-purple-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Quản lý Khách Hàng"}),s.jsx("p",{className:"text-gray-400",children:"Tính năng quản lý khách hàng đang được phát triển."})]})}),c==="hr"&&s.jsx("div",{className:"space-y-8",children:s.jsx($x,{})}),c==="settings"&&s.jsx("div",{className:"space-y-8",children:s.jsx(p1,{onLogout:re})})]})]}),s.jsx(x1,{activeTab:c,onTabChange:ue,isModalOpen:m,onLogout:re})]})}const Z1=()=>{const[l,a]=b.useState(["sbg-new"]);return s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:s.jsx(on,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Dropdown Loại Công Việc - Tối Ưu Mobile"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Badge/Tag design với responsive layout"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(po,{label:"Chọn loại công việc",value:l,onChange:a,placeholder:"Chọn một hoặc nhiều loại công việc",required:!0}),s.jsx("div",{className:"bg-gray-700/50 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(N2,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-medium text-white",children:"Tính năng tối ưu:"}),s.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Badge/Tag design:"})," Đơn giản, dễ nhận diện"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Responsive grid:"})," 2-3-4 cột tùy màn hình"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Touch-friendly:"})," Min 44px height cho mobile"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Smart truncation:"})," Hiển thị tối đa 3 badges + counter"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Khóa cuộn mạnh mẽ:"})," Prevent tất cả scroll events"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Mobile optimized:"})," 90vh height trên mobile"]})]})]})]})}),l.length>0&&s.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-4",children:[s.jsxs("h4",{className:"font-medium text-green-400 mb-2",children:["Đã chọn (",l.length,"):"]}),s.jsx("div",{className:"text-sm text-gray-300",children:s.jsx("code",{className:"bg-gray-700 px-2 py-1 rounded text-green-400",children:JSON.stringify(l,null,2)})})]})]})]})},J1=()=>{const[l,a]=b.useState([]);return s.jsx("div",{className:"min-h-screen bg-gray-900 p-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white mb-8",children:"WorkType Dropdown - Tối Ưu Mobile"}),s.jsxs("div",{className:"space-y-8 mb-8",children:[s.jsx(Z1,{}),s.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-green-400 mb-4",children:"📱 Mobile Responsive Design"}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl mb-2",children:"📱"}),s.jsx("div",{className:"text-sm font-medium text-white",children:"Mobile"}),s.jsx("div",{className:"text-xs text-gray-400",children:"Dưới 640px"}),s.jsx("div",{className:"text-xs text-green-400",children:"2 cột grid"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl mb-2",children:"📟"}),s.jsx("div",{className:"text-sm font-medium text-white",children:"Tablet"}),s.jsx("div",{className:"text-xs text-gray-400",children:"640px - 1024px"}),s.jsx("div",{className:"text-xs text-green-400",children:"3 cột grid"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl mb-2",children:"💻"}),s.jsx("div",{className:"text-sm font-medium text-white",children:"Desktop"}),s.jsx("div",{className:"text-xs text-gray-400",children:"Trên 1024px"}),s.jsx("div",{className:"text-xs text-green-400",children:"4 cột grid"})]})]}),s.jsx("p",{className:"text-sm text-gray-300",children:"Sử dụng Developer Tools (F12) → Device Toolbar (Ctrl+Shift+M) để test responsive design"})]}),s.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg border border-gray-700",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Test Thủ Công"}),s.jsx(po,{label:"Loại công việc",value:l,onChange:a,placeholder:"Chọn loại công việc",required:!0}),s.jsxs("div",{className:"mt-6",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Selected Values:"}),s.jsx("pre",{className:"bg-gray-700 p-3 rounded text-green-400 text-xs overflow-x-auto",children:JSON.stringify(l,null,2)})]})]})]}),s.jsxs("div",{className:"mt-8 space-y-6",children:[s.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"🧪 Hướng Dẫn Test"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-blue-400 mb-3",children:"Test 1: Khóa Cuộn Trang"}),s.jsxs("ol",{className:"text-gray-300 space-y-2 text-sm",children:[s.jsx("li",{children:"1. Cuộn trang xuống một chút"}),s.jsx("li",{children:"2. Mở dropdown loại công việc"}),s.jsx("li",{children:"3. Thử cuộn bằng:"}),s.jsx("li",{className:"ml-4",children:"• Scroll wheel chuột"}),s.jsx("li",{className:"ml-4",children:"• Phím mũi tên ↑↓"}),s.jsx("li",{className:"ml-4",children:"• Page Up/Down"}),s.jsx("li",{className:"ml-4",children:"• Spacebar"}),s.jsx("li",{children:"4. ✅ Trang không được cuộn"}),s.jsx("li",{children:"5. Đóng dropdown"}),s.jsx("li",{children:"6. ✅ Cuộn hoạt động bình thường"})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-green-400 mb-3",children:"Test 2: Badge Design & Mobile"}),s.jsxs("ol",{className:"text-gray-300 space-y-2 text-sm",children:[s.jsx("li",{children:"1. Mở dropdown loại công việc"}),s.jsx("li",{children:"2. ✅ Badge/tag design đơn giản"}),s.jsx("li",{children:"3. ✅ Responsive grid:"}),s.jsx("li",{className:"ml-4",children:"• Mobile: 2-3 cột"}),s.jsx("li",{className:"ml-4",children:"• Desktop: 4 cột"}),s.jsx("li",{children:"4. ✅ Touch-friendly (min 44px)"}),s.jsx("li",{children:"5. ✅ Selected badges truncation"}),s.jsx("li",{children:"6. ✅ Smooth animations"}),s.jsx("li",{children:"7. ✅ Mobile height: 90vh"})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Nội Dung Test Cuộn Trang"}),s.jsx("p",{className:"text-gray-400",children:"Sử dụng nội dung dưới đây để test tính năng khóa cuộn trang:"}),Array.from({length:25},(n,i)=>s.jsxs("div",{className:"bg-gray-700 p-4 rounded text-white",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:["📄 Nội dung test scroll #",i+1]}),s.jsxs("span",{className:"text-gray-400 text-sm",children:["Line ",i+1,"/25"]})]}),s.jsx("p",{className:"text-gray-300 text-sm mt-2",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."})]},i))]})]})]})})},W1=()=>{const l=n=>{console.log("Edit clicked!",n),alert("Nút Sửa đã được click!")},a=n=>{console.log("Delete clicked!",n),alert("Nút Xóa đã được click!")};return s.jsx("div",{className:"min-h-screen bg-gray-900 p-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-white mb-8",children:"TaskActions Demo"}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Compact Mode (như trong TaskList)"}),s.jsx("div",{className:"bg-blue-900/20 border border-blue-500/30 rounded-lg p-4",children:s.jsxs("p",{className:"text-blue-300 text-sm",children:["💡 ",s.jsx("strong",{children:"Hướng dẫn:"}),s.jsx("br",{}),"• ",s.jsx("strong",{children:"Desktop:"})," Di chuyển chuột vào task để thấy 2 nút Sửa/Xóa xuất hiện",s.jsx("br",{}),"• ",s.jsx("strong",{children:"Mobile/Tablet:"})," Tap vào task để mở chi tiết, 2 nút Sửa/Xóa có trong modal (tiết kiệm không gian)"]})}),s.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:s.jsxs("div",{className:"group flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4 px-3 sm:px-4 lg:px-6 py-3 hover:bg-gray-700/30 transition-all duration-200 cursor-pointer relative border-b border-gray-700/50",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"hidden md:flex items-center w-full",children:[s.jsx("span",{className:"text-gray-200 text-sm font-medium min-w-0 flex-shrink-0",style:{width:"180px"},children:"Nguyễn Văn A"}),s.jsxs("h5",{className:"font-medium text-white group-hover:text-blue-300 transition-colors text-sm min-w-0 flex-1 ml-8",children:["Tạo campaign Facebook cho sản phẩm mới",s.jsxs("span",{className:"text-gray-300 font-normal",children:[" - ","Thiết kế creative và setup targeting cho chiến dịch quảng cáo"]})]})]}),s.jsxs("div",{className:"md:hidden w-full space-y-1",children:[s.jsxs("div",{className:"flex items-center w-full",children:[s.jsx("span",{className:"text-gray-200 text-base font-medium truncate",children:"Nguyễn Văn A"}),s.jsx("div",{className:"flex-1"}),s.jsx("span",{className:"text-xs text-gray-400 font-medium",style:{marginLeft:"auto",paddingLeft:"16px"},children:"Hôm nay"})]}),s.jsx("h5",{className:"font-bold text-white text-sm leading-tight",children:"Tạo campaign Facebook cho sản phẩm mới"}),s.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:"Thiết kế creative và setup targeting cho chiến dịch quảng cáo"})]})]}),s.jsx("div",{className:"hidden md:block flex-shrink-0 text-xs text-gray-400 font-medium min-w-0",style:{width:"60px",textAlign:"right"},children:"Hôm nay"}),s.jsx("div",{className:"hidden md:flex flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200 absolute right-4 top-1/2 -translate-y-1/2",children:s.jsx(pa,{onEdit:l,onDelete:a,compact:!0})})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Standalone Modes"}),s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Compact Mode"}),s.jsx(pa,{onEdit:l,onDelete:a,compact:!0})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Default Mode"}),s.jsx(pa,{onEdit:l,onDelete:a,compact:!1})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Mobile/Tablet UX - Space Optimized"}),s.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Tiết Kiệm Không Gian"}),s.jsxs("div",{className:"space-y-3 text-gray-300 text-sm",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400",children:"✓"}),s.jsxs("span",{children:[s.jsx("strong",{children:"Ẩn 2 nút Sửa/Xóa"})," - Tiết kiệm không gian màn hình"]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400",children:"✓"}),s.jsxs("span",{children:[s.jsx("strong",{children:"Tap để mở chi tiết"})," - Toàn bộ task area có thể tap"]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400",children:"✓"}),s.jsxs("span",{children:[s.jsx("strong",{children:"Actions trong modal"})," - 2 nút Sửa/Xóa có trong TaskDetailModal"]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-green-400",children:"✓"}),s.jsxs("span",{children:[s.jsx("strong",{children:"Clean interface"})," - Giao diện gọn gàng, tập trung vào nội dung"]})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:"Background Tests"}),s.jsxs("div",{className:"bg-blue-900/20 rounded-lg p-6",children:[s.jsx("h3",{className:"text-white mb-2",children:"On Blue Background"}),s.jsx(pa,{onEdit:l,onDelete:a,compact:!0})]}),s.jsxs("div",{className:"bg-gray-700 rounded-lg p-6",children:[s.jsx("h3",{className:"text-white mb-2",children:"On Dark Gray Background"}),s.jsx(pa,{onEdit:l,onDelete:a,compact:!0})]}),s.jsxs("div",{className:"bg-gray-600 rounded-lg p-6",children:[s.jsx("h3",{className:"text-white mb-2",children:"On Light Gray Background"}),s.jsx(pa,{onEdit:l,onDelete:a,compact:!0})]})]})]})]})})};function eS(){return s.jsxs(nb,{children:[s.jsx(Nt,{path:"/auth/region-selection",element:s.jsx(xs,{requireAuth:!1,children:s.jsx(NN,{})})}),s.jsx(Nt,{path:"/auth/director-login",element:s.jsx(xs,{requireAuth:!1,children:s.jsx(SN,{})})}),s.jsx(Nt,{path:"/auth/team-selection",element:s.jsx(xs,{requireAuth:!1,children:s.jsx(_N,{})})}),s.jsx(Nt,{path:"/auth/user-selection",element:s.jsx(xs,{requireAuth:!1,children:s.jsx(jN,{})})}),s.jsx(Nt,{path:"/auth/password",element:s.jsx(xs,{requireAuth:!1,children:s.jsx(wN,{})})}),s.jsx(Nt,{path:"/auth/change-password",element:s.jsx(xs,{requireAuth:!1,children:s.jsx(kN,{})})}),s.jsx(Nt,{path:"/dashboard",element:s.jsx(xs,{requireAuth:!0,children:s.jsx(Lg,{})})}),s.jsx(Nt,{path:"/dashboard/:tab",element:s.jsx(xs,{requireAuth:!0,children:s.jsx(Lg,{})})}),s.jsx(Nt,{path:"/test/dropdown",element:s.jsx(xs,{requireAuth:!1,children:s.jsx(J1,{})})}),s.jsx(Nt,{path:"/test/task-actions",element:s.jsx(xs,{requireAuth:!1,children:s.jsx(W1,{})})}),s.jsx(Nt,{path:"/",element:s.jsx(fl,{to:"/auth/region-selection",replace:!0})}),s.jsx(Nt,{path:"/auth",element:s.jsx(fl,{to:"/auth/region-selection",replace:!0})}),s.jsx(Nt,{path:"/auth/login",element:s.jsx(fl,{to:"/auth/region-selection",replace:!0})}),s.jsx(Nt,{path:"*",element:s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"404"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Trang không tìm thấy"}),s.jsx("a",{href:"/auth/region-selection",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Về trang chọn khu vực"})]})})})]})}const tS=new iw({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}});function sS(){return s.jsx(bN,{children:s.jsx(cw,{client:tS,children:s.jsx(Cb,{children:s.jsx(vN,{children:s.jsx(pN,{children:s.jsx(eS,{})})})})})})}class Od{constructor(){this.intervalId=null,this.isRunning=!1,this.CHECK_INTERVAL=60*1e3,this.DAILY_CHECK_HOUR=0,this.lastDailyCheck=null}start(){if(this.isRunning){console.log("Scheduled tasks job is already running");return}console.log("Starting scheduled tasks background job..."),this.isRunning=!0,this.runDailyCheck(),this.intervalId=setInterval(()=>{this.checkAndRunDailyJob()},this.CHECK_INTERVAL),console.log(`Scheduled tasks job started. Checking every ${this.CHECK_INTERVAL/1e3} seconds.`)}stop(){if(!this.isRunning){console.log("Scheduled tasks job is not running");return}this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.isRunning=!1,console.log("Scheduled tasks background job stopped")}checkAndRunDailyJob(){const a=new Date,n=a.toISOString().split("T")[0];(a.getHours()===this.DAILY_CHECK_HOUR&&this.lastDailyCheck!==n||this.lastDailyCheck===null)&&this.runDailyCheck()}async runDailyCheck(){try{console.log("Running daily scheduled tasks check..."),console.log("⚠️  Scheduled tasks feature temporarily disabled - database migration pending"),this.lastDailyCheck=new Date().toISOString().split("T")[0]}catch(a){console.error("Error in daily scheduled tasks check:",a)}}notifyTasksMoved(a){"Notification"in window&&Notification.permission==="granted"&&new Notification("Công việc đã lên lịch",{body:`${a.length} công việc đã được thêm vào danh sách hôm nay`,icon:"/favicon.ico"})}async requestNotificationPermission(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.log("This browser does not support notifications"),!1)}async triggerManualCheck(){console.log("Manually triggering scheduled tasks check..."),await this.runDailyCheck()}getStatus(){const a=new Date,n=new Date(a);return n.setDate(n.getDate()+1),n.setHours(0,0,0,0),{isRunning:this.isRunning,lastCheck:this.lastDailyCheck,nextCheck:n.toISOString()}}static initialize(){const a=new Od;return a.requestNotificationPermission(),a.start(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&a.checkAndRunDailyJob()}),window.addEventListener("beforeunload",()=>{a.stop()}),a}}Od.initialize();const Ix=document.getElementById("root");if(!Ix)throw new Error("Root element not found");const aS=mv.createRoot(Ix);aS.render(s.jsx(b.StrictMode,{children:s.jsx(sS,{})}));
//# sourceMappingURL=index-BDyntrmq.js.map
